var Iy=Object.defineProperty;var by=(e,t,n)=>t in e?Iy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Za=(e,t,n)=>by(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Oh=!1;var Sl=Array.isArray,Ry=Array.prototype.indexOf,Cl=Array.from,Sy=Object.defineProperty,ji=Object.getOwnPropertyDescriptor,Cy=Object.getOwnPropertyDescriptors,Py=Object.prototype,xy=Array.prototype,op=Object.getPrototypeOf,Mh=Object.isExtensible;function Vy(e){for(var t=0;t<e.length;t++)e[t]()}const Ve=2,ap=4,sa=8,Pl=16,bn=32,ni=64,xl=128,Ae=256,yo=512,Ne=1024,yn=2048,yr=4096,mn=8192,Vl=16384,up=32768,Nl=65536,Lh=1<<17,Ny=1<<18,lp=1<<19,bu=1<<20,tu=Symbol("$state"),Dy=Symbol(""),cp=new class extends Error{constructor(){super(...arguments);Za(this,"name","StaleReactionError");Za(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function hp(e){return e===this.v}function ky(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function fp(e){return!ky(e,this.v)}function Oy(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function My(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ly(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Fy(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Uy(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function By(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function $y(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let qy=!1;const Dl=1,kl=2,dp=4,jy=8,zy=16,Hy=1,Gy=2,fe=Symbol(),Wy="http://www.w3.org/1999/xhtml";function pp(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ge=null;function Fh(e){ge=e}function gp(e,t=!1,n){var r=ge={p:ge,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};bp(()=>{r.d=!0})}function mp(e){const t=ge;if(t!==null){const o=t.e;if(o!==null){var n=gt,r=ut;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];Bn(s.effect),en(s.reaction),Rp(s.fn)}}finally{Bn(n),en(r)}}ge=t.p,t.m=!0}return{}}function _p(){return!0}function ze(e){if(typeof e!="object"||e===null||tu in e)return e;const t=op(e);if(t!==Py&&t!==xy)return e;var n=new Map,r=Sl(e),i=Ft(0),s=ut,o=u=>{var l=ut;en(s);var c=u();return en(l),c};return r&&n.set("length",Ft(e.length)),new Proxy(e,{defineProperty(u,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Uy();var h=n.get(l);return h===void 0?h=o(()=>{var d=Ft(c.value);return n.set(l,d),d}):tt(h,c.value,!0),!0},deleteProperty(u,l){var c=n.get(l);if(c===void 0){if(l in u){const p=o(()=>Ft(fe));n.set(l,p),eu(i)}}else{if(r&&typeof l=="string"){var h=n.get("length"),d=Number(l);Number.isInteger(d)&&d<h.v&&tt(h,d)}tt(c,fe),eu(i)}return!0},get(u,l,c){var m;if(l===tu)return e;var h=n.get(l),d=l in u;if(h===void 0&&(!d||(m=ji(u,l))!=null&&m.writable)&&(h=o(()=>{var _=ze(d?u[l]:fe),E=Ft(_);return E}),n.set(l,h)),h!==void 0){var p=U(h);return p===fe?void 0:p}return Reflect.get(u,l,c)},getOwnPropertyDescriptor(u,l){var c=Reflect.getOwnPropertyDescriptor(u,l);if(c&&"value"in c){var h=n.get(l);h&&(c.value=U(h))}else if(c===void 0){var d=n.get(l),p=d==null?void 0:d.v;if(d!==void 0&&p!==fe)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return c},has(u,l){var p;if(l===tu)return!0;var c=n.get(l),h=c!==void 0&&c.v!==fe||Reflect.has(u,l);if(c!==void 0||gt!==null&&(!h||(p=ji(u,l))!=null&&p.writable)){c===void 0&&(c=o(()=>{var m=h?ze(u[l]):fe,_=Ft(m);return _}),n.set(l,c));var d=U(c);if(d===fe)return!1}return h},set(u,l,c,h){var N;var d=n.get(l),p=l in u;if(r&&l==="length")for(var m=c;m<d.v;m+=1){var _=n.get(m+"");_!==void 0?tt(_,fe):m in u&&(_=o(()=>Ft(fe)),n.set(m+"",_))}if(d===void 0)(!p||(N=ji(u,l))!=null&&N.writable)&&(d=o(()=>Ft(void 0)),tt(d,ze(c)),n.set(l,d));else{p=d.v!==fe;var E=o(()=>ze(c));tt(d,E)}var v=Reflect.getOwnPropertyDescriptor(u,l);if(v!=null&&v.set&&v.set.call(h,c),!p){if(r&&typeof l=="string"){var P=n.get("length"),S=Number(l);Number.isInteger(S)&&S>=P.v&&tt(P,S+1)}eu(i)}return!0},ownKeys(u){U(i);var l=Reflect.ownKeys(u).filter(d=>{var p=n.get(d);return p===void 0||p.v!==fe});for(var[c,h]of n)h.v!==fe&&!(c in u)&&l.push(c);return l},setPrototypeOf(){By()}})}function eu(e,t=1){tt(e,e.v+t)}function Ol(e){var t=Ve|yn,n=ut!==null&&(ut.f&Ve)!==0?ut:null;return gt===null||n!==null&&(n.f&Ae)!==0?t|=Ae:gt.f|=lp,{ctx:ge,deps:null,effects:null,equals:hp,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??gt,ac:null}}function xn(e){const t=Ol(e);return kp(t),t}function Ky(e){const t=Ol(e);return t.equals=fp,t}function yp(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Un(t[n])}}function Qy(e){for(var t=e.parent;t!==null;){if((t.f&Ve)===0)return t;t=t.parent}return null}function vp(e){var t,n=gt;Bn(Qy(e));try{yp(e),t=Fp(e)}finally{Bn(n)}return t}function wp(e){var t=vp(e);if(e.equals(t)||(e.v=t,e.wv=Mp()),!ii){var n=(Dn||(e.f&Ae)!==0)&&e.deps!==null?yr:Ne;nn(e,n)}}const Qi=new Map;function vo(e,t){var n={f:0,v:e,reactions:null,equals:hp,rv:0,wv:0};return n}function Ft(e,t){const n=vo(e);return kp(n),n}function Xy(e,t=!1,n=!0){const r=vo(e);return t||(r.equals=fp),r}function tt(e,t,n=!1){ut!==null&&(!He||(ut.f&Lh)!==0)&&_p()&&(ut.f&(Ve|Pl|Lh))!==0&&!(zt!=null&&zt[1].includes(e)&&zt[0]===ut)&&$y();let r=n?ze(t):t;return Ru(e,r)}function Ru(e,t){if(!e.equals(t)){var n=e.v;ii?Qi.set(e,t):Qi.set(e,n),e.v=t,(e.f&Ve)!==0&&((e.f&yn)!==0&&vp(e),nn(e,(e.f&Ae)===0?Ne:yr)),e.wv=Mp(),Ep(e,yn),gt!==null&&(gt.f&Ne)!==0&&(gt.f&(bn|ni))===0&&(Re===null?lv([e]):Re.push(e))}return t}function Ep(e,t){var n=e.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i],o=s.f;(o&yn)===0&&(nn(s,t),(o&(Ne|Ae))!==0&&((o&Ve)!==0?Ep(s,yr):Ul(s)))}}let Jy=!1;var Uh,Tp,Ap,Ip;function Yy(){if(Uh===void 0){Uh=window,Tp=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ap=ji(t,"firstChild").get,Ip=ji(t,"nextSibling").get,Mh(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Mh(n)&&(n.__t=void 0)}}function oa(e=""){return document.createTextNode(e)}function Gr(e){return Ap.call(e)}function aa(e){return Ip.call(e)}function Pt(e,t){return Gr(e)}function Si(e,t){{var n=Gr(e);return n instanceof Comment&&n.data===""?aa(n):n}}function Gt(e,t=1,n=!1){let r=e;for(;t--;)r=aa(r);return r}function Zy(e){e.textContent=""}function tv(e){gt===null&&ut===null&&Ly(),ut!==null&&(ut.f&Ae)!==0&&gt===null&&My(),ii&&Oy()}function ev(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ri(e,t,n,r=!0){var i=gt,s={ctx:ge,deps:null,nodes_start:null,nodes_end:null,f:e|yn,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Fl(s),s.f|=up}catch(l){throw Un(s),l}else t!==null&&Ul(s);var o=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(lp|xl))===0;if(!o&&r&&(i!==null&&ev(s,i),ut!==null&&(ut.f&Ve)!==0)){var u=ut;(u.effects??(u.effects=[])).push(s)}return s}function bp(e){const t=ri(sa,null,!1);return nn(t,Ne),t.teardown=e,t}function nv(e){tv();var t=gt!==null&&(gt.f&bn)!==0&&ge!==null&&!ge.m;if(t){var n=ge;(n.e??(n.e=[])).push({fn:e,effect:gt,reaction:ut})}else{var r=Rp(e);return r}}function rv(e){const t=ri(ni,e,!0);return(n={})=>new Promise(r=>{n.outro?wo(t,()=>{Un(t),r(void 0)}):(Un(t),r(void 0))})}function Rp(e){return ri(ap,e,!1)}function iv(e){return ri(sa,e,!0)}function ln(e,t=[],n=Ol){const r=t.map(n);return Ml(()=>e(...r.map(U)))}function Ml(e,t=0){var n=ri(sa|Pl|t,e,!0);return n}function Xi(e,t=!0){return ri(sa|bn,e,!0,t)}function Sp(e){var t=e.teardown;if(t!==null){const n=ii,r=ut;Bh(!0),en(null);try{t.call(null)}finally{Bh(n),en(r)}}}function Cp(e,t=!1){var i;var n=e.first;for(e.first=e.last=null;n!==null;){(i=n.ac)==null||i.abort(cp);var r=n.next;(n.f&ni)!==0?n.parent=null:Un(n,t),n=r}}function sv(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&bn)===0&&Un(t),t=n}}function Un(e,t=!0){var n=!1;(t||(e.f&Ny)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(ov(e.nodes_start,e.nodes_end),n=!0),Cp(e,t&&!n),bo(e,0),nn(e,Vl);var r=e.transitions;if(r!==null)for(const s of r)s.stop();Sp(e);var i=e.parent;i!==null&&i.first!==null&&Pp(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function ov(e,t){for(;e!==null;){var n=e===t?null:aa(e);e.remove(),e=n}}function Pp(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function wo(e,t){var n=[];Ll(e,n,!0),xp(n,()=>{Un(e),t&&t()})}function xp(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Ll(e,t,n){if((e.f&mn)===0){if(e.f^=mn,e.transitions!==null)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&Nl)!==0||(r.f&bn)!==0;Ll(r,t,s?n:!1),r=i}}}function Eo(e){Vp(e,!0)}function Vp(e,t){if((e.f&mn)!==0){e.f^=mn;for(var n=e.first;n!==null;){var r=n.next,i=(n.f&Nl)!==0||(n.f&bn)!==0;Vp(n,i?t:!1),n=r}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let To=[];function av(){var e=To;To=[],Vy(e)}function Np(e){To.length===0&&queueMicrotask(av),To.push(e)}function uv(e){var t=gt;if((t.f&up)===0){if((t.f&xl)===0)throw e;t.fn(e)}else Dp(e,t)}function Dp(e,t){for(;t!==null;){if((t.f&xl)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let Su=!1,Ao=null,ur=!1,ii=!1;function Bh(e){ii=e}let ro=[];let ut=null,He=!1;function en(e){ut=e}let gt=null;function Bn(e){gt=e}let zt=null;function kp(e){ut!==null&&ut.f&bu&&(zt===null?zt=[ut,[e]]:zt[1].push(e))}let oe=null,we=0,Re=null;function lv(e){Re=e}let Op=1,Io=0,Dn=!1;function Mp(){return++Op}function ua(e){var d;var t=e.f;if((t&yn)!==0)return!0;if((t&yr)!==0){var n=e.deps,r=(t&Ae)!==0;if(n!==null){var i,s,o=(t&yo)!==0,u=r&&gt!==null&&!Dn,l=n.length;if(o||u){var c=e,h=c.parent;for(i=0;i<l;i++)s=n[i],(o||!((d=s==null?void 0:s.reactions)!=null&&d.includes(c)))&&(s.reactions??(s.reactions=[])).push(c);o&&(c.f^=yo),u&&h!==null&&(h.f&Ae)===0&&(c.f^=Ae)}for(i=0;i<l;i++)if(s=n[i],ua(s)&&wp(s),s.wv>e.wv)return!0}(!r||gt!==null&&!Dn)&&nn(e,Ne)}return!1}function Lp(e,t,n=!0){var r=e.reactions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];zt!=null&&zt[1].includes(e)&&zt[0]===ut||((s.f&Ve)!==0?Lp(s,t,!1):t===s&&(n?nn(s,yn):(s.f&Ne)!==0&&nn(s,yr),Ul(s)))}}function Fp(e){var m;var t=oe,n=we,r=Re,i=ut,s=Dn,o=zt,u=ge,l=He,c=e.f;oe=null,we=0,Re=null,Dn=(c&Ae)!==0&&(He||!ur||ut===null),ut=(c&(bn|ni))===0?e:null,zt=null,Fh(e.ctx),He=!1,Io++,e.f|=bu,e.ac!==null&&(e.ac.abort(cp),e.ac=null);try{var h=(0,e.fn)(),d=e.deps;if(oe!==null){var p;if(bo(e,we),d!==null&&we>0)for(d.length=we+oe.length,p=0;p<oe.length;p++)d[we+p]=oe[p];else e.deps=d=oe;if(!Dn||(c&Ve)!==0&&e.reactions!==null)for(p=we;p<d.length;p++)((m=d[p]).reactions??(m.reactions=[])).push(e)}else d!==null&&we<d.length&&(bo(e,we),d.length=we);if(_p()&&Re!==null&&!He&&d!==null&&(e.f&(Ve|yr|yn))===0)for(p=0;p<Re.length;p++)Lp(Re[p],e);return i!==null&&i!==e&&(Io++,Re!==null&&(r===null?r=Re:r.push(...Re))),h}catch(_){uv(_)}finally{oe=t,we=n,Re=r,ut=i,Dn=s,zt=o,Fh(u),He=l,e.f^=bu}}function cv(e,t){let n=t.reactions;if(n!==null){var r=Ry.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&Ve)!==0&&(oe===null||!oe.includes(t))&&(nn(t,yr),(t.f&(Ae|yo))===0&&(t.f^=yo),yp(t),bo(t,0))}function bo(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)cv(e,n[r])}function Fl(e){var t=e.f;if((t&Vl)===0){nn(e,Ne);var n=gt,r=ur;gt=e,ur=!0;try{(t&Pl)!==0?sv(e):Cp(e),Sp(e);var i=Fp(e);e.teardown=typeof i=="function"?i:null,e.wv=Op;var s;Oh&&qy&&(e.f&yn)!==0&&e.deps}finally{ur=r,gt=n}}}function hv(){try{Fy()}catch(e){if(Ao!==null)Dp(e,Ao);else throw e}}function fv(){var e=ur;try{var t=0;for(ur=!0;ro.length>0;){t++>1e3&&hv();var n=ro,r=n.length;ro=[];for(var i=0;i<r;i++){var s=pv(n[i]);dv(s)}Qi.clear()}}finally{Su=!1,ur=e,Ao=null}}function dv(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(Vl|mn))===0&&ua(r)&&(Fl(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Pp(r):r.fn=null))}}function Ul(e){Su||(Su=!0,queueMicrotask(fv));for(var t=Ao=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(ni|bn))!==0){if((n&Ne)===0)return;t.f^=Ne}}ro.push(t)}function pv(e){for(var t=[],n=e;n!==null;){var r=n.f,i=(r&(bn|ni))!==0,s=i&&(r&Ne)!==0;if(!s&&(r&mn)===0){(r&ap)!==0?t.push(n):i?n.f^=Ne:ua(n)&&Fl(n);var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return t}function U(e){var t=e.f,n=(t&Ve)!==0;if(ut!==null&&!He){if(!(zt!=null&&zt[1].includes(e))||zt[0]!==ut){var r=ut.deps;e.rv<Io&&(e.rv=Io,oe===null&&r!==null&&r[we]===e?we++:oe===null?oe=[e]:(!Dn||!oe.includes(e))&&oe.push(e))}}else if(n&&e.deps===null&&e.effects===null){var i=e,s=i.parent;s!==null&&(s.f&Ae)===0&&(i.f^=Ae)}return n&&(i=e,ua(i)&&wp(i)),ii&&Qi.has(e)?Qi.get(e):e.v}function Bl(e){var t=He;try{return He=!0,e()}finally{He=t}}const gv=-7169;function nn(e,t){e.f=e.f&gv|t}const mv=["touchstart","touchmove"];function _v(e){return mv.includes(e)}let $h=!1;function yv(){$h||($h=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function Up(e){var t=ut,n=gt;en(null),Bn(null);try{return e()}finally{en(t),Bn(n)}}function vv(e,t,n,r=n){e.addEventListener(t,()=>Up(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),yv()}const Bp=new Set,Cu=new Set;function wv(e,t,n,r={}){function i(s){if(r.capture||xi.call(t,s),!s.cancelBubble)return Up(()=>n==null?void 0:n.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Np(()=>{t.addEventListener(e,i,r)}):t.addEventListener(e,i,r),i}function Ev(e,t,n,r,i){var s={capture:r,passive:i},o=wv(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&bp(()=>{t.removeEventListener(e,o,s)})}function Tv(e){for(var t=0;t<e.length;t++)Bp.add(e[t]);for(var n of Cu)n(e)}function xi(e){var S;var t=this,n=t.ownerDocument,r=e.type,i=((S=e.composedPath)==null?void 0:S.call(e))||[],s=i[0]||e.target,o=0,u=e.__root;if(u){var l=i.indexOf(u);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=i.indexOf(t);if(c===-1)return;l<=c&&(o=l)}if(s=i[o]||e.target,s!==t){Sy(e,"currentTarget",{configurable:!0,get(){return s||n}});var h=ut,d=gt;en(null),Bn(null);try{for(var p,m=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+r];if(E!=null&&(!s.disabled||e.target===s))if(Sl(E)){var[v,...P]=E;v.apply(s,[e,...P])}else E.call(s,e)}catch(N){p?m.push(N):p=N}if(e.cancelBubble||_===t||_===null)break;s=_}if(p){for(let N of m)queueMicrotask(()=>{throw N});throw p}}finally{e.__root=t,delete e.currentTarget,en(h),Bn(d)}}}function $p(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Ji(e,t){var n=gt;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function Kn(e,t){var n=(t&Hy)!==0,r=(t&Gy)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=$p(s?e:"<!>"+e),n||(i=Gr(i)));var o=r||Tp?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=Gr(o),l=o.lastChild;Ji(u,l)}else Ji(o,o);return o}}function Av(e,t,n="svg"){var r=!e.startsWith("<!>"),i=`<${n}>${r?e:"<!>"+e}</${n}>`,s;return()=>{if(!s){var o=$p(i),u=Gr(o);s=Gr(u)}var l=s.cloneNode(!0);return Ji(l,l),l}}function ms(e,t){return Av(e,t,"svg")}function Iv(e=""){{var t=oa(e+"");return Ji(t,t),t}}function zs(){var e=document.createDocumentFragment(),t=document.createComment(""),n=oa();return e.append(t,n),Ji(t,n),e}function qt(e,t){e!==null&&e.before(t)}function xr(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function bv(e,t){return Rv(e,t)}const Vr=new Map;function Rv(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:o=!0}){Yy();var u=new Set,l=d=>{for(var p=0;p<d.length;p++){var m=d[p];if(!u.has(m)){u.add(m);var _=_v(m);t.addEventListener(m,xi,{passive:_});var E=Vr.get(m);E===void 0?(document.addEventListener(m,xi,{passive:_}),Vr.set(m,1)):Vr.set(m,E+1)}}};l(Cl(Bp)),Cu.add(l);var c=void 0,h=rv(()=>{var d=n??t.appendChild(oa());return Xi(()=>{if(s){gp({});var p=ge;p.c=s}i&&(r.$$events=i),c=e(d,r)||{},s&&mp()}),()=>{var _;for(var p of u){t.removeEventListener(p,xi);var m=Vr.get(p);--m===0?(document.removeEventListener(p,xi),Vr.delete(p)):Vr.set(p,m)}Cu.delete(l),d!==n&&((_=d.parentNode)==null||_.removeChild(d))}});return Sv.set(c,h),c}let Sv=new WeakMap;function cn(e,t,[n,r]=[0,0]){var i=e,s=null,o=null,u=fe,l=n>0?Nl:0,c=!1;const h=(p,m=!0)=>{c=!0,d(m,p)},d=(p,m)=>{u!==(u=p)&&(u?(s?Eo(s):m&&(s=Xi(()=>m(i))),o&&wo(o,()=>{o=null})):(o?Eo(o):m&&(o=Xi(()=>m(i,[n+1,r]))),s&&wo(s,()=>{s=null})))};Ml(()=>{c=!1,t(h),c||d(null,null)},l)}function Nr(e,t){return t}function Cv(e,t,n,r){for(var i=[],s=t.length,o=0;o<s;o++)Ll(t[o].e,i,!0);var u=s>0&&i.length===0&&n!==null;if(u){var l=n.parentNode;Zy(l),l.append(n),r.clear(),Vn(e,t[0].prev,t[s-1].next)}xp(i,()=>{for(var c=0;c<s;c++){var h=t[c];u||(r.delete(h.k),Vn(e,h.prev,h.next)),Un(h.e,!u)}})}function rr(e,t,n,r,i,s=null){var o=e,u={flags:t,items:new Map,first:null},l=(t&dp)!==0;if(l){var c=e;o=c.appendChild(oa())}var h=null,d=!1,p=Ky(()=>{var m=n();return Sl(m)?m:m==null?[]:Cl(m)});Ml(()=>{var m=U(p),_=m.length;d&&_===0||(d=_===0,Pv(m,u,o,i,t,r,n),s!==null&&(_===0?h?Eo(h):h=Xi(()=>s(o)):h!==null&&wo(h,()=>{h=null})),U(p))})}function Pv(e,t,n,r,i,s,o){var X,F,Y,lt;var u=(i&jy)!==0,l=(i&(Dl|kl))!==0,c=e.length,h=t.items,d=t.first,p=d,m,_=null,E,v=[],P=[],S,N,x,M;if(u)for(M=0;M<c;M+=1)S=e[M],N=s(S,M),x=h.get(N),x!==void 0&&((X=x.a)==null||X.measure(),(E??(E=new Set)).add(x));for(M=0;M<c;M+=1){if(S=e[M],N=s(S,M),x=h.get(N),x===void 0){var B=p?p.e.nodes_start:n;_=Vv(B,t,_,_===null?t.first:_.next,S,N,M,r,i,o),h.set(N,_),v=[],P=[],p=_.next;continue}if(l&&xv(x,S,M,i),(x.e.f&mn)!==0&&(Eo(x.e),u&&((F=x.a)==null||F.unfix(),(E??(E=new Set)).delete(x))),x!==p){if(m!==void 0&&m.has(x)){if(v.length<P.length){var I=P[0],w;_=I.prev;var T=v[0],R=v[v.length-1];for(w=0;w<v.length;w+=1)qh(v[w],I,n);for(w=0;w<P.length;w+=1)m.delete(P[w]);Vn(t,T.prev,R.next),Vn(t,_,T),Vn(t,R,I),p=I,_=R,M-=1,v=[],P=[]}else m.delete(x),qh(x,p,n),Vn(t,x.prev,x.next),Vn(t,x,_===null?t.first:_.next),Vn(t,_,x),_=x;continue}for(v=[],P=[];p!==null&&p.k!==N;)(p.e.f&mn)===0&&(m??(m=new Set)).add(p),P.push(p),p=p.next;if(p===null)continue;x=p}v.push(x),_=x,p=x.next}if(p!==null||m!==void 0){for(var b=m===void 0?[]:Cl(m);p!==null;)(p.e.f&mn)===0&&b.push(p),p=p.next;var C=b.length;if(C>0){var A=(i&dp)!==0&&c===0?n:null;if(u){for(M=0;M<C;M+=1)(Y=b[M].a)==null||Y.measure();for(M=0;M<C;M+=1)(lt=b[M].a)==null||lt.fix()}Cv(t,b,A,h)}}u&&Np(()=>{var mt;if(E!==void 0)for(x of E)(mt=x.a)==null||mt.apply()}),gt.first=t.first&&t.first.e,gt.last=_&&_.e}function xv(e,t,n,r){(r&Dl)!==0&&Ru(e.v,t),(r&kl)!==0?Ru(e.i,n):e.i=n}function Vv(e,t,n,r,i,s,o,u,l,c){var h=(l&Dl)!==0,d=(l&zy)===0,p=h?d?Xy(i,!1,!1):vo(i):i,m=(l&kl)===0?o:vo(o),_={i:m,v:p,k:s,a:null,e:null,prev:n,next:r};try{return _.e=Xi(()=>u(e,p,m,c),Jy),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function qh(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var o=aa(s);i.before(s),s=o}}function Vn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}const jh=[...` 	
\r\fÂ \v\uFEFF`];function Nv(e,t,n){var r=""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,o=0;(o=r.indexOf(i,o))>=0;){var u=o+s;(o===0||jh.includes(r[o-1]))&&(u===r.length||jh.includes(r[u]))?r=(o===0?"":r.substring(0,o))+r.substring(u+1):o=u}}return r===""?null:r}function Dv(e,t,n,r,i,s){var o=e.__className;if(o!==n||o===void 0){var u=Nv(n,r,s);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(s&&i!==s)for(var l in s){var c=!!s[l];(i==null||c!==!!i[l])&&e.classList.toggle(l,c)}return s}const kv=Symbol("is custom element"),Ov=Symbol("is html");function Wt(e,t,n,r){var i=Mv(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[Dy]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Lv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Mv(e){return e.__attributes??(e.__attributes={[kv]:e.nodeName.includes("-"),[Ov]:e.namespaceURI===Wy})}var zh=new Map;function Lv(e){var t=zh.get(e.nodeName);if(t)return t;zh.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=Cy(r);for(var s in n)n[s].set&&t.push(s);r=op(r)}return t}function Fv(e,t,n=t){vv(e,"input",r=>{var i=r?e.defaultValue:e.value;if(i=nu(e)?ru(i):i,n(i),i!==(i=t())){var s=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(o,e.value.length))}}),Bl(t)==null&&e.value&&n(nu(e)?ru(e.value):e.value),iv(()=>{var r=t();nu(e)&&r===ru(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function nu(e){var t=e.type;return t==="number"||t==="range"}function ru(e){return e===""?null:+e}function Pu(e){ge===null&&pp(),nv(()=>{const t=Bl(e);if(typeof t=="function")return t})}function Uv(e){ge===null&&pp(),Pu(()=>()=>Bl(e))}const Bv="5";var sp;typeof window<"u"&&((sp=window.__svelte??(window.__svelte={})).v??(sp.v=new Set)).add(Bv);function qp(e,t){return function(){return e.apply(t,arguments)}}const{toString:$v}=Object.prototype,{getPrototypeOf:$l}=Object,{iterator:la,toStringTag:jp}=Symbol,ca=(e=>t=>{const n=$v.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ue=e=>(e=e.toLowerCase(),t=>ca(t)===e),ha=e=>t=>typeof t===e,{isArray:si}=Array,Yi=ha("undefined");function qv(e){return e!==null&&!Yi(e)&&e.constructor!==null&&!Yi(e.constructor)&&me(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const zp=Ue("ArrayBuffer");function jv(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&zp(e.buffer),t}const zv=ha("string"),me=ha("function"),Hp=ha("number"),fa=e=>e!==null&&typeof e=="object",Hv=e=>e===!0||e===!1,io=e=>{if(ca(e)!=="object")return!1;const t=$l(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(jp in e)&&!(la in e)},Gv=Ue("Date"),Wv=Ue("File"),Kv=Ue("Blob"),Qv=Ue("FileList"),Xv=e=>fa(e)&&me(e.pipe),Jv=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||me(e.append)&&((t=ca(e))==="formdata"||t==="object"&&me(e.toString)&&e.toString()==="[object FormData]"))},Yv=Ue("URLSearchParams"),[Zv,t0,e0,n0]=["ReadableStream","Request","Response","Headers"].map(Ue),r0=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _s(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),si(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],t.call(null,e[u],u,e)}}function Gp(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const sr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Wp=e=>!Yi(e)&&e!==sr;function xu(){const{caseless:e}=Wp(this)&&this||{},t={},n=(r,i)=>{const s=e&&Gp(t,i)||i;io(t[s])&&io(r)?t[s]=xu(t[s],r):io(r)?t[s]=xu({},r):si(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&_s(arguments[r],n);return t}const i0=(e,t,n,{allOwnKeys:r}={})=>(_s(t,(i,s)=>{n&&me(i)?e[s]=qp(i,n):e[s]=i},{allOwnKeys:r}),e),s0=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),o0=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},a0=(e,t,n,r)=>{let i,s,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&$l(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},u0=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},l0=e=>{if(!e)return null;if(si(e))return e;let t=e.length;if(!Hp(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},c0=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&$l(Uint8Array)),h0=(e,t)=>{const r=(e&&e[la]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},f0=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},d0=Ue("HTMLFormElement"),p0=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Hh=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),g0=Ue("RegExp"),Kp=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};_s(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},m0=e=>{Kp(e,(t,n)=>{if(me(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(me(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},_0=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return si(e)?r(e):r(String(e).split(t)),n},y0=()=>{},v0=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function w0(e){return!!(e&&me(e.append)&&e[jp]==="FormData"&&e[la])}const E0=e=>{const t=new Array(10),n=(r,i)=>{if(fa(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=si(r)?[]:{};return _s(r,(o,u)=>{const l=n(o,i+1);!Yi(l)&&(s[u]=l)}),t[i]=void 0,s}}return r};return n(e,0)},T0=Ue("AsyncFunction"),A0=e=>e&&(fa(e)||me(e))&&me(e.then)&&me(e.catch),Qp=((e,t)=>e?setImmediate:t?((n,r)=>(sr.addEventListener("message",({source:i,data:s})=>{i===sr&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),sr.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",me(sr.postMessage)),I0=typeof queueMicrotask<"u"?queueMicrotask.bind(sr):typeof process<"u"&&process.nextTick||Qp,b0=e=>e!=null&&me(e[la]),D={isArray:si,isArrayBuffer:zp,isBuffer:qv,isFormData:Jv,isArrayBufferView:jv,isString:zv,isNumber:Hp,isBoolean:Hv,isObject:fa,isPlainObject:io,isReadableStream:Zv,isRequest:t0,isResponse:e0,isHeaders:n0,isUndefined:Yi,isDate:Gv,isFile:Wv,isBlob:Kv,isRegExp:g0,isFunction:me,isStream:Xv,isURLSearchParams:Yv,isTypedArray:c0,isFileList:Qv,forEach:_s,merge:xu,extend:i0,trim:r0,stripBOM:s0,inherits:o0,toFlatObject:a0,kindOf:ca,kindOfTest:Ue,endsWith:u0,toArray:l0,forEachEntry:h0,matchAll:f0,isHTMLForm:d0,hasOwnProperty:Hh,hasOwnProp:Hh,reduceDescriptors:Kp,freezeMethods:m0,toObjectSet:_0,toCamelCase:p0,noop:y0,toFiniteNumber:v0,findKey:Gp,global:sr,isContextDefined:Wp,isSpecCompliantForm:w0,toJSONObject:E0,isAsyncFn:T0,isThenable:A0,setImmediate:Qp,asap:I0,isIterable:b0};function Z(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}D.inherits(Z,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const Xp=Z.prototype,Jp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Jp[e]={value:e}});Object.defineProperties(Z,Jp);Object.defineProperty(Xp,"isAxiosError",{value:!0});Z.from=(e,t,n,r,i,s)=>{const o=Object.create(Xp);return D.toFlatObject(e,o,function(l){return l!==Error.prototype},u=>u!=="isAxiosError"),Z.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const R0=null;function Vu(e){return D.isPlainObject(e)||D.isArray(e)}function Yp(e){return D.endsWith(e,"[]")?e.slice(0,-2):e}function Gh(e,t,n){return e?e.concat(t).map(function(i,s){return i=Yp(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function S0(e){return D.isArray(e)&&!e.some(Vu)}const C0=D.toFlatObject(D,{},null,function(t){return/^is[A-Z]/.test(t)});function da(e,t,n){if(!D.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=D.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,v){return!D.isUndefined(v[E])});const r=n.metaTokens,i=n.visitor||h,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(i))throw new TypeError("visitor must be a function");function c(_){if(_===null)return"";if(D.isDate(_))return _.toISOString();if(D.isBoolean(_))return _.toString();if(!l&&D.isBlob(_))throw new Z("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(_)||D.isTypedArray(_)?l&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,E,v){let P=_;if(_&&!v&&typeof _=="object"){if(D.endsWith(E,"{}"))E=r?E:E.slice(0,-2),_=JSON.stringify(_);else if(D.isArray(_)&&S0(_)||(D.isFileList(_)||D.endsWith(E,"[]"))&&(P=D.toArray(_)))return E=Yp(E),P.forEach(function(N,x){!(D.isUndefined(N)||N===null)&&t.append(o===!0?Gh([E],x,s):o===null?E:E+"[]",c(N))}),!1}return Vu(_)?!0:(t.append(Gh(v,E,s),c(_)),!1)}const d=[],p=Object.assign(C0,{defaultVisitor:h,convertValue:c,isVisitable:Vu});function m(_,E){if(!D.isUndefined(_)){if(d.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));d.push(_),D.forEach(_,function(P,S){(!(D.isUndefined(P)||P===null)&&i.call(t,P,D.isString(S)?S.trim():S,E,p))===!0&&m(P,E?E.concat(S):[S])}),d.pop()}}if(!D.isObject(e))throw new TypeError("data must be an object");return m(e),t}function Wh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function ql(e,t){this._pairs=[],e&&da(e,this,t)}const Zp=ql.prototype;Zp.append=function(t,n){this._pairs.push([t,n])};Zp.toString=function(t){const n=t?function(r){return t.call(this,r,Wh)}:Wh;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function P0(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function tg(e,t,n){if(!t)return e;const r=n&&n.encode||P0;D.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=D.isURLSearchParams(t)?t.toString():new ql(t,n).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Kh{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){D.forEach(this.handlers,function(r){r!==null&&t(r)})}}const eg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},x0=typeof URLSearchParams<"u"?URLSearchParams:ql,V0=typeof FormData<"u"?FormData:null,N0=typeof Blob<"u"?Blob:null,D0={isBrowser:!0,classes:{URLSearchParams:x0,FormData:V0,Blob:N0},protocols:["http","https","file","blob","url","data"]},jl=typeof window<"u"&&typeof document<"u",Nu=typeof navigator=="object"&&navigator||void 0,k0=jl&&(!Nu||["ReactNative","NativeScript","NS"].indexOf(Nu.product)<0),O0=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",M0=jl&&window.location.href||"http://localhost",L0=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:jl,hasStandardBrowserEnv:k0,hasStandardBrowserWebWorkerEnv:O0,navigator:Nu,origin:M0},Symbol.toStringTag,{value:"Module"})),re={...L0,...D0};function F0(e,t){return da(e,new re.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return re.isNode&&D.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function U0(e){return D.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function B0(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function ng(e){function t(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),l=s>=n.length;return o=!o&&D.isArray(i)?i.length:o,l?(D.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!D.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],s)&&D.isArray(i[o])&&(i[o]=B0(i[o])),!u)}if(D.isFormData(e)&&D.isFunction(e.entries)){const n={};return D.forEachEntry(e,(r,i)=>{t(U0(r),i,n,0)}),n}return null}function $0(e,t,n){if(D.isString(e))try{return(t||JSON.parse)(e),D.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const ys={transitional:eg,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=D.isObject(t);if(s&&D.isHTMLForm(t)&&(t=new FormData(t)),D.isFormData(t))return i?JSON.stringify(ng(t)):t;if(D.isArrayBuffer(t)||D.isBuffer(t)||D.isStream(t)||D.isFile(t)||D.isBlob(t)||D.isReadableStream(t))return t;if(D.isArrayBufferView(t))return t.buffer;if(D.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return F0(t,this.formSerializer).toString();if((u=D.isFileList(t))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return da(u?{"files[]":t}:t,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),$0(t)):t}],transformResponse:[function(t){const n=this.transitional||ys.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(D.isResponse(t)||D.isReadableStream(t))return t;if(t&&D.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Z.from(u,Z.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:re.classes.FormData,Blob:re.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],e=>{ys.headers[e]={}});const q0=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),j0=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&q0[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Qh=Symbol("internals");function Ci(e){return e&&String(e).trim().toLowerCase()}function so(e){return e===!1||e==null?e:D.isArray(e)?e.map(so):String(e)}function z0(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const H0=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function iu(e,t,n,r,i){if(D.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!D.isString(t)){if(D.isString(r))return t.indexOf(r)!==-1;if(D.isRegExp(r))return r.test(t)}}function G0(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function W0(e,t){const n=D.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,o){return this[r].call(this,t,i,s,o)},configurable:!0})})}let _e=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,l,c){const h=Ci(l);if(!h)throw new Error("header name must be a non-empty string");const d=D.findKey(i,h);(!d||i[d]===void 0||c===!0||c===void 0&&i[d]!==!1)&&(i[d||l]=so(u))}const o=(u,l)=>D.forEach(u,(c,h)=>s(c,h,l));if(D.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(D.isString(t)&&(t=t.trim())&&!H0(t))o(j0(t),n);else if(D.isObject(t)&&D.isIterable(t)){let u={},l,c;for(const h of t){if(!D.isArray(h))throw TypeError("Object iterator must return a key-value pair");u[c=h[0]]=(l=u[c])?D.isArray(l)?[...l,h[1]]:[l,h[1]]:h[1]}o(u,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=Ci(t),t){const r=D.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return z0(i);if(D.isFunction(n))return n.call(this,i,r);if(D.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ci(t),t){const r=D.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||iu(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(o){if(o=Ci(o),o){const u=D.findKey(r,o);u&&(!n||iu(r,r[u],u,n))&&(delete r[u],i=!0)}}return D.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||iu(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return D.forEach(this,(i,s)=>{const o=D.findKey(r,s);if(o){n[o]=so(i),delete n[s];return}const u=t?G0(s):String(s).trim();u!==s&&delete n[s],n[u]=so(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return D.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&D.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[Qh]=this[Qh]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=Ci(o);r[u]||(W0(i,o),r[u]=!0)}return D.isArray(t)?t.forEach(s):s(t),this}};_e.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(_e.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});D.freezeMethods(_e);function su(e,t){const n=this||ys,r=t||n,i=_e.from(r.headers);let s=r.data;return D.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function rg(e){return!!(e&&e.__CANCEL__)}function oi(e,t,n){Z.call(this,e??"canceled",Z.ERR_CANCELED,t,n),this.name="CanceledError"}D.inherits(oi,Z,{__CANCEL__:!0});function ig(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Z("Request failed with status code "+n.status,[Z.ERR_BAD_REQUEST,Z.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function K0(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Q0(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),h=r[s];o||(o=c),n[i]=l,r[i]=c;let d=s,p=0;for(;d!==i;)p+=n[d++],d=d%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),c-o<t)return;const m=h&&c-h;return m?Math.round(p*1e3/m):void 0}}function X0(e,t){let n=0,r=1e3/t,i,s;const o=(c,h=Date.now())=>{n=h,i=null,s&&(clearTimeout(s),s=null),e.apply(null,c)};return[(...c)=>{const h=Date.now(),d=h-n;d>=r?o(c,h):(i=c,s||(s=setTimeout(()=>{s=null,o(i)},r-d)))},()=>i&&o(i)]}const Ro=(e,t,n=3)=>{let r=0;const i=Q0(50,250);return X0(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,l=o-r,c=i(l),h=o<=u;r=o;const d={loaded:o,total:u,progress:u?o/u:void 0,bytes:l,rate:c||void 0,estimated:c&&u&&h?(u-o)/c:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(d)},n)},Xh=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Jh=e=>(...t)=>D.asap(()=>e(...t)),J0=re.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,re.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(re.origin),re.navigator&&/(msie|trident)/i.test(re.navigator.userAgent)):()=>!0,Y0=re.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];D.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),D.isString(r)&&o.push("path="+r),D.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Z0(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function tw(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function sg(e,t,n){let r=!Z0(t);return e&&(r||n==!1)?tw(e,t):t}const Yh=e=>e instanceof _e?{...e}:e;function fr(e,t){t=t||{};const n={};function r(c,h,d,p){return D.isPlainObject(c)&&D.isPlainObject(h)?D.merge.call({caseless:p},c,h):D.isPlainObject(h)?D.merge({},h):D.isArray(h)?h.slice():h}function i(c,h,d,p){if(D.isUndefined(h)){if(!D.isUndefined(c))return r(void 0,c,d,p)}else return r(c,h,d,p)}function s(c,h){if(!D.isUndefined(h))return r(void 0,h)}function o(c,h){if(D.isUndefined(h)){if(!D.isUndefined(c))return r(void 0,c)}else return r(void 0,h)}function u(c,h,d){if(d in t)return r(c,h);if(d in e)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(c,h,d)=>i(Yh(c),Yh(h),d,!0)};return D.forEach(Object.keys(Object.assign({},e,t)),function(h){const d=l[h]||i,p=d(e[h],t[h],h);D.isUndefined(p)&&d!==u||(n[h]=p)}),n}const og=e=>{const t=fr({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=t;t.headers=o=_e.from(o),t.url=tg(sg(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let l;if(D.isFormData(n)){if(re.hasStandardBrowserEnv||re.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...h]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...h].join("; "))}}if(re.hasStandardBrowserEnv&&(r&&D.isFunction(r)&&(r=r(t)),r||r!==!1&&J0(t.url))){const c=i&&s&&Y0.read(s);c&&o.set(i,c)}return t},ew=typeof XMLHttpRequest<"u",nw=ew&&function(e){return new Promise(function(n,r){const i=og(e);let s=i.data;const o=_e.from(i.headers).normalize();let{responseType:u,onUploadProgress:l,onDownloadProgress:c}=i,h,d,p,m,_;function E(){m&&m(),_&&_(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(i.method.toUpperCase(),i.url,!0),v.timeout=i.timeout;function P(){if(!v)return;const N=_e.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),M={data:!u||u==="text"||u==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:N,config:e,request:v};ig(function(I){n(I),E()},function(I){r(I),E()},M),v=null}"onloadend"in v?v.onloadend=P:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(P)},v.onabort=function(){v&&(r(new Z("Request aborted",Z.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new Z("Network Error",Z.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let x=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const M=i.transitional||eg;i.timeoutErrorMessage&&(x=i.timeoutErrorMessage),r(new Z(x,M.clarifyTimeoutError?Z.ETIMEDOUT:Z.ECONNABORTED,e,v)),v=null},s===void 0&&o.setContentType(null),"setRequestHeader"in v&&D.forEach(o.toJSON(),function(x,M){v.setRequestHeader(M,x)}),D.isUndefined(i.withCredentials)||(v.withCredentials=!!i.withCredentials),u&&u!=="json"&&(v.responseType=i.responseType),c&&([p,_]=Ro(c,!0),v.addEventListener("progress",p)),l&&v.upload&&([d,m]=Ro(l),v.upload.addEventListener("progress",d),v.upload.addEventListener("loadend",m)),(i.cancelToken||i.signal)&&(h=N=>{v&&(r(!N||N.type?new oi(null,e,v):N),v.abort(),v=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const S=K0(i.url);if(S&&re.protocols.indexOf(S)===-1){r(new Z("Unsupported protocol "+S+":",Z.ERR_BAD_REQUEST,e));return}v.send(s||null)})},rw=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(c){if(!i){i=!0,u();const h=c instanceof Error?c:this.reason;r.abort(h instanceof Z?h:new oi(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new Z(`timeout ${t} of ms exceeded`,Z.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>D.asap(u),l}},iw=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},sw=async function*(e,t){for await(const n of ow(e))yield*iw(n,t)},ow=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},Zh=(e,t,n,r)=>{const i=sw(e,t);let s=0,o,u=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:h}=await i.next();if(c){u(),l.close();return}let d=h.byteLength;if(n){let p=s+=d;n(p)}l.enqueue(new Uint8Array(h))}catch(c){throw u(c),c}},cancel(l){return u(l),i.return()}},{highWaterMark:2})},pa=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",ag=pa&&typeof ReadableStream=="function",aw=pa&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),ug=(e,...t)=>{try{return!!e(...t)}catch{return!1}},uw=ag&&ug(()=>{let e=!1;const t=new Request(re.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),tf=64*1024,Du=ag&&ug(()=>D.isReadableStream(new Response("").body)),So={stream:Du&&(e=>e.body)};pa&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!So[t]&&(So[t]=D.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Z(`Response type '${t}' is not supported`,Z.ERR_NOT_SUPPORT,r)})})})(new Response);const lw=async e=>{if(e==null)return 0;if(D.isBlob(e))return e.size;if(D.isSpecCompliantForm(e))return(await new Request(re.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(D.isArrayBufferView(e)||D.isArrayBuffer(e))return e.byteLength;if(D.isURLSearchParams(e)&&(e=e+""),D.isString(e))return(await aw(e)).byteLength},cw=async(e,t)=>{const n=D.toFiniteNumber(e.getContentLength());return n??lw(t)},hw=pa&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:l,responseType:c,headers:h,withCredentials:d="same-origin",fetchOptions:p}=og(e);c=c?(c+"").toLowerCase():"text";let m=rw([i,s&&s.toAbortSignal()],o),_;const E=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(l&&uw&&n!=="get"&&n!=="head"&&(v=await cw(h,r))!==0){let M=new Request(t,{method:"POST",body:r,duplex:"half"}),B;if(D.isFormData(r)&&(B=M.headers.get("content-type"))&&h.setContentType(B),M.body){const[I,w]=Xh(v,Ro(Jh(l)));r=Zh(M.body,tf,I,w)}}D.isString(d)||(d=d?"include":"omit");const P="credentials"in Request.prototype;_=new Request(t,{...p,signal:m,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:P?d:void 0});let S=await fetch(_,p);const N=Du&&(c==="stream"||c==="response");if(Du&&(u||N&&E)){const M={};["status","statusText","headers"].forEach(T=>{M[T]=S[T]});const B=D.toFiniteNumber(S.headers.get("content-length")),[I,w]=u&&Xh(B,Ro(Jh(u),!0))||[];S=new Response(Zh(S.body,tf,I,()=>{w&&w(),E&&E()}),M)}c=c||"text";let x=await So[D.findKey(So,c)||"text"](S,e);return!N&&E&&E(),await new Promise((M,B)=>{ig(M,B,{data:x,headers:_e.from(S.headers),status:S.status,statusText:S.statusText,config:e,request:_})})}catch(P){throw E&&E(),P&&P.name==="TypeError"&&/Load failed|fetch/i.test(P.message)?Object.assign(new Z("Network Error",Z.ERR_NETWORK,e,_),{cause:P.cause||P}):Z.from(P,P&&P.code,e,_)}}),ku={http:R0,xhr:nw,fetch:hw};D.forEach(ku,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ef=e=>`- ${e}`,fw=e=>D.isFunction(e)||e===null||e===!1,lg={getAdapter:e=>{e=D.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let o;if(r=n,!fw(n)&&(r=ku[(o=String(n)).toLowerCase()],r===void 0))throw new Z(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,l])=>`adapter ${u} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(ef).join(`
`):" "+ef(s[0]):"as no adapter specified";throw new Z("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:ku};function ou(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new oi(null,e)}function nf(e){return ou(e),e.headers=_e.from(e.headers),e.data=su.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),lg.getAdapter(e.adapter||ys.adapter)(e).then(function(r){return ou(e),r.data=su.call(e,e.transformResponse,r),r.headers=_e.from(r.headers),r},function(r){return rg(r)||(ou(e),r&&r.response&&(r.response.data=su.call(e,e.transformResponse,r.response),r.response.headers=_e.from(r.response.headers))),Promise.reject(r)})}const cg="1.10.0",ga={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ga[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const rf={};ga.transitional=function(t,n,r){function i(s,o){return"[Axios v"+cg+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(t===!1)throw new Z(i(o," has been removed"+(n?" in "+n:"")),Z.ERR_DEPRECATED);return n&&!rf[o]&&(rf[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,u):!0}};ga.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function dw(e,t,n){if(typeof e!="object")throw new Z("options must be an object",Z.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const u=e[s],l=u===void 0||o(u,s,e);if(l!==!0)throw new Z("option "+s+" must be "+l,Z.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Z("Unknown option "+s,Z.ERR_BAD_OPTION)}}const oo={assertOptions:dw,validators:ga},qe=oo.validators;let lr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Kh,response:new Kh}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=fr(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&oo.assertOptions(r,{silentJSONParsing:qe.transitional(qe.boolean),forcedJSONParsing:qe.transitional(qe.boolean),clarifyTimeoutError:qe.transitional(qe.boolean)},!1),i!=null&&(D.isFunction(i)?n.paramsSerializer={serialize:i}:oo.assertOptions(i,{encode:qe.function,serialize:qe.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),oo.assertOptions(n,{baseUrl:qe.spelling("baseURL"),withXsrfToken:qe.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&D.merge(s.common,s[n.method]);s&&D.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),n.headers=_e.concat(o,s);const u=[];let l=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(n)===!1||(l=l&&E.synchronous,u.unshift(E.fulfilled,E.rejected))});const c=[];this.interceptors.response.forEach(function(E){c.push(E.fulfilled,E.rejected)});let h,d=0,p;if(!l){const _=[nf.bind(this),void 0];for(_.unshift.apply(_,u),_.push.apply(_,c),p=_.length,h=Promise.resolve(n);d<p;)h=h.then(_[d++],_[d++]);return h}p=u.length;let m=n;for(d=0;d<p;){const _=u[d++],E=u[d++];try{m=_(m)}catch(v){E.call(this,v);break}}try{h=nf.call(this,m)}catch(_){return Promise.reject(_)}for(d=0,p=c.length;d<p;)h=h.then(c[d++],c[d++]);return h}getUri(t){t=fr(this.defaults,t);const n=sg(t.baseURL,t.url,t.allowAbsoluteUrls);return tg(n,t.params,t.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(t){lr.prototype[t]=function(n,r){return this.request(fr(r||{},{method:t,url:n,data:(r||{}).data}))}});D.forEach(["post","put","patch"],function(t){function n(r){return function(s,o,u){return this.request(fr(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}lr.prototype[t]=n(),lr.prototype[t+"Form"]=n(!0)});let pw=class hg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},t(function(s,o,u){r.reason||(r.reason=new oi(s,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new hg(function(i){t=i}),cancel:t}}};function gw(e){return function(n){return e.apply(null,n)}}function mw(e){return D.isObject(e)&&e.isAxiosError===!0}const Ou={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ou).forEach(([e,t])=>{Ou[t]=e});function fg(e){const t=new lr(e),n=qp(lr.prototype.request,t);return D.extend(n,lr.prototype,t,{allOwnKeys:!0}),D.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return fg(fr(e,i))},n}const It=fg(ys);It.Axios=lr;It.CanceledError=oi;It.CancelToken=pw;It.isCancel=rg;It.VERSION=cg;It.toFormData=da;It.AxiosError=Z;It.Cancel=It.CanceledError;It.all=function(t){return Promise.all(t)};It.spread=gw;It.isAxiosError=mw;It.mergeConfig=fr;It.AxiosHeaders=_e;It.formToJSON=e=>ng(D.isHTMLForm(e)?new FormData(e):e);It.getAdapter=lg.getAdapter;It.HttpStatusCode=Ou;It.default=It;const{Axios:NP,AxiosError:DP,CanceledError:kP,isCancel:OP,CancelToken:MP,VERSION:LP,all:FP,Cancel:UP,isAxiosError:BP,spread:$P,toFormData:qP,AxiosHeaders:jP,HttpStatusCode:zP,formToJSON:HP,getAdapter:GP,mergeConfig:WP}=It;class dr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,u=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);u&&(n[r++]=u),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function*_w(e){for(const t of e)yield*t}function dg(e){return Array.from(_w(e))}var yw={value:()=>{}};function zl(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ao(n)}function ao(e){this._=e}function vw(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ao.prototype=zl.prototype={constructor:ao,on:function(e,t){var n=this._,r=vw(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=ww(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=sf(n[i],e.name,t);else if(t==null)for(i in n)n[i]=sf(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ao(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function ww(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function sf(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=yw,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Mu="http://www.w3.org/1999/xhtml";const of={svg:"http://www.w3.org/2000/svg",xhtml:Mu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ma(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),of.hasOwnProperty(t)?{space:of[t],local:e}:e}function Ew(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Mu&&t.documentElement.namespaceURI===Mu?t.createElement(e):t.createElementNS(n,e)}}function Tw(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function pg(e){var t=ma(e);return(t.local?Tw:Ew)(t)}function Aw(){}function Hl(e){return e==null?Aw:function(){return this.querySelector(e)}}function Iw(e){typeof e!="function"&&(e=Hl(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=new Array(o),l,c,h=0;h<o;++h)(l=s[h])&&(c=e.call(l,l.__data__,h,s))&&("__data__"in l&&(c.__data__=l.__data__),u[h]=c);return new Le(r,this._parents)}function bw(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Rw(){return[]}function gg(e){return e==null?Rw:function(){return this.querySelectorAll(e)}}function Sw(e){return function(){return bw(e.apply(this,arguments))}}function Cw(e){typeof e=="function"?e=Sw(e):e=gg(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],u=o.length,l,c=0;c<u;++c)(l=o[c])&&(r.push(e.call(l,l.__data__,c,o)),i.push(l));return new Le(r,i)}function mg(e){return function(){return this.matches(e)}}function _g(e){return function(t){return t.matches(e)}}var Pw=Array.prototype.find;function xw(e){return function(){return Pw.call(this.children,e)}}function Vw(){return this.firstElementChild}function Nw(e){return this.select(e==null?Vw:xw(typeof e=="function"?e:_g(e)))}var Dw=Array.prototype.filter;function kw(){return Array.from(this.children)}function Ow(e){return function(){return Dw.call(this.children,e)}}function Mw(e){return this.selectAll(e==null?kw:Ow(typeof e=="function"?e:_g(e)))}function Lw(e){typeof e!="function"&&(e=mg(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&u.push(l);return new Le(r,this._parents)}function yg(e){return new Array(e.length)}function Fw(){return new Le(this._enter||this._groups.map(yg),this._parents)}function Co(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Co.prototype={constructor:Co,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Uw(e){return function(){return e}}function Bw(e,t,n,r,i,s){for(var o=0,u,l=t.length,c=s.length;o<c;++o)(u=t[o])?(u.__data__=s[o],r[o]=u):n[o]=new Co(e,s[o]);for(;o<l;++o)(u=t[o])&&(i[o]=u)}function $w(e,t,n,r,i,s,o){var u,l,c=new Map,h=t.length,d=s.length,p=new Array(h),m;for(u=0;u<h;++u)(l=t[u])&&(p[u]=m=o.call(l,l.__data__,u,t)+"",c.has(m)?i[u]=l:c.set(m,l));for(u=0;u<d;++u)m=o.call(e,s[u],u,s)+"",(l=c.get(m))?(r[u]=l,l.__data__=s[u],c.delete(m)):n[u]=new Co(e,s[u]);for(u=0;u<h;++u)(l=t[u])&&c.get(p[u])===l&&(i[u]=l)}function qw(e){return e.__data__}function jw(e,t){if(!arguments.length)return Array.from(this,qw);var n=t?$w:Bw,r=this._parents,i=this._groups;typeof e!="function"&&(e=Uw(e));for(var s=i.length,o=new Array(s),u=new Array(s),l=new Array(s),c=0;c<s;++c){var h=r[c],d=i[c],p=d.length,m=zw(e.call(h,h&&h.__data__,c,r)),_=m.length,E=u[c]=new Array(_),v=o[c]=new Array(_),P=l[c]=new Array(p);n(h,d,E,v,P,m,t);for(var S=0,N=0,x,M;S<_;++S)if(x=E[S]){for(S>=N&&(N=S+1);!(M=v[N])&&++N<_;);x._next=M||null}}return o=new Le(o,r),o._enter=u,o._exit=l,o}function zw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Hw(){return new Le(this._exit||this._groups.map(yg),this._parents)}function Gw(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Ww(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),u=new Array(i),l=0;l<o;++l)for(var c=n[l],h=r[l],d=c.length,p=u[l]=new Array(d),m,_=0;_<d;++_)(m=c[_]||h[_])&&(p[_]=m);for(;l<i;++l)u[l]=n[l];return new Le(u,this._parents)}function Kw(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Qw(e){e||(e=Xw);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],u=o.length,l=i[s]=new Array(u),c,h=0;h<u;++h)(c=o[h])&&(l[h]=c);l.sort(t)}return new Le(i,this._parents).order()}function Xw(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Jw(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Yw(){return Array.from(this)}function Zw(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function tE(){let e=0;for(const t of this)++e;return e}function eE(){return!this.node()}function nE(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,u;s<o;++s)(u=i[s])&&e.call(u,u.__data__,s,i);return this}function rE(e){return function(){this.removeAttribute(e)}}function iE(e){return function(){this.removeAttributeNS(e.space,e.local)}}function sE(e,t){return function(){this.setAttribute(e,t)}}function oE(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function aE(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function uE(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function lE(e,t){var n=ma(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?iE:rE:typeof t=="function"?n.local?uE:aE:n.local?oE:sE)(n,t))}function vg(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function cE(e){return function(){this.style.removeProperty(e)}}function hE(e,t,n){return function(){this.style.setProperty(e,t,n)}}function fE(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function dE(e,t,n){return arguments.length>1?this.each((t==null?cE:typeof t=="function"?fE:hE)(e,t,n??"")):Wr(this.node(),e)}function Wr(e,t){return e.style.getPropertyValue(t)||vg(e).getComputedStyle(e,null).getPropertyValue(t)}function pE(e){return function(){delete this[e]}}function gE(e,t){return function(){this[e]=t}}function mE(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function _E(e,t){return arguments.length>1?this.each((t==null?pE:typeof t=="function"?mE:gE)(e,t)):this.node()[e]}function wg(e){return e.trim().split(/^|\s+/)}function Gl(e){return e.classList||new Eg(e)}function Eg(e){this._node=e,this._names=wg(e.getAttribute("class")||"")}Eg.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Tg(e,t){for(var n=Gl(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Ag(e,t){for(var n=Gl(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function yE(e){return function(){Tg(this,e)}}function vE(e){return function(){Ag(this,e)}}function wE(e,t){return function(){(t.apply(this,arguments)?Tg:Ag)(this,e)}}function EE(e,t){var n=wg(e+"");if(arguments.length<2){for(var r=Gl(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?wE:t?yE:vE)(n,t))}function TE(){this.textContent=""}function AE(e){return function(){this.textContent=e}}function IE(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function bE(e){return arguments.length?this.each(e==null?TE:(typeof e=="function"?IE:AE)(e)):this.node().textContent}function RE(){this.innerHTML=""}function SE(e){return function(){this.innerHTML=e}}function CE(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function PE(e){return arguments.length?this.each(e==null?RE:(typeof e=="function"?CE:SE)(e)):this.node().innerHTML}function xE(){this.nextSibling&&this.parentNode.appendChild(this)}function VE(){return this.each(xE)}function NE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function DE(){return this.each(NE)}function kE(e){var t=typeof e=="function"?e:pg(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function OE(){return null}function ME(e,t){var n=typeof e=="function"?e:pg(e),r=t==null?OE:typeof t=="function"?t:Hl(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function LE(){var e=this.parentNode;e&&e.removeChild(this)}function FE(){return this.each(LE)}function UE(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function BE(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function $E(e){return this.select(e?BE:UE)}function qE(e){return arguments.length?this.property("__data__",e):this.node().__data__}function jE(e){return function(t){e.call(this,t,this.__data__)}}function zE(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function HE(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function GE(e,t,n){return function(){var r=this.__on,i,s=jE(t);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function WE(e,t,n){var r=zE(e+""),i,s=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,c=u.length,h;l<c;++l)for(i=0,h=u[l];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(u=t?GE:HE,i=0;i<s;++i)this.each(u(r[i],t,n));return this}function Ig(e,t,n){var r=vg(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function KE(e,t){return function(){return Ig(this,e,t)}}function QE(e,t){return function(){return Ig(this,e,t.apply(this,arguments))}}function XE(e,t){return this.each((typeof t=="function"?QE:KE)(e,t))}function*JE(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var YE=[null];function Le(e,t){this._groups=e,this._parents=t}function vs(){return new Le([[document.documentElement]],YE)}function ZE(){return this}Le.prototype=vs.prototype={constructor:Le,select:Iw,selectAll:Cw,selectChild:Nw,selectChildren:Mw,filter:Lw,data:jw,enter:Fw,exit:Hw,join:Gw,merge:Ww,selection:ZE,order:Kw,sort:Qw,call:Jw,nodes:Yw,node:Zw,size:tE,empty:eE,each:nE,attr:lE,style:dE,property:_E,classed:EE,text:bE,html:PE,raise:VE,lower:DE,append:kE,insert:ME,remove:FE,clone:$E,datum:qE,on:WE,dispatch:XE,[Symbol.iterator]:JE};function ws(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _a(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function vr(){}var Zi=.7,Po=1/Zi,$r="\\s*([+-]?\\d+)\\s*",ts="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ke="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tT=/^#([0-9a-f]{3,8})$/,eT=new RegExp(`^rgb\\(${$r},${$r},${$r}\\)$`),nT=new RegExp(`^rgb\\(${Ke},${Ke},${Ke}\\)$`),rT=new RegExp(`^rgba\\(${$r},${$r},${$r},${ts}\\)$`),iT=new RegExp(`^rgba\\(${Ke},${Ke},${Ke},${ts}\\)$`),sT=new RegExp(`^hsl\\(${ts},${Ke},${Ke}\\)$`),oT=new RegExp(`^hsla\\(${ts},${Ke},${Ke},${ts}\\)$`),af={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ws(vr,es,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:uf,formatHex:uf,formatHex8:aT,formatHsl:uT,formatRgb:lf,toString:lf});function uf(){return this.rgb().formatHex()}function aT(){return this.rgb().formatHex8()}function uT(){return Rg(this).formatHsl()}function lf(){return this.rgb().formatRgb()}function es(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=tT.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?cf(t):n===3?new ie(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Hs(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Hs(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=eT.exec(e))?new ie(t[1],t[2],t[3],1):(t=nT.exec(e))?new ie(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=rT.exec(e))?Hs(t[1],t[2],t[3],t[4]):(t=iT.exec(e))?Hs(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=sT.exec(e))?df(t[1],t[2]/100,t[3]/100,1):(t=oT.exec(e))?df(t[1],t[2]/100,t[3]/100,t[4]):af.hasOwnProperty(e)?cf(af[e]):e==="transparent"?new ie(NaN,NaN,NaN,0):null}function cf(e){return new ie(e>>16&255,e>>8&255,e&255,1)}function Hs(e,t,n,r){return r<=0&&(e=t=n=NaN),new ie(e,t,n,r)}function bg(e){return e instanceof vr||(e=es(e)),e?(e=e.rgb(),new ie(e.r,e.g,e.b,e.opacity)):new ie}function Lu(e,t,n,r){return arguments.length===1?bg(e):new ie(e,t,n,r??1)}function ie(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ws(ie,Lu,_a(vr,{brighter(e){return e=e==null?Po:Math.pow(Po,e),new ie(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zi:Math.pow(Zi,e),new ie(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ie(cr(this.r),cr(this.g),cr(this.b),xo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hf,formatHex:hf,formatHex8:lT,formatRgb:ff,toString:ff}));function hf(){return`#${or(this.r)}${or(this.g)}${or(this.b)}`}function lT(){return`#${or(this.r)}${or(this.g)}${or(this.b)}${or((isNaN(this.opacity)?1:this.opacity)*255)}`}function ff(){const e=xo(this.opacity);return`${e===1?"rgb(":"rgba("}${cr(this.r)}, ${cr(this.g)}, ${cr(this.b)}${e===1?")":`, ${e})`}`}function xo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function cr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function or(e){return e=cr(e),(e<16?"0":"")+e.toString(16)}function df(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Me(e,t,n,r)}function Rg(e){if(e instanceof Me)return new Me(e.h,e.s,e.l,e.opacity);if(e instanceof vr||(e=es(e)),!e)return new Me;if(e instanceof Me)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,u=s-i,l=(s+i)/2;return u?(t===s?o=(n-r)/u+(n<r)*6:n===s?o=(r-t)/u+2:o=(t-n)/u+4,u/=l<.5?s+i:2-s-i,o*=60):u=l>0&&l<1?0:o,new Me(o,u,l,e.opacity)}function cT(e,t,n,r){return arguments.length===1?Rg(e):new Me(e,t,n,r??1)}function Me(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ws(Me,cT,_a(vr,{brighter(e){return e=e==null?Po:Math.pow(Po,e),new Me(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zi:Math.pow(Zi,e),new Me(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ie(au(e>=240?e-240:e+120,i,r),au(e,i,r),au(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Me(pf(this.h),Gs(this.s),Gs(this.l),xo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xo(this.opacity);return`${e===1?"hsl(":"hsla("}${pf(this.h)}, ${Gs(this.s)*100}%, ${Gs(this.l)*100}%${e===1?")":`, ${e})`}`}}));function pf(e){return e=(e||0)%360,e<0?e+360:e}function Gs(e){return Math.max(0,Math.min(1,e||0))}function au(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const hT=Math.PI/180,fT=180/Math.PI,Vo=18,Sg=.96422,Cg=1,Pg=.82521,xg=4/29,qr=6/29,Vg=3*qr*qr,dT=qr*qr*qr;function Ng(e){if(e instanceof Qe)return new Qe(e.l,e.a,e.b,e.opacity);if(e instanceof pn)return Dg(e);e instanceof ie||(e=bg(e));var t=hu(e.r),n=hu(e.g),r=hu(e.b),i=uu((.2225045*t+.7168786*n+.0606169*r)/Cg),s,o;return t===n&&n===r?s=o=i:(s=uu((.4360747*t+.3850649*n+.1430804*r)/Sg),o=uu((.0139322*t+.0971045*n+.7141733*r)/Pg)),new Qe(116*i-16,500*(s-i),200*(i-o),e.opacity)}function Fu(e,t,n,r){return arguments.length===1?Ng(e):new Qe(e,t,n,r??1)}function Qe(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}ws(Qe,Fu,_a(vr,{brighter(e){return new Qe(this.l+Vo*(e??1),this.a,this.b,this.opacity)},darker(e){return new Qe(this.l-Vo*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Sg*lu(t),e=Cg*lu(e),n=Pg*lu(n),new ie(cu(3.1338561*t-1.6168667*e-.4906146*n),cu(-.9787684*t+1.9161415*e+.033454*n),cu(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function uu(e){return e>dT?Math.pow(e,1/3):e/Vg+xg}function lu(e){return e>qr?e*e*e:Vg*(e-xg)}function cu(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function hu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function pT(e){if(e instanceof pn)return new pn(e.h,e.c,e.l,e.opacity);if(e instanceof Qe||(e=Ng(e)),e.a===0&&e.b===0)return new pn(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*fT;return new pn(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function gT(e,t,n,r){return arguments.length===1?pT(e):new pn(e,t,n,r??1)}function pn(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Dg(e){if(isNaN(e.h))return new Qe(e.l,0,0,e.opacity);var t=e.h*hT;return new Qe(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ws(pn,gT,_a(vr,{brighter(e){return new pn(this.h,this.c,this.l+Vo*(e??1),this.opacity)},darker(e){return new pn(this.h,this.c,this.l-Vo*(e??1),this.opacity)},rgb(){return Dg(this).rgb()}}));const kg=e=>()=>e;function mT(e,t){return function(n){return e+n*t}}function _T(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function yT(e){return(e=+e)==1?Fr:function(t,n){return n-t?_T(t,n,e):kg(isNaN(t)?n:t)}}function Fr(e,t){var n=t-e;return n?mT(e,n):kg(isNaN(e)?t:e)}const gf=function e(t){var n=yT(t);function r(i,s){var o=n((i=Lu(i)).r,(s=Lu(s)).r),u=n(i.g,s.g),l=n(i.b,s.b),c=Fr(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=u(h),i.b=l(h),i.opacity=c(h),i+""}}return r.gamma=e,r}(1);function Nn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Uu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fu=new RegExp(Uu.source,"g");function vT(e){return function(){return e}}function wT(e){return function(t){return e(t)+""}}function ET(e,t){var n=Uu.lastIndex=fu.lastIndex=0,r,i,s,o=-1,u=[],l=[];for(e=e+"",t=t+"";(r=Uu.exec(e))&&(i=fu.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),u[o]?u[o]+=s:u[++o]=s),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,l.push({i:o,x:Nn(r,i)})),n=fu.lastIndex;return n<t.length&&(s=t.slice(n),u[o]?u[o]+=s:u[++o]=s),u.length<2?l[0]?wT(l[0].x):vT(t):(t=l.length,function(c){for(var h=0,d;h<t;++h)u[(d=l[h]).i]=d.x(c);return u.join("")})}var mf=180/Math.PI,Bu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Og(e,t,n,r,i,s){var o,u,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,l/=u),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*mf,skewX:Math.atan(l)*mf,scaleX:o,scaleY:u}}var Ws;function TT(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Bu:Og(t.a,t.b,t.c,t.d,t.e,t.f)}function AT(e){return e==null||(Ws||(Ws=document.createElementNS("http://www.w3.org/2000/svg","g")),Ws.setAttribute("transform",e),!(e=Ws.transform.baseVal.consolidate()))?Bu:(e=e.matrix,Og(e.a,e.b,e.c,e.d,e.e,e.f))}function Mg(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,h,d,p,m,_){if(c!==d||h!==p){var E=m.push("translate(",null,t,null,n);_.push({i:E-4,x:Nn(c,d)},{i:E-2,x:Nn(h,p)})}else(d||p)&&m.push("translate("+d+t+p+n)}function o(c,h,d,p){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),p.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Nn(c,h)})):h&&d.push(i(d)+"rotate("+h+r)}function u(c,h,d,p){c!==h?p.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Nn(c,h)}):h&&d.push(i(d)+"skewX("+h+r)}function l(c,h,d,p,m,_){if(c!==d||h!==p){var E=m.push(i(m)+"scale(",null,",",null,")");_.push({i:E-4,x:Nn(c,d)},{i:E-2,x:Nn(h,p)})}else(d!==1||p!==1)&&m.push(i(m)+"scale("+d+","+p+")")}return function(c,h){var d=[],p=[];return c=e(c),h=e(h),s(c.translateX,c.translateY,h.translateX,h.translateY,d,p),o(c.rotate,h.rotate,d,p),u(c.skewX,h.skewX,d,p),l(c.scaleX,c.scaleY,h.scaleX,h.scaleY,d,p),c=h=null,function(m){for(var _=-1,E=p.length,v;++_<E;)d[(v=p[_]).i]=v.x(m);return d.join("")}}}var IT=Mg(TT,"px, ","px)","deg)"),bT=Mg(AT,", ",")",")");function _f(e,t){var n=Fr((e=Fu(e)).l,(t=Fu(t)).l),r=Fr(e.a,t.a),i=Fr(e.b,t.b),s=Fr(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=s(o),e+""}}var Kr=0,Vi=0,Pi=0,Lg=1e3,No,Ni,Do=0,pr=0,ya=0,ns=typeof performance=="object"&&performance.now?performance:Date,Fg=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Wl(){return pr||(Fg(RT),pr=ns.now()+ya)}function RT(){pr=0}function ko(){this._call=this._time=this._next=null}ko.prototype=Kl.prototype={constructor:ko,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Wl():+n)+(t==null?0:+t),!this._next&&Ni!==this&&(Ni?Ni._next=this:No=this,Ni=this),this._call=e,this._time=n,$u()},stop:function(){this._call&&(this._call=null,this._time=1/0,$u())}};function Kl(e,t,n){var r=new ko;return r.restart(e,t,n),r}function ST(){Wl(),++Kr;for(var e=No,t;e;)(t=pr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Kr}function yf(){pr=(Do=ns.now())+ya,Kr=Vi=0;try{ST()}finally{Kr=0,PT(),pr=0}}function CT(){var e=ns.now(),t=e-Do;t>Lg&&(ya-=t,Do=e)}function PT(){for(var e,t=No,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:No=n);Ni=e,$u(r)}function $u(e){if(!Kr){Vi&&(Vi=clearTimeout(Vi));var t=e-pr;t>24?(e<1/0&&(Vi=setTimeout(yf,e-ns.now()-ya)),Pi&&(Pi=clearInterval(Pi))):(Pi||(Do=ns.now(),Pi=setInterval(CT,Lg)),Kr=1,Fg(yf))}}function vf(e,t,n){var r=new ko;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var xT=zl("start","end","cancel","interrupt"),VT=[],Ug=0,wf=1,qu=2,uo=3,Ef=4,ju=5,lo=6;function va(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;NT(e,n,{name:t,index:r,group:i,on:xT,tween:VT,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Ug})}function Ql(e,t){var n=Be(e,t);if(n.state>Ug)throw new Error("too late; already scheduled");return n}function sn(e,t){var n=Be(e,t);if(n.state>uo)throw new Error("too late; already running");return n}function Be(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function NT(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Kl(s,0,n.time);function s(c){n.state=wf,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var h,d,p,m;if(n.state!==wf)return l();for(h in r)if(m=r[h],m.name===n.name){if(m.state===uo)return vf(o);m.state===Ef?(m.state=lo,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[h]):+h<t&&(m.state=lo,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[h])}if(vf(function(){n.state===uo&&(n.state=Ef,n.timer.restart(u,n.delay,n.time),u(c))}),n.state=qu,n.on.call("start",e,e.__data__,n.index,n.group),n.state===qu){for(n.state=uo,i=new Array(p=n.tween.length),h=0,d=-1;h<p;++h)(m=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=m);i.length=d+1}}function u(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=ju,1),d=-1,p=i.length;++d<p;)i[d].call(e,h);n.state===ju&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=lo,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function DT(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>qu&&r.state<ju,r.state=lo,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function kT(e){return this.each(function(){DT(this,e)})}function OT(e,t){var n,r;return function(){var i=sn(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,u=r.length;o<u;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function MT(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=sn(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var u={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=u;break}l===c&&i.push(u)}s.tween=i}}function LT(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Be(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?OT:MT)(n,e,t))}function Xl(e,t,n){var r=e._id;return e.each(function(){var i=sn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Be(i,r).value[t]}}function Bg(e,t){var n;return(typeof t=="number"?Nn:t instanceof es?gf:(n=es(t))?(t=n,gf):ET)(e,t)}function FT(e){return function(){this.removeAttribute(e)}}function UT(e){return function(){this.removeAttributeNS(e.space,e.local)}}function BT(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function $T(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function qT(e,t,n){var r,i,s;return function(){var o,u=n(this),l;return u==null?void this.removeAttribute(e):(o=this.getAttribute(e),l=u+"",o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,u)))}}function jT(e,t,n){var r,i,s;return function(){var o,u=n(this),l;return u==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),l=u+"",o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,u)))}}function zT(e,t){var n=ma(e),r=n==="transform"?bT:Bg;return this.attrTween(e,typeof t=="function"?(n.local?jT:qT)(n,r,Xl(this,"attr."+e,t)):t==null?(n.local?UT:FT)(n):(n.local?$T:BT)(n,r,t))}function HT(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function GT(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function WT(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&GT(e,s)),n}return i._value=t,i}function KT(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&HT(e,s)),n}return i._value=t,i}function QT(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=ma(e);return this.tween(n,(r.local?WT:KT)(r,t))}function XT(e,t){return function(){Ql(this,e).delay=+t.apply(this,arguments)}}function JT(e,t){return t=+t,function(){Ql(this,e).delay=t}}function YT(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?XT:JT)(t,e)):Be(this.node(),t).delay}function ZT(e,t){return function(){sn(this,e).duration=+t.apply(this,arguments)}}function t1(e,t){return t=+t,function(){sn(this,e).duration=t}}function e1(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ZT:t1)(t,e)):Be(this.node(),t).duration}function n1(e,t){if(typeof t!="function")throw new Error;return function(){sn(this,e).ease=t}}function r1(e){var t=this._id;return arguments.length?this.each(n1(t,e)):Be(this.node(),t).ease}function i1(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;sn(this,e).ease=n}}function s1(e){if(typeof e!="function")throw new Error;return this.each(i1(this._id,e))}function o1(e){typeof e!="function"&&(e=mg(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&u.push(l);return new vn(r,this._parents,this._name,this._id)}function a1(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),u=0;u<s;++u)for(var l=t[u],c=n[u],h=l.length,d=o[u]=new Array(h),p,m=0;m<h;++m)(p=l[m]||c[m])&&(d[m]=p);for(;u<r;++u)o[u]=t[u];return new vn(o,this._parents,this._name,this._id)}function u1(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function l1(e,t,n){var r,i,s=u1(t)?Ql:sn;return function(){var o=s(this,e),u=o.on;u!==r&&(i=(r=u).copy()).on(t,n),o.on=i}}function c1(e,t){var n=this._id;return arguments.length<2?Be(this.node(),n).on.on(e):this.each(l1(n,e,t))}function h1(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function f1(){return this.on("end.remove",h1(this._id))}function d1(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Hl(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var u=r[o],l=u.length,c=s[o]=new Array(l),h,d,p=0;p<l;++p)(h=u[p])&&(d=e.call(h,h.__data__,p,u))&&("__data__"in h&&(d.__data__=h.__data__),c[p]=d,va(c[p],t,n,p,c,Be(h,n)));return new vn(s,this._parents,t,n)}function p1(e){var t=this._name,n=this._id;typeof e!="function"&&(e=gg(e));for(var r=this._groups,i=r.length,s=[],o=[],u=0;u<i;++u)for(var l=r[u],c=l.length,h,d=0;d<c;++d)if(h=l[d]){for(var p=e.call(h,h.__data__,d,l),m,_=Be(h,n),E=0,v=p.length;E<v;++E)(m=p[E])&&va(m,t,n,E,p,_);s.push(p),o.push(h)}return new vn(s,o,t,n)}var g1=vs.prototype.constructor;function m1(){return new g1(this._groups,this._parents)}function _1(e,t){var n,r,i;return function(){var s=Wr(this,e),o=(this.style.removeProperty(e),Wr(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function $g(e){return function(){this.style.removeProperty(e)}}function y1(e,t,n){var r,i=n+"",s;return function(){var o=Wr(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function v1(e,t,n){var r,i,s;return function(){var o=Wr(this,e),u=n(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(e),Wr(this,e))),o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,u))}}function w1(e,t){var n,r,i,s="style."+t,o="end."+s,u;return function(){var l=sn(this,e),c=l.on,h=l.value[s]==null?u||(u=$g(t)):void 0;(c!==n||i!==h)&&(r=(n=c).copy()).on(o,i=h),l.on=r}}function E1(e,t,n){var r=(e+="")=="transform"?IT:Bg;return t==null?this.styleTween(e,_1(e,r)).on("end.style."+e,$g(e)):typeof t=="function"?this.styleTween(e,v1(e,r,Xl(this,"style."+e,t))).each(w1(this._id,e)):this.styleTween(e,y1(e,r,t),n).on("end.style."+e,null)}function T1(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function A1(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&T1(e,o,n)),r}return s._value=t,s}function I1(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,A1(e,t,n??""))}function b1(e){return function(){this.textContent=e}}function R1(e){return function(){var t=e(this);this.textContent=t??""}}function S1(e){return this.tween("text",typeof e=="function"?R1(Xl(this,"text",e)):b1(e==null?"":e+""))}function C1(e){return function(t){this.textContent=e.call(this,t)}}function P1(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&C1(i)),t}return r._value=e,r}function x1(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,P1(e))}function V1(){for(var e=this._name,t=this._id,n=qg(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,l,c=0;c<u;++c)if(l=o[c]){var h=Be(l,t);va(l,e,n,c,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new vn(r,this._parents,e,n)}function N1(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var u={value:o},l={value:function(){--i===0&&s()}};n.each(function(){var c=sn(this,r),h=c.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(l)),c.on=t}),i===0&&s()})}var D1=0;function vn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function qg(){return++D1}var hn=vs.prototype;vn.prototype={constructor:vn,select:d1,selectAll:p1,selectChild:hn.selectChild,selectChildren:hn.selectChildren,filter:o1,merge:a1,selection:m1,transition:V1,call:hn.call,nodes:hn.nodes,node:hn.node,size:hn.size,empty:hn.empty,each:hn.each,on:c1,attr:zT,attrTween:QT,style:E1,styleTween:I1,text:S1,textTween:x1,remove:f1,tween:LT,delay:YT,duration:e1,ease:r1,easeVarying:s1,end:N1,[Symbol.iterator]:hn[Symbol.iterator]};function k1(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var O1={time:null,delay:0,duration:250,ease:k1};function M1(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function L1(e){var t,n;e instanceof vn?(t=e._id,e=e._name):(t=qg(),(n=O1).time=Wl(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,l,c=0;c<u;++c)(l=o[c])&&va(l,e,t,c,o,n||M1(l,t));return new vn(r,this._parents,e,t)}vs.prototype.interrupt=kT;vs.prototype.transition=L1;function F1(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,o=n.length,u,l=0,c=0;for(s=0;s<o;++s)u=n[s],l+=u.x,c+=u.y;for(l=(l/o-e)*r,c=(c/o-t)*r,s=0;s<o;++s)u=n[s],u.x-=l,u.y-=c}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function U1(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return jg(this.cover(t,n),t,n,e)}function jg(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},u=e._x0,l=e._y0,c=e._x1,h=e._y1,d,p,m,_,E,v,P,S;if(!s)return e._root=o,e;for(;s.length;)if((E=t>=(d=(u+c)/2))?u=d:c=d,(v=n>=(p=(l+h)/2))?l=p:h=p,i=s,!(s=s[P=v<<1|E]))return i[P]=o,e;if(m=+e._x.call(null,s.data),_=+e._y.call(null,s.data),t===m&&n===_)return o.next=s,i?i[P]=o:e._root=o,e;do i=i?i[P]=new Array(4):e._root=new Array(4),(E=t>=(d=(u+c)/2))?u=d:c=d,(v=n>=(p=(l+h)/2))?l=p:h=p;while((P=v<<1|E)===(S=(_>=p)<<1|m>=d));return i[S]=s,i[P]=o,e}function B1(e){var t,n,r=e.length,i,s,o=new Array(r),u=new Array(r),l=1/0,c=1/0,h=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,u[n]=s,i<l&&(l=i),i>h&&(h=i),s<c&&(c=s),s>d&&(d=s));if(l>h||c>d)return this;for(this.cover(l,c).cover(h,d),n=0;n<r;++n)jg(this,o[n],u[n],e[n]);return this}function $1(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n||1,u=this._root,l,c;n>e||e>=i||r>t||t>=s;)switch(c=(t<r)<<1|e<n,l=new Array(4),l[c]=u,u=l,o*=2,c){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function q1(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function j1(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ae(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function z1(e,t,n){var r,i=this._x0,s=this._y0,o,u,l,c,h=this._x1,d=this._y1,p=[],m=this._root,_,E;for(m&&p.push(new ae(m,i,s,h,d)),n==null?n=1/0:(i=e-n,s=t-n,h=e+n,d=t+n,n*=n);_=p.pop();)if(!(!(m=_.node)||(o=_.x0)>h||(u=_.y0)>d||(l=_.x1)<i||(c=_.y1)<s))if(m.length){var v=(o+l)/2,P=(u+c)/2;p.push(new ae(m[3],v,P,l,c),new ae(m[2],o,P,v,c),new ae(m[1],v,u,l,P),new ae(m[0],o,u,v,P)),(E=(t>=P)<<1|e>=v)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-E],p[p.length-1-E]=_)}else{var S=e-+this._x.call(null,m.data),N=t-+this._y.call(null,m.data),x=S*S+N*N;if(x<n){var M=Math.sqrt(n=x);i=e-M,s=t-M,h=e+M,d=t+M,r=m.data}}return r}function H1(e){if(isNaN(h=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,u=this._y0,l=this._x1,c=this._y1,h,d,p,m,_,E,v,P;if(!n)return this;if(n.length)for(;;){if((_=h>=(p=(o+l)/2))?o=p:l=p,(E=d>=(m=(u+c)/2))?u=m:c=m,t=n,!(n=n[v=E<<1|_]))return this;if(!n.length)break;(t[v+1&3]||t[v+2&3]||t[v+3&3])&&(r=t,P=v)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[v]=s:delete t[v],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[P]=n:this._root=n),this):(this._root=s,this)}function G1(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function W1(){return this._root}function K1(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Q1(e){var t=[],n,r=this._root,i,s,o,u,l;for(r&&t.push(new ae(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,u=n.x1,l=n.y1)&&r.length){var c=(s+u)/2,h=(o+l)/2;(i=r[3])&&t.push(new ae(i,c,h,u,l)),(i=r[2])&&t.push(new ae(i,s,h,c,l)),(i=r[1])&&t.push(new ae(i,c,o,u,h)),(i=r[0])&&t.push(new ae(i,s,o,c,h))}return this}function X1(e){var t=[],n=[],r;for(this._root&&t.push(new ae(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,u=r.y0,l=r.x1,c=r.y1,h=(o+l)/2,d=(u+c)/2;(s=i[0])&&t.push(new ae(s,o,u,h,d)),(s=i[1])&&t.push(new ae(s,h,u,l,d)),(s=i[2])&&t.push(new ae(s,o,d,h,c)),(s=i[3])&&t.push(new ae(s,h,d,l,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function J1(e){return e[0]}function Y1(e){return arguments.length?(this._x=e,this):this._x}function Z1(e){return e[1]}function tA(e){return arguments.length?(this._y=e,this):this._y}function zg(e,t,n){var r=new Jl(t??J1,n??Z1,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Jl(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function Tf(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ue=zg.prototype=Jl.prototype;ue.copy=function(){var e=new Jl(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Tf(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Tf(r));return e};ue.add=U1;ue.addAll=B1;ue.cover=$1;ue.data=q1;ue.extent=j1;ue.find=z1;ue.remove=H1;ue.removeAll=G1;ue.root=W1;ue.size=K1;ue.visit=Q1;ue.visitAfter=X1;ue.x=Y1;ue.y=tA;function gn(e){return function(){return e}}function Ur(e){return(e()-.5)*1e-6}function eA(e){return e.index}function Af(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function nA(e){var t=eA,n=d,r,i=gn(30),s,o,u,l,c,h=1;e==null&&(e=[]);function d(v){return 1/Math.min(u[v.source.index],u[v.target.index])}function p(v){for(var P=0,S=e.length;P<h;++P)for(var N=0,x,M,B,I,w,T,R;N<S;++N)x=e[N],M=x.source,B=x.target,I=B.x+B.vx-M.x-M.vx||Ur(c),w=B.y+B.vy-M.y-M.vy||Ur(c),T=Math.sqrt(I*I+w*w),T=(T-s[N])/T*v*r[N],I*=T,w*=T,B.vx-=I*(R=l[N]),B.vy-=w*R,M.vx+=I*(R=1-R),M.vy+=w*R}function m(){if(o){var v,P=o.length,S=e.length,N=new Map(o.map((M,B)=>[t(M,B,o),M])),x;for(v=0,u=new Array(P);v<S;++v)x=e[v],x.index=v,typeof x.source!="object"&&(x.source=Af(N,x.source)),typeof x.target!="object"&&(x.target=Af(N,x.target)),u[x.source.index]=(u[x.source.index]||0)+1,u[x.target.index]=(u[x.target.index]||0)+1;for(v=0,l=new Array(S);v<S;++v)x=e[v],l[v]=u[x.source.index]/(u[x.source.index]+u[x.target.index]);r=new Array(S),_(),s=new Array(S),E()}}function _(){if(o)for(var v=0,P=e.length;v<P;++v)r[v]=+n(e[v],v,e)}function E(){if(o)for(var v=0,P=e.length;v<P;++v)s[v]=+i(e[v],v,e)}return p.initialize=function(v,P){o=v,c=P,m()},p.links=function(v){return arguments.length?(e=v,m(),p):e},p.id=function(v){return arguments.length?(t=v,p):t},p.iterations=function(v){return arguments.length?(h=+v,p):h},p.strength=function(v){return arguments.length?(n=typeof v=="function"?v:gn(+v),_(),p):n},p.distance=function(v){return arguments.length?(i=typeof v=="function"?v:gn(+v),E(),p):i},p}const rA=1664525,iA=1013904223,If=4294967296;function sA(){let e=1;return()=>(e=(rA*e+iA)%If)/If}function oA(e){return e.x}function aA(e){return e.y}var uA=10,lA=Math.PI*(3-Math.sqrt(5));function cA(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,u=new Map,l=Kl(d),c=zl("tick","end"),h=sA();e==null&&(e=[]);function d(){p(),c.call("tick",t),n<r&&(l.stop(),c.call("end",t))}function p(E){var v,P=e.length,S;E===void 0&&(E=1);for(var N=0;N<E;++N)for(n+=(s-n)*i,u.forEach(function(x){x(n)}),v=0;v<P;++v)S=e[v],S.fx==null?S.x+=S.vx*=o:(S.x=S.fx,S.vx=0),S.fy==null?S.y+=S.vy*=o:(S.y=S.fy,S.vy=0);return t}function m(){for(var E=0,v=e.length,P;E<v;++E){if(P=e[E],P.index=E,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var S=uA*Math.sqrt(.5+E),N=E*lA;P.x=S*Math.cos(N),P.y=S*Math.sin(N)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function _(E){return E.initialize&&E.initialize(e,h),E}return m(),t={tick:p,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(E){return arguments.length?(e=E,m(),u.forEach(_),t):e},alpha:function(E){return arguments.length?(n=+E,t):n},alphaMin:function(E){return arguments.length?(r=+E,t):r},alphaDecay:function(E){return arguments.length?(i=+E,t):+i},alphaTarget:function(E){return arguments.length?(s=+E,t):s},velocityDecay:function(E){return arguments.length?(o=1-E,t):1-o},randomSource:function(E){return arguments.length?(h=E,u.forEach(_),t):h},force:function(E,v){return arguments.length>1?(v==null?u.delete(E):u.set(E,_(v)),t):u.get(E)},find:function(E,v,P){var S=0,N=e.length,x,M,B,I,w;for(P==null?P=1/0:P*=P,S=0;S<N;++S)I=e[S],x=E-I.x,M=v-I.y,B=x*x+M*M,B<P&&(w=I,P=B);return w},on:function(E,v){return arguments.length>1?(c.on(E,v),t):c.on(E)}}}function hA(){var e,t,n,r,i=gn(-30),s,o=1,u=1/0,l=.81;function c(m){var _,E=e.length,v=zg(e,oA,aA).visitAfter(d);for(r=m,_=0;_<E;++_)t=e[_],v.visit(p)}function h(){if(e){var m,_=e.length,E;for(s=new Array(_),m=0;m<_;++m)E=e[m],s[E.index]=+i(E,m,e)}}function d(m){var _=0,E,v,P=0,S,N,x;if(m.length){for(S=N=x=0;x<4;++x)(E=m[x])&&(v=Math.abs(E.value))&&(_+=E.value,P+=v,S+=v*E.x,N+=v*E.y);m.x=S/P,m.y=N/P}else{E=m,E.x=E.data.x,E.y=E.data.y;do _+=s[E.data.index];while(E=E.next)}m.value=_}function p(m,_,E,v){if(!m.value)return!0;var P=m.x-t.x,S=m.y-t.y,N=v-_,x=P*P+S*S;if(N*N/l<x)return x<u&&(P===0&&(P=Ur(n),x+=P*P),S===0&&(S=Ur(n),x+=S*S),x<o&&(x=Math.sqrt(o*x)),t.vx+=P*m.value*r/x,t.vy+=S*m.value*r/x),!0;if(m.length||x>=u)return;(m.data!==t||m.next)&&(P===0&&(P=Ur(n),x+=P*P),S===0&&(S=Ur(n),x+=S*S),x<o&&(x=Math.sqrt(o*x)));do m.data!==t&&(N=s[m.data.index]*r/x,t.vx+=P*N,t.vy+=S*N);while(m=m.next)}return c.initialize=function(m,_){e=m,n=_,h()},c.strength=function(m){return arguments.length?(i=typeof m=="function"?m:gn(+m),h(),c):i},c.distanceMin=function(m){return arguments.length?(o=m*m,c):Math.sqrt(o)},c.distanceMax=function(m){return arguments.length?(u=m*m,c):Math.sqrt(u)},c.theta=function(m){return arguments.length?(l=m*m,c):Math.sqrt(l)},c}function fA(e,t,n){var r,i=gn(.1),s,o;typeof e!="function"&&(e=gn(+e)),t==null&&(t=0),n==null&&(n=0);function u(c){for(var h=0,d=r.length;h<d;++h){var p=r[h],m=p.x-t||1e-6,_=p.y-n||1e-6,E=Math.sqrt(m*m+_*_),v=(o[h]-E)*s[h]*c/E;p.vx+=m*v,p.vy+=_*v}}function l(){if(r){var c,h=r.length;for(s=new Array(h),o=new Array(h),c=0;c<h;++c)o[c]=+e(r[c],c,r),s[c]=isNaN(o[c])?0:+i(r[c],c,r)}}return u.initialize=function(c){r=c,l()},u.strength=function(c){return arguments.length?(i=typeof c=="function"?c:gn(+c),l(),u):i},u.radius=function(c){return arguments.length?(e=typeof c=="function"?c:gn(+c),l(),u):e},u.x=function(c){return arguments.length?(t=+c,u):t},u.y=function(c){return arguments.length?(n=+c,u):n},u}var pt=1e-6,ot=Math.PI,Pe=ot/2,bf=ot/4,De=ot*2,fn=180/ot,Ee=ot/180,bt=Math.abs,dA=Math.atan,rs=Math.atan2,Vt=Math.cos,Nt=Math.sin,pA=Math.sign||function(e){return e>0?1:e<0?-1:0},wr=Math.sqrt;function gA(e){return e>1?0:e<-1?ot:Math.acos(e)}function is(e){return e>1?Pe:e<-1?-Pe:Math.asin(e)}function xe(){}function Oo(e,t){e&&Sf.hasOwnProperty(e.type)&&Sf[e.type](e,t)}var Rf={Feature:function(e,t){Oo(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Oo(n[r].geometry,t)}},Sf={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){zu(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)zu(n[r],t,0)},Polygon:function(e,t){Cf(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Cf(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Oo(n[r],t)}};function zu(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function Cf(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)zu(e[n],t,1);t.polygonEnd()}function Dr(e,t){e&&Rf.hasOwnProperty(e.type)?Rf[e.type](e,t):Oo(e,t)}function Hu(e){return[rs(e[1],e[0]),is(e[2])]}function Qr(e){var t=e[0],n=e[1],r=Vt(n);return[r*Vt(t),r*Nt(t),Nt(n)]}function Ks(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Mo(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function du(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Qs(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Gu(e){var t=wr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Wu(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function Ku(e,t){return bt(e)>ot&&(e-=Math.round(e/De)*De),[e,t]}Ku.invert=Ku;function mA(e,t,n){return(e%=De)?t||n?Wu(xf(e),Vf(t,n)):xf(e):t||n?Vf(t,n):Ku}function Pf(e){return function(t,n){return t+=e,bt(t)>ot&&(t-=Math.round(t/De)*De),[t,n]}}function xf(e){var t=Pf(e);return t.invert=Pf(-e),t}function Vf(e,t){var n=Vt(e),r=Nt(e),i=Vt(t),s=Nt(t);function o(u,l){var c=Vt(l),h=Vt(u)*c,d=Nt(u)*c,p=Nt(l),m=p*n+h*r;return[rs(d*i-m*s,h*n-p*r),is(m*i+d*s)]}return o.invert=function(u,l){var c=Vt(l),h=Vt(u)*c,d=Nt(u)*c,p=Nt(l),m=p*i-d*s;return[rs(d*i+p*s,h*n+m*r),is(m*n-h*r)]},o}function _A(e,t,n,r,i,s){if(n){var o=Vt(t),u=Nt(t),l=r*n;i==null?(i=t+r*De,s=t-l/2):(i=Nf(o,i),s=Nf(o,s),(r>0?i<s:i>s)&&(i+=r*De));for(var c,h=i;r>0?h>s:h<s;h-=l)c=Hu([o,-u*Vt(h),-u*Nt(h)]),e.point(c[0],c[1])}}function Nf(e,t){t=Qr(t),t[0]-=e,Gu(t);var n=gA(-t[1]);return((-t[2]<0?-n:n)+De-pt)%De}function Hg(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:xe,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function co(e,t){return bt(e[0]-t[0])<pt&&bt(e[1]-t[1])<pt}function Xs(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Gg(e,t,n,r,i){var s=[],o=[],u,l;if(e.forEach(function(_){if(!((E=_.length-1)<=0)){var E,v=_[0],P=_[E],S;if(co(v,P)){if(!v[2]&&!P[2]){for(i.lineStart(),u=0;u<E;++u)i.point((v=_[u])[0],v[1]);i.lineEnd();return}P[0]+=2*pt}s.push(S=new Xs(v,_,null,!0)),o.push(S.o=new Xs(v,null,S,!1)),s.push(S=new Xs(P,_,null,!1)),o.push(S.o=new Xs(P,null,S,!0))}}),!!s.length){for(o.sort(t),Df(s),Df(o),u=0,l=o.length;u<l;++u)o[u].e=n=!n;for(var c=s[0],h,d;;){for(var p=c,m=!0;p.v;)if((p=p.n)===c)return;h=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(m)for(u=0,l=h.length;u<l;++u)i.point((d=h[u])[0],d[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(m)for(h=p.p.z,u=h.length-1;u>=0;--u)i.point((d=h[u])[0],d[1]);else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,h=p.z,m=!m}while(!p.v);i.lineEnd()}}}function Df(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function pu(e){return bt(e[0])<=ot?e[0]:pA(e[0])*((bt(e[0])+ot)%De-ot)}function yA(e,t){var n=pu(t),r=t[1],i=Nt(r),s=[Nt(n),-Vt(n),0],o=0,u=0,l=new dr;i===1?r=Pe+pt:i===-1&&(r=-Pe-pt);for(var c=0,h=e.length;c<h;++c)if(p=(d=e[c]).length)for(var d,p,m=d[p-1],_=pu(m),E=m[1]/2+bf,v=Nt(E),P=Vt(E),S=0;S<p;++S,_=x,v=B,P=I,m=N){var N=d[S],x=pu(N),M=N[1]/2+bf,B=Nt(M),I=Vt(M),w=x-_,T=w>=0?1:-1,R=T*w,b=R>ot,C=v*B;if(l.add(rs(C*T*Nt(R),P*I+C*Vt(R))),o+=b?w+T*De:w,b^_>=n^x>=n){var A=Mo(Qr(m),Qr(N));Gu(A);var X=Mo(s,A);Gu(X);var F=(b^w>=0?-1:1)*is(X[2]);(r>F||r===F&&(A[0]||A[1]))&&(u+=b^w>=0?1:-1)}}return(o<-pt||o<pt&&l<-1e-12)^u&1}function Wg(e,t,n,r){return function(i){var s=t(i),o=Hg(),u=t(o),l=!1,c,h,d,p={point:m,lineStart:E,lineEnd:v,polygonStart:function(){p.point=P,p.lineStart=S,p.lineEnd=N,h=[],c=[]},polygonEnd:function(){p.point=m,p.lineStart=E,p.lineEnd=v,h=dg(h);var x=yA(c,r);h.length?(l||(i.polygonStart(),l=!0),Gg(h,wA,x,n,i)):x&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),h=c=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function m(x,M){e(x,M)&&i.point(x,M)}function _(x,M){s.point(x,M)}function E(){p.point=_,s.lineStart()}function v(){p.point=m,s.lineEnd()}function P(x,M){d.push([x,M]),u.point(x,M)}function S(){u.lineStart(),d=[]}function N(){P(d[0][0],d[0][1]),u.lineEnd();var x=u.clean(),M=o.result(),B,I=M.length,w,T,R;if(d.pop(),c.push(d),d=null,!!I){if(x&1){if(T=M[0],(w=T.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),B=0;B<w;++B)i.point((R=T[B])[0],R[1]);i.lineEnd()}return}I>1&&x&2&&M.push(M.pop().concat(M.shift())),h.push(M.filter(vA))}}return p}}function vA(e){return e.length>1}function wA(e,t){return((e=e.x)[0]<0?e[1]-Pe-pt:Pe-e[1])-((t=t.x)[0]<0?t[1]-Pe-pt:Pe-t[1])}const kf=Wg(function(){return!0},EA,AA,[-ot,-Pe]);function EA(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var u=s>0?ot:-ot,l=bt(s-t);bt(l-ot)<pt?(e.point(t,n=(n+o)/2>0?Pe:-Pe),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&l>=ot&&(bt(t-r)<pt&&(t-=r*pt),bt(s-u)<pt&&(s-=u*pt),n=TA(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=o),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function TA(e,t,n,r){var i,s,o=Nt(e-n);return bt(o)>pt?dA((Nt(t)*(s=Vt(r))*Nt(n)-Nt(r)*(i=Vt(t))*Nt(e))/(i*s*o)):(t+r)/2}function AA(e,t,n,r){var i;if(e==null)i=n*Pe,r.point(-ot,i),r.point(0,i),r.point(ot,i),r.point(ot,0),r.point(ot,-i),r.point(0,-i),r.point(-ot,-i),r.point(-ot,0),r.point(-ot,i);else if(bt(e[0]-t[0])>pt){var s=e[0]<t[0]?ot:-ot;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function IA(e){var t=Vt(e),n=2*Ee,r=t>0,i=bt(t)>pt;function s(h,d,p,m){_A(m,e,n,p,h,d)}function o(h,d){return Vt(h)*Vt(d)>t}function u(h){var d,p,m,_,E;return{lineStart:function(){_=m=!1,E=1},point:function(v,P){var S=[v,P],N,x=o(v,P),M=r?x?0:c(v,P):x?c(v+(v<0?ot:-ot),P):0;if(!d&&(_=m=x)&&h.lineStart(),x!==m&&(N=l(d,S),(!N||co(d,N)||co(S,N))&&(S[2]=1)),x!==m)E=0,x?(h.lineStart(),N=l(S,d),h.point(N[0],N[1])):(N=l(d,S),h.point(N[0],N[1],2),h.lineEnd()),d=N;else if(i&&d&&r^x){var B;!(M&p)&&(B=l(S,d,!0))&&(E=0,r?(h.lineStart(),h.point(B[0][0],B[0][1]),h.point(B[1][0],B[1][1]),h.lineEnd()):(h.point(B[1][0],B[1][1]),h.lineEnd(),h.lineStart(),h.point(B[0][0],B[0][1],3)))}x&&(!d||!co(d,S))&&h.point(S[0],S[1]),d=S,m=x,p=M},lineEnd:function(){m&&h.lineEnd(),d=null},clean:function(){return E|(_&&m)<<1}}}function l(h,d,p){var m=Qr(h),_=Qr(d),E=[1,0,0],v=Mo(m,_),P=Ks(v,v),S=v[0],N=P-S*S;if(!N)return!p&&h;var x=t*P/N,M=-t*S/N,B=Mo(E,v),I=Qs(E,x),w=Qs(v,M);du(I,w);var T=B,R=Ks(I,T),b=Ks(T,T),C=R*R-b*(Ks(I,I)-1);if(!(C<0)){var A=wr(C),X=Qs(T,(-R-A)/b);if(du(X,I),X=Hu(X),!p)return X;var F=h[0],Y=d[0],lt=h[1],mt=d[1],Bt;Y<F&&(Bt=F,F=Y,Y=Bt);var $e=Y-F,le=bt($e-ot)<pt,$t=le||$e<pt;if(!le&&mt<lt&&(Bt=lt,lt=mt,mt=Bt),$t?le?lt+mt>0^X[1]<(bt(X[0]-F)<pt?lt:mt):lt<=X[1]&&X[1]<=mt:$e>ot^(F<=X[0]&&X[0]<=Y)){var ft=Qs(T,(-R+A)/b);return du(ft,I),[X,Hu(ft)]}}}function c(h,d){var p=r?e:ot-e,m=0;return h<-p?m|=1:h>p&&(m|=2),d<-p?m|=4:d>p&&(m|=8),m}return Wg(o,u,s,r?[0,-e]:[-ot,e-ot])}function bA(e,t,n,r,i,s){var o=e[0],u=e[1],l=t[0],c=t[1],h=0,d=1,p=l-o,m=c-u,_;if(_=n-o,!(!p&&_>0)){if(_/=p,p<0){if(_<h)return;_<d&&(d=_)}else if(p>0){if(_>d)return;_>h&&(h=_)}if(_=i-o,!(!p&&_<0)){if(_/=p,p<0){if(_>d)return;_>h&&(h=_)}else if(p>0){if(_<h)return;_<d&&(d=_)}if(_=r-u,!(!m&&_>0)){if(_/=m,m<0){if(_<h)return;_<d&&(d=_)}else if(m>0){if(_>d)return;_>h&&(h=_)}if(_=s-u,!(!m&&_<0)){if(_/=m,m<0){if(_>d)return;_>h&&(h=_)}else if(m>0){if(_<h)return;_<d&&(d=_)}return h>0&&(e[0]=o+h*p,e[1]=u+h*m),d<1&&(t[0]=o+d*p,t[1]=u+d*m),!0}}}}}var Di=1e9,Js=-Di;function RA(e,t,n,r){function i(c,h){return e<=c&&c<=n&&t<=h&&h<=r}function s(c,h,d,p){var m=0,_=0;if(c==null||(m=o(c,d))!==(_=o(h,d))||l(c,h)<0^d>0)do p.point(m===0||m===3?e:n,m>1?r:t);while((m=(m+d+4)%4)!==_);else p.point(h[0],h[1])}function o(c,h){return bt(c[0]-e)<pt?h>0?0:3:bt(c[0]-n)<pt?h>0?2:1:bt(c[1]-t)<pt?h>0?1:0:h>0?3:2}function u(c,h){return l(c.x,h.x)}function l(c,h){var d=o(c,1),p=o(h,1);return d!==p?d-p:d===0?h[1]-c[1]:d===1?c[0]-h[0]:d===2?c[1]-h[1]:h[0]-c[0]}return function(c){var h=c,d=Hg(),p,m,_,E,v,P,S,N,x,M,B,I={point:w,lineStart:C,lineEnd:A,polygonStart:R,polygonEnd:b};function w(F,Y){i(F,Y)&&h.point(F,Y)}function T(){for(var F=0,Y=0,lt=m.length;Y<lt;++Y)for(var mt=m[Y],Bt=1,$e=mt.length,le=mt[0],$t,ft,Rn=le[0],ce=le[1];Bt<$e;++Bt)$t=Rn,ft=ce,le=mt[Bt],Rn=le[0],ce=le[1],ft<=r?ce>r&&(Rn-$t)*(r-ft)>(ce-ft)*(e-$t)&&++F:ce<=r&&(Rn-$t)*(r-ft)<(ce-ft)*(e-$t)&&--F;return F}function R(){h=d,p=[],m=[],B=!0}function b(){var F=T(),Y=B&&F,lt=(p=dg(p)).length;(Y||lt)&&(c.polygonStart(),Y&&(c.lineStart(),s(null,null,1,c),c.lineEnd()),lt&&Gg(p,u,F,s,c),c.polygonEnd()),h=c,p=m=_=null}function C(){I.point=X,m&&m.push(_=[]),M=!0,x=!1,S=N=NaN}function A(){p&&(X(E,v),P&&x&&d.rejoin(),p.push(d.result())),I.point=w,x&&h.lineEnd()}function X(F,Y){var lt=i(F,Y);if(m&&_.push([F,Y]),M)E=F,v=Y,P=lt,M=!1,lt&&(h.lineStart(),h.point(F,Y));else if(lt&&x)h.point(F,Y);else{var mt=[S=Math.max(Js,Math.min(Di,S)),N=Math.max(Js,Math.min(Di,N))],Bt=[F=Math.max(Js,Math.min(Di,F)),Y=Math.max(Js,Math.min(Di,Y))];bA(mt,Bt,e,t,n,r)?(x||(h.lineStart(),h.point(mt[0],mt[1])),h.point(Bt[0],Bt[1]),lt||h.lineEnd(),B=!1):lt&&(h.lineStart(),h.point(F,Y),B=!1)}S=F,N=Y,x=lt}return I}}const Qu=e=>e;var gu=new dr,Xu=new dr,Kg,Qg,Ju,Yu,dn={point:xe,lineStart:xe,lineEnd:xe,polygonStart:function(){dn.lineStart=SA,dn.lineEnd=PA},polygonEnd:function(){dn.lineStart=dn.lineEnd=dn.point=xe,gu.add(bt(Xu)),Xu=new dr},result:function(){var e=gu/2;return gu=new dr,e}};function SA(){dn.point=CA}function CA(e,t){dn.point=Xg,Kg=Ju=e,Qg=Yu=t}function Xg(e,t){Xu.add(Yu*e-Ju*t),Ju=e,Yu=t}function PA(){Xg(Kg,Qg)}var Xr=1/0,Lo=Xr,ss=-Xr,Fo=ss,Uo={point:xA,lineStart:xe,lineEnd:xe,polygonStart:xe,polygonEnd:xe,result:function(){var e=[[Xr,Lo],[ss,Fo]];return ss=Fo=-(Lo=Xr=1/0),e}};function xA(e,t){e<Xr&&(Xr=e),e>ss&&(ss=e),t<Lo&&(Lo=t),t>Fo&&(Fo=t)}var Zu=0,tl=0,ki=0,Bo=0,$o=0,Br=0,el=0,nl=0,Oi=0,Jg,Yg,Ge,We,Se={point:gr,lineStart:Of,lineEnd:Mf,polygonStart:function(){Se.lineStart=DA,Se.lineEnd=kA},polygonEnd:function(){Se.point=gr,Se.lineStart=Of,Se.lineEnd=Mf},result:function(){var e=Oi?[el/Oi,nl/Oi]:Br?[Bo/Br,$o/Br]:ki?[Zu/ki,tl/ki]:[NaN,NaN];return Zu=tl=ki=Bo=$o=Br=el=nl=Oi=0,e}};function gr(e,t){Zu+=e,tl+=t,++ki}function Of(){Se.point=VA}function VA(e,t){Se.point=NA,gr(Ge=e,We=t)}function NA(e,t){var n=e-Ge,r=t-We,i=wr(n*n+r*r);Bo+=i*(Ge+e)/2,$o+=i*(We+t)/2,Br+=i,gr(Ge=e,We=t)}function Mf(){Se.point=gr}function DA(){Se.point=OA}function kA(){Zg(Jg,Yg)}function OA(e,t){Se.point=Zg,gr(Jg=Ge=e,Yg=We=t)}function Zg(e,t){var n=e-Ge,r=t-We,i=wr(n*n+r*r);Bo+=i*(Ge+e)/2,$o+=i*(We+t)/2,Br+=i,i=We*e-Ge*t,el+=i*(Ge+e),nl+=i*(We+t),Oi+=i*3,gr(Ge=e,We=t)}function tm(e){this._context=e}tm.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,De);break}}},result:xe};var rl=new dr,mu,em,nm,Mi,Li,os={point:xe,lineStart:function(){os.point=MA},lineEnd:function(){mu&&rm(em,nm),os.point=xe},polygonStart:function(){mu=!0},polygonEnd:function(){mu=null},result:function(){var e=+rl;return rl=new dr,e}};function MA(e,t){os.point=rm,em=Mi=e,nm=Li=t}function rm(e,t){Mi-=e,Li-=t,rl.add(wr(Mi*Mi+Li*Li)),Mi=e,Li=t}let Lf,qo,Ff,Uf;class Bf{constructor(t){this._append=t==null?im:LA(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Ff||this._append!==qo){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,Ff=r,qo=this._append,Uf=this._,this._=i}this._+=Uf;break}}}result(){const t=this._;return this._="",t.length?t:null}}function im(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function LA(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return im;if(t!==Lf){const n=10**t;Lf=t,qo=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return qo}function FA(e,t){let n=3,r=4.5,i,s;function o(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Dr(u,i(s))),s.result()}return o.area=function(u){return Dr(u,i(dn)),dn.result()},o.measure=function(u){return Dr(u,i(os)),os.result()},o.bounds=function(u){return Dr(u,i(Uo)),Uo.result()},o.centroid=function(u){return Dr(u,i(Se)),Se.result()},o.projection=function(u){return arguments.length?(i=u==null?(e=null,Qu):(e=u).stream,o):e},o.context=function(u){return arguments.length?(s=u==null?(t=null,new Bf(n)):new tm(t=u),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),o):r},o.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const l=Math.floor(u);if(!(l>=0))throw new RangeError(`invalid digits: ${u}`);n=l}return t===null&&(s=new Bf(n)),o},o.projection(e).digits(n).context(t)}function Yl(e){return function(t){var n=new il;for(var r in e)n[r]=e[r];return n.stream=t,n}}function il(){}il.prototype={constructor:il,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Zl(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Dr(n,e.stream(Uo)),t(Uo.result()),r!=null&&e.clipExtent(r),e}function sm(e,t,n){return Zl(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([u,l])},n)}function UA(e,t,n){return sm(e,[[0,0],t],n)}function BA(e,t,n){return Zl(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([o,u])},n)}function $A(e,t,n){return Zl(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,u])},n)}var $f=16,qA=Vt(30*Ee);function qf(e,t){return+t?zA(e,t):jA(e)}function jA(e){return Yl({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function zA(e,t){function n(r,i,s,o,u,l,c,h,d,p,m,_,E,v){var P=c-r,S=h-i,N=P*P+S*S;if(N>4*t&&E--){var x=o+p,M=u+m,B=l+_,I=wr(x*x+M*M+B*B),w=is(B/=I),T=bt(bt(B)-1)<pt||bt(s-d)<pt?(s+d)/2:rs(M,x),R=e(T,w),b=R[0],C=R[1],A=b-r,X=C-i,F=S*A-P*X;(F*F/N>t||bt((P*A+S*X)/N-.5)>.3||o*p+u*m+l*_<qA)&&(n(r,i,s,o,u,l,b,C,T,x/=I,M/=I,B,E,v),v.point(b,C),n(b,C,T,x,M,B,c,h,d,p,m,_,E,v))}}return function(r){var i,s,o,u,l,c,h,d,p,m,_,E,v={point:P,lineStart:S,lineEnd:x,polygonStart:function(){r.polygonStart(),v.lineStart=M},polygonEnd:function(){r.polygonEnd(),v.lineStart=S}};function P(w,T){w=e(w,T),r.point(w[0],w[1])}function S(){d=NaN,v.point=N,r.lineStart()}function N(w,T){var R=Qr([w,T]),b=e(w,T);n(d,p,h,m,_,E,d=b[0],p=b[1],h=w,m=R[0],_=R[1],E=R[2],$f,r),r.point(d,p)}function x(){v.point=P,r.lineEnd()}function M(){S(),v.point=B,v.lineEnd=I}function B(w,T){N(i=w,T),s=d,o=p,u=m,l=_,c=E,v.point=N}function I(){n(d,p,h,m,_,E,s,o,i,u,l,c,$f,r),v.lineEnd=x,x()}return v}}var HA=Yl({point:function(e,t){this.stream.point(e*Ee,t*Ee)}});function GA(e){return Yl({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function WA(e,t,n,r,i){function s(o,u){return o*=r,u*=i,[t+e*o,n-e*u]}return s.invert=function(o,u){return[(o-t)/e*r,(n-u)/e*i]},s}function jf(e,t,n,r,i,s){if(!s)return WA(e,t,n,r,i);var o=Vt(s),u=Nt(s),l=o*e,c=u*e,h=o/e,d=u/e,p=(u*n-o*t)/e,m=(u*t+o*n)/e;function _(E,v){return E*=r,v*=i,[l*E-c*v+t,n-c*E-l*v]}return _.invert=function(E,v){return[r*(h*E-d*v+p),i*(m-d*E-h*v)]},_}function KA(e){return QA(function(){return e})()}function QA(e){var t,n=150,r=480,i=250,s=0,o=0,u=0,l=0,c=0,h,d=0,p=1,m=1,_=null,E=kf,v=null,P,S,N,x=Qu,M=.5,B,I,w,T,R;function b(F){return w(F[0]*Ee,F[1]*Ee)}function C(F){return F=w.invert(F[0],F[1]),F&&[F[0]*fn,F[1]*fn]}b.stream=function(F){return T&&R===F?T:T=HA(GA(h)(E(B(x(R=F)))))},b.preclip=function(F){return arguments.length?(E=F,_=void 0,X()):E},b.postclip=function(F){return arguments.length?(x=F,v=P=S=N=null,X()):x},b.clipAngle=function(F){return arguments.length?(E=+F?IA(_=F*Ee):(_=null,kf),X()):_*fn},b.clipExtent=function(F){return arguments.length?(x=F==null?(v=P=S=N=null,Qu):RA(v=+F[0][0],P=+F[0][1],S=+F[1][0],N=+F[1][1]),X()):v==null?null:[[v,P],[S,N]]},b.scale=function(F){return arguments.length?(n=+F,A()):n},b.translate=function(F){return arguments.length?(r=+F[0],i=+F[1],A()):[r,i]},b.center=function(F){return arguments.length?(s=F[0]%360*Ee,o=F[1]%360*Ee,A()):[s*fn,o*fn]},b.rotate=function(F){return arguments.length?(u=F[0]%360*Ee,l=F[1]%360*Ee,c=F.length>2?F[2]%360*Ee:0,A()):[u*fn,l*fn,c*fn]},b.angle=function(F){return arguments.length?(d=F%360*Ee,A()):d*fn},b.reflectX=function(F){return arguments.length?(p=F?-1:1,A()):p<0},b.reflectY=function(F){return arguments.length?(m=F?-1:1,A()):m<0},b.precision=function(F){return arguments.length?(B=qf(I,M=F*F),X()):wr(M)},b.fitExtent=function(F,Y){return sm(b,F,Y)},b.fitSize=function(F,Y){return UA(b,F,Y)},b.fitWidth=function(F,Y){return BA(b,F,Y)},b.fitHeight=function(F,Y){return $A(b,F,Y)};function A(){var F=jf(n,0,0,p,m,d).apply(null,t(s,o)),Y=jf(n,r-F[0],i-F[1],p,m,d);return h=mA(u,l,c),I=Wu(t,Y),w=Wu(h,I),B=qf(I,M),X()}function X(){return T=R=null,b}return function(){return t=e.apply(this,arguments),b.invert=t.invert&&C,A()}}function om(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}om.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(bt(i)>pt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function XA(){return KA(om).scale(175.295)}function Fi(e,t,n){this.k=e,this.x=t,this.y=n}Fi.prototype={constructor:Fi,scale:function(e){return e===1?this:new Fi(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Fi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Fi.prototype;function JA(e){return e}function YA(e){if(e==null)return JA;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(u,l){l||(t=n=0);var c=2,h=u.length,d=new Array(h);for(d[0]=(t+=u[0])*r+s,d[1]=(n+=u[1])*i+o;c<h;)d[c]=u[c],++c;return d}}function ZA(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function zf(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Hf(e,n)})}:Hf(e,t)}function Hf(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=tI(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function tI(e,t){var n=YA(e.transform),r=e.arcs;function i(h,d){d.length&&d.pop();for(var p=r[h<0?~h:h],m=0,_=p.length;m<_;++m)d.push(n(p[m],m));h<0&&ZA(d,_)}function s(h){return n(h)}function o(h){for(var d=[],p=0,m=h.length;p<m;++p)i(h[p],d);return d.length<2&&d.push(d[0]),d}function u(h){for(var d=o(h);d.length<4;)d.push(d[0]);return d}function l(h){return h.map(u)}function c(h){var d=h.type,p;switch(d){case"GeometryCollection":return{type:d,geometries:h.geometries.map(c)};case"Point":p=s(h.coordinates);break;case"MultiPoint":p=h.coordinates.map(s);break;case"LineString":p=o(h.arcs);break;case"MultiLineString":p=h.arcs.map(o);break;case"Polygon":p=l(h.arcs);break;case"MultiPolygon":p=h.arcs.map(l);break;default:return null}return{type:d,coordinates:p}}return c(t)}const eI=()=>{};var Gf={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const am=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},nI=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],o=e[n++],u=e[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(l>>10)),t[r++]=String.fromCharCode(56320+(l&1023))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},um={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,u=o?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,h=s>>2,d=(s&3)<<4|u>>4;let p=(u&15)<<2|c>>6,m=c&63;l||(m=64,o||(p=64)),r.push(n[h],n[d],n[p],n[m])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(am(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):nI(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],u=i<e.length?n[e.charAt(i)]:0;++i;const c=i<e.length?n[e.charAt(i)]:64;++i;const d=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||u==null||c==null||d==null)throw new rI;const p=s<<2|u>>4;if(r.push(p),c!==64){const m=u<<4&240|c>>2;if(r.push(m),d!==64){const _=c<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class rI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iI=function(e){const t=am(e);return um.encodeByteArray(t,!0)},jo=function(e){return iI(e).replace(/\./g,"")},sI=function(e){try{return um.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI=()=>oI().__FIREBASE_DEFAULTS__,uI=()=>{if(typeof process>"u"||typeof Gf>"u")return;const e=Gf.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},lI=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&sI(e[1]);return t&&JSON.parse(t)},tc=()=>{try{return eI()||aI()||uI()||lI()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},cI=e=>{var t,n;return(n=(t=tc())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},hI=e=>{const t=cI(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},lm=()=>{var e;return(e=tc())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dI(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[jo(JSON.stringify(n)),jo(JSON.stringify(o)),""].join(".")}const zi={};function gI(){const e={prod:[],emulator:[]};for(const t of Object.keys(zi))zi[t]?e.emulator.push(t):e.prod.push(t);return e}function mI(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let Wf=!1;function _I(e,t){if(typeof window>"u"||typeof document>"u"||!ec(window.location.host)||zi[e]===t||zi[e]||Wf)return;zi[e]=t;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=gI().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function u(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Wf=!0,o()},p}function h(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=mI(r),m=n("text"),_=document.getElementById(m)||document.createElement("span"),E=n("learnmore"),v=document.getElementById(E)||document.createElement("a"),P=n("preprendIcon"),S=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;u(N),h(v,E);const x=c();l(S,P),N.append(S,_,v,x),document.body.appendChild(N)}s?(_.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vI(){var e;const t=(e=tc())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wI(){return!vI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function EI(){try{return typeof indexedDB=="object"}catch{return!1}}function TI(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="FirebaseError";class ai extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=AI,Object.setPrototypeOf(this,ai.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cm.prototype.create)}}class cm{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?II(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new ai(i,u,r)}}function II(e,t){return e.replace(bI,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const bI=/\{\$([^}]+)}/g;function zo(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],o=t[i];if(Kf(s)&&Kf(o)){if(!zo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Kf(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(e){return e&&e._delegate?e._delegate:e}class as{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new fI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(CI(t))try{this.getOrInitializeService({instanceIdentifier:ir})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=ir){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ir){return this.instances.has(t)}getOptions(t=ir){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:SI(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=ir){return this.component?this.component.multipleInstances?t:ir:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function SI(e){return e===ir?void 0:e}function CI(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new RI(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(st||(st={}));const xI={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},VI=st.INFO,NI={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},DI=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=NI[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class hm{constructor(t){this.name=t,this._logLevel=VI,this._logHandler=DI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in st))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?xI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...t),this._logHandler(this,st.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...t),this._logHandler(this,st.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,st.INFO,...t),this._logHandler(this,st.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,st.WARN,...t),this._logHandler(this,st.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...t),this._logHandler(this,st.ERROR,...t)}}const kI=(e,t)=>t.some(n=>e instanceof n);let Qf,Xf;function OI(){return Qf||(Qf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MI(){return Xf||(Xf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fm=new WeakMap,sl=new WeakMap,dm=new WeakMap,_u=new WeakMap,nc=new WeakMap;function LI(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(On(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&fm.set(n,e)}).catch(()=>{}),nc.set(t,e),t}function FI(e){if(sl.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});sl.set(e,t)}let ol={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return sl.get(e);if(t==="objectStoreNames")return e.objectStoreNames||dm.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return On(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function UI(e){ol=e(ol)}function BI(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(yu(this),t,...n);return dm.set(r,t.sort?t.sort():[t]),On(r)}:MI().includes(e)?function(...t){return e.apply(yu(this),t),On(fm.get(this))}:function(...t){return On(e.apply(yu(this),t))}}function $I(e){return typeof e=="function"?BI(e):(e instanceof IDBTransaction&&FI(e),kI(e,OI())?new Proxy(e,ol):e)}function On(e){if(e instanceof IDBRequest)return LI(e);if(_u.has(e))return _u.get(e);const t=$I(e);return t!==e&&(_u.set(e,t),nc.set(t,e)),t}const yu=e=>nc.get(e);function qI(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),u=On(o);return r&&o.addEventListener("upgradeneeded",l=>{r(On(o.result),l.oldVersion,l.newVersion,On(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),u}const jI=["get","getKey","getAll","getAllKeys","count"],zI=["put","add","delete","clear"],vu=new Map;function Jf(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(vu.get(t))return vu.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=zI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||jI.includes(n)))return;const s=async function(o,...u){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(u.shift())),(await Promise.all([c[n](...u),i&&l.done]))[0]};return vu.set(t,s),s}UI(e=>({...e,get:(t,n,r)=>Jf(t,n)||e.get(t,n,r),has:(t,n)=>!!Jf(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(GI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function GI(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const al="@firebase/app",Yf="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En=new hm("@firebase/app"),WI="@firebase/app-compat",KI="@firebase/analytics-compat",QI="@firebase/analytics",XI="@firebase/app-check-compat",JI="@firebase/app-check",YI="@firebase/auth",ZI="@firebase/auth-compat",tb="@firebase/database",eb="@firebase/data-connect",nb="@firebase/database-compat",rb="@firebase/functions",ib="@firebase/functions-compat",sb="@firebase/installations",ob="@firebase/installations-compat",ab="@firebase/messaging",ub="@firebase/messaging-compat",lb="@firebase/performance",cb="@firebase/performance-compat",hb="@firebase/remote-config",fb="@firebase/remote-config-compat",db="@firebase/storage",pb="@firebase/storage-compat",gb="@firebase/firestore",mb="@firebase/ai",_b="@firebase/firestore-compat",yb="firebase",vb="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul="[DEFAULT]",wb={[al]:"fire-core",[WI]:"fire-core-compat",[QI]:"fire-analytics",[KI]:"fire-analytics-compat",[JI]:"fire-app-check",[XI]:"fire-app-check-compat",[YI]:"fire-auth",[ZI]:"fire-auth-compat",[tb]:"fire-rtdb",[eb]:"fire-data-connect",[nb]:"fire-rtdb-compat",[rb]:"fire-fn",[ib]:"fire-fn-compat",[sb]:"fire-iid",[ob]:"fire-iid-compat",[ab]:"fire-fcm",[ub]:"fire-fcm-compat",[lb]:"fire-perf",[cb]:"fire-perf-compat",[hb]:"fire-rc",[fb]:"fire-rc-compat",[db]:"fire-gcs",[pb]:"fire-gcs-compat",[gb]:"fire-fst",[_b]:"fire-fst-compat",[mb]:"fire-vertex","fire-js":"fire-js",[yb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho=new Map,Eb=new Map,ll=new Map;function Zf(e,t){try{e.container.addComponent(t)}catch(n){En.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Go(e){const t=e.name;if(ll.has(t))return En.debug(`There were multiple attempts to register component ${t}.`),!1;ll.set(t,e);for(const n of Ho.values())Zf(n,e);for(const n of Eb.values())Zf(n,e);return!0}function Tb(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ab(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mn=new cm("app","Firebase",Ib);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new as("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Mn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb=vb;function pm(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:ul,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw Mn.create("bad-app-name",{appName:String(i)});if(n||(n=lm()),!n)throw Mn.create("no-options");const s=Ho.get(i);if(s){if(zo(n,s.options)&&zo(r,s.config))return s;throw Mn.create("duplicate-app",{appName:i})}const o=new PI(i);for(const l of ll.values())o.addComponent(l);const u=new bb(n,r,o);return Ho.set(i,u),u}function Sb(e=ul){const t=Ho.get(e);if(!t&&e===ul&&lm())return pm();if(!t)throw Mn.create("no-app",{appName:e});return t}function jr(e,t,n){var r;let i=(r=wb[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${t}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),En.warn(u.join(" "));return}Go(new as(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="firebase-heartbeat-database",Pb=1,us="firebase-heartbeat-store";let wu=null;function gm(){return wu||(wu=qI(Cb,Pb,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(us)}catch(n){console.warn(n)}}}}).catch(e=>{throw Mn.create("idb-open",{originalErrorMessage:e.message})})),wu}async function xb(e){try{const n=(await gm()).transaction(us),r=await n.objectStore(us).get(mm(e));return await n.done,r}catch(t){if(t instanceof ai)En.warn(t.message);else{const n=Mn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});En.warn(n.message)}}}async function td(e,t){try{const r=(await gm()).transaction(us,"readwrite");await r.objectStore(us).put(t,mm(e)),await r.done}catch(n){if(n instanceof ai)En.warn(n.message);else{const r=Mn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});En.warn(r.message)}}}function mm(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb=1024,Nb=30;class Db{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Ob(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ed();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>Nb){const o=Mb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){En.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ed(),{heartbeatsToSend:r,unsentEntries:i}=kb(this._heartbeatsCache.heartbeats),s=jo(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return En.warn(n),""}}}function ed(){return new Date().toISOString().substring(0,10)}function kb(e,t=Vb){const n=[];let r=e.slice();for(const i of e){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),nd(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),nd(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Ob{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return EI()?TI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await xb(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return td(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return td(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function nd(e){return jo(JSON.stringify({version:2,heartbeats:e})).length}function Mb(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(e){Go(new as("platform-logger",t=>new HI(t),"PRIVATE")),Go(new as("heartbeat",t=>new Db(t),"PRIVATE")),jr(al,Yf,e),jr(al,Yf,"esm2017"),jr("fire-js","")}Lb("");var Fb="firebase",Ub="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jr(Fb,Ub,"app");var rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ln,_m;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,w){function T(){}T.prototype=w.prototype,I.D=w.prototype,I.prototype=new T,I.prototype.constructor=I,I.C=function(R,b,C){for(var A=Array(arguments.length-2),X=2;X<arguments.length;X++)A[X-2]=arguments[X];return w.prototype[b].apply(R,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,w,T){T||(T=0);var R=Array(16);if(typeof w=="string")for(var b=0;16>b;++b)R[b]=w.charCodeAt(T++)|w.charCodeAt(T++)<<8|w.charCodeAt(T++)<<16|w.charCodeAt(T++)<<24;else for(b=0;16>b;++b)R[b]=w[T++]|w[T++]<<8|w[T++]<<16|w[T++]<<24;w=I.g[0],T=I.g[1],b=I.g[2];var C=I.g[3],A=w+(C^T&(b^C))+R[0]+3614090360&4294967295;w=T+(A<<7&4294967295|A>>>25),A=C+(b^w&(T^b))+R[1]+3905402710&4294967295,C=w+(A<<12&4294967295|A>>>20),A=b+(T^C&(w^T))+R[2]+606105819&4294967295,b=C+(A<<17&4294967295|A>>>15),A=T+(w^b&(C^w))+R[3]+3250441966&4294967295,T=b+(A<<22&4294967295|A>>>10),A=w+(C^T&(b^C))+R[4]+4118548399&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(b^w&(T^b))+R[5]+1200080426&4294967295,C=w+(A<<12&4294967295|A>>>20),A=b+(T^C&(w^T))+R[6]+2821735955&4294967295,b=C+(A<<17&4294967295|A>>>15),A=T+(w^b&(C^w))+R[7]+4249261313&4294967295,T=b+(A<<22&4294967295|A>>>10),A=w+(C^T&(b^C))+R[8]+1770035416&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(b^w&(T^b))+R[9]+2336552879&4294967295,C=w+(A<<12&4294967295|A>>>20),A=b+(T^C&(w^T))+R[10]+4294925233&4294967295,b=C+(A<<17&4294967295|A>>>15),A=T+(w^b&(C^w))+R[11]+2304563134&4294967295,T=b+(A<<22&4294967295|A>>>10),A=w+(C^T&(b^C))+R[12]+1804603682&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(b^w&(T^b))+R[13]+4254626195&4294967295,C=w+(A<<12&4294967295|A>>>20),A=b+(T^C&(w^T))+R[14]+2792965006&4294967295,b=C+(A<<17&4294967295|A>>>15),A=T+(w^b&(C^w))+R[15]+1236535329&4294967295,T=b+(A<<22&4294967295|A>>>10),A=w+(b^C&(T^b))+R[1]+4129170786&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^b&(w^T))+R[6]+3225465664&4294967295,C=w+(A<<9&4294967295|A>>>23),A=b+(w^T&(C^w))+R[11]+643717713&4294967295,b=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(b^C))+R[0]+3921069994&4294967295,T=b+(A<<20&4294967295|A>>>12),A=w+(b^C&(T^b))+R[5]+3593408605&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^b&(w^T))+R[10]+38016083&4294967295,C=w+(A<<9&4294967295|A>>>23),A=b+(w^T&(C^w))+R[15]+3634488961&4294967295,b=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(b^C))+R[4]+3889429448&4294967295,T=b+(A<<20&4294967295|A>>>12),A=w+(b^C&(T^b))+R[9]+568446438&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^b&(w^T))+R[14]+3275163606&4294967295,C=w+(A<<9&4294967295|A>>>23),A=b+(w^T&(C^w))+R[3]+4107603335&4294967295,b=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(b^C))+R[8]+1163531501&4294967295,T=b+(A<<20&4294967295|A>>>12),A=w+(b^C&(T^b))+R[13]+2850285829&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^b&(w^T))+R[2]+4243563512&4294967295,C=w+(A<<9&4294967295|A>>>23),A=b+(w^T&(C^w))+R[7]+1735328473&4294967295,b=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(b^C))+R[12]+2368359562&4294967295,T=b+(A<<20&4294967295|A>>>12),A=w+(T^b^C)+R[5]+4294588738&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^b)+R[8]+2272392833&4294967295,C=w+(A<<11&4294967295|A>>>21),A=b+(C^w^T)+R[11]+1839030562&4294967295,b=C+(A<<16&4294967295|A>>>16),A=T+(b^C^w)+R[14]+4259657740&4294967295,T=b+(A<<23&4294967295|A>>>9),A=w+(T^b^C)+R[1]+2763975236&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^b)+R[4]+1272893353&4294967295,C=w+(A<<11&4294967295|A>>>21),A=b+(C^w^T)+R[7]+4139469664&4294967295,b=C+(A<<16&4294967295|A>>>16),A=T+(b^C^w)+R[10]+3200236656&4294967295,T=b+(A<<23&4294967295|A>>>9),A=w+(T^b^C)+R[13]+681279174&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^b)+R[0]+3936430074&4294967295,C=w+(A<<11&4294967295|A>>>21),A=b+(C^w^T)+R[3]+3572445317&4294967295,b=C+(A<<16&4294967295|A>>>16),A=T+(b^C^w)+R[6]+76029189&4294967295,T=b+(A<<23&4294967295|A>>>9),A=w+(T^b^C)+R[9]+3654602809&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^b)+R[12]+3873151461&4294967295,C=w+(A<<11&4294967295|A>>>21),A=b+(C^w^T)+R[15]+530742520&4294967295,b=C+(A<<16&4294967295|A>>>16),A=T+(b^C^w)+R[2]+3299628645&4294967295,T=b+(A<<23&4294967295|A>>>9),A=w+(b^(T|~C))+R[0]+4096336452&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~b))+R[7]+1126891415&4294967295,C=w+(A<<10&4294967295|A>>>22),A=b+(w^(C|~T))+R[14]+2878612391&4294967295,b=C+(A<<15&4294967295|A>>>17),A=T+(C^(b|~w))+R[5]+4237533241&4294967295,T=b+(A<<21&4294967295|A>>>11),A=w+(b^(T|~C))+R[12]+1700485571&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~b))+R[3]+2399980690&4294967295,C=w+(A<<10&4294967295|A>>>22),A=b+(w^(C|~T))+R[10]+4293915773&4294967295,b=C+(A<<15&4294967295|A>>>17),A=T+(C^(b|~w))+R[1]+2240044497&4294967295,T=b+(A<<21&4294967295|A>>>11),A=w+(b^(T|~C))+R[8]+1873313359&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~b))+R[15]+4264355552&4294967295,C=w+(A<<10&4294967295|A>>>22),A=b+(w^(C|~T))+R[6]+2734768916&4294967295,b=C+(A<<15&4294967295|A>>>17),A=T+(C^(b|~w))+R[13]+1309151649&4294967295,T=b+(A<<21&4294967295|A>>>11),A=w+(b^(T|~C))+R[4]+4149444226&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~b))+R[11]+3174756917&4294967295,C=w+(A<<10&4294967295|A>>>22),A=b+(w^(C|~T))+R[2]+718787259&4294967295,b=C+(A<<15&4294967295|A>>>17),A=T+(C^(b|~w))+R[9]+3951481745&4294967295,I.g[0]=I.g[0]+w&4294967295,I.g[1]=I.g[1]+(b+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+b&4294967295,I.g[3]=I.g[3]+C&4294967295}r.prototype.u=function(I,w){w===void 0&&(w=I.length);for(var T=w-this.blockSize,R=this.B,b=this.h,C=0;C<w;){if(b==0)for(;C<=T;)i(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<w;)if(R[b++]=I.charCodeAt(C++),b==this.blockSize){i(this,R),b=0;break}}else for(;C<w;)if(R[b++]=I[C++],b==this.blockSize){i(this,R),b=0;break}}this.h=b,this.o+=w},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var w=1;w<I.length-8;++w)I[w]=0;var T=8*this.o;for(w=I.length-8;w<I.length;++w)I[w]=T&255,T/=256;for(this.u(I),I=Array(16),w=T=0;4>w;++w)for(var R=0;32>R;R+=8)I[T++]=this.g[w]>>>R&255;return I};function s(I,w){var T=u;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=w(I)}function o(I,w){this.h=w;for(var T=[],R=!0,b=I.length-1;0<=b;b--){var C=I[b]|0;R&&C==w||(T[b]=C,R=!1)}this.g=T}var u={};function l(I){return-128<=I&&128>I?s(I,function(w){return new o([w|0],0>w?-1:0)}):new o([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return v(c(-I));for(var w=[],T=1,R=0;I>=T;R++)w[R]=I/T|0,T*=4294967296;return new o(w,0)}function h(I,w){if(I.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(I.charAt(0)=="-")return v(h(I.substring(1),w));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(w,8)),R=d,b=0;b<I.length;b+=8){var C=Math.min(8,I.length-b),A=parseInt(I.substring(b,b+C),w);8>C?(C=c(Math.pow(w,C)),R=R.j(C).add(c(A))):(R=R.j(T),R=R.add(c(A)))}return R}var d=l(0),p=l(1),m=l(16777216);e=o.prototype,e.m=function(){if(E(this))return-v(this).m();for(var I=0,w=1,T=0;T<this.g.length;T++){var R=this.i(T);I+=(0<=R?R:4294967296+R)*w,w*=4294967296}return I},e.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(E(this))return"-"+v(this).toString(I);for(var w=c(Math.pow(I,6)),T=this,R="";;){var b=x(T,w).g;T=P(T,b.j(w));var C=((0<T.g.length?T.g[0]:T.h)>>>0).toString(I);if(T=b,_(T))return C+R;for(;6>C.length;)C="0"+C;R=C+R}},e.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var w=0;w<I.g.length;w++)if(I.g[w]!=0)return!1;return!0}function E(I){return I.h==-1}e.l=function(I){return I=P(this,I),E(I)?-1:_(I)?0:1};function v(I){for(var w=I.g.length,T=[],R=0;R<w;R++)T[R]=~I.g[R];return new o(T,~I.h).add(p)}e.abs=function(){return E(this)?v(this):this},e.add=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],R=0,b=0;b<=w;b++){var C=R+(this.i(b)&65535)+(I.i(b)&65535),A=(C>>>16)+(this.i(b)>>>16)+(I.i(b)>>>16);R=A>>>16,C&=65535,A&=65535,T[b]=A<<16|C}return new o(T,T[T.length-1]&-2147483648?-1:0)};function P(I,w){return I.add(v(w))}e.j=function(I){if(_(this)||_(I))return d;if(E(this))return E(I)?v(this).j(v(I)):v(v(this).j(I));if(E(I))return v(this.j(v(I)));if(0>this.l(m)&&0>I.l(m))return c(this.m()*I.m());for(var w=this.g.length+I.g.length,T=[],R=0;R<2*w;R++)T[R]=0;for(R=0;R<this.g.length;R++)for(var b=0;b<I.g.length;b++){var C=this.i(R)>>>16,A=this.i(R)&65535,X=I.i(b)>>>16,F=I.i(b)&65535;T[2*R+2*b]+=A*F,S(T,2*R+2*b),T[2*R+2*b+1]+=C*F,S(T,2*R+2*b+1),T[2*R+2*b+1]+=A*X,S(T,2*R+2*b+1),T[2*R+2*b+2]+=C*X,S(T,2*R+2*b+2)}for(R=0;R<w;R++)T[R]=T[2*R+1]<<16|T[2*R];for(R=w;R<2*w;R++)T[R]=0;return new o(T,0)};function S(I,w){for(;(I[w]&65535)!=I[w];)I[w+1]+=I[w]>>>16,I[w]&=65535,w++}function N(I,w){this.g=I,this.h=w}function x(I,w){if(_(w))throw Error("division by zero");if(_(I))return new N(d,d);if(E(I))return w=x(v(I),w),new N(v(w.g),v(w.h));if(E(w))return w=x(I,v(w)),new N(v(w.g),w.h);if(30<I.g.length){if(E(I)||E(w))throw Error("slowDivide_ only works with positive integers.");for(var T=p,R=w;0>=R.l(I);)T=M(T),R=M(R);var b=B(T,1),C=B(R,1);for(R=B(R,2),T=B(T,2);!_(R);){var A=C.add(R);0>=A.l(I)&&(b=b.add(T),C=A),R=B(R,1),T=B(T,1)}return w=P(I,b.j(w)),new N(b,w)}for(b=d;0<=I.l(w);){for(T=Math.max(1,Math.floor(I.m()/w.m())),R=Math.ceil(Math.log(T)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),C=c(T),A=C.j(w);E(A)||0<A.l(I);)T-=R,C=c(T),A=C.j(w);_(C)&&(C=p),b=b.add(C),I=P(I,A)}return new N(b,I)}e.A=function(I){return x(this,I).h},e.and=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],R=0;R<w;R++)T[R]=this.i(R)&I.i(R);return new o(T,this.h&I.h)},e.or=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],R=0;R<w;R++)T[R]=this.i(R)|I.i(R);return new o(T,this.h|I.h)},e.xor=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],R=0;R<w;R++)T[R]=this.i(R)^I.i(R);return new o(T,this.h^I.h)};function M(I){for(var w=I.g.length+1,T=[],R=0;R<w;R++)T[R]=I.i(R)<<1|I.i(R-1)>>>31;return new o(T,I.h)}function B(I,w){var T=w>>5;w%=32;for(var R=I.g.length-T,b=[],C=0;C<R;C++)b[C]=0<w?I.i(C+T)>>>w|I.i(C+T+1)<<32-w:I.i(C+T);return new o(b,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_m=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Ln=o}).apply(typeof rd<"u"?rd:typeof self<"u"?self:typeof window<"u"?window:{});var Ys=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ym,Ui,vm,ho,cl,wm,Em,Tm;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,g){return a==Array.prototype||a==Object.prototype||(a[f]=g.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ys=="object"&&Ys];for(var f=0;f<a.length;++f){var g=a[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(a,f){if(f)t:{var g=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var V=a[y];if(!(V in g))break t;g=g[V]}a=a[a.length-1],y=g[a],f=f(y),f!=y&&f!=null&&t(g,a,{configurable:!0,writable:!0,value:f})}}function s(a,f){a instanceof String&&(a+="");var g=0,y=!1,V={next:function(){if(!y&&g<a.length){var k=g++;return{value:f(k,a[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(a){return a||function(){return s(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function l(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function c(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,g){return a.call.apply(a.bind,arguments)}function d(a,f,g){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,y),a.apply(f,V)}}return function(){return a.apply(f,arguments)}}function p(a,f,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function m(a,f){var g=Array.prototype.slice.call(arguments,1);return function(){var y=g.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function _(a,f){function g(){}g.prototype=f.prototype,a.aa=f.prototype,a.prototype=new g,a.prototype.constructor=a,a.Qb=function(y,V,k){for(var $=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)$[dt-2]=arguments[dt];return f.prototype[V].apply(y,$)}}function E(a){const f=a.length;if(0<f){const g=Array(f);for(let y=0;y<f;y++)g[y]=a[y];return g}return[]}function v(a,f){for(let g=1;g<arguments.length;g++){const y=arguments[g];if(l(y)){const V=a.length||0,k=y.length||0;a.length=V+k;for(let $=0;$<k;$++)a[V+$]=y[$]}else a.push(y)}}class P{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function S(a){return/^[\s\xa0]*$/.test(a)}function N(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function x(a){return x[" "](a),a}x[" "]=function(){};var M=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function B(a,f,g){for(const y in a)f.call(g,a[y],y,a)}function I(a,f){for(const g in a)f.call(void 0,a[g],g,a)}function w(a){const f={};for(const g in a)f[g]=a[g];return f}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(a,f){let g,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(g in y)a[g]=y[g];for(let k=0;k<T.length;k++)g=T[k],Object.prototype.hasOwnProperty.call(y,g)&&(a[g]=y[g])}}function b(a){var f=1;a=a.split(":");const g=[];for(;0<f&&a.length;)g.push(a.shift()),f--;return a.length&&g.push(a.join(":")),g}function C(a){u.setTimeout(()=>{throw a},0)}function A(){var a=Bt;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class X{constructor(){this.h=this.g=null}add(f,g){const y=F.get();y.set(f,g),this.h?this.h.next=y:this.g=y,this.h=y}}var F=new P(()=>new Y,a=>a.reset());class Y{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let lt,mt=!1,Bt=new X,$e=()=>{const a=u.Promise.resolve(void 0);lt=()=>{a.then(le)}};var le=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(g){C(g)}var f=F;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}mt=!1};function $t(){this.s=this.s,this.C=this.C}$t.prototype.s=!1,$t.prototype.ma=function(){this.s||(this.s=!0,this.N())},$t.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ft(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}ft.prototype.h=function(){this.defaultPrevented=!0};var Rn=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const g=()=>{};u.addEventListener("test",g,f),u.removeEventListener("test",g,f)}catch{}return a}();function ce(a,f){if(ft.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var g=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(M){t:{try{x(f.nodeName);var V=!0;break t}catch{}V=!1}V||(f=null)}}else g=="mouseover"?f=a.fromElement:g=="mouseout"&&(f=a.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Oa[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ce.aa.h.call(this)}}_(ce,ft);var Oa={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Yn="closure_listenable_"+(1e6*Math.random()|0),Ma=0;function Cs(a,f,g,y,V){this.listener=a,this.proxy=null,this.src=f,this.type=g,this.capture=!!y,this.ha=V,this.key=++Ma,this.da=this.fa=!1}function Ar(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Ir(a){this.src=a,this.g={},this.h=0}Ir.prototype.add=function(a,f,g,y,V){var k=a.toString();a=this.g[k],a||(a=this.g[k]=[],this.h++);var $=H(a,f,y,V);return-1<$?(f=a[$],g||(f.fa=!1)):(f=new Cs(f,this.src,k,!!y,V),f.fa=g,a.push(f)),f};function di(a,f){var g=f.type;if(g in a.g){var y=a.g[g],V=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=V)&&Array.prototype.splice.call(y,V,1),k&&(Ar(f),a.g[g].length==0&&(delete a.g[g],a.h--))}}function H(a,f,g,y){for(var V=0;V<a.length;++V){var k=a[V];if(!k.da&&k.listener==f&&k.capture==!!g&&k.ha==y)return V}return-1}var j="closure_lm_"+(1e6*Math.random()|0),W={};function nt(a,f,g,y,V){if(Array.isArray(f)){for(var k=0;k<f.length;k++)nt(a,f[k],g,y,V);return null}return g=on(g),a&&a[Yn]?a.K(f,g,c(y)?!!y.capture:!1,V):ht(a,f,g,!1,y,V)}function ht(a,f,g,y,V,k){if(!f)throw Error("Invalid event type");var $=c(V)?!!V.capture:!!V,dt=Jt(a);if(dt||(a[j]=dt=new Ir(a)),g=dt.add(f,g,y,$,k),g.proxy)return g;if(y=Rt(),g.proxy=y,y.src=a,y.listener=g,a.addEventListener)Rn||(V=$),V===void 0&&(V=!1),a.addEventListener(f.toString(),y,V);else if(a.attachEvent)a.attachEvent(Tt(f.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Rt(){function a(g){return f.call(a.src,a.listener,g)}const f=ke;return a}function wt(a,f,g,y,V){if(Array.isArray(f))for(var k=0;k<f.length;k++)wt(a,f[k],g,y,V);else y=c(y)?!!y.capture:!!y,g=on(g),a&&a[Yn]?(a=a.i,f=String(f).toString(),f in a.g&&(k=a.g[f],g=H(k,g,y,V),-1<g&&(Ar(k[g]),Array.prototype.splice.call(k,g,1),k.length==0&&(delete a.g[f],a.h--)))):a&&(a=Jt(a))&&(f=a.g[f.toString()],a=-1,f&&(a=H(f,g,y,V)),(g=-1<a?f[a]:null)&&Et(g))}function Et(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[Yn])di(f.i,a);else{var g=a.type,y=a.proxy;f.removeEventListener?f.removeEventListener(g,y,a.capture):f.detachEvent?f.detachEvent(Tt(g),y):f.addListener&&f.removeListener&&f.removeListener(y),(g=Jt(f))?(di(g,a),g.h==0&&(g.src=null,f[j]=null)):Ar(a)}}}function Tt(a){return a in W?W[a]:W[a]="on"+a}function ke(a,f){if(a.da)a=!0;else{f=new ce(f,this);var g=a.listener,y=a.ha||a.src;a.fa&&Et(a),a=g.call(y,f)}return a}function Jt(a){return a=a[j],a instanceof Ir?a:null}var he="__closure_events_fn_"+(1e9*Math.random()>>>0);function on(a){return typeof a=="function"?a:(a[he]||(a[he]=function(f){return a.handleEvent(f)}),a[he])}function At(){$t.call(this),this.i=new Ir(this),this.M=this,this.F=null}_(At,$t),At.prototype[Yn]=!0,At.prototype.removeEventListener=function(a,f,g,y){wt(this,a,f,g,y)};function Lt(a,f){var g,y=a.F;if(y)for(g=[];y;y=y.F)g.push(y);if(a=a.M,y=f.type||f,typeof f=="string")f=new ft(f,a);else if(f instanceof ft)f.target=f.target||a;else{var V=f;f=new ft(y,a),R(f,V)}if(V=!0,g)for(var k=g.length-1;0<=k;k--){var $=f.g=g[k];V=ye($,y,!0,f)&&V}if($=f.g=a,V=ye($,y,!0,f)&&V,V=ye($,y,!1,f)&&V,g)for(k=0;k<g.length;k++)$=f.g=g[k],V=ye($,y,!1,f)&&V}At.prototype.N=function(){if(At.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var g=a.g[f],y=0;y<g.length;y++)Ar(g[y]);delete a.g[f],a.h--}}this.F=null},At.prototype.K=function(a,f,g,y){return this.i.add(String(a),f,!1,g,y)},At.prototype.L=function(a,f,g,y){return this.i.add(String(a),f,!0,g,y)};function ye(a,f,g,y){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var V=!0,k=0;k<f.length;++k){var $=f[k];if($&&!$.da&&$.capture==g){var dt=$.listener,Ht=$.ha||$.src;$.fa&&di(a.i,$),V=dt.call(Ht,y)!==!1&&V}}return V&&!y.defaultPrevented}function Ie(a,f,g){if(typeof a=="function")g&&(a=p(a,g));else if(a&&typeof a.handleEvent=="function")a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:u.setTimeout(a,f||0)}function be(a){a.g=Ie(()=>{a.g=null,a.i&&(a.i=!1,be(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class br extends $t{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:be(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pi(a){$t.call(this),this.h=a,this.g={}}_(pi,$t);var qc=[];function jc(a){B(a.g,function(f,g){this.g.hasOwnProperty(g)&&Et(f)},a),a.g={}}pi.prototype.N=function(){pi.aa.N.call(this),jc(this)},pi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var La=u.JSON.stringify,Z_=u.JSON.parse,ty=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function Fa(){}Fa.prototype.h=null;function zc(a){return a.h||(a.h=a.i())}function Hc(){}var gi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ua(){ft.call(this,"d")}_(Ua,ft);function Ba(){ft.call(this,"c")}_(Ba,ft);var Zn={},Gc=null;function Ps(){return Gc=Gc||new At}Zn.La="serverreachability";function Wc(a){ft.call(this,Zn.La,a)}_(Wc,ft);function mi(a){const f=Ps();Lt(f,new Wc(f))}Zn.STAT_EVENT="statevent";function Kc(a,f){ft.call(this,Zn.STAT_EVENT,a),this.stat=f}_(Kc,ft);function se(a){const f=Ps();Lt(f,new Kc(f,a))}Zn.Ma="timingevent";function Qc(a,f){ft.call(this,Zn.Ma,a),this.size=f}_(Qc,ft);function _i(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},f)}function yi(){this.g=!0}yi.prototype.xa=function(){this.g=!1};function ey(a,f,g,y,V,k){a.info(function(){if(a.g)if(k)for(var $="",dt=k.split("&"),Ht=0;Ht<dt.length;Ht++){var at=dt[Ht].split("=");if(1<at.length){var Yt=at[0];at=at[1];var Zt=Yt.split("_");$=2<=Zt.length&&Zt[1]=="type"?$+(Yt+"="+at+"&"):$+(Yt+"=redacted&")}}else $=null;else $=k;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+f+`
`+g+`
`+$})}function ny(a,f,g,y,V,k,$){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+f+`
`+g+`
`+k+" "+$})}function Rr(a,f,g,y){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+iy(a,g)+(y?" "+y:"")})}function ry(a,f){a.info(function(){return"TIMEOUT: "+f})}yi.prototype.info=function(){};function iy(a,f){if(!a.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(a=0;a<g.length;a++)if(Array.isArray(g[a])){var y=g[a];if(!(2>y.length)){var V=y[1];if(Array.isArray(V)&&!(1>V.length)){var k=V[0];if(k!="noop"&&k!="stop"&&k!="close")for(var $=1;$<V.length;$++)V[$]=""}}}}return La(g)}catch{return f}}var xs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Xc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$a;function Vs(){}_(Vs,Fa),Vs.prototype.g=function(){return new XMLHttpRequest},Vs.prototype.i=function(){return{}},$a=new Vs;function Sn(a,f,g,y){this.j=a,this.i=f,this.l=g,this.R=y||1,this.U=new pi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Jc}function Jc(){this.i=null,this.g="",this.h=!1}var Yc={},qa={};function ja(a,f,g){a.L=1,a.v=Os(an(f)),a.m=g,a.P=!0,Zc(a,null)}function Zc(a,f){a.F=Date.now(),Ns(a),a.A=an(a.v);var g=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),dh(g.i,"t",y),a.C=0,g=a.j.J,a.h=new Jc,a.g=Vh(a.j,g?f:null,!a.m),0<a.O&&(a.M=new br(p(a.Y,a,a.g),a.O)),f=a.U,g=a.g,y=a.ca;var V="readystatechange";Array.isArray(V)||(V&&(qc[0]=V.toString()),V=qc);for(var k=0;k<V.length;k++){var $=nt(g,V[k],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),mi(),ey(a.i,a.u,a.A,a.l,a.R,a.m)}Sn.prototype.ca=function(a){a=a.target;const f=this.M;f&&un(a)==3?f.j():this.Y(a)},Sn.prototype.Y=function(a){try{if(a==this.g)t:{const Zt=un(this.g);var f=this.g.Ba();const Pr=this.g.Z();if(!(3>Zt)&&(Zt!=3||this.g&&(this.h.h||this.g.oa()||wh(this.g)))){this.J||Zt!=4||f==7||(f==8||0>=Pr?mi(3):mi(2)),za(this);var g=this.g.Z();this.X=g;e:if(th(this)){var y=wh(this.g);a="";var V=y.length,k=un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tr(this),vi(this);var $="";break e}this.h.i=new u.TextDecoder}for(f=0;f<V;f++)this.h.h=!0,a+=this.h.i.decode(y[f],{stream:!(k&&f==V-1)});y.length=0,this.h.g+=a,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=g==200,ny(this.i,this.u,this.A,this.l,this.R,Zt,g),this.o){if(this.T&&!this.K){e:{if(this.g){var dt,Ht=this.g;if((dt=Ht.g?Ht.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(dt)){var at=dt;break e}}at=null}if(g=at)Rr(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ha(this,g);else{this.o=!1,this.s=3,se(12),tr(this),vi(this);break t}}if(this.P){g=!0;let Oe;for(;!this.J&&this.C<$.length;)if(Oe=sy(this,$),Oe==qa){Zt==4&&(this.s=4,se(14),g=!1),Rr(this.i,this.l,null,"[Incomplete Response]");break}else if(Oe==Yc){this.s=4,se(15),Rr(this.i,this.l,$,"[Invalid Chunk]"),g=!1;break}else Rr(this.i,this.l,Oe,null),Ha(this,Oe);if(th(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||$.length!=0||this.h.h||(this.s=1,se(16),g=!1),this.o=this.o&&g,!g)Rr(this.i,this.l,$,"[Invalid Chunked Response]"),tr(this),vi(this);else if(0<$.length&&!this.W){this.W=!0;var Yt=this.j;Yt.g==this&&Yt.ba&&!Yt.M&&(Yt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Ja(Yt),Yt.M=!0,se(11))}}else Rr(this.i,this.l,$,null),Ha(this,$);Zt==4&&tr(this),this.o&&!this.J&&(Zt==4?Sh(this.j,this):(this.o=!1,Ns(this)))}else Ty(this.g),g==400&&0<$.indexOf("Unknown SID")?(this.s=3,se(12)):(this.s=0,se(13)),tr(this),vi(this)}}}catch{}finally{}};function th(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function sy(a,f){var g=a.C,y=f.indexOf(`
`,g);return y==-1?qa:(g=Number(f.substring(g,y)),isNaN(g)?Yc:(y+=1,y+g>f.length?qa:(f=f.slice(y,y+g),a.C=y+g,f)))}Sn.prototype.cancel=function(){this.J=!0,tr(this)};function Ns(a){a.S=Date.now()+a.I,eh(a,a.I)}function eh(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=_i(p(a.ba,a),f)}function za(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Sn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(ry(this.i,this.A),this.L!=2&&(mi(),se(17)),tr(this),this.s=2,vi(this)):eh(this,this.S-a)};function vi(a){a.j.G==0||a.J||Sh(a.j,a)}function tr(a){za(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,jc(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function Ha(a,f){try{var g=a.j;if(g.G!=0&&(g.g==a||Ga(g.h,a))){if(!a.K&&Ga(g.h,a)&&g.G==3){try{var y=g.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){t:if(!g.u){if(g.g)if(g.g.F+3e3<a.F)$s(g),Us(g);else break t;Xa(g),se(18)}}else g.za=V[1],0<g.za-g.T&&37500>V[2]&&g.F&&g.v==0&&!g.C&&(g.C=_i(p(g.Za,g),6e3));if(1>=ih(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else nr(g,11)}else if((a.K||g.g==a)&&$s(g),!S(f))for(V=g.Da.g.parse(f),f=0;f<V.length;f++){let at=V[f];if(g.T=at[0],at=at[1],g.G==2)if(at[0]=="c"){g.K=at[1],g.ia=at[2];const Yt=at[3];Yt!=null&&(g.la=Yt,g.j.info("VER="+g.la));const Zt=at[4];Zt!=null&&(g.Aa=Zt,g.j.info("SVER="+g.Aa));const Pr=at[5];Pr!=null&&typeof Pr=="number"&&0<Pr&&(y=1.5*Pr,g.L=y,g.j.info("backChannelRequestTimeoutMs_="+y)),y=g;const Oe=a.g;if(Oe){const js=Oe.g?Oe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(js){var k=y.h;k.g||js.indexOf("spdy")==-1&&js.indexOf("quic")==-1&&js.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(Wa(k,k.h),k.h=null))}if(y.D){const Ya=Oe.g?Oe.g.getResponseHeader("X-HTTP-Session-Id"):null;Ya&&(y.ya=Ya,yt(y.I,y.D,Ya))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-a.F,g.j.info("Handshake RTT: "+g.R+"ms")),y=g;var $=a;if(y.qa=xh(y,y.J?y.ia:null,y.W),$.K){sh(y.h,$);var dt=$,Ht=y.L;Ht&&(dt.I=Ht),dt.B&&(za(dt),Ns(dt)),y.g=$}else bh(y);0<g.i.length&&Bs(g)}else at[0]!="stop"&&at[0]!="close"||nr(g,7);else g.G==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?nr(g,7):Qa(g):at[0]!="noop"&&g.l&&g.l.ta(at),g.v=0)}}mi(4)}catch{}}var oy=class{constructor(a,f){this.g=a,this.map=f}};function nh(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function rh(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function ih(a){return a.h?1:a.g?a.g.size:0}function Ga(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function Wa(a,f){a.g?a.g.add(f):a.h=f}function sh(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}nh.prototype.cancel=function(){if(this.i=oh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function oh(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const g of a.g.values())f=f.concat(g.D);return f}return E(a.i)}function ay(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var f=[],g=a.length,y=0;y<g;y++)f.push(a[y]);return f}f=[],g=0;for(y in a)f[g++]=a[y];return f}function uy(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var f=[];a=a.length;for(var g=0;g<a;g++)f.push(g);return f}f=[],g=0;for(const y in a)f[g++]=y;return f}}}function ah(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var g=uy(a),y=ay(a),V=y.length,k=0;k<V;k++)f.call(void 0,y[k],g&&g[k],a)}var uh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ly(a,f){if(a){a=a.split("&");for(var g=0;g<a.length;g++){var y=a[g].indexOf("="),V=null;if(0<=y){var k=a[g].substring(0,y);V=a[g].substring(y+1)}else k=a[g];f(k,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function er(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof er){this.h=a.h,Ds(this,a.j),this.o=a.o,this.g=a.g,ks(this,a.s),this.l=a.l;var f=a.i,g=new Ti;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),lh(this,g),this.m=a.m}else a&&(f=String(a).match(uh))?(this.h=!1,Ds(this,f[1]||"",!0),this.o=wi(f[2]||""),this.g=wi(f[3]||"",!0),ks(this,f[4]),this.l=wi(f[5]||"",!0),lh(this,f[6]||"",!0),this.m=wi(f[7]||"")):(this.h=!1,this.i=new Ti(null,this.h))}er.prototype.toString=function(){var a=[],f=this.j;f&&a.push(Ei(f,ch,!0),":");var g=this.g;return(g||f=="file")&&(a.push("//"),(f=this.o)&&a.push(Ei(f,ch,!0),"@"),a.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&a.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&a.push("/"),a.push(Ei(g,g.charAt(0)=="/"?fy:hy,!0))),(g=this.i.toString())&&a.push("?",g),(g=this.m)&&a.push("#",Ei(g,py)),a.join("")};function an(a){return new er(a)}function Ds(a,f,g){a.j=g?wi(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function ks(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function lh(a,f,g){f instanceof Ti?(a.i=f,gy(a.i,a.h)):(g||(f=Ei(f,dy)),a.i=new Ti(f,a.h))}function yt(a,f,g){a.i.set(f,g)}function Os(a){return yt(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function wi(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Ei(a,f,g){return typeof a=="string"?(a=encodeURI(a).replace(f,cy),g&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function cy(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var ch=/[#\/\?@]/g,hy=/[#\?:]/g,fy=/[#\?]/g,dy=/[#\?@]/g,py=/#/g;function Ti(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function Cn(a){a.g||(a.g=new Map,a.h=0,a.i&&ly(a.i,function(f,g){a.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}e=Ti.prototype,e.add=function(a,f){Cn(this),this.i=null,a=Sr(this,a);var g=this.g.get(a);return g||this.g.set(a,g=[]),g.push(f),this.h+=1,this};function hh(a,f){Cn(a),f=Sr(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function fh(a,f){return Cn(a),f=Sr(a,f),a.g.has(f)}e.forEach=function(a,f){Cn(this),this.g.forEach(function(g,y){g.forEach(function(V){a.call(f,V,y,this)},this)},this)},e.na=function(){Cn(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let y=0;y<f.length;y++){const V=a[y];for(let k=0;k<V.length;k++)g.push(f[y])}return g},e.V=function(a){Cn(this);let f=[];if(typeof a=="string")fh(this,a)&&(f=f.concat(this.g.get(Sr(this,a))));else{a=Array.from(this.g.values());for(let g=0;g<a.length;g++)f=f.concat(a[g])}return f},e.set=function(a,f){return Cn(this),this.i=null,a=Sr(this,a),fh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},e.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function dh(a,f,g){hh(a,f),0<g.length&&(a.i=null,a.g.set(Sr(a,f),E(g)),a.h+=g.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var y=f[g];const k=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var V=k;$[y]!==""&&(V+="="+encodeURIComponent(String($[y]))),a.push(V)}}return this.i=a.join("&")};function Sr(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function gy(a,f){f&&!a.j&&(Cn(a),a.i=null,a.g.forEach(function(g,y){var V=y.toLowerCase();y!=V&&(hh(this,y),dh(this,V,g))},a)),a.j=f}function my(a,f){const g=new yi;if(u.Image){const y=new Image;y.onload=m(Pn,g,"TestLoadImage: loaded",!0,f,y),y.onerror=m(Pn,g,"TestLoadImage: error",!1,f,y),y.onabort=m(Pn,g,"TestLoadImage: abort",!1,f,y),y.ontimeout=m(Pn,g,"TestLoadImage: timeout",!1,f,y),u.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else f(!1)}function _y(a,f){const g=new yi,y=new AbortController,V=setTimeout(()=>{y.abort(),Pn(g,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:y.signal}).then(k=>{clearTimeout(V),k.ok?Pn(g,"TestPingServer: ok",!0,f):Pn(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),Pn(g,"TestPingServer: error",!1,f)})}function Pn(a,f,g,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(g)}catch{}}function yy(){this.g=new ty}function vy(a,f,g){const y=g||"";try{ah(a,function(V,k){let $=V;c(V)&&($=La(V)),f.push(y+k+"="+encodeURIComponent($))})}catch(V){throw f.push(y+"type="+encodeURIComponent("_badmap")),V}}function Ms(a){this.l=a.Ub||null,this.j=a.eb||!1}_(Ms,Fa),Ms.prototype.g=function(){return new Ls(this.l,this.j)},Ms.prototype.i=function(a){return function(){return a}}({});function Ls(a,f){At.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Ls,At),e=Ls.prototype,e.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,Ii(this)},e.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||u).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ai(this)),this.readyState=0},e.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ii(this)),this.g&&(this.readyState=3,Ii(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ph(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function ph(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}e.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?Ai(this):Ii(this),this.readyState==3&&ph(this)}},e.Ra=function(a){this.g&&(this.response=this.responseText=a,Ai(this))},e.Qa=function(a){this.g&&(this.response=a,Ai(this))},e.ga=function(){this.g&&Ai(this)};function Ai(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ii(a)}e.setRequestHeader=function(a,f){this.u.append(a,f)},e.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,a.push(g[0]+": "+g[1]),g=f.next();return a.join(`\r
`)};function Ii(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ls.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function gh(a){let f="";return B(a,function(g,y){f+=y,f+=":",f+=g,f+=`\r
`}),f}function Ka(a,f,g){t:{for(y in g){var y=!1;break t}y=!0}y||(g=gh(g),typeof a=="string"?g!=null&&encodeURIComponent(String(g)):yt(a,f,g))}function Ct(a){At.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Ct,At);var wy=/^https?$/i,Ey=["POST","PUT"];e=Ct.prototype,e.Ha=function(a){this.J=a},e.ea=function(a,f,g,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$a.g(),this.v=this.o?zc(this.o):zc($a),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(k){mh(this,k);return}if(a=g||"",g=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)g.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const k of y.keys())g.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(g.keys()).find(k=>k.toLowerCase()=="content-type"),V=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Ey,f,void 0))||y||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,$]of g)this.g.setRequestHeader(k,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vh(this),this.u=!0,this.g.send(a),this.u=!1}catch(k){mh(this,k)}};function mh(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,_h(a),Fs(a)}function _h(a){a.A||(a.A=!0,Lt(a,"complete"),Lt(a,"error"))}e.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Lt(this,"complete"),Lt(this,"abort"),Fs(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fs(this,!0)),Ct.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?yh(this):this.bb())},e.bb=function(){yh(this)};function yh(a){if(a.h&&typeof o<"u"&&(!a.v[1]||un(a)!=4||a.Z()!=2)){if(a.u&&un(a)==4)Ie(a.Ea,0,a);else if(Lt(a,"readystatechange"),un(a)==4){a.h=!1;try{const $=a.Z();t:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var g;if(!(g=f)){var y;if(y=$===0){var V=String(a.D).match(uh)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),y=!wy.test(V?V.toLowerCase():"")}g=y}if(g)Lt(a,"complete"),Lt(a,"success");else{a.m=6;try{var k=2<un(a)?a.g.statusText:""}catch{k=""}a.l=k+" ["+a.Z()+"]",_h(a)}}finally{Fs(a)}}}}function Fs(a,f){if(a.g){vh(a);const g=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||Lt(a,"ready");try{g.onreadystatechange=y}catch{}}}function vh(a){a.I&&(u.clearTimeout(a.I),a.I=null)}e.isActive=function(){return!!this.g};function un(a){return a.g?a.g.readyState:0}e.Z=function(){try{return 2<un(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),Z_(f)}};function wh(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Ty(a){const f={};a=(a.g&&2<=un(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(S(a[y]))continue;var g=b(a[y]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const k=f[V]||[];f[V]=k,k.push(g)}I(f,function(y){return y.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bi(a,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[a]||f}function Eh(a){this.Aa=0,this.i=[],this.j=new yi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bi("baseRetryDelayMs",5e3,a),this.cb=bi("retryDelaySeedMs",1e4,a),this.Wa=bi("forwardChannelMaxRetries",2,a),this.wa=bi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new nh(a&&a.concurrentRequestLimit),this.Da=new yy,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Eh.prototype,e.la=8,e.G=1,e.connect=function(a,f,g,y){se(0),this.W=a,this.H=f||{},g&&y!==void 0&&(this.H.OSID=g,this.H.OAID=y),this.F=this.X,this.I=xh(this,null,this.W),Bs(this)};function Qa(a){if(Th(a),a.G==3){var f=a.U++,g=an(a.I);if(yt(g,"SID",a.K),yt(g,"RID",f),yt(g,"TYPE","terminate"),Ri(a,g),f=new Sn(a,a.j,f),f.L=2,f.v=Os(an(g)),g=!1,u.navigator&&u.navigator.sendBeacon)try{g=u.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&u.Image&&(new Image().src=f.v,g=!0),g||(f.g=Vh(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Ns(f)}Ph(a)}function Us(a){a.g&&(Ja(a),a.g.cancel(),a.g=null)}function Th(a){Us(a),a.u&&(u.clearTimeout(a.u),a.u=null),$s(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Bs(a){if(!rh(a.h)&&!a.s){a.s=!0;var f=a.Ga;lt||$e(),mt||(lt(),mt=!0),Bt.add(f,a),a.B=0}}function Ay(a,f){return ih(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=_i(p(a.Ga,a,f),Ch(a,a.B)),a.B++,!0)}e.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new Sn(this,this.j,a);let k=this.o;if(this.S&&(k?(k=w(k),R(k,this.S)):k=this.S),this.m!==null||this.O||(V.H=k,k=null),this.P)t:{for(var f=0,g=0;g<this.i.length;g++){e:{var y=this.i[g];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break e}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=g;break t}if(f===4096||g===this.i.length-1){f=g+1;break t}}f=1e3}else f=1e3;f=Ih(this,V,f),g=an(this.I),yt(g,"RID",a),yt(g,"CVER",22),this.D&&yt(g,"X-HTTP-Session-Id",this.D),Ri(this,g),k&&(this.O?f="headers="+encodeURIComponent(String(gh(k)))+"&"+f:this.m&&Ka(g,this.m,k)),Wa(this.h,V),this.Ua&&yt(g,"TYPE","init"),this.P?(yt(g,"$req",f),yt(g,"SID","null"),V.T=!0,ja(V,g,null)):ja(V,g,f),this.G=2}}else this.G==3&&(a?Ah(this,a):this.i.length==0||rh(this.h)||Ah(this))};function Ah(a,f){var g;f?g=f.l:g=a.U++;const y=an(a.I);yt(y,"SID",a.K),yt(y,"RID",g),yt(y,"AID",a.T),Ri(a,y),a.m&&a.o&&Ka(y,a.m,a.o),g=new Sn(a,a.j,g,a.B+1),a.m===null&&(g.H=a.o),f&&(a.i=f.D.concat(a.i)),f=Ih(a,g,1e3),g.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Wa(a.h,g),ja(g,y,f)}function Ri(a,f){a.H&&B(a.H,function(g,y){yt(f,y,g)}),a.l&&ah({},function(g,y){yt(f,y,g)})}function Ih(a,f,g){g=Math.min(a.i.length,g);var y=a.l?p(a.l.Na,a.l,a):null;t:{var V=a.i;let k=-1;for(;;){const $=["count="+g];k==-1?0<g?(k=V[0].g,$.push("ofs="+k)):k=0:$.push("ofs="+k);let dt=!0;for(let Ht=0;Ht<g;Ht++){let at=V[Ht].g;const Yt=V[Ht].map;if(at-=k,0>at)k=Math.max(0,V[Ht].g-100),dt=!1;else try{vy(Yt,$,"req"+at+"_")}catch{y&&y(Yt)}}if(dt){y=$.join("&");break t}}}return a=a.i.splice(0,g),f.D=a,y}function bh(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;lt||$e(),mt||(lt(),mt=!0),Bt.add(f,a),a.v=0}}function Xa(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=_i(p(a.Fa,a),Ch(a,a.v)),a.v++,!0)}e.Fa=function(){if(this.u=null,Rh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=_i(p(this.ab,this),a)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,se(10),Us(this),Rh(this))};function Ja(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function Rh(a){a.g=new Sn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=an(a.qa);yt(f,"RID","rpc"),yt(f,"SID",a.K),yt(f,"AID",a.T),yt(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&yt(f,"TO",a.ja),yt(f,"TYPE","xmlhttp"),Ri(a,f),a.m&&a.o&&Ka(f,a.m,a.o),a.L&&(a.g.I=a.L);var g=a.g;a=a.ia,g.L=1,g.v=Os(an(f)),g.m=null,g.P=!0,Zc(g,a)}e.Za=function(){this.C!=null&&(this.C=null,Us(this),Xa(this),se(19))};function $s(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function Sh(a,f){var g=null;if(a.g==f){$s(a),Ja(a),a.g=null;var y=2}else if(Ga(a.h,f))g=f.D,sh(a.h,f),y=1;else return;if(a.G!=0){if(f.o)if(y==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var V=a.B;y=Ps(),Lt(y,new Qc(y,g)),Bs(a)}else bh(a);else if(V=f.s,V==3||V==0&&0<f.X||!(y==1&&Ay(a,f)||y==2&&Xa(a)))switch(g&&0<g.length&&(f=a.h,f.i=f.i.concat(g)),V){case 1:nr(a,5);break;case 4:nr(a,10);break;case 3:nr(a,6);break;default:nr(a,2)}}}function Ch(a,f){let g=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(g*=2),g*f}function nr(a,f){if(a.j.info("Error code "+f),f==2){var g=p(a.fb,a),y=a.Xa;const V=!y;y=new er(y||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ds(y,"https"),Os(y),V?my(y.toString(),g):_y(y.toString(),g)}else se(2);a.G=0,a.l&&a.l.sa(f),Ph(a),Th(a)}e.fb=function(a){a?(this.j.info("Successfully pinged google.com"),se(2)):(this.j.info("Failed to ping google.com"),se(1))};function Ph(a){if(a.G=0,a.ka=[],a.l){const f=oh(a.h);(f.length!=0||a.i.length!=0)&&(v(a.ka,f),v(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function xh(a,f,g){var y=g instanceof er?an(g):new er(g);if(y.g!="")f&&(y.g=f+"."+y.g),ks(y,y.s);else{var V=u.location;y=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;var k=new er(null);y&&Ds(k,y),f&&(k.g=f),V&&ks(k,V),g&&(k.l=g),y=k}return g=a.D,f=a.ya,g&&f&&yt(y,g,f),yt(y,"VER",a.la),Ri(a,y),y}function Vh(a,f,g){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new Ct(new Ms({eb:g})):new Ct(a.pa),f.Ha(a.J),f}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Nh(){}e=Nh.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function qs(){}qs.prototype.g=function(a,f){return new ve(a,f)};function ve(a,f){At.call(this),this.g=new Eh(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!S(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!S(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Cr(this)}_(ve,At),ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ve.prototype.close=function(){Qa(this.g)},ve.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var g={};g.__data__=a,a=g}else this.u&&(g={},g.__data__=La(a),a=g);f.i.push(new oy(f.Ya++,a)),f.G==3&&Bs(f)},ve.prototype.N=function(){this.g.l=null,delete this.j,Qa(this.g),delete this.g,ve.aa.N.call(this)};function Dh(a){Ua.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){t:{for(const g in f){a=g;break t}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}_(Dh,Ua);function kh(){Ba.call(this),this.status=1}_(kh,Ba);function Cr(a){this.g=a}_(Cr,Nh),Cr.prototype.ua=function(){Lt(this.g,"a")},Cr.prototype.ta=function(a){Lt(this.g,new Dh(a))},Cr.prototype.sa=function(a){Lt(this.g,new kh)},Cr.prototype.ra=function(){Lt(this.g,"b")},qs.prototype.createWebChannel=qs.prototype.g,ve.prototype.send=ve.prototype.o,ve.prototype.open=ve.prototype.m,ve.prototype.close=ve.prototype.close,Tm=function(){return new qs},Em=function(){return Ps()},wm=Zn,cl={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xs.NO_ERROR=0,xs.TIMEOUT=8,xs.HTTP_ERROR=6,ho=xs,Xc.COMPLETE="complete",vm=Xc,Hc.EventType=gi,gi.OPEN="a",gi.CLOSE="b",gi.ERROR="c",gi.MESSAGE="d",At.prototype.listen=At.prototype.K,Ui=Hc,Ct.prototype.listenOnce=Ct.prototype.L,Ct.prototype.getLastError=Ct.prototype.Ka,Ct.prototype.getLastErrorCode=Ct.prototype.Ba,Ct.prototype.getStatus=Ct.prototype.Z,Ct.prototype.getResponseJson=Ct.prototype.Oa,Ct.prototype.getResponseText=Ct.prototype.oa,Ct.prototype.send=Ct.prototype.ea,Ct.prototype.setWithCredentials=Ct.prototype.Ha,ym=Ct}).apply(typeof Ys<"u"?Ys:typeof self<"u"?self:typeof window<"u"?window:{});const id="@firebase/firestore",sd="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ee.UNAUTHENTICATED=new ee(null),ee.GOOGLE_CREDENTIALS=new ee("google-credentials-uid"),ee.FIRST_PARTY=new ee("first-party-uid"),ee.MOCK_USER=new ee("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ui="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr=new hm("@firebase/firestore");function kr(){return mr.logLevel}function z(e,...t){if(mr.logLevel<=st.DEBUG){const n=t.map(rc);mr.debug(`Firestore (${ui}): ${e}`,...n)}}function Tn(e,...t){if(mr.logLevel<=st.ERROR){const n=t.map(rc);mr.error(`Firestore (${ui}): ${e}`,...n)}}function $n(e,...t){if(mr.logLevel<=st.WARN){const n=t.map(rc);mr.warn(`Firestore (${ui}): ${e}`,...n)}}function rc(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,Am(e,r,n)}function Am(e,t,n){let r=`FIRESTORE (${ui}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Tn(r),new Error(r)}function ct(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||Am(t,i,r)}function J(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends ai{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Bb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(ee.UNAUTHENTICATED))}shutdown(){}}class $b{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class qb{constructor(t){this.t=t,this.currentUser=ee.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ct(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new _n;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new _n,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},u=l=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new _n)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ct(typeof r.accessToken=="string",31837,{l:r}),new Im(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ct(t===null||typeof t=="string",2055,{h:t}),new ee(t)}}class jb{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=ee.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zb{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new jb(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(ee.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class od{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Hb{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ab(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ct(this.o===void 0,3512);const r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new od(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ct(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new od(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Gb(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%62))}return r}}function et(e,t){return e<t?-1:e>t?1:0}function hl(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return et(r,i);{const s=bm(),o=Wb(s.encode(ad(e,n)),s.encode(ad(t,n)));return o!==0?o:et(r,i)}}n+=r>65535?2:1}return et(e.length,t.length)}function ad(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Wb(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return et(e[n],t[n]);return et(e.length,t.length)}function Jr(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ud="__name__";class je{constructor(t,n,r){n===void 0?n=0:n>t.length&&K(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&K(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return je.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof je?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const s=je.compareSegments(t.get(i),n.get(i));if(s!==0)return s}return et(t.length,n.length)}static compareSegments(t,n){const r=je.isNumericId(t),i=je.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?je.extractNumericId(t).compare(je.extractNumericId(n)):hl(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ln.fromString(t.substring(4,t.length-2))}}class _t extends je{construct(t,n,r){return new _t(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new q(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new _t(n)}static emptyPath(){return new _t([])}}const Kb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qt extends je{construct(t,n,r){return new Qt(t,n,r)}static isValidIdentifier(t){return Kb.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ud}static keyField(){return new Qt([ud])}static fromServerFormat(t){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new q(O.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new q(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=l,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new q(O.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Qt(n)}static emptyPath(){return new Qt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(t){this.path=t}static fromPath(t){return new G(_t.fromString(t))}static fromName(t){return new G(_t.fromString(t).popFirst(5))}static empty(){return new G(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&_t.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return _t.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new G(new _t(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(e,t,n){if(!n)throw new q(O.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Qb(e,t,n,r){if(t===!0&&r===!0)throw new q(O.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function ld(e){if(!G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function cd(e){if(G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Sm(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function wa(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":K(12329,{type:typeof e})}function An(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new q(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=wa(e);throw new q(O.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Xb(e,t){if(t<=0)throw new q(O.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(e,t){const n={typeString:e};return t&&(n.value=t),n}function Es(e,t){if(!Sm(e))throw new q(O.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new q(O.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd=-62135596800,fd=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(t){return vt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*fd);return new vt(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<hd)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fd}_compareTo(t){return this.seconds===t.seconds?et(this.nanoseconds,t.nanoseconds):et(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Es(t,vt._jsonSchema))return new vt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-hd;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Mt("string",vt._jsonSchemaVersion),seconds:Mt("number"),nanoseconds:Mt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{static fromTimestamp(t){return new Q(t)}static min(){return new Q(new vt(0,0))}static max(){return new Q(new vt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls=-1;function Jb(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Q.fromTimestamp(r===1e9?new vt(n+1,0):new vt(n,r));return new qn(i,G.empty(),t)}function Yb(e){return new qn(e.readTime,e.key,ls)}class qn{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new qn(Q.min(),G.empty(),ls)}static max(){return new qn(Q.max(),G.empty(),ls)}}function Zb(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=G.comparator(e.documentKey,t.documentKey),n!==0?n:et(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function li(e){if(e.code!==O.FAILED_PRECONDITION||e.message!==tR)throw e;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&K(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):L.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):L.reject(n)}static resolve(t){return new L((n,r)=>{n(t)})}static reject(t){return new L((n,r)=>{r(t)})}static waitFor(t){return new L((n,r)=>{let i=0,s=0,o=!1;t.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(t){let n=L.resolve(!1);for(const r of t)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new L((r,i)=>{const s=t.length,o=new Array(s);let u=0;for(let l=0;l<s;l++){const c=l;n(t[c]).next(h=>{o[c]=h,++u,u===s&&r(o)},h=>i(h))}})}static doWhile(t,n){return new L((r,i)=>{const s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}}function nR(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ci(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}Ea.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sc=-1;function Ta(e){return e==null}function Wo(e){return e===0&&1/e==-1/0}function rR(e){return typeof e=="number"&&Number.isInteger(e)&&!Wo(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="";function iR(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=dd(t)),t=sR(e.get(n),t);return dd(t)}function sR(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const s=e.charAt(i);switch(s){case"\0":n+="";break;case Cm:n+="";break;default:n+=s}}return n}function dd(e){return e+Cm+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Qn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Pm(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(t,n){this.comparator=t,this.root=n||Kt.EMPTY}insert(t,n){return new St(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Kt.BLACK,null,null))}remove(t){return new St(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Kt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Zs(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Zs(this.root,t,this.comparator,!1)}getReverseIterator(){return new Zs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Zs(this.root,t,this.comparator,!0)}}class Zs{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Kt{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??Kt.RED,this.left=i??Kt.EMPTY,this.right=s??Kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new Kt(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Kt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return Kt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw K(43730,{key:this.key,value:this.value});if(this.right.isRed())throw K(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw K(27949);return t+(this.isRed()?0:1)}}Kt.EMPTY=null,Kt.RED=!0,Kt.BLACK=!1;Kt.EMPTY=new class{constructor(){this.size=0}get key(){throw K(57766)}get value(){throw K(16141)}get color(){throw K(16727)}get left(){throw K(29726)}get right(){throw K(36894)}copy(t,n,r,i,s){return this}insert(t,n,r){return new Kt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(t){this.comparator=t,this.data=new St(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new gd(this.data.getIterator())}getIteratorFrom(t){return new gd(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Ut)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Ut(this.comparator);return n.data=t,n}}class gd{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(t){this.fields=t,t.sort(Qt.comparator)}static empty(){return new Te([])}unionWith(t){let n=new Ut(Qt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Te(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Jr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new xm("Invalid base64 string: "+s):s}}(t);return new Xt(n)}static fromUint8Array(t){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new Xt(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return et(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Xt.EMPTY_BYTE_STRING=new Xt("");const oR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jn(e){if(ct(!!e,39018),typeof e=="string"){let t=0;const n=oR.exec(e);if(ct(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:xt(e.seconds),nanos:xt(e.nanos)}}function xt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function zn(e){return typeof e=="string"?Xt.fromBase64String(e):Xt.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="server_timestamp",Nm="__type__",Dm="__previous_value__",km="__local_write_time__";function oc(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[Nm])===null||n===void 0?void 0:n.stringValue)===Vm}function Aa(e){const t=e.mapValue.fields[Dm];return oc(t)?Aa(t):t}function cs(e){const t=jn(e.mapValue.fields[km].timestampValue);return new vt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(t,n,r,i,s,o,u,l,c,h){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const Ko="(default)";class hs{constructor(t,n){this.projectId=t,this.database=n||Ko}static empty(){return new hs("","")}get isDefaultDatabase(){return this.database===Ko}isEqual(t){return t instanceof hs&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om="__type__",uR="__max__",to={mapValue:{}},Mm="__vector__",Qo="value";function Hn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?oc(e)?4:cR(e)?9007199254740991:lR(e)?10:11:K(28295,{value:e})}function rn(e,t){if(e===t)return!0;const n=Hn(e);if(n!==Hn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return cs(e).isEqual(cs(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=jn(i.timestampValue),u=jn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return zn(i.bytesValue).isEqual(zn(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return xt(i.geoPointValue.latitude)===xt(s.geoPointValue.latitude)&&xt(i.geoPointValue.longitude)===xt(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return xt(i.integerValue)===xt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=xt(i.doubleValue),u=xt(s.doubleValue);return o===u?Wo(o)===Wo(u):isNaN(o)&&isNaN(u)}return!1}(e,t);case 9:return Jr(e.arrayValue.values||[],t.arrayValue.values||[],rn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(pd(o)!==pd(u))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(u[l]===void 0||!rn(o[l],u[l])))return!1;return!0}(e,t);default:return K(52216,{left:e})}}function fs(e,t){return(e.values||[]).find(n=>rn(n,t))!==void 0}function Yr(e,t){if(e===t)return 0;const n=Hn(e),r=Hn(t);if(n!==r)return et(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return et(e.booleanValue,t.booleanValue);case 2:return function(s,o){const u=xt(s.integerValue||s.doubleValue),l=xt(o.integerValue||o.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(e,t);case 3:return md(e.timestampValue,t.timestampValue);case 4:return md(cs(e),cs(t));case 5:return hl(e.stringValue,t.stringValue);case 6:return function(s,o){const u=zn(s),l=zn(o);return u.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const u=s.split("/"),l=o.split("/");for(let c=0;c<u.length&&c<l.length;c++){const h=et(u[c],l[c]);if(h!==0)return h}return et(u.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const u=et(xt(s.latitude),xt(o.latitude));return u!==0?u:et(xt(s.longitude),xt(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return _d(e.arrayValue,t.arrayValue);case 10:return function(s,o){var u,l,c,h;const d=s.fields||{},p=o.fields||{},m=(u=d[Qo])===null||u===void 0?void 0:u.arrayValue,_=(l=p[Qo])===null||l===void 0?void 0:l.arrayValue,E=et(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:_d(m,_)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===to.mapValue&&o===to.mapValue)return 0;if(s===to.mapValue)return 1;if(o===to.mapValue)return-1;const u=s.fields||{},l=Object.keys(u),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const p=hl(l[d],h[d]);if(p!==0)return p;const m=Yr(u[l[d]],c[h[d]]);if(m!==0)return m}return et(l.length,h.length)}(e.mapValue,t.mapValue);default:throw K(23264,{le:n})}}function md(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return et(e,t);const n=jn(e),r=jn(t),i=et(n.seconds,r.seconds);return i!==0?i:et(n.nanos,r.nanos)}function _d(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Yr(n[i],r[i]);if(s)return s}return et(n.length,r.length)}function Zr(e){return fl(e)}function fl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=jn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return zn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return G.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=fl(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${fl(n.fields[o])}`;return i+"}"}(e.mapValue):K(61005,{value:e})}function fo(e){switch(Hn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Aa(e);return t?16+fo(t):16;case 5:return 2*e.stringValue.length;case 6:return zn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+fo(s),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return Qn(r.fields,(s,o)=>{i+=s.length+fo(o)}),i}(e.mapValue);default:throw K(13486,{value:e})}}function yd(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function dl(e){return!!e&&"integerValue"in e}function ac(e){return!!e&&"arrayValue"in e}function vd(e){return!!e&&"nullValue"in e}function wd(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function po(e){return!!e&&"mapValue"in e}function lR(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[Om])===null||n===void 0?void 0:n.stringValue)===Mm}function Hi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Qn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=Hi(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Hi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function cR(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===uR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(t){this.value=t}static empty(){return new pe({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!po(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Hi(n)}setAll(t){let n=Qt.emptyPath(),r={},i=[];t.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=Hi(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){const n=this.field(t.popLast());po(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return rn(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];po(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){Qn(n,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new pe(Hi(this.value))}}function Lm(e){const t=[];return Qn(e.fields,(n,r)=>{const i=new Qt([n]);if(po(r)){const s=Lm(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new Te(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(t,n,r,i,s,o,u){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(t){return new ne(t,0,Q.min(),Q.min(),Q.min(),pe.empty(),0)}static newFoundDocument(t,n,r,i){return new ne(t,1,n,Q.min(),r,i,0)}static newNoDocument(t,n){return new ne(t,2,n,Q.min(),Q.min(),pe.empty(),0)}static newUnknownDocument(t,n){return new ne(t,3,n,Q.min(),Q.min(),pe.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=pe.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=pe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof ne&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ne(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(t,n){this.position=t,this.inclusive=n}}function Ed(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=Yr(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Td(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!rn(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(t,n="asc"){this.field=t,this.dir=n}}function hR(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{}class Ot extends Fm{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new dR(t,n,r):n==="array-contains"?new mR(t,r):n==="in"?new _R(t,r):n==="not-in"?new yR(t,r):n==="array-contains-any"?new vR(t,r):new Ot(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new pR(t,r):new gR(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Yr(n,this.value)):n!==null&&Hn(this.value)===Hn(n)&&this.matchesComparison(Yr(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return K(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fe extends Fm{constructor(t,n){super(),this.filters=t,this.op=n,this.he=null}static create(t,n){return new Fe(t,n)}matches(t){return Um(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Um(e){return e.op==="and"}function Bm(e){return fR(e)&&Um(e)}function fR(e){for(const t of e.filters)if(t instanceof Fe)return!1;return!0}function pl(e){if(e instanceof Ot)return e.field.canonicalString()+e.op.toString()+Zr(e.value);if(Bm(e))return e.filters.map(t=>pl(t)).join(",");{const t=e.filters.map(n=>pl(n)).join(",");return`${e.op}(${t})`}}function $m(e,t){return e instanceof Ot?function(r,i){return i instanceof Ot&&r.op===i.op&&r.field.isEqual(i.field)&&rn(r.value,i.value)}(e,t):e instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&$m(o,i.filters[u]),!0):!1}(e,t):void K(19439)}function qm(e){return e instanceof Ot?function(n){return`${n.field.canonicalString()} ${n.op} ${Zr(n.value)}`}(e):e instanceof Fe?function(n){return n.op.toString()+" {"+n.getFilters().map(qm).join(" ,")+"}"}(e):"Filter"}class dR extends Ot{constructor(t,n,r){super(t,n,r),this.key=G.fromName(r.referenceValue)}matches(t){const n=G.comparator(t.key,this.key);return this.matchesComparison(n)}}class pR extends Ot{constructor(t,n){super(t,"in",n),this.keys=jm("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class gR extends Ot{constructor(t,n){super(t,"not-in",n),this.keys=jm("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function jm(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class mR extends Ot{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return ac(n)&&fs(n.arrayValue,this.value)}}class _R extends Ot{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&fs(this.value.arrayValue,n)}}class yR extends Ot{constructor(t,n){super(t,"not-in",n)}matches(t){if(fs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!fs(this.value.arrayValue,n)}}class vR extends Ot{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!ac(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>fs(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(t,n=null,r=[],i=[],s=null,o=null,u=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.Pe=null}}function Ad(e,t=null,n=[],r=[],i=null,s=null,o=null){return new wR(e,t,n,r,i,s,o)}function uc(e){const t=J(e);if(t.Pe===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>pl(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ta(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Zr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Zr(r)).join(",")),t.Pe=n}return t.Pe}function lc(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!hR(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!$m(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Td(e.startAt,t.startAt)&&Td(e.endAt,t.endAt)}function gl(e){return G.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(t,n=null,r=[],i=[],s=null,o="F",u=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function ER(e,t,n,r,i,s,o,u){return new hi(e,t,n,r,i,s,o,u)}function cc(e){return new hi(e)}function Id(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function zm(e){return e.collectionGroup!==null}function Gi(e){const t=J(e);if(t.Te===null){t.Te=[];const n=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Ut(Qt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(u=u.add(c.field))})}),u})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Te.push(new ds(s,r))}),n.has(Qt.keyField().canonicalString())||t.Te.push(new ds(Qt.keyField(),r))}return t.Te}function Xe(e){const t=J(e);return t.Ie||(t.Ie=TR(t,Gi(e))),t.Ie}function TR(e,t){if(e.limitType==="F")return Ad(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ds(i.field,s)});const n=e.endAt?new Xo(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Xo(e.startAt.position,e.startAt.inclusive):null;return Ad(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function ml(e,t){const n=e.filters.concat([t]);return new hi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Jo(e,t,n){return new hi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ia(e,t){return lc(Xe(e),Xe(t))&&e.limitType===t.limitType}function Hm(e){return`${uc(Xe(e))}|lt:${e.limitType}`}function Or(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>qm(i)).join(", ")}]`),Ta(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Zr(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Zr(i)).join(",")),`Target(${r})`}(Xe(e))}; limitType=${e.limitType})`}function ba(e,t){return t.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(const s of Gi(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,u,l){const c=Ed(o,u,l);return o.inclusive?c<=0:c<0}(r.startAt,Gi(r),i)||r.endAt&&!function(o,u,l){const c=Ed(o,u,l);return o.inclusive?c>=0:c>0}(r.endAt,Gi(r),i))}(e,t)}function AR(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Gm(e){return(t,n)=>{let r=!1;for(const i of Gi(e)){const s=IR(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function IR(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(s,o,u){const l=o.data.field(s),c=u.data.field(s);return l!==null&&c!==null?Yr(l,c):K(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return K(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Qn(this.inner,(n,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return Pm(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=new St(G.comparator);function In(){return bR}const Wm=new St(G.comparator);function Bi(...e){let t=Wm;for(const n of e)t=t.insert(n.key,n);return t}function Km(e){let t=Wm;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function ar(){return Wi()}function Qm(){return Wi()}function Wi(){return new Er(e=>e.toString(),(e,t)=>e.isEqual(t))}const RR=new St(G.comparator),SR=new Ut(G.comparator);function rt(...e){let t=SR;for(const n of e)t=t.add(n);return t}const CR=new Ut(et);function PR(){return CR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wo(t)?"-0":t}}function Xm(e){return{integerValue:""+e}}function xR(e,t){return rR(t)?Xm(t):hc(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(){this._=void 0}}function VR(e,t,n){return e instanceof Yo?function(i,s){const o={fields:{[Nm]:{stringValue:Vm},[km]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&oc(s)&&(s=Aa(s)),s&&(o.fields[Dm]=s),{mapValue:o}}(n,t):e instanceof ps?Ym(e,t):e instanceof gs?Zm(e,t):function(i,s){const o=Jm(i,s),u=bd(o)+bd(i.Ee);return dl(o)&&dl(i.Ee)?Xm(u):hc(i.serializer,u)}(e,t)}function NR(e,t,n){return e instanceof ps?Ym(e,t):e instanceof gs?Zm(e,t):n}function Jm(e,t){return e instanceof Zo?function(r){return dl(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}class Yo extends Ra{}class ps extends Ra{constructor(t){super(),this.elements=t}}function Ym(e,t){const n=t_(t);for(const r of e.elements)n.some(i=>rn(i,r))||n.push(r);return{arrayValue:{values:n}}}class gs extends Ra{constructor(t){super(),this.elements=t}}function Zm(e,t){let n=t_(t);for(const r of e.elements)n=n.filter(i=>!rn(i,r));return{arrayValue:{values:n}}}class Zo extends Ra{constructor(t,n){super(),this.serializer=t,this.Ee=n}}function bd(e){return xt(e.integerValue||e.doubleValue)}function t_(e){return ac(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function DR(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof ps&&i instanceof ps||r instanceof gs&&i instanceof gs?Jr(r.elements,i.elements,rn):r instanceof Zo&&i instanceof Zo?rn(r.Ee,i.Ee):r instanceof Yo&&i instanceof Yo}(e.transform,t.transform)}class kR{constructor(t,n){this.version=t,this.transformResults=n}}class Je{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Je}static exists(t){return new Je(void 0,t)}static updateTime(t){return new Je(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function go(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Sa{}function e_(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new r_(e.key,Je.none()):new Ts(e.key,e.data,Je.none());{const n=e.data,r=pe.empty();let i=new Ut(Qt.comparator);for(let s of t.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Xn(e.key,r,new Te(i.toArray()),Je.none())}}function OR(e,t,n){e instanceof Ts?function(i,s,o){const u=i.value.clone(),l=Sd(i.fieldTransforms,s,o.transformResults);u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,n):e instanceof Xn?function(i,s,o){if(!go(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=Sd(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(n_(i)),l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Ki(e,t,n,r){return e instanceof Ts?function(s,o,u,l){if(!go(s.precondition,o))return u;const c=s.value.clone(),h=Cd(s.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(e,t,n,r):e instanceof Xn?function(s,o,u,l){if(!go(s.precondition,o))return u;const c=Cd(s.fieldTransforms,l,o),h=o.data;return h.setAll(n_(s)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,r):function(s,o,u){return go(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(e,t,n)}function MR(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),s=Jm(r.transform,i||null);s!=null&&(n===null&&(n=pe.empty()),n.set(r.field,s))}return n||null}function Rd(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Jr(r,i,(s,o)=>DR(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ts extends Sa{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xn extends Sa{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function n_(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Sd(e,t,n){const r=new Map;ct(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,u=t.data.field(s.field);r.set(s.field,NR(o,u,n[i]))}return r}function Cd(e,t,n){const r=new Map;for(const i of e){const s=i.transform,o=n.data.field(i.field);r.set(i.field,VR(s,o,t))}return r}class r_ extends Sa{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LR extends Sa{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&OR(s,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Ki(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Ki(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=Qm();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const l=e_(o,u);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),rt())}isEqual(t){return this.batchId===t.batchId&&Jr(this.mutations,t.mutations,(n,r)=>Rd(n,r))&&Jr(this.baseMutations,t.baseMutations,(n,r)=>Rd(n,r))}}class fc{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){ct(t.mutations.length===r.length,58842,{Ve:t.mutations.length,me:r.length});let i=function(){return RR}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new fc(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt,it;function $R(e){switch(e){case O.OK:return K(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return K(15467,{code:e})}}function i_(e){if(e===void 0)return Tn("GRPC error has no .code"),O.UNKNOWN;switch(e){case kt.OK:return O.OK;case kt.CANCELLED:return O.CANCELLED;case kt.UNKNOWN:return O.UNKNOWN;case kt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case kt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case kt.INTERNAL:return O.INTERNAL;case kt.UNAVAILABLE:return O.UNAVAILABLE;case kt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case kt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case kt.NOT_FOUND:return O.NOT_FOUND;case kt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case kt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case kt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case kt.ABORTED:return O.ABORTED;case kt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case kt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case kt.DATA_LOSS:return O.DATA_LOSS;default:return K(39323,{code:e})}}(it=kt||(kt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR=new Ln([4294967295,4294967295],0);function Pd(e){const t=bm().encode(e),n=new _m;return n.update(t),new Uint8Array(n.digest())}function xd(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Ln([n,r],0),new Ln([i,s],0)]}class dc{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $i(`Invalid padding: ${n}`);if(r<0)throw new $i(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new $i(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new $i(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*t.length-n,this.ge=Ln.fromNumber(this.fe)}pe(t,n,r){let i=t.add(n.multiply(Ln.fromNumber(r)));return i.compare(qR)===1&&(i=new Ln([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const n=Pd(t),[r,i]=xd(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(t,n,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new dc(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(t){if(this.fe===0)return;const n=Pd(t),[r,i]=xd(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class $i extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const i=new Map;return i.set(t,As.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new Ca(Q.min(),i,new St(et),In(),rt())}}class As{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new As(r,n,rt(),rt(),rt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(t,n,r,i){this.Se=t,this.removedTargetIds=n,this.key=r,this.be=i}}class s_{constructor(t,n){this.targetId=t,this.De=n}}class o_{constructor(t,n,r=Xt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Vd{constructor(){this.ve=0,this.Ce=Nd(),this.Fe=Xt.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=rt(),n=rt(),r=rt();return this.Ce.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:K(38017,{changeType:s})}}),new As(this.Fe,this.Me,t,n,r)}ke(){this.xe=!1,this.Ce=Nd()}qe(t,n){this.xe=!0,this.Ce=this.Ce.insert(t,n)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,ct(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class jR{constructor(t){this.We=t,this.Ge=new Map,this.ze=In(),this.je=eo(),this.Je=eo(),this.He=new St(et)}Ye(t){for(const n of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(n,t.be):this.Xe(n,t.key,t.be);for(const n of t.removedTargetIds)this.Xe(n,t.key,t.be)}et(t){this.forEachTarget(t,n=>{const r=this.tt(n);switch(t.state){case 0:this.nt(n)&&r.Be(t.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(t.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(t.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(t.resumeToken));break;default:K(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(t){const n=t.targetId,r=t.De.count,i=this.st(n);if(i){const s=i.target;if(gl(s))if(r===0){const o=new G(s.path);this.Xe(n,o,ne.newNoDocument(o,Q.min()))}else ct(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const u=this._t(t),l=u?this.ut(u,t,o):1;if(l!==0){this.rt(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,c)}}}}}_t(t){const n=t.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=zn(r).toUint8Array()}catch(l){if(l instanceof xm)return $n("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new dc(o,i,s)}catch(l){return $n(l instanceof $i?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.fe===0?null:u}ut(t,n,r){return n.De.count===r-this.ht(t,n.targetId)?0:2}ht(t,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(u)||(this.Xe(n,s,null),i++)}),i}Pt(t){const n=new Map;this.Ge.forEach((s,o)=>{const u=this.st(o);if(u){if(s.current&&gl(u.target)){const l=new G(u.target.path);this.Tt(l).has(o)||this.It(o,l)||this.Xe(o,l,ne.newNoDocument(l,t))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=rt();this.Je.forEach((s,o)=>{let u=!0;o.forEachWhile(l=>{const c=this.st(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(t));const i=new Ca(t,n,this.He,this.ze,r);return this.ze=In(),this.je=eo(),this.Je=eo(),this.He=new St(et),i}Ze(t,n){if(!this.nt(t))return;const r=this.It(t,n.key)?2:0;this.tt(t).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(t)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(t))}Xe(t,n,r){if(!this.nt(t))return;const i=this.tt(t);this.It(t,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(t)),this.Je=this.Je.insert(n,this.dt(n).add(t)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(t){this.Ge.delete(t)}ot(t){const n=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let n=this.Ge.get(t);return n||(n=new Vd,this.Ge.set(t,n)),n}dt(t){let n=this.Je.get(t);return n||(n=new Ut(et),this.Je=this.Je.insert(t,n)),n}Tt(t){let n=this.je.get(t);return n||(n=new Ut(et),this.je=this.je.insert(t,n)),n}nt(t){const n=this.st(t)!==null;return n||z("WatchChangeAggregator","Detected inactive target",t),n}st(t){const n=this.Ge.get(t);return n&&n.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new Vd),this.We.getRemoteKeysForTarget(t).forEach(n=>{this.Xe(t,n,null)})}It(t,n){return this.We.getRemoteKeysForTarget(t).has(n)}}function eo(){return new St(G.comparator)}function Nd(){return new St(G.comparator)}const zR={asc:"ASCENDING",desc:"DESCENDING"},HR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GR={and:"AND",or:"OR"};class WR{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function _l(e,t){return e.useProto3Json||Ta(t)?t:{value:t}}function ta(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function a_(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function KR(e,t){return ta(e,t.toTimestamp())}function Ye(e){return ct(!!e,49232),Q.fromTimestamp(function(n){const r=jn(n);return new vt(r.seconds,r.nanos)}(e))}function pc(e,t){return yl(e,t).canonicalString()}function yl(e,t){const n=function(i){return new _t(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function u_(e){const t=_t.fromString(e);return ct(d_(t),10190,{key:t.toString()}),t}function vl(e,t){return pc(e.databaseId,t.path)}function Eu(e,t){const n=u_(t);if(n.get(1)!==e.databaseId.projectId)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new G(c_(n))}function l_(e,t){return pc(e.databaseId,t)}function QR(e){const t=u_(e);return t.length===4?_t.emptyPath():c_(t)}function wl(e){return new _t(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function c_(e){return ct(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Dd(e,t,n){return{name:vl(e,t),fields:n.value.mapValue.fields}}function XR(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:K(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(c,h){return c.useProto3Json?(ct(h===void 0||typeof h=="string",58123),Xt.fromBase64String(h||"")):(ct(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xt.fromUint8Array(h||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(c){const h=c.code===void 0?O.UNKNOWN:i_(c.code);return new q(h,c.message||"")}(o);n=new o_(r,i,s,u||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Eu(e,r.document.name),s=Ye(r.document.updateTime),o=r.document.createTime?Ye(r.document.createTime):Q.min(),u=new pe({mapValue:{fields:r.document.fields}}),l=ne.newFoundDocument(i,s,o,u),c=r.targetIds||[],h=r.removedTargetIds||[];n=new mo(c,h,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Eu(e,r.document),s=r.readTime?Ye(r.readTime):Q.min(),o=ne.newNoDocument(i,s),u=r.removedTargetIds||[];n=new mo([],u,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Eu(e,r.document),s=r.removedTargetIds||[];n=new mo([],s,i,null)}else{if(!("filter"in t))return K(11601,{At:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new BR(i,s),u=r.targetId;n=new s_(u,o)}}return n}function JR(e,t){let n;if(t instanceof Ts)n={update:Dd(e,t.key,t.value)};else if(t instanceof r_)n={delete:vl(e,t.key)};else if(t instanceof Xn)n={update:Dd(e,t.key,t.data),updateMask:oS(t.fieldMask)};else{if(!(t instanceof LR))return K(16599,{Rt:t.type});n={verify:vl(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Yo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ps)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof gs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Zo)return{fieldPath:o.field.canonicalString(),increment:u.Ee};throw K(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:KR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:K(27497)}(e,t.precondition)),n}function YR(e,t){return e&&e.length>0?(ct(t!==void 0,14353),e.map(n=>function(i,s){let o=i.updateTime?Ye(i.updateTime):Ye(s);return o.isEqual(Q.min())&&(o=Ye(s)),new kR(o,i.transformResults||[])}(n,t))):[]}function ZR(e,t){return{documents:[l_(e,t.path)]}}function tS(e,t){const n={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=l_(e,i);const s=function(c){if(c.length!==0)return f_(Fe.create(c,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(h=>function(p){return{field:Mr(p.field),direction:rS(p.dir)}}(h))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const u=_l(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{Vt:n,parent:i}}function eS(e){let t=QR(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ct(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let s=[];n.where&&(s=function(d){const p=h_(d);return p instanceof Fe&&Bm(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(_){return new ds(Lr(_.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(p))}(n.orderBy));let u=null;n.limit&&(u=function(d){let p;return p=typeof d=="object"?d.value:d,Ta(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(d){const p=!!d.before,m=d.values||[];return new Xo(m,p)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const p=!d.before,m=d.values||[];return new Xo(m,p)}(n.endAt)),ER(t,i,o,s,u,"F",l,c)}function nS(e,t){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K(28987,{purpose:i})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function h_(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Lr(n.unaryFilter.field);return Ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Lr(n.unaryFilter.field);return Ot.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Lr(n.unaryFilter.field);return Ot.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Lr(n.unaryFilter.field);return Ot.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return K(61313);default:return K(60726)}}(e):e.fieldFilter!==void 0?function(n){return Ot.create(Lr(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return K(58110);default:return K(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Fe.create(n.compositeFilter.filters.map(r=>h_(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return K(1026)}}(n.compositeFilter.op))}(e):K(30097,{filter:e})}function rS(e){return zR[e]}function iS(e){return HR[e]}function sS(e){return GR[e]}function Mr(e){return{fieldPath:e.canonicalString()}}function Lr(e){return Qt.fromServerFormat(e.fieldPath)}function f_(e){return e instanceof Ot?function(n){if(n.op==="=="){if(wd(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NAN"}};if(vd(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(wd(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NOT_NAN"}};if(vd(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mr(n.field),op:iS(n.op),value:n.value}}}(e):e instanceof Fe?function(n){const r=n.getFilters().map(i=>f_(i));return r.length===1?r[0]:{compositeFilter:{op:sS(n.op),filters:r}}}(e):K(54877,{filter:e})}function oS(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function d_(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(t,n,r,i,s=Q.min(),o=Q.min(),u=Xt.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(t){return new kn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(t){this.gt=t}}function uS(e){const t=eS({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Jo(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(){this.Dn=new cS}addToCollectionParentIndex(t,n){return this.Dn.add(n),L.resolve()}getCollectionParents(t,n){return L.resolve(this.Dn.getEntries(n))}addFieldIndex(t,n){return L.resolve()}deleteFieldIndex(t,n){return L.resolve()}deleteAllFieldIndexes(t){return L.resolve()}createTargetIndexes(t,n){return L.resolve()}getDocumentsMatchingTarget(t,n){return L.resolve(null)}getIndexType(t,n){return L.resolve(0)}getFieldIndexes(t,n){return L.resolve([])}getNextCollectionGroupToUpdate(t){return L.resolve(null)}getMinOffset(t,n){return L.resolve(qn.min())}getMinOffsetFromCollectionGroup(t,n){return L.resolve(qn.min())}updateCollectionGroup(t,n,r){return L.resolve()}updateIndexEntries(t,n){return L.resolve()}}class cS{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new Ut(_t.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new Ut(_t.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},p_=41943040;class de{static withCacheSize(t){return new de(t,de.DEFAULT_COLLECTION_PERCENTILE,de.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */de.DEFAULT_COLLECTION_PERCENTILE=10,de.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,de.DEFAULT=new de(p_,de.DEFAULT_COLLECTION_PERCENTILE,de.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),de.DISABLED=new de(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new ti(0)}static ur(){return new ti(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="LruGarbageCollector",hS=1048576;function Md([e,t],[n,r]){const i=et(e,n);return i===0?et(t,r):i}class fS{constructor(t){this.Tr=t,this.buffer=new Ut(Md),this.Ir=0}dr(){return++this.Ir}Er(t){const n=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Md(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class dS{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){z(Od,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ci(n)?z(Od,"Ignoring IndexedDB error during garbage collection: ",n):await li(n)}await this.Rr(3e5)})}}class pS{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.mr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return L.resolve(Ea.ue);const r=new fS(n);return this.Vr.forEachTarget(t,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(t,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.Vr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(kd)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),kd):this.pr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,n){let r,i,s,o,u,l,c;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(r=d,u=Date.now(),this.removeTargets(t,r,n))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(t,r))).next(d=>(c=Date.now(),kr()<=st.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(l-u)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function gS(e,t){return new pS(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(){this.changes=new Er(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,ne.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&Ki(r.mutation,i,Te.empty(),vt.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,rt()).next(()=>r))}getLocalViewOfDocuments(t,n,r=rt()){const i=ar();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let o=Bi();return s.forEach((u,l)=>{o=o.insert(u,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=ar();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,rt()))}populateOverlays(t,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(t,n,r,i){let s=In();const o=Wi(),u=function(){return Wi()}();return n.forEach((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof Xn)?s=s.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Ki(h.mutation,c,h.mutation.getFieldMask(),vt.now())):o.set(c.key,Te.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,h)=>o.set(c,h)),n.forEach((c,h)=>{var d;return u.set(c,new _S(h,(d=o.get(c))!==null&&d!==void 0?d:null))}),u))}recalculateAndSaveOverlays(t,n){const r=Wi();let i=new St((o,u)=>o-u),s=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const u of o)u.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let h=r.get(l)||Te.empty();h=u.applyToLocalView(c,h),r.set(l,h);const d=(i.get(u.batchId)||rt()).add(l);i=i.insert(u.batchId,d)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const l=u.getNext(),c=l.key,h=l.value,d=Qm();h.forEach(p=>{if(!s.has(p)){const m=e_(n.get(p),r.get(p));m!==null&&d.set(p,m),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,d))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):zm(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):L.resolve(ar());let u=ls,l=s;return o.next(c=>L.forEach(c,(h,d)=>(u<d.largestBatchId&&(u=d.largestBatchId),s.get(h)?L.resolve():this.remoteDocumentCache.getEntry(t,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,rt())).next(h=>({batchId:u,changes:Km(h)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new G(n)).next(r=>{let i=Bi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const s=n.collectionGroup;let o=Bi();return this.indexManager.getCollectionParents(t,s).next(u=>L.forEach(u,l=>{const c=function(d,p){return new hi(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,r,i).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(o=>{s.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,ne.newInvalidDocument(h)))});let u=Bi();return o.forEach((l,c)=>{const h=s.get(l);h!==void 0&&Ki(h.mutation,c,Te.empty(),vt.now()),ba(n,c)&&(u=u.insert(l,c))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,n){return L.resolve(this.Br.get(n))}saveBundleMetadata(t,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ye(i.createTime)}}(n)),L.resolve()}getNamedQuery(t,n){return L.resolve(this.Lr.get(n))}saveNamedQuery(t,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:uS(i.bundledQuery),readTime:Ye(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(){this.overlays=new St(G.comparator),this.kr=new Map}getOverlay(t,n){return L.resolve(this.overlays.get(n))}getOverlays(t,n){const r=ar();return L.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.wt(t,n,s)}),L.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),L.resolve()}getOverlaysForCollection(t,n,r){const i=ar(),s=n.length+1,o=new G(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const l=u.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return L.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new St((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=ar(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const u=ar(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>u.set(c,h)),!(u.size()>=i)););return L.resolve(u)}wt(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new UR(n,r));let s=this.kr.get(n);s===void 0&&(s=rt(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(){this.sessionToken=Xt.EMPTY_BYTE_STRING}getSessionToken(t){return L.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(){this.qr=new Ut(jt.Qr),this.$r=new Ut(jt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,n){const r=new jt(t,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Wr(new jt(t,n))}Gr(t,n){t.forEach(r=>this.removeReference(r,n))}zr(t){const n=new G(new _t([])),r=new jt(n,t),i=new jt(n,t+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const n=new G(new _t([])),r=new jt(n,t),i=new jt(n,t+1);let s=rt();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new jt(t,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class jt{constructor(t,n){this.key=t,this.Hr=n}static Qr(t,n){return G.comparator(t.key,n.key)||et(t.Hr,n.Hr)}static Ur(t,n){return et(t.Hr,n.Hr)||G.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Ut(jt.Qr)}checkEmpty(t){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new FR(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.Yr=this.Yr.add(new jt(u.key,s)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return L.resolve(o)}lookupMutationBatch(t,n){return L.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?sc:this.er-1)}getAllMutationBatches(t){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new jt(n,0),i=new jt(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const u=this.Zr(o.Hr);s.push(u)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Ut(et);return n.forEach(i=>{const s=new jt(i,0),o=new jt(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],u=>{r=r.add(u.Hr)})}),L.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new jt(new G(s),0);let u=new Ut(et);return this.Yr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(u=u.add(l.Hr)),!0)},o),L.resolve(this.ei(u))}ei(t){const n=[];return t.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){ct(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return L.forEach(n.mutations,i=>{const s=new jt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Yr=r})}rr(t){}containsKey(t,n){const r=new jt(n,0),i=this.Yr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,L.resolve()}ti(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(t){this.ni=t,this.docs=function(){return new St(G.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():ne.newInvalidDocument(n))}getEntries(t,n){let r=In();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ne.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=In();const o=n.path,u=new G(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Zb(Yb(h),r)<=0||(i.has(h.key)||ba(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(t,n,r,i){K(9500)}ri(t,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new IS(this)}getSize(t){return L.resolve(this.size)}}class IS extends mS{constructor(t){super(),this.Or=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(t,i)):this.Or.removeEntry(r)}),L.waitFor(n)}getFromCache(t,n){return this.Or.getEntry(t,n)}getAllFromCache(t,n){return this.Or.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(t){this.persistence=t,this.ii=new Er(n=>uc(n),lc),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.si=0,this.oi=new gc,this.targetCount=0,this._i=ti.ar()}forEachTarget(t,n){return this.ii.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(t){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return L.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),L.resolve()}hr(t){this.ii.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this._i=new ti(n),this.highestTargetId=n),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,n){return this.hr(n),this.targetCount+=1,L.resolve()}updateTargetData(t,n){return this.hr(n),L.resolve()}removeTargetData(t,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(t,n,r){let i=0;const s=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(t){return L.resolve(this.targetCount)}getTargetData(t,n){const r=this.ii.get(n)||null;return L.resolve(r)}addMatchingKeys(t,n,r){return this.oi.Kr(n,r),L.resolve()}removeMatchingKeys(t,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.oi.zr(n),L.resolve()}getMatchingKeysForTargetId(t,n){const r=this.oi.Jr(n);return L.resolve(r)}containsKey(t,n){return L.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(t,n){this.ai={},this.overlays={},this.ui=new Ea(0),this.ci=!1,this.ci=!0,this.li=new ES,this.referenceDelegate=t(this),this.hi=new bS(this),this.indexManager=new lS,this.remoteDocumentCache=function(i){return new AS(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new aS(n),this.Ti=new vS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new wS,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ai[t.toKey()];return r||(r=new TS(n,this.referenceDelegate),this.ai[t.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,n,r){z("MemoryPersistence","Starting transaction:",t);const i=new RS(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(t,n){return L.or(Object.values(this.ai).map(r=>()=>r.containsKey(t,n)))}}class RS extends eR{constructor(t){super(),this.currentSequenceNumber=t}}class mc{constructor(t){this.persistence=t,this.Ai=new gc,this.Ri=null}static Vi(t){return new mc(t)}get mi(){if(this.Ri)return this.Ri;throw K(60996)}addReference(t,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),L.resolve()}removeReference(t,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(t,n){return this.mi.add(n.toString()),L.resolve()}removeTarget(t,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ii(){this.Ri=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.mi,r=>{const i=G.fromPath(r);return this.fi(t,i).next(s=>{s||n.removeEntry(i,Q.min())})}).next(()=>(this.Ri=null,n.apply(t)))}updateLimboDocument(t,n){return this.fi(t,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(t){return 0}fi(t,n){return L.or([()=>L.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class ea{constructor(t,n){this.persistence=t,this.gi=new Er(r=>iR(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=gS(this,n)}static Vi(t,n){return new ea(t,n)}Ii(){}di(t){return L.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}mr(t){const n=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}yr(t){let n=0;return this.gr(t,r=>{n++}).next(()=>n)}gr(t,n){return L.forEach(this.gi,(r,i)=>this.Sr(t,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(t,o=>this.Sr(t,o,n).next(u=>{u||(r++,s.removeEntry(o,Q.min()))})).next(()=>s.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}removeReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}updateLimboDocument(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}Pi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=fo(t.data.value)),n}Sr(t,n,r){return L.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.gi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.Is=r,this.ds=i}static Es(t,n){let r=rt(),i=rt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new _c(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return wI()?8:nR(yI())>0?6:4}()}initialize(t,n){this.gs=t,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(t,n,r,i){const s={result:null};return this.ps(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(t,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new SS;return this.ws(t,n,o).next(u=>{if(s.result=u,this.Rs)return this.Ss(t,n,o,u.size)})}).next(()=>s.result)}Ss(t,n,r,i){return r.documentReadCount<this.Vs?(kr()<=st.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",Or(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),L.resolve()):(kr()<=st.DEBUG&&z("QueryEngine","Query:",Or(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(kr()<=st.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",Or(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Xe(n))):L.resolve())}ps(t,n){if(Id(n))return L.resolve(null);let r=Xe(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Jo(n,null,"F"),r=Xe(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const o=rt(...s);return this.gs.getDocuments(t,o).next(u=>this.indexManager.getMinOffset(t,r).next(l=>{const c=this.bs(n,u);return this.Ds(n,c,o,l.readTime)?this.ps(t,Jo(n,null,"F")):this.vs(t,c,n,l)}))})))}ys(t,n,r,i){return Id(n)||i.isEqual(Q.min())?L.resolve(null):this.gs.getDocuments(t,r).next(s=>{const o=this.bs(n,s);return this.Ds(n,o,r,i)?L.resolve(null):(kr()<=st.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Or(n)),this.vs(t,o,n,Jb(i,ls)).next(u=>u))})}bs(t,n){let r=new Ut(Gm(t));return n.forEach((i,s)=>{ba(t,s)&&(r=r.add(s))}),r}Ds(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(t,n,r){return kr()<=st.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",Or(n)),this.gs.getDocumentsMatchingQuery(t,n,qn.min(),r)}vs(t,n,r,i){return this.gs.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc="LocalStore",PS=3e8;class xS{constructor(t,n,r,i){this.persistence=t,this.Cs=n,this.serializer=i,this.Fs=new St(et),this.Ms=new Er(s=>uc(s),lc),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(r)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new yS(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Fs))}}function VS(e,t,n,r){return new xS(e,t,n,r)}async function m_(e,t){const n=J(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let l=rt();for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){u.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Bs:c,removedBatchIds:o,addedBatchIds:u}))})})}function NS(e,t){const n=J(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,l,c,h){const d=c.batch,p=d.keys();let m=L.resolve();return p.forEach(_=>{m=m.next(()=>h.getEntry(l,_)).next(E=>{const v=c.docVersions.get(_);ct(v!==null,48541),E.version.compareTo(v)<0&&(d.applyToRemoteDocument(E,c),E.isValidDocument()&&(E.setReadTime(c.commitVersion),h.addEntry(E)))})}),m.next(()=>u.mutationQueue.removeMutationBatch(l,d))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=rt();for(let c=0;c<u.mutationResults.length;++c)u.mutationResults[c].transformResults.length>0&&(l=l.add(u.batch.mutations[c].key));return l}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function __(e){const t=J(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.hi.getLastRemoteSnapshotVersion(n))}function DS(e,t){const n=J(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const u=[];t.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;u.push(n.hi.removeMatchingKeys(s,h.removedDocuments,d).next(()=>n.hi.addMatchingKeys(s,h.addedDocuments,d)));let m=p.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(Xt.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,r)),i=i.insert(d,m),function(E,v,P){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=PS?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(p,m,h)&&u.push(n.hi.updateTargetData(s,m))});let l=In(),c=rt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),u.push(kS(s,o,t.documentUpdates).next(h=>{l=h.Ls,c=h.ks})),!r.isEqual(Q.min())){const h=n.hi.getLastRemoteSnapshotVersion(s).next(d=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(h)}return L.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.Fs=i,s))}function kS(e,t,n){let r=rt(),i=rt();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let o=In();return n.forEach((u,l)=>{const c=s.get(u);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(Q.min())?(t.removeEntry(u,l.readTime),o=o.insert(u,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(u,l)):z(yc,"Ignoring outdated watch update for ",u,". Current version:",c.version," Watch version:",l.version)}),{Ls:o,ks:i}})}function OS(e,t){const n=J(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=sc),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function MS(e,t){const n=J(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,t).next(s=>s?(i=s,L.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new kn(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(t,r.targetId)),r})}async function El(e,t,n){const r=J(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ci(o))throw o;z(yc,`Failed to update sequence numbers for target ${t}: ${o}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function Ld(e,t,n){const r=J(e);let i=Q.min(),s=rt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=J(l),p=d.Ms.get(h);return p!==void 0?L.resolve(d.Fs.get(p)):d.hi.getTargetData(c,h)}(r,o,Xe(t)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,t,n?i:Q.min(),n?s:rt())).next(u=>(LS(r,AR(t),u),{documents:u,qs:s})))}function LS(e,t,n){let r=e.xs.get(t)||Q.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.xs.set(t,r)}class Fd{constructor(){this.activeTargetIds=PR()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class FS{constructor(){this.Fo=new Fd,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,n,r){this.Mo[t]=n}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new Fd,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud="ConnectivityMonitor";class Bd{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){z(Ud,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){z(Ud,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let no=null;function Tl(){return no===null?no=function(){return 268435456+Math.round(2147483648*Math.random())}():no++,"0x"+no.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu="RestConnection",BS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $S{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Ko?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,n,r,i,s){const o=Tl(),u=this.Go(t,n.toUriEncodedString());z(Tu,`Sending RPC '${t}' ${o}:`,u,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,i,s);const{host:c}=new URL(u),h=ec(c);return this.jo(t,u,l,r,h).then(d=>(z(Tu,`Received RPC '${t}' ${o}: `,d),d),d=>{throw $n(Tu,`RPC '${t}' ${o} failed with error: `,d,"url: ",u,"request:",r),d})}Jo(t,n,r,i,s,o){return this.Wo(t,n,r,i,s)}zo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ui}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}Go(t,n){const r=BS[t];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te="WebChannelConnection";class jS extends $S{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,n,r,i,s){const o=Tl();return new Promise((u,l)=>{const c=new ym;c.setWithCredentials(!0),c.listenOnce(vm.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ho.NO_ERROR:const d=c.getResponseJson();z(te,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),u(d);break;case ho.TIMEOUT:z(te,`RPC '${t}' ${o} timed out`),l(new q(O.DEADLINE_EXCEEDED,"Request time out"));break;case ho.HTTP_ERROR:const p=c.getStatus();if(z(te,`RPC '${t}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const E=function(P){const S=P.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(S)>=0?S:O.UNKNOWN}(_.status);l(new q(E,_.message))}else l(new q(O.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new q(O.UNAVAILABLE,"Connection failed."));break;default:K(9055,{c_:t,streamId:o,l_:c.getLastErrorCode(),h_:c.getLastError()})}}finally{z(te,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);z(te,`RPC '${t}' ${o} sending request:`,i),c.send(n,"POST",h,r,15)})}P_(t,n,r){const i=Tl(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Tm(),u=Em(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=s.join("");z(te,`Creating RPC '${t}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);this.T_(d);let p=!1,m=!1;const _=new qS({Ho:v=>{m?z(te,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(p||(z(te,`Opening RPC '${t}' stream ${i} transport.`),d.open(),p=!0),z(te,`RPC '${t}' stream ${i} sending:`,v),d.send(v))},Yo:()=>d.close()}),E=(v,P,S)=>{v.listen(P,N=>{try{S(N)}catch(x){setTimeout(()=>{throw x},0)}})};return E(d,Ui.EventType.OPEN,()=>{m||(z(te,`RPC '${t}' stream ${i} transport opened.`),_.s_())}),E(d,Ui.EventType.CLOSE,()=>{m||(m=!0,z(te,`RPC '${t}' stream ${i} transport closed`),_.__(),this.I_(d))}),E(d,Ui.EventType.ERROR,v=>{m||(m=!0,$n(te,`RPC '${t}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),_.__(new q(O.UNAVAILABLE,"The operation could not be completed")))}),E(d,Ui.EventType.MESSAGE,v=>{var P;if(!m){const S=v.data[0];ct(!!S,16349);const N=S,x=(N==null?void 0:N.error)||((P=N[0])===null||P===void 0?void 0:P.error);if(x){z(te,`RPC '${t}' stream ${i} received error:`,x);const M=x.status;let B=function(T){const R=kt[T];if(R!==void 0)return i_(R)}(M),I=x.message;B===void 0&&(B=O.INTERNAL,I="Unknown error status: "+M+" with message "+x.message),m=!0,_.__(new q(B,I)),d.close()}else z(te,`RPC '${t}' stream ${i} received:`,S),_.a_(S)}}),E(u,wm.STAT_EVENT,v=>{v.stat===cl.PROXY?z(te,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===cl.NOPROXY&&z(te,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.o_()},0),_}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(n=>n===t)}}function Au(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(e){return new WR(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(t,n,r=1e3,i=1.5,s=6e4){this.Fi=t,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d="PersistentStream";class v_{constructor(t,n,r,i,s,o,u,l){this.Fi=t,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new y_(t,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():n&&n.code===O.RESOURCE_EXHAUSTED?(Tn(n.toString()),Tn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(n)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{t(()=>{const i=new q(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(t,n){const r=this.K_(this.b_);this.stream=this.z_(t,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return z($d,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return n=>{this.Fi.enqueueAndForget(()=>this.b_===t?n():(z($d,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zS extends v_{constructor(t,n,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(t,n){return this.connection.P_("Listen",t,n)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const n=XR(this.serializer,t),r=function(s){if(!("targetChange"in s))return Q.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Q.min():o.readTime?Ye(o.readTime):Q.min()}(t);return this.listener.J_(n,r)}H_(t){const n={};n.database=wl(this.serializer),n.addTarget=function(s,o){let u;const l=o.target;if(u=gl(l)?{documents:ZR(s,l)}:{query:tS(s,l).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=a_(s,o.resumeToken);const c=_l(s,o.expectedCount);c!==null&&(u.expectedCount=c)}else if(o.snapshotVersion.compareTo(Q.min())>0){u.readTime=ta(s,o.snapshotVersion.toTimestamp());const c=_l(s,o.expectedCount);c!==null&&(u.expectedCount=c)}return u}(this.serializer,t);const r=nS(this.serializer,t);r&&(n.labels=r),this.k_(n)}Y_(t){const n={};n.database=wl(this.serializer),n.removeTarget=t,this.k_(n)}}class HS extends v_{constructor(t,n,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,n){return this.connection.P_("Write",t,n)}j_(t){return ct(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ct(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){ct(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const n=YR(t.writeResults,t.commitTime),r=Ye(t.commitTime);return this.listener.ta(r,n)}na(){const t={};t.database=wl(this.serializer),this.k_(t)}X_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>JR(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{}class WS extends GS{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,yl(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(O.UNKNOWN,s.toString())})}Jo(t,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(t,yl(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(O.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class KS{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Tn(n),this._a=!1):z("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r="RemoteStore";class QS{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Tr(this)&&(z(_r,"Restarting streams for network reachability change."),await async function(l){const c=J(l);c.Ia.add(4),await Is(c),c.Aa.set("Unknown"),c.Ia.delete(4),await xa(c)}(this))})}),this.Aa=new KS(r,i)}}async function xa(e){if(Tr(e))for(const t of e.da)await t(!0)}async function Is(e){for(const t of e.da)await t(!1)}function w_(e,t){const n=J(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),Tc(n)?Ec(n):fi(n).x_()&&wc(n,t))}function vc(e,t){const n=J(e),r=fi(n);n.Ta.delete(t),r.x_()&&E_(n,t),n.Ta.size===0&&(r.x_()?r.B_():Tr(n)&&n.Aa.set("Unknown"))}function wc(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Q.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}fi(e).H_(t)}function E_(e,t){e.Ra.$e(t),fi(e).Y_(t)}function Ec(e){e.Ra=new jR({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),fi(e).start(),e.Aa.aa()}function Tc(e){return Tr(e)&&!fi(e).M_()&&e.Ta.size>0}function Tr(e){return J(e).Ia.size===0}function T_(e){e.Ra=void 0}async function XS(e){e.Aa.set("Online")}async function JS(e){e.Ta.forEach((t,n)=>{wc(e,t)})}async function YS(e,t){T_(e),Tc(e)?(e.Aa.la(t),Ec(e)):e.Aa.set("Unknown")}async function ZS(e,t,n){if(e.Aa.set("Online"),t instanceof o_&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.Ta.delete(u),i.Ra.removeTarget(u))}(e,t)}catch(r){z(_r,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await na(e,r)}else if(t instanceof mo?e.Ra.Ye(t):t instanceof s_?e.Ra.it(t):e.Ra.et(t),!n.isEqual(Q.min()))try{const r=await __(e.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Ra.Pt(o);return u.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ta.get(c);h&&s.Ta.set(c,h.withResumeToken(l.resumeToken,o))}}),u.targetMismatches.forEach((l,c)=>{const h=s.Ta.get(l);if(!h)return;s.Ta.set(l,h.withResumeToken(Xt.EMPTY_BYTE_STRING,h.snapshotVersion)),E_(s,l);const d=new kn(h.target,l,c,h.sequenceNumber);wc(s,d)}),s.remoteSyncer.applyRemoteEvent(u)}(e,n)}catch(r){z(_r,"Failed to raise snapshot:",r),await na(e,r)}}async function na(e,t,n){if(!ci(t))throw t;e.Ia.add(1),await Is(e),e.Aa.set("Offline"),n||(n=()=>__(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{z(_r,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await xa(e)})}function A_(e,t){return t().catch(n=>na(e,n,t))}async function Va(e){const t=J(e),n=Gn(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:sc;for(;tC(t);)try{const i=await OS(t.localStore,r);if(i===null){t.Pa.length===0&&n.B_();break}r=i.batchId,eC(t,i)}catch(i){await na(t,i)}I_(t)&&b_(t)}function tC(e){return Tr(e)&&e.Pa.length<10}function eC(e,t){e.Pa.push(t);const n=Gn(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function I_(e){return Tr(e)&&!Gn(e).M_()&&e.Pa.length>0}function b_(e){Gn(e).start()}async function nC(e){Gn(e).na()}async function rC(e){const t=Gn(e);for(const n of e.Pa)t.X_(n.mutations)}async function iC(e,t,n){const r=e.Pa.shift(),i=fc.from(r,t,n);await A_(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Va(e)}async function sC(e,t){t&&Gn(e).Z_&&await async function(r,i){if(function(o){return $R(o)&&o!==O.ABORTED}(i.code)){const s=r.Pa.shift();Gn(r).N_(),await A_(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Va(r)}}(e,t),I_(e)&&b_(e)}async function qd(e,t){const n=J(e);n.asyncQueue.verifyOperationInProgress(),z(_r,"RemoteStore received new credentials");const r=Tr(n);n.Ia.add(3),await Is(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await xa(n)}async function oC(e,t){const n=J(e);t?(n.Ia.delete(2),await xa(n)):t||(n.Ia.add(2),await Is(n),n.Aa.set("Unknown"))}function fi(e){return e.Va||(e.Va=function(n,r,i){const s=J(n);return s.ia(),new zS(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:XS.bind(null,e),e_:JS.bind(null,e),n_:YS.bind(null,e),J_:ZS.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),Tc(e)?Ec(e):e.Aa.set("Unknown")):(await e.Va.stop(),T_(e))})),e.Va}function Gn(e){return e.ma||(e.ma=function(n,r,i){const s=J(n);return s.ia(),new HS(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:nC.bind(null,e),n_:sC.bind(null,e),ea:rC.bind(null,e),ta:iC.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await Va(e)):(await e.ma.stop(),e.Pa.length>0&&(z(_r,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new _n,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){const o=Date.now()+r,u=new Ac(t,n,o,i,s);return u.start(r),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(O.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ic(e,t){if(Tn("AsyncQueue",`${t}: ${e}`),ci(e))return new q(O.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{static emptySet(t){return new zr(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=Bi(),this.sortedSet=new St(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof zr)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new zr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(){this.fa=new St(G.comparator)}track(t){const n=t.doc.key,r=this.fa.get(n);r?t.type!==0&&r.type===3?this.fa=this.fa.insert(n,t):t.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.fa=this.fa.remove(n):t.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):K(63341,{At:t,ga:r}):this.fa=this.fa.insert(n,t)}pa(){const t=[];return this.fa.inorderTraversal((n,r)=>{t.push(r)}),t}}class ei{constructor(t,n,r,i,s,o,u,l,c){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new ei(t,n,zr.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ia(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class uC{constructor(){this.queries=zd(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=J(n),s=i.queries;i.queries=zd(),s.forEach((o,u)=>{for(const l of u.wa)l.onError(r)})})(this,new q(O.ABORTED,"Firestore shutting down"))}}function zd(){return new Er(e=>Hm(e),Ia)}async function R_(e,t){const n=J(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new aC,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=Ic(o,`Initialization of query '${Or(t.query)}' failed`);return void t.onError(u)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&bc(n)}async function S_(e,t){const n=J(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const o=s.wa.indexOf(t);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function lC(e,t){const n=J(e);let r=!1;for(const i of t){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.wa)u.Ca(i)&&(r=!0);o.ya=i}}r&&bc(n)}function cC(e,t,n){const r=J(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function bc(e){e.Da.forEach(t=>{t.next()})}var Al,Hd;(Hd=Al||(Al={})).Fa="default",Hd.Cache="cache";class C_{constructor(t,n,r){this.query=t,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new ei(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),n=!0):this.Ba(t,this.onlineState)&&(this.La(t),n=!0),this.Oa=t,n}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),n=!0),n}Ba(t,n){if(!t.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(t){t=ei.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==Al.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(t){this.key=t}}class x_{constructor(t){this.key=t}}class hC{constructor(t,n){this.query=t,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=rt(),this.mutatedKeys=rt(),this.Xa=Gm(t),this.eu=new zr(this.Xa)}get tu(){return this.Ha}nu(t,n){const r=n?n.ru:new jd,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const p=i.get(h),m=ba(this.query,d)?d:null,_=!!p&&this.mutatedKeys.has(p.key),E=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let v=!1;p&&m?p.data.isEqual(m.data)?_!==E&&(r.track({type:3,doc:m}),v=!0):this.iu(p,m)||(r.track({type:2,doc:m}),v=!0,(l&&this.Xa(m,l)>0||c&&this.Xa(m,c)<0)&&(u=!0)):!p&&m?(r.track({type:0,doc:m}),v=!0):p&&!m&&(r.track({type:1,doc:p}),v=!0,(l||c)&&(u=!0)),v&&(m?(o=o.add(m),s=E?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:u,mutatedKeys:s}}iu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const o=t.ru.pa();o.sort((h,d)=>function(m,_){const E=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K(20277,{At:v})}};return E(m)-E(_)}(h.type,d.type)||this.Xa(h.doc,d.doc)),this.su(r),i=i!=null&&i;const u=n&&!i?this.ou():[],l=this.Za.size===0&&this.current&&!i?1:0,c=l!==this.Ya;return this.Ya=l,o.length!==0||c?{snapshot:new ei(this.query,t.eu,s,o,t.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new jd,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=rt(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return t.forEach(r=>{this.Za.has(r)||n.push(new x_(r))}),this.Za.forEach(r=>{t.has(r)||n.push(new P_(r))}),n}uu(t){this.Ha=t.qs,this.Za=rt();const n=this.nu(t.documents);return this.applyChanges(n,!0)}cu(){return ei.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Rc="SyncEngine";class fC{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class dC{constructor(t){this.key=t,this.lu=!1}}class pC{constructor(t,n,r,i,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Er(u=>Hm(u),Ia),this.Tu=new Map,this.Iu=new Set,this.du=new St(G.comparator),this.Eu=new Map,this.Au=new gc,this.Ru={},this.Vu=new Map,this.mu=ti.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function gC(e,t,n=!0){const r=M_(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await V_(r,t,n,!0),i}async function mC(e,t){const n=M_(e);await V_(n,t,!0,!1)}async function V_(e,t,n,r){const i=await MS(e.localStore,Xe(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await _C(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&n&&w_(e.remoteStore,i),u}async function _C(e,t,n,r,i){e.gu=(d,p,m)=>async function(E,v,P,S){let N=v.view.nu(P);N.Ds&&(N=await Ld(E.localStore,v.query,!1).then(({documents:I})=>v.view.nu(I,N)));const x=S&&S.targetChanges.get(v.targetId),M=S&&S.targetMismatches.get(v.targetId)!=null,B=v.view.applyChanges(N,E.isPrimaryClient,x,M);return Wd(E,v.targetId,B._u),B.snapshot}(e,d,p,m);const s=await Ld(e.localStore,t,!0),o=new hC(t,s.qs),u=o.nu(s.documents),l=As.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),c=o.applyChanges(u,e.isPrimaryClient,l);Wd(e,n,c._u);const h=new fC(t,n,o);return e.Pu.set(t,h),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function yC(e,t,n){const r=J(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!Ia(o,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await El(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&vc(r.remoteStore,i.targetId),Il(r,i.targetId)}).catch(li)):(Il(r,i.targetId),await El(r.localStore,i.targetId,!0))}async function vC(e,t){const n=J(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),vc(n.remoteStore,r.targetId))}async function wC(e,t,n){const r=SC(e);try{const i=await function(o,u){const l=J(o),c=vt.now(),h=u.reduce((m,_)=>m.add(_.key),rt());let d,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let _=In(),E=rt();return l.Os.getEntries(m,h).next(v=>{_=v,_.forEach((P,S)=>{S.isValidDocument()||(E=E.add(P))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,_)).next(v=>{d=v;const P=[];for(const S of u){const N=MR(S,d.get(S.key).overlayedDocument);N!=null&&P.push(new Xn(S.key,N,Lm(N.value.mapValue),Je.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,P,u)}).next(v=>{p=v;const P=v.applyToLocalDocumentSet(d,E);return l.documentOverlayCache.saveOverlays(m,v.batchId,P)})}).then(()=>({batchId:p.batchId,changes:Km(d)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,l){let c=o.Ru[o.currentUser.toKey()];c||(c=new St(et)),c=c.insert(u,l),o.Ru[o.currentUser.toKey()]=c}(r,i.batchId,n),await bs(r,i.changes),await Va(r.remoteStore)}catch(i){const s=Ic(i,"Failed to persist write");n.reject(s)}}async function N_(e,t){const n=J(e);try{const r=await DS(n.localStore,t);t.targetChanges.forEach((i,s)=>{const o=n.Eu.get(s);o&&(ct(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?ct(o.lu,14607):i.removedDocuments.size>0&&(ct(o.lu,42227),o.lu=!1))}),await bs(n,r,t)}catch(r){await li(r)}}function Gd(e,t,n){const r=J(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,o)=>{const u=o.view.va(t);u.snapshot&&i.push(u.snapshot)}),function(o,u){const l=J(o);l.onlineState=u;let c=!1;l.queries.forEach((h,d)=>{for(const p of d.wa)p.va(u)&&(c=!0)}),c&&bc(l)}(r.eventManager,t),i.length&&r.hu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function EC(e,t,n){const r=J(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let o=new St(G.comparator);o=o.insert(s,ne.newNoDocument(s,Q.min()));const u=rt().add(s),l=new Ca(Q.min(),new Map,new St(et),o,u);await N_(r,l),r.du=r.du.remove(s),r.Eu.delete(t),Sc(r)}else await El(r.localStore,t,!1).then(()=>Il(r,t,n)).catch(li)}async function TC(e,t){const n=J(e),r=t.batch.batchId;try{const i=await NS(n.localStore,t);k_(n,r,null),D_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await bs(n,i)}catch(i){await li(i)}}async function AC(e,t,n){const r=J(e);try{const i=await function(o,u){const l=J(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,u).next(d=>(ct(d!==null,37113),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(r.localStore,t);k_(r,t,n),D_(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await bs(r,i)}catch(i){await li(i)}}function D_(e,t){(e.Vu.get(t)||[]).forEach(n=>{n.resolve()}),e.Vu.delete(t)}function k_(e,t,n){const r=J(e);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function Il(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(r=>{e.Au.containsKey(r)||O_(e,r)})}function O_(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(vc(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),Sc(e))}function Wd(e,t,n){for(const r of n)r instanceof P_?(e.Au.addReference(r.key,t),IC(e,r)):r instanceof x_?(z(Rc,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||O_(e,r.key)):K(19791,{yu:r})}function IC(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(z(Rc,"New document in limbo: "+n),e.Iu.add(r),Sc(e))}function Sc(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new G(_t.fromString(t)),r=e.mu.next();e.Eu.set(r,new dC(n)),e.du=e.du.insert(n,r),w_(e.remoteStore,new kn(Xe(cc(n.path)),r,"TargetPurposeLimboResolution",Ea.ue))}}async function bs(e,t,n){const r=J(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,l)=>{o.push(r.gu(l,t,n).then(c=>{var h;if((c||n)&&r.isPrimaryClient){const d=c?!c.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){i.push(c);const d=_c.Es(l.targetId,c);s.push(d)}}))}),await Promise.all(o),r.hu.J_(i),await async function(l,c){const h=J(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>L.forEach(c,p=>L.forEach(p.Is,m=>h.persistence.referenceDelegate.addReference(d,p.targetId,m)).next(()=>L.forEach(p.ds,m=>h.persistence.referenceDelegate.removeReference(d,p.targetId,m)))))}catch(d){if(!ci(d))throw d;z(yc,"Failed to update sequence numbers: "+d)}for(const d of c){const p=d.targetId;if(!d.fromCache){const m=h.Fs.get(p),_=m.snapshotVersion,E=m.withLastLimboFreeSnapshotVersion(_);h.Fs=h.Fs.insert(p,E)}}}(r.localStore,s))}async function bC(e,t){const n=J(e);if(!n.currentUser.isEqual(t)){z(Rc,"User change. New user:",t.toKey());const r=await m_(n.localStore,t);n.currentUser=t,function(s,o){s.Vu.forEach(u=>{u.forEach(l=>{l.reject(new q(O.CANCELLED,o))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await bs(n,r.Bs)}}function RC(e,t){const n=J(e),r=n.Eu.get(t);if(r&&r.lu)return rt().add(r.key);{let i=rt();const s=n.Tu.get(t);if(!s)return i;for(const o of s){const u=n.Pu.get(o);i=i.unionWith(u.view.tu)}return i}}function M_(e){const t=J(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=N_.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=RC.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=EC.bind(null,t),t.hu.J_=lC.bind(null,t.eventManager),t.hu.pu=cC.bind(null,t.eventManager),t}function SC(e){const t=J(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=TC.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=AC.bind(null,t),t}class ra{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Pa(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,n){return null}Fu(t,n){return null}vu(t){return VS(this.persistence,new CS,t.initialUser,this.serializer)}Du(t){return new g_(mc.Vi,this.serializer)}bu(t){return new FS}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ra.provider={build:()=>new ra};class CC extends ra{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,n){ct(this.persistence.referenceDelegate instanceof ea,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new dS(r,t.asyncQueue,n)}Du(t){const n=this.cacheSizeBytes!==void 0?de.withCacheSize(this.cacheSizeBytes):de.DEFAULT;return new g_(r=>ea.Vi(r,n),this.serializer)}}class bl{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Gd(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bC.bind(null,this.syncEngine),await oC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new uC}()}createDatastore(t){const n=Pa(t.databaseInfo.databaseId),r=function(s){return new jS(s)}(t.databaseInfo);return function(s,o,u,l){return new WS(s,o,u,l)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,o,u){return new QS(r,i,s,o,u)}(this.localStore,this.datastore,t.asyncQueue,n=>Gd(this.syncEngine,n,0),function(){return Bd.C()?new Bd:new US}())}createSyncEngine(t,n){return function(i,s,o,u,l,c,h){const d=new pC(i,s,o,u,l,c);return h&&(d.fu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const s=J(i);z(_r,"RemoteStore shutting down."),s.Ia.add(5),await Is(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}bl.provider={build:()=>new bl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):Tn("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="FirestoreClient";class PC{constructor(t,n,r,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ee.UNAUTHENTICATED,this.clientId=ic.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{z(Wn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z(Wn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new _n;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=Ic(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function Iu(e,t){e.asyncQueue.verifyOperationInProgress(),z(Wn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await m_(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>{$n("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{z("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{$n("Terminating Firestore due to IndexedDb database deletion failed",i)})}),e._offlineComponents=t}async function Kd(e,t){e.asyncQueue.verifyOperationInProgress();const n=await xC(e);z(Wn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>qd(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>qd(t.remoteStore,i)),e._onlineComponents=t}async function xC(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){z(Wn,"Using user provided OfflineComponentProvider");try{await Iu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===O.FAILED_PRECONDITION||i.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;$n("Error using user provided cache. Falling back to memory cache: "+n),await Iu(e,new ra)}}else z(Wn,"Using default OfflineComponentProvider"),await Iu(e,new CC(void 0));return e._offlineComponents}async function F_(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(z(Wn,"Using user provided OnlineComponentProvider"),await Kd(e,e._uninitializedComponentsProvider._online)):(z(Wn,"Using default OnlineComponentProvider"),await Kd(e,new bl))),e._onlineComponents}function VC(e){return F_(e).then(t=>t.syncEngine)}async function U_(e){const t=await F_(e),n=t.eventManager;return n.onListen=gC.bind(null,t.syncEngine),n.onUnlisten=yC.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=mC.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=vC.bind(null,t.syncEngine),n}function NC(e,t,n={}){const r=new _n;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,l,c){const h=new L_({next:p=>{h.Ou(),o.enqueueAndForget(()=>S_(s,d));const m=p.docs.has(u);!m&&p.fromCache?c.reject(new q(O.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new q(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new C_(cc(u.path),h,{includeMetadataChanges:!0,ka:!0});return R_(s,d)}(await U_(e),e.asyncQueue,t,n,r)),r.promise}function DC(e,t,n={}){const r=new _n;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,l,c){const h=new L_({next:p=>{h.Ou(),o.enqueueAndForget(()=>S_(s,d)),p.fromCache&&l.source==="server"?c.reject(new q(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new C_(u,h,{includeMetadataChanges:!0,ka:!0});return R_(s,d)}(await U_(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_="firestore.googleapis.com",Xd=!0;class Jd{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new q(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$_,this.ssl=Xd}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Xd;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=p_;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<hS)throw new q(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Qb("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=B_((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Na{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new q(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jd(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Bb;switch(r.type){case"firstParty":return new zb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Qd.get(n);r&&(z("ComponentProvider","Removing Datastore"),Qd.delete(n),r.terminate())}(this),Promise.resolve()}}function kC(e,t,n,r={}){var i;e=An(e,Na);const s=ec(t),o=e._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;s&&(dI(`https://${l}`),_I("Firestore",!0)),o.host!==$_&&o.host!==l&&$n("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:r});if(!zo(c,u)&&(e._setSettings(c),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=ee.MOCK_USER;else{h=pI(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new q(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ee(p)}e._authCredentials=new $b(new Im(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Jn(this.firestore,t,this._query)}}class Dt{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Dt(this.firestore,t,this._key)}toJSON(){return{type:Dt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(Es(n,Dt._jsonSchema))return new Dt(t,r||null,new G(_t.fromString(n.referencePath)))}}Dt._jsonSchemaVersion="firestore/documentReference/1.0",Dt._jsonSchema={type:Mt("string",Dt._jsonSchemaVersion),referencePath:Mt("string")};class Fn extends Jn{constructor(t,n,r){super(t,n,cc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Dt(this.firestore,null,new G(t))}withConverter(t){return new Fn(this.firestore,t,this._path)}}function q_(e,t,...n){if(e=wn(e),Rm("collection","path",t),e instanceof Na){const r=_t.fromString(t,...n);return cd(r),new Fn(e,null,r)}{if(!(e instanceof Dt||e instanceof Fn))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_t.fromString(t,...n));return cd(r),new Fn(e.firestore,null,r)}}function OC(e,t,...n){if(e=wn(e),arguments.length===1&&(t=ic.newId()),Rm("doc","path",t),e instanceof Na){const r=_t.fromString(t,...n);return ld(r),new Dt(e,null,new G(r))}{if(!(e instanceof Dt||e instanceof Fn))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_t.fromString(t,...n));return ld(r),new Dt(e.firestore,e instanceof Fn?e.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="AsyncQueue";class Zd{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new y_(this,"async_queue_retry"),this.oc=()=>{const r=Au();r&&z(Yd,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=t;const n=Au();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const n=Au();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new _n;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!ci(t))throw t;z(Yd,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const n=this._c.then(()=>(this.nc=!0,t().catch(r=>{throw this.tc=r,this.nc=!1,Tn("INTERNAL UNHANDLED ERROR: ",tp(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(t,n,r){this.ac(),this.sc.indexOf(t)>-1&&(n=0);const i=Ac.createAndSchedule(this,t,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&K(47125,{hc:tp(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const n of this.ec)if(n.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const n=this.ec.indexOf(t);this.ec.splice(n,1)}}function tp(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class Rs extends Na{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new Zd,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Zd(t),this._firestoreClient=void 0,await t}}}function MC(e,t){const n=typeof e=="object"?e:Sb(),r=typeof e=="string"?e:Ko,i=Tb(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=hI("firestore");s&&kC(i,...s)}return i}function Cc(e){if(e._terminated)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||LC(e),e._firestoreClient}function LC(e){var t,n,r;const i=e._freezeSettings(),s=function(u,l,c,h){return new aR(u,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,B_(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new PC(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(u){const l=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ce(Xt.fromBase64String(t))}catch(n){throw new q(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Ce(Xt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Ce._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Es(t,Ce._jsonSchema))return Ce.fromBase64String(t.bytes)}}Ce._jsonSchemaVersion="firestore/bytes/1.0",Ce._jsonSchema={type:Mt("string",Ce._jsonSchemaVersion),bytes:Mt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new q(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new q(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new q(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return et(this._lat,t._lat)||et(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ze._jsonSchemaVersion}}static fromJSON(t){if(Es(t,Ze._jsonSchema))return new Ze(t.latitude,t.longitude)}}Ze._jsonSchemaVersion="firestore/geoPoint/1.0",Ze._jsonSchema={type:Mt("string",Ze._jsonSchemaVersion),latitude:Mt("number"),longitude:Mt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:tn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Es(t,tn._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new tn(t.vectorValues);throw new q(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}tn._jsonSchemaVersion="firestore/vectorValue/1.0",tn._jsonSchema={type:Mt("string",tn._jsonSchemaVersion),vectorValues:Mt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC=/^__.*__$/;class UC{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Xn(t,this.data,this.fieldMask,n,this.fieldTransforms):new Ts(t,this.data,n,this.fieldTransforms)}}class j_{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Xn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function z_(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K(40011,{Ec:e})}}class xc{constructor(t,n,r,i,s,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new xc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.fc(t),i}gc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return ia(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(z_(this.Ec)&&FC.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class BC{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Pa(t)}Dc(t,n,r,i=!1){return new xc({Ec:t,methodName:n,bc:r,path:Qt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vc(e){const t=e._freezeSettings(),n=Pa(e._databaseId);return new BC(e._databaseId,!!t.ignoreUndefinedProperties,n)}function $C(e,t,n,r,i,s={}){const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);Nc("Data must be an object, but it was:",o,r);const u=H_(r,o);let l,c;if(s.merge)l=new Te(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=Rl(t,d,n);if(!o.contains(p))throw new q(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);W_(h,p)||h.push(p)}l=new Te(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new UC(new pe(u),l,c)}class ka extends Pc{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ka}}function qC(e,t,n,r){const i=e.Dc(1,t,n);Nc("Data must be an object, but it was:",i,r);const s=[],o=pe.empty();Qn(r,(l,c)=>{const h=Dc(t,l,n);c=wn(c);const d=i.gc(h);if(c instanceof ka)s.push(h);else{const p=Ss(c,d);p!=null&&(s.push(h),o.set(h,p))}});const u=new Te(s);return new j_(o,u,i.fieldTransforms)}function jC(e,t,n,r,i,s){const o=e.Dc(1,t,n),u=[Rl(t,r,n)],l=[i];if(s.length%2!=0)throw new q(O.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)u.push(Rl(t,s[p])),l.push(s[p+1]);const c=[],h=pe.empty();for(let p=u.length-1;p>=0;--p)if(!W_(c,u[p])){const m=u[p];let _=l[p];_=wn(_);const E=o.gc(m);if(_ instanceof ka)c.push(m);else{const v=Ss(_,E);v!=null&&(c.push(m),h.set(m,v))}}const d=new Te(c);return new j_(h,d,o.fieldTransforms)}function zC(e,t,n,r=!1){return Ss(n,e.Dc(r?4:3,t))}function Ss(e,t){if(G_(e=wn(e)))return Nc("Unsupported field value:",t,e),H_(e,t);if(e instanceof Pc)return function(r,i){if(!z_(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let l=Ss(u,i.yc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=wn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return xR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=vt.fromDate(r);return{timestampValue:ta(i.serializer,s)}}if(r instanceof vt){const s=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ta(i.serializer,s)}}if(r instanceof Ze)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ce)return{bytesValue:a_(i.serializer,r._byteString)};if(r instanceof Dt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:pc(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof tn)return function(o,u){return{mapValue:{fields:{[Om]:{stringValue:Mm},[Qo]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw u.wc("VectorValues must only contain numeric values.");return hc(u.serializer,c)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${wa(r)}`)}(e,t)}function H_(e,t){const n={};return Pm(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Qn(e,(r,i)=>{const s=Ss(i,t.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function G_(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof vt||e instanceof Ze||e instanceof Ce||e instanceof Dt||e instanceof Pc||e instanceof tn)}function Nc(e,t,n){if(!G_(n)||!Sm(n)){const r=wa(n);throw r==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function Rl(e,t,n){if((t=wn(t))instanceof Da)return t._internalPath;if(typeof t=="string")return Dc(e,t);throw ia("Field path arguments must be of type string or ",e,!1,void 0,n)}const HC=new RegExp("[~\\*/\\[\\]]");function Dc(e,t,n){if(t.search(HC)>=0)throw ia(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Da(...t.split("."))._internalPath}catch{throw ia(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ia(e,t,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${t}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new q(O.INVALID_ARGUMENT,u+e+l)}function W_(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new GC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(kc("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class GC extends K_{data(){return super.data()}}function kc(e,t){return typeof t=="string"?Dc(e,t):t instanceof Da?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new q(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Oc{}class Mc extends Oc{}function KC(e,t,...n){let r=[];t instanceof Oc&&r.push(t),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Fc).length,u=s.filter(l=>l instanceof Lc).length;if(o>1||o>0&&u>0)throw new q(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class Lc extends Mc{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new Lc(t,n,r)}_apply(t){const n=this._parse(t);return Q_(t._query,n),new Jn(t.firestore,t.converter,ml(t._query,n))}_parse(t){const n=Vc(t.firestore);return function(s,o,u,l,c,h,d){let p;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){np(d,h);const _=[];for(const E of d)_.push(ep(l,s,E));p={arrayValue:{values:_}}}else p=ep(l,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||np(d,h),p=zC(u,o,d,h==="in"||h==="not-in");return Ot.create(c,h,p)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class Fc extends Oc{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new Fc(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Fe.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const l of u)Q_(o,l),o=ml(o,l)}(t._query,n),new Jn(t.firestore,t.converter,ml(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Uc extends Mc{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new Uc(t,n)}_apply(t){const n=function(i,s,o){if(i.startAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ds(s,o)}(t._query,this._field,this._direction);return new Jn(t.firestore,t.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new hi(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function QC(e,t="asc"){const n=t,r=kc("orderBy",e);return Uc._create(r,n)}class Bc extends Mc{constructor(t,n,r){super(),this.type=t,this._limit=n,this._limitType=r}static _create(t,n,r){return new Bc(t,n,r)}_apply(t){return new Jn(t.firestore,t.converter,Jo(t._query,this._limit,this._limitType))}}function XC(e){return Xb("limit",e),Bc._create("limit",e,"F")}function ep(e,t,n){if(typeof(n=wn(n))=="string"){if(n==="")throw new q(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zm(t)&&n.indexOf("/")!==-1)throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(_t.fromString(n));if(!G.isDocumentKey(r))throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yd(e,new G(r))}if(n instanceof Dt)return yd(e,n._key);throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wa(n)}.`)}function np(e,t){if(!Array.isArray(e)||e.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Q_(e,t){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class JC{convertValue(t,n="none"){switch(Hn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(zn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw K(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Qn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(t){var n,r,i;const s=(i=(r=(n=t.fields)===null||n===void 0?void 0:n[Qo].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>xt(o.doubleValue));return new tn(s)}convertGeoPoint(t){return new Ze(xt(t.latitude),xt(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=Aa(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(cs(t));default:return null}}convertTimestamp(t){const n=jn(t);return new vt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=_t.fromString(t);ct(d_(r),9688,{name:t});const i=new hs(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||Tn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class qi{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class hr extends K_{constructor(t,n,r,i,s,o){super(t,n,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new _o(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(kc("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=hr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}hr._jsonSchemaVersion="firestore/documentSnapshot/1.0",hr._jsonSchema={type:Mt("string",hr._jsonSchemaVersion),bundleSource:Mt("string","DocumentSnapshot"),bundleName:Mt("string"),bundle:Mt("string")};class _o extends hr{data(t={}){return super.data(t)}}class Hr{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new qi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new _o(this._firestore,this._userDataWriter,r.key,r,new qi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const l=new _o(i._firestore,i._userDataWriter,u.doc.key,u.doc,new qi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const l=new _o(i._firestore,i._userDataWriter,u.doc.key,u.doc,new qi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return u.type!==0&&(c=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),h=o.indexOf(u.doc.key)),{type:ZC(u.type),doc:l,oldIndex:c,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Hr._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=ic.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function ZC(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tP(e){e=An(e,Dt);const t=An(e.firestore,Rs);return NC(Cc(t),e._key).then(n=>rP(t,e,n))}Hr._jsonSchemaVersion="firestore/querySnapshot/1.0",Hr._jsonSchema={type:Mt("string",Hr._jsonSchemaVersion),bundleSource:Mt("string","QuerySnapshot"),bundleName:Mt("string"),bundle:Mt("string")};class X_ extends JC{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ce(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Dt(this.firestore,null,n)}}function J_(e){e=An(e,Jn);const t=An(e.firestore,Rs),n=Cc(t),r=new X_(t);return WC(e._query),DC(n,e._query).then(i=>new Hr(t,r,e,i))}function eP(e,t,n){e=An(e,Dt);const r=An(e.firestore,Rs),i=YC(e.converter,t);return Y_(r,[$C(Vc(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,Je.none())])}function nP(e,t,n,...r){e=An(e,Dt);const i=An(e.firestore,Rs),s=Vc(i);let o;return o=typeof(t=wn(t))=="string"||t instanceof Da?jC(s,"updateDoc",e._key,t,n,r):qC(s,"updateDoc",e._key,t),Y_(i,[o.toMutation(e._key,Je.exists(!0))])}function Y_(e,t){return function(r,i){const s=new _n;return r.asyncQueue.enqueueAndForget(async()=>wC(await VC(r),i,s)),s.promise}(Cc(e),t)}function rP(e,t,n){const r=n.docs.get(t._key),i=new X_(e);return new hr(e,i,t._key,r,new qi(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){ui=i})(Rb),Go(new as("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new Rs(new qb(r.getProvider("auth-internal")),new Hb(o,r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new q(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(c.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),jr(id,sd,t),jr(id,sd,"esm2017")})();const iP={apiKey:"AIzaSyAZsdXZU6WbM33SaKP5PoYm7G0V2ABYUSU",authDomain:"great-wave-everywhere.firebaseapp.com",projectId:"great-wave-everywhere",storageBucket:"great-wave-everywhere.firebasestorage.app",messagingSenderId:"636756607685",appId:"1:636756607685:web:2199075bc12821f89466ac",measurementId:"G-XRVYGKFWJ8"},sP=pm(iP),$c=MC(sP);async function oP(e){const t=OC($c,"words",e.toLowerCase()),n=await tP(t);n.exists()?await nP(t,{count:n.data().count+1}):await eP(t,{count:1})}async function rp(){return(await J_(q_($c,"words"))).docs.map(t=>({id:t.id,count:t.data().count}))}async function ip(e=5){const t=KC(q_($c,"words"),QC("count","desc"),XC(e));return(await J_(t)).docs.map(r=>({id:r.id,count:r.data().count}))}var aP=Kn('<div class="loading-indicator svelte-1bkcitg">Loading...</div>'),uP=Kn('<img alt="Header image"/>'),lP=(e,t)=>{e.key==="Enter"&&t()},cP=ms('<path fill="#ADC2CE" stroke="#377293" stroke-width="0.5"></path>'),hP=(e,t,n,r)=>{tt(t,U(n).domain,!0),tt(r,U(n).domain||"Unknown domain",!0)},fP=(e,t,n)=>{tt(t,null),tt(n,"")},dP=ms('<g class="location-pin svelte-1bkcitg"><circle class="pin svelte-1bkcitg" style="pointer-events: none;"></circle></g>'),pP=ms('<svg width="200" height="125" viewBox="0 0 200 125" class="world-map svelte-1bkcitg"><!><!></svg>'),gP=Kn('<span style="color: #377293; font-weight: bold; font-size: 0.95rem;"> </span>'),mP=(e,t,n,r,i,s)=>{const o=t(U(n).image.link);tt(r,o,!0);const u=U(i).find(l=>l.domain===o);tt(s,u?u.domain||"Unknown domain":o||"Unknown domain",!0)},_P=(e,t,n)=>{tt(t,null),tt(n,"")},yP=Kn('<div class="image-with-title svelte-1bkcitg"><a target="_blank" rel="noopener noreferrer"><img class="svelte-1bkcitg"/></a> <div class="image-title-box svelte-1bkcitg"> </div></div>'),vP=Kn('<div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;"><span style="color: #377293; font-weight: bold; font-size: 0.95rem;">Hover for image server locations:</span> <!></div> <div class="image-container grid-3x3 svelte-1bkcitg" style="width: 100%; max-width: 900px; margin: 0 auto;"></div>',1),wP=Kn(`<div class="no-images-placeholder svelte-1bkcitg"><p class="svelte-1bkcitg">Enter a search term above to query Google Images for "Great Wave off
            Kanagawa + [your search term]." Your search results will appear
            here.</p></div>`),EP=ms('<line stroke="#fff" stroke-opacity="0.6" stroke-width="2" class="svelte-1bkcitg"></line>'),TP=(e,t,n)=>t(U(n).id),AP=ms('<text text-anchor="middle" alignment-baseline="middle" filter="url(#dropshadow)" style="cursor: pointer;" class="svelte-1bkcitg"> </text>'),IP=(e,t,n)=>t(U(n).id),bP=Kn('<li style="cursor:pointer;" class="svelte-1bkcitg"> <span class="count svelte-1bkcitg"> </span></li>'),RP=Kn(`<main class="svelte-1bkcitg"><!>  <div class="header svelte-1bkcitg"><div class="header-image-crossfade svelte-1bkcitg"></div> <div><div class="title svelte-1bkcitg">GREAT WAVE <span style="color: #F0BF91;">REMIX</span></div> <p class="subtitle svelte-1bkcitg">Discover Hokusai's "Great Wave off Kanagawa" in unexpected contexts
        worldwide. Search Google Images for any term you associate with this
        iconic Japanese artwork to see how it has been reimagined in formats
        spanning diverse topics and cultures.</p></div></div> <div class="header-piping svelte-1bkcitg"></div> <h1 style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;" class="svelte-1bkcitg">HOKUSAI'S <em class="italic svelte-1bkcitg">GREAT WAVE</em> CAN BE <span style="display: flex; align-items: center; gap: 0.5rem;"><input type="text" placeholder="ANYTHING" style="margin-left: 0.5rem;" class="svelte-1bkcitg"/> <button class="svelte-1bkcitg">Search</button></span></h1> <div class="search-container search-container-below-h1 svelte-1bkcitg"><div class="call-to-action svelte-1bkcitg">No images yet â enter a search term above! <br/> (First search may take several
      seconds while the server wakes.)</div></div> <div class="main-grid svelte-1bkcitg"><div class="left-column svelte-1bkcitg"><div class="map-container svelte-1bkcitg"><!></div> <!> <!></div> <div class="right-column svelte-1bkcitg"><div class="word-cloud-container svelte-1bkcitg"><div class="call-to-action svelte-1bkcitg">Or click on a trending topic!</div> <svg width="120%" height="400" viewBox="0 0 480 400" class="svelte-1bkcitg"><defs><filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.3"></feDropShadow></filter></defs><g style="transform: translate(0, -100px)"><!><!></g></svg> <div class="trending-panel svelte-1bkcitg"><ul class="svelte-1bkcitg"></ul></div></div></div></div> <div style="text-align: left; color: #377293; padding-top: 5rem;"><h2 class="svelte-1bkcitg">Why remix the "Great Wave?"</h2> This project explores the impact of Hokusai's iconic artwork, allowing users
    to see for themselves how it continues to reverberate worldwide. Two centuries
    since its creation around 1831, scholars say Hokusaiâs print is possibly the
    most reproduced image in the history of art, with global recognition far beyond
    its original Japanese audience.</div> <div class="bottom-panel"><div class="chart-container svelte-1bkcitg"><div><p class="svelte-1bkcitg">The exponential-like rise in frequency of the phrase âGreat Wave off
          Kanagawaâ in millions of Google Books shows references to the artwork
          appearing more frequently over time, reflecting Japan's rise as a
          cultural superpower.</p> <p class="svelte-1bkcitg">The print helped spark Japonisme in the West (influencing Monet, van
          Gogh, and others), and that early cultural exchange laid the
          foundation for global fame. European artists and critics rediscovered
          Japanese woodblocks after Japan opened to trade in the 19th century,
          elevating Hokusaiâs work in Western art circles.</p> <p class="svelte-1bkcitg">"Great Wave" now appears everywhere â from high fashion and novelty
          goods to digital art, emojis, and even LEGO sets. It was chosen for
          the 2024 Japanese 1,000-yen note â a highly public national symbol.</p></div> <div><p class="chart-title svelte-1bkcitg">Mentions of "Great Wave off Kanagawa" over time</p> <img src="/ngram_chart_great_wave_off_kanagawa.png" alt="Google Ngram Viewer chart for 'Great Wave off Kanagawa'" class="ngram-chart svelte-1bkcitg"/> <p class="source svelte-1bkcitg">Source: Google Books Ngram Viewer, English corpus, 1900â2022</p></div></div></div></main>`);function SP(e,t){gp(t,!0);let n=Ft(0),r;const i=["/main-image.jpeg","/Hokusai-Great_Wave_off_Kanagawa-cat-end.jpg","/tomoko_nagao_hokusai-the_great_wave_of_kanagawa_with_mc_cupnoodle_kewpie_kikkoman_and_kitty_2012_digital_art_50_x_70_cm-_70_x_100_cm.jpe_3.jpg","/135e9cb8ff232a9c7e1f1be108eb670f.jpg","/2372ef58832305.5a0b25df284b7.jpg.webp","/image_BT0qjFvT31.png.jpeg"];Pu(()=>{r=setInterval(()=>{tt(n,(U(n)+1)%i.length)},5e3)}),Uv(()=>{clearInterval(r)});async function s(H){if(H){tt(m,!0);try{const j=await It.get(`https://great-wave-api-1muq.onrender.com/api/images/multilang?q=${encodeURIComponent(H)}`);tt(l,j.data.filter(ht=>ht.image&&ht.image.link),!0);const W=U(l).map(ht=>ht.image.link).filter(Boolean);let nt=[];if(W.length>0)try{nt=(await It.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:W})).data}catch{}tt(_,nt.filter(ht=>{if(ht==null)return!1;const Rt=Number(ht.lat),wt=Number(ht.lng);return!(isNaN(Rt)||isNaN(wt)||Rt===0&&wt===0)}),!0),tt(c,"")}catch(j){console.error("Error fetching images for word",j)}finally{tt(m,!1)}}}function o(H){if(!H)return null;try{const j=H.startsWith("http")?H:`https://${H}`;return new URL(j).hostname}catch{return H}}let u=Ft(null),l=Ft(ze([])),c=Ft(""),h=Ft(ze([])),d=Ft(ze([])),p=Ft(ze([])),m=Ft(!1),_=Ft(ze([])),E=Ft(null),v=Ft("");async function P(){try{const H=await fetch("/ne_110m_admin_0_countries.json");if(!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const j=await H.json(),W=Object.keys(j.objects)[0];tt(E,zf(j,j.objects[W]),!0)}catch{try{const j=await fetch("/ne_110m_admin_0_countries.json");if(j.ok){const W=await j.json(),nt=Object.keys(W.objects)[0];tt(E,zf(W,W.objects[nt]),!0)}}catch{}}}Pu(async()=>{tt(m,!0);try{try{tt(h,await rp(),!0),tt(p,await ip(5),!0),N(),x()}catch(H){console.warn("Firebase connection failed:",H),tt(h,[],!0),tt(p,[],!0)}await P()}finally{tt(m,!1)}});async function S(){if(U(c)){tt(m,!0);try{const H=await It.get(`https://great-wave-api-1muq.onrender.com/api/images/multilang?q=${encodeURIComponent(U(c))}`);tt(l,H.data.filter(nt=>nt.image&&nt.image.link),!0);const j=U(l).map(nt=>nt.image.link).filter(Boolean);let W=[];if(j.length>0)try{W=(await It.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:j})).data}catch{}tt(_,W.filter(nt=>{if(nt==null)return!1;const ht=Number(nt.lat),Rt=Number(nt.lng);return!(isNaN(ht)||isNaN(Rt)||ht===0&&Rt===0)}),!0);try{await oP(U(c)),tt(h,await rp(),!0),tt(p,await ip(5),!0),N(),x()}catch(nt){console.warn("Firebase update failed:",nt)}tt(c,"")}catch(H){console.error("Error fetching images",H)}finally{tt(m,!1)}}}function N(){tt(d,[],!0);for(let H=1;H<U(h).length;H++)U(d).push({source:U(h)[H-1].id,target:U(h)[H].id})}function x(){const H=Math.max(...U(h).map(j=>j.count));cA(U(h)).force("link",nA(U(d)).id(j=>j.id).distance(25)).force("charge",hA().strength(-100)).force("center",F1(200,300)).force("gravity",fA(j=>150*(1-j.count/H),200,300).strength(.5)).force("boundary",()=>{U(h).forEach(j=>{j.x=Math.max(20,Math.min(380,j.x||0)),j.y=Math.max(20,Math.min(580,j.y||0))})}).on("tick",()=>{tt(h,[...U(h)],!0)})}function M(H){return U(h).find(j=>j.id===H)}function B(H){const j=M(H.source),W=M(H.target);return{x1:(j==null?void 0:j.x)||0,y1:(j==null?void 0:j.y)||0,x2:(W==null?void 0:W.x)||0,y2:(W==null?void 0:W.y)||0}}var I=RP(),w=Pt(I);{var T=H=>{var j=aP();qt(H,j)};cn(w,H=>{U(m)&&H(T)})}var R=Gt(w,2),b=Pt(R);rr(b,21,()=>i,Nr,(H,j,W)=>{var nt=uP();let ht;ln(Rt=>{Wt(nt,"src",U(j)),ht=Dv(nt,1,"svelte-1bkcitg",null,ht,Rt)},[()=>({visible:U(n)===W,hidden:U(n)!==W})]),qt(H,nt)});var C=Gt(R,4),A=Gt(Pt(C),3),X=Pt(A);X.__keydown=[lP,S];var F=Gt(X,2);F.__click=S;var Y=Gt(C,4),lt=Pt(Y),mt=Pt(lt),Bt=Pt(mt);{var $e=H=>{var j=pP();const W=xn(()=>XA().scale(40).translate([100,62.5])),nt=xn(()=>FA().projection(U(W)));var ht=Pt(j);rr(ht,17,()=>U(E).features,Nr,(Et,Tt,ke)=>{var Jt=zs();const he=xn(()=>U(nt)(U(Tt)));var on=Si(Jt);{var At=ye=>{var Ie=cP();ln(()=>Wt(Ie,"d",U(he))),qt(ye,Ie)},Lt=ye=>{var Ie=Iv();ln(be=>xr(Ie,be),[()=>{var be;return console.log(`No path data for country ${ke}:`,(be=U(Tt).geometry)==null?void 0:be.type)}]),qt(ye,Ie)};cn(on,ye=>{U(he)?ye(At):ye(Lt,!1)})}qt(Et,Jt)});var Rt=Gt(ht);{var wt=Et=>{var Tt=zs(),ke=Si(Tt);rr(ke,17,()=>U(_),Nr,(Jt,he)=>{var on=zs();const At=xn(()=>U(W)([U(he).lng,U(he).lat]));var Lt=Si(on);{var ye=Ie=>{var be=dP();be.__mouseover=[hP,u,he,v],be.__mouseout=[fP,u,v];var br=Pt(be);ln(()=>{Wt(br,"cx",U(At)[0]),Wt(br,"cy",U(At)[1]),Wt(br,"r",U(u)===U(he).domain?7:4),Wt(br,"fill",U(u)===U(he).domain?"#ff4500":"#ff6b35")}),qt(Ie,be)};cn(Lt,Ie=>{U(At)&&Ie(ye)})}qt(Jt,on)}),qt(Et,Tt)};cn(Rt,Et=>{U(_).length>0&&Et(wt)})}qt(H,j)};cn(Bt,H=>{U(l).length>0&&U(E)&&H($e)})}var le=Gt(mt,2);{var $t=H=>{var j=vP(),W=Si(j),nt=Gt(Pt(W),2);{var ht=wt=>{var Et=gP(),Tt=Pt(Et);ln(()=>xr(Tt,U(v))),qt(wt,Et)};cn(nt,wt=>{U(v)&&wt(ht)})}var Rt=Gt(W,2);rr(Rt,23,()=>U(l).slice(0,8),(wt,Et)=>`${wt.image.link||"no-link"}-${Et}`,(wt,Et)=>{var Tt=yP(),ke=Pt(Tt),Jt=Pt(ke);Jt.__mouseover=[mP,o,Et,u,_,v],Jt.__mouseout=[_P,u,v];var he=Gt(ke,2),on=Pt(he);ln(()=>{Wt(ke,"href",U(Et).image.link),Wt(Jt,"src",U(Et).image.link),Wt(Jt,"alt",U(Et).image.title),xr(on,U(Et).image.title)}),Ev("error",Jt,At=>{At.target.src=""}),qt(wt,Tt)}),qt(H,j)};cn(le,H=>{U(l).length>0&&H($t)})}var ft=Gt(le,2);{var Rn=H=>{var j=wP();qt(H,j)};cn(ft,H=>{U(l).length===0&&H(Rn)})}var ce=Gt(lt,2),Oa=Pt(ce),Yn=Gt(Pt(Oa),2),Ma=Gt(Pt(Yn)),Cs=Pt(Ma);rr(Cs,17,()=>U(d),Nr,(H,j)=>{var W=zs(),nt=Si(W);{var ht=Rt=>{var wt=EP();ln((Et,Tt,ke,Jt)=>{Wt(wt,"x1",Et),Wt(wt,"y1",Tt),Wt(wt,"x2",ke),Wt(wt,"y2",Jt)},[()=>B(U(j)).x1,()=>B(U(j)).y1,()=>B(U(j)).x2,()=>B(U(j)).y2]),qt(Rt,wt)};cn(nt,Rt=>{M(U(j).source)&&M(U(j).target)&&Rt(ht)})}qt(H,W)});var Ar=Gt(Cs);rr(Ar,17,()=>U(h),Nr,(H,j)=>{var W=AP();const nt=xn(()=>Math.min(...U(h).map(Tt=>Tt.count))),ht=xn(()=>Math.max(...U(h).map(Tt=>Tt.count))),Rt=xn(()=>(U(j).count-U(nt))/Math.max(1,U(ht)-U(nt))),wt=xn(()=>U(Rt)<.7?_f("#ADC2CE","#377293")(U(Rt)/.7):_f("#377293","#ff6b35")((U(Rt)-.7)/.3));W.__click=[TP,s,j],W.__mouseover=Tt=>{Tt.target.style.fill="#ff6b35",Tt.target.style.cursor="pointer"},W.__mouseout=Tt=>{Tt.target.style.fill=U(wt)};var Et=Pt(W);ln(()=>{Wt(W,"x",U(j).x),Wt(W,"y",U(j).y),Wt(W,"font-size",`${8+U(j).count}px`),Wt(W,"fill",U(wt)),xr(Et,U(j).id)}),qt(H,W)});var Ir=Gt(Yn,2),di=Pt(Ir);rr(di,21,()=>U(p),Nr,(H,j)=>{var W=bP();W.__click=[IP,s,j];var nt=Pt(W),ht=Gt(nt),Rt=Pt(ht);ln(()=>{xr(nt,`${U(j).id??""} `),xr(Rt,`(${U(j).count??""})`)}),qt(H,W)}),Fv(X,()=>U(c),H=>tt(c,H)),qt(e,I),mp()}Tv(["keydown","click","mouseover","mouseout"]);bv(SP,{target:document.getElementById("app")});
