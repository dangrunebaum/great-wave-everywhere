var oy=Object.defineProperty;var ay=(e,t,n)=>t in e?oy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ha=(e,t,n)=>ay(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Rh=!1;var gl=Array.isArray,uy=Array.prototype.indexOf,ml=Array.from,ly=Object.defineProperty,Fi=Object.getOwnPropertyDescriptor,cy=Object.getOwnPropertyDescriptors,hy=Object.prototype,fy=Array.prototype,Xd=Object.getPrototypeOf,Sh=Object.isExtensible;function dy(e){for(var t=0;t<e.length;t++)e[t]()}const Ve=2,Yd=4,Jo=8,_l=16,In=32,Jr=64,yl=128,Re=256,ho=512,Ne=1024,_n=2048,vr=4096,gn=8192,vl=16384,Jd=32768,wl=65536,bh=1<<17,py=1<<18,Zd=1<<19,pu=1<<20,Ga=Symbol("$state"),gy=Symbol(""),tp=new class extends Error{constructor(){super(...arguments);Ha(this,"name","StaleReactionError");Ha(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function ep(e){return e===this.v}function my(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function np(e){return!my(e,this.v)}function _y(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function yy(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function vy(e){throw new Error("https://svelte.dev/e/effect_orphan")}function wy(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ey(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ty(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ay(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Iy=!1;const El=1,Tl=2,rp=4,Ry=8,Sy=16,ip=1,by=2,ce=Symbol(),Cy="http://www.w3.org/1999/xhtml";function sp(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let pe=null;function Ch(e){pe=e}function op(e,t=!1,n){var r=pe={p:pe,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};Ly(()=>{r.d=!0})}function ap(e){const t=pe;if(t!==null){const o=t.e;if(o!==null){var n=ft,r=at;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];Un(s.effect),rn(s.reaction),mp(s.fn)}}finally{Un(n),rn(r)}}pe=t.p,t.m=!0}return{}}function up(){return!0}function We(e){if(typeof e!="object"||e===null||Ga in e)return e;const t=Xd(e);if(t!==hy&&t!==fy)return e;var n=new Map,r=gl(e),i=Ot(0),s=at,o=u=>{var c=at;rn(s);var l=u();return rn(c),l};return r&&n.set("length",Ot(e.length)),new Proxy(e,{defineProperty(u,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&Ey();var h=n.get(c);return h===void 0?h=o(()=>{var d=Ot(l.value);return n.set(c,d),d}):nt(h,l.value,!0),!0},deleteProperty(u,c){var l=n.get(c);if(l===void 0){if(c in u){const p=o(()=>Ot(ce));n.set(c,p),Wa(i)}}else{if(r&&typeof c=="string"){var h=n.get("length"),d=Number(c);Number.isInteger(d)&&d<h.v&&nt(h,d)}nt(l,ce),Wa(i)}return!0},get(u,c,l){var m;if(c===Ga)return e;var h=n.get(c),d=c in u;if(h===void 0&&(!d||(m=Fi(u,c))!=null&&m.writable)&&(h=o(()=>{var _=We(d?u[c]:ce),E=Ot(_);return E}),n.set(c,h)),h!==void 0){var p=B(h);return p===ce?void 0:p}return Reflect.get(u,c,l)},getOwnPropertyDescriptor(u,c){var l=Reflect.getOwnPropertyDescriptor(u,c);if(l&&"value"in l){var h=n.get(c);h&&(l.value=B(h))}else if(l===void 0){var d=n.get(c),p=d==null?void 0:d.v;if(d!==void 0&&p!==ce)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return l},has(u,c){var p;if(c===Ga)return!0;var l=n.get(c),h=l!==void 0&&l.v!==ce||Reflect.has(u,c);if(l!==void 0||ft!==null&&(!h||(p=Fi(u,c))!=null&&p.writable)){l===void 0&&(l=o(()=>{var m=h?We(u[c]):ce,_=Ot(m);return _}),n.set(c,l));var d=B(l);if(d===ce)return!1}return h},set(u,c,l,h){var N;var d=n.get(c),p=c in u;if(r&&c==="length")for(var m=l;m<d.v;m+=1){var _=n.get(m+"");_!==void 0?nt(_,ce):m in u&&(_=o(()=>Ot(ce)),n.set(m+"",_))}if(d===void 0)(!p||(N=Fi(u,c))!=null&&N.writable)&&(d=o(()=>Ot(void 0)),nt(d,We(l)),n.set(c,d));else{p=d.v!==ce;var E=o(()=>We(l));nt(d,E)}var v=Reflect.getOwnPropertyDescriptor(u,c);if(v!=null&&v.set&&v.set.call(h,l),!p){if(r&&typeof c=="string"){var P=n.get("length"),b=Number(c);Number.isInteger(b)&&b>=P.v&&nt(P,b+1)}Wa(i)}return!0},ownKeys(u){B(i);var c=Reflect.ownKeys(u).filter(d=>{var p=n.get(d);return p===void 0||p.v!==ce});for(var[l,h]of n)h.v!==ce&&!(l in u)&&c.push(l);return c},setPrototypeOf(){Ty()}})}function Wa(e,t=1){nt(e,e.v+t)}function Al(e){var t=Ve|_n,n=at!==null&&(at.f&Ve)!==0?at:null;return ft===null||n!==null&&(n.f&Re)!==0?t|=Re:ft.f|=Zd,{ctx:pe,deps:null,effects:null,equals:ep,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??ft,ac:null}}function Ls(e){const t=Al(e);return Ip(t),t}function Py(e){const t=Al(e);return t.equals=np,t}function lp(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Fn(t[n])}}function xy(e){for(var t=e.parent;t!==null;){if((t.f&Ve)===0)return t;t=t.parent}return null}function cp(e){var t,n=ft;Un(xy(e));try{lp(e),t=Cp(e)}finally{Un(n)}return t}function hp(e){var t=cp(e);if(e.equals(t)||(e.v=t,e.wv=Sp()),!ti){var n=(Nn||(e.f&Re)!==0)&&e.deps!==null?vr:Ne;sn(e,n)}}const zi=new Map;function fo(e,t){var n={f:0,v:e,reactions:null,equals:ep,rv:0,wv:0};return n}function Ot(e,t){const n=fo(e);return Ip(n),n}function Vy(e,t=!1,n=!0){const r=fo(e);return t||(r.equals=np),r}function nt(e,t,n=!1){at!==null&&(!Ke||(at.f&bh)!==0)&&up()&&(at.f&(Ve|_l|bh))!==0&&!(Bt!=null&&Bt[1].includes(e)&&Bt[0]===at)&&Ay();let r=n?We(t):t;return gu(e,r)}function gu(e,t){if(!e.equals(t)){var n=e.v;ti?zi.set(e,t):zi.set(e,n),e.v=t,(e.f&Ve)!==0&&((e.f&_n)!==0&&cp(e),sn(e,(e.f&Re)===0?Ne:vr)),e.wv=Sp(),fp(e,_n),ft!==null&&(ft.f&Ne)!==0&&(ft.f&(In|Jr))===0&&(Se===null?Hy([e]):Se.push(e))}return t}function fp(e,t){var n=e.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i],o=s.f;(o&_n)===0&&(sn(s,t),(o&(Ne|Re))!==0&&((o&Ve)!==0?fp(s,vr):bl(s)))}}let Ny=!1;var Ph,dp,pp,gp;function Dy(){if(Ph===void 0){Ph=window,dp=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;pp=Fi(t,"firstChild").get,gp=Fi(t,"nextSibling").get,Sh(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Sh(n)&&(n.__t=void 0)}}function Zo(e=""){return document.createTextNode(e)}function Ae(e){return pp.call(e)}function ta(e){return gp.call(e)}function Et(e,t){return Ae(e)}function Ai(e,t){{var n=Ae(e);return n instanceof Comment&&n.data===""?ta(n):n}}function qt(e,t=1,n=!1){let r=e;for(;t--;)r=ta(r);return r}function ky(e){e.textContent=""}function Oy(e){ft===null&&at===null&&vy(),at!==null&&(at.f&Re)!==0&&ft===null&&yy(),ti&&_y()}function My(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Zr(e,t,n,r=!0){var i=ft,s={ctx:pe,deps:null,nodes_start:null,nodes_end:null,f:e|_n,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Sl(s),s.f|=Jd}catch(c){throw Fn(s),c}else t!==null&&bl(s);var o=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(Zd|yl))===0;if(!o&&r&&(i!==null&&My(s,i),at!==null&&(at.f&Ve)!==0)){var u=at;(u.effects??(u.effects=[])).push(s)}return s}function Ly(e){const t=Zr(Jo,null,!1);return sn(t,Ne),t.teardown=e,t}function Fy(e){Oy();var t=ft!==null&&(ft.f&In)!==0&&pe!==null&&!pe.m;if(t){var n=pe;(n.e??(n.e=[])).push({fn:e,effect:ft,reaction:at})}else{var r=mp(e);return r}}function Uy(e){const t=Zr(Jr,e,!0);return(n={})=>new Promise(r=>{n.outro?po(t,()=>{Fn(t),r(void 0)}):(Fn(t),r(void 0))})}function mp(e){return Zr(Yd,e,!1)}function By(e){return Zr(Jo,e,!0)}function Me(e,t=[],n=Al){const r=t.map(n);return Il(()=>e(...r.map(B)))}function Il(e,t=0){var n=Zr(Jo|_l|t,e,!0);return n}function Hi(e,t=!0){return Zr(Jo|In,e,!0,t)}function _p(e){var t=e.teardown;if(t!==null){const n=ti,r=at;xh(!0),rn(null);try{t.call(null)}finally{xh(n),rn(r)}}}function yp(e,t=!1){var i;var n=e.first;for(e.first=e.last=null;n!==null;){(i=n.ac)==null||i.abort(tp);var r=n.next;(n.f&Jr)!==0?n.parent=null:Fn(n,t),n=r}}function $y(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&In)===0&&Fn(t),t=n}}function Fn(e,t=!0){var n=!1;(t||(e.f&py)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(vp(e.nodes_start,e.nodes_end),n=!0),yp(e,t&&!n),vo(e,0),sn(e,vl);var r=e.transitions;if(r!==null)for(const s of r)s.stop();_p(e);var i=e.parent;i!==null&&i.first!==null&&wp(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function vp(e,t){for(;e!==null;){var n=e===t?null:ta(e);e.remove(),e=n}}function wp(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function po(e,t){var n=[];Rl(e,n,!0),Ep(n,()=>{Fn(e),t&&t()})}function Ep(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Rl(e,t,n){if((e.f&gn)===0){if(e.f^=gn,e.transitions!==null)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&wl)!==0||(r.f&In)!==0;Rl(r,t,s?n:!1),r=i}}}function go(e){Tp(e,!0)}function Tp(e,t){if((e.f&gn)!==0){e.f^=gn;for(var n=e.first;n!==null;){var r=n.next,i=(n.f&wl)!==0||(n.f&In)!==0;Tp(n,i?t:!1),n=r}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let mo=[];function qy(){var e=mo;mo=[],dy(e)}function jy(e){mo.length===0&&queueMicrotask(qy),mo.push(e)}function zy(e){var t=ft;if((t.f&Jd)===0){if((t.f&yl)===0)throw e;t.fn(e)}else Ap(e,t)}function Ap(e,t){for(;t!==null;){if((t.f&yl)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let mu=!1,_o=null,ur=!1,ti=!1;function xh(e){ti=e}let Ys=[];let at=null,Ke=!1;function rn(e){at=e}let ft=null;function Un(e){ft=e}let Bt=null;function Ip(e){at!==null&&at.f&pu&&(Bt===null?Bt=[at,[e]]:Bt[1].push(e))}let oe=null,Ee=0,Se=null;function Hy(e){Se=e}let Rp=1,yo=0,Nn=!1;function Sp(){return++Rp}function ea(e){var d;var t=e.f;if((t&_n)!==0)return!0;if((t&vr)!==0){var n=e.deps,r=(t&Re)!==0;if(n!==null){var i,s,o=(t&ho)!==0,u=r&&ft!==null&&!Nn,c=n.length;if(o||u){var l=e,h=l.parent;for(i=0;i<c;i++)s=n[i],(o||!((d=s==null?void 0:s.reactions)!=null&&d.includes(l)))&&(s.reactions??(s.reactions=[])).push(l);o&&(l.f^=ho),u&&h!==null&&(h.f&Re)===0&&(l.f^=Re)}for(i=0;i<c;i++)if(s=n[i],ea(s)&&hp(s),s.wv>e.wv)return!0}(!r||ft!==null&&!Nn)&&sn(e,Ne)}return!1}function bp(e,t,n=!0){var r=e.reactions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];Bt!=null&&Bt[1].includes(e)&&Bt[0]===at||((s.f&Ve)!==0?bp(s,t,!1):t===s&&(n?sn(s,_n):(s.f&Ne)!==0&&sn(s,vr),bl(s)))}}function Cp(e){var m;var t=oe,n=Ee,r=Se,i=at,s=Nn,o=Bt,u=pe,c=Ke,l=e.f;oe=null,Ee=0,Se=null,Nn=(l&Re)!==0&&(Ke||!ur||at===null),at=(l&(In|Jr))===0?e:null,Bt=null,Ch(e.ctx),Ke=!1,yo++,e.f|=pu,e.ac!==null&&(e.ac.abort(tp),e.ac=null);try{var h=(0,e.fn)(),d=e.deps;if(oe!==null){var p;if(vo(e,Ee),d!==null&&Ee>0)for(d.length=Ee+oe.length,p=0;p<oe.length;p++)d[Ee+p]=oe[p];else e.deps=d=oe;if(!Nn||(l&Ve)!==0&&e.reactions!==null)for(p=Ee;p<d.length;p++)((m=d[p]).reactions??(m.reactions=[])).push(e)}else d!==null&&Ee<d.length&&(vo(e,Ee),d.length=Ee);if(up()&&Se!==null&&!Ke&&d!==null&&(e.f&(Ve|vr|_n))===0)for(p=0;p<Se.length;p++)bp(Se[p],e);return i!==null&&i!==e&&(yo++,Se!==null&&(r===null?r=Se:r.push(...Se))),h}catch(_){zy(_)}finally{oe=t,Ee=n,Se=r,at=i,Nn=s,Bt=o,Ch(u),Ke=c,e.f^=pu}}function Gy(e,t){let n=t.reactions;if(n!==null){var r=uy.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&Ve)!==0&&(oe===null||!oe.includes(t))&&(sn(t,vr),(t.f&(Re|ho))===0&&(t.f^=ho),lp(t),vo(t,0))}function vo(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Gy(e,n[r])}function Sl(e){var t=e.f;if((t&vl)===0){sn(e,Ne);var n=ft,r=ur;ft=e,ur=!0;try{(t&_l)!==0?$y(e):yp(e),_p(e);var i=Cp(e);e.teardown=typeof i=="function"?i:null,e.wv=Rp;var s;Rh&&Iy&&(e.f&_n)!==0&&e.deps}finally{ur=r,ft=n}}}function Wy(){try{wy()}catch(e){if(_o!==null)Ap(e,_o);else throw e}}function Ky(){var e=ur;try{var t=0;for(ur=!0;Ys.length>0;){t++>1e3&&Wy();var n=Ys,r=n.length;Ys=[];for(var i=0;i<r;i++){var s=Xy(n[i]);Qy(s)}zi.clear()}}finally{mu=!1,ur=e,_o=null}}function Qy(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(vl|gn))===0&&ea(r)&&(Sl(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?wp(r):r.fn=null))}}function bl(e){mu||(mu=!0,queueMicrotask(Ky));for(var t=_o=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(Jr|In))!==0){if((n&Ne)===0)return;t.f^=Ne}}Ys.push(t)}function Xy(e){for(var t=[],n=e;n!==null;){var r=n.f,i=(r&(In|Jr))!==0,s=i&&(r&Ne)!==0;if(!s&&(r&gn)===0){(r&Yd)!==0?t.push(n):i?n.f^=Ne:ea(n)&&Sl(n);var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return t}function B(e){var t=e.f,n=(t&Ve)!==0;if(at!==null&&!Ke){if(!(Bt!=null&&Bt[1].includes(e))||Bt[0]!==at){var r=at.deps;e.rv<yo&&(e.rv=yo,oe===null&&r!==null&&r[Ee]===e?Ee++:oe===null?oe=[e]:(!Nn||!oe.includes(e))&&oe.push(e))}}else if(n&&e.deps===null&&e.effects===null){var i=e,s=i.parent;s!==null&&(s.f&Re)===0&&(i.f^=Re)}return n&&(i=e,ea(i)&&hp(i)),ti&&zi.has(e)?zi.get(e):e.v}function Cl(e){var t=Ke;try{return Ke=!0,e()}finally{Ke=t}}const Yy=-7169;function sn(e,t){e.f=e.f&Yy|t}const Jy=["touchstart","touchmove"];function Zy(e){return Jy.includes(e)}let Vh=!1;function tv(){Vh||(Vh=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function ev(e){var t=at,n=ft;rn(null),Un(null);try{return e()}finally{rn(t),Un(n)}}function nv(e,t,n,r=n){e.addEventListener(t,()=>ev(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),tv()}const Pp=new Set,_u=new Set;function rv(e){for(var t=0;t<e.length;t++)Pp.add(e[t]);for(var n of _u)n(e)}function Fs(e){var b;var t=this,n=t.ownerDocument,r=e.type,i=((b=e.composedPath)==null?void 0:b.call(e))||[],s=i[0]||e.target,o=0,u=e.__root;if(u){var c=i.indexOf(u);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var l=i.indexOf(t);if(l===-1)return;c<=l&&(o=c)}if(s=i[o]||e.target,s!==t){ly(e,"currentTarget",{configurable:!0,get(){return s||n}});var h=at,d=ft;rn(null),Un(null);try{for(var p,m=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+r];if(E!=null&&(!s.disabled||e.target===s))if(gl(E)){var[v,...P]=E;v.apply(s,[e,...P])}else E.call(s,e)}catch(N){p?m.push(N):p=N}if(e.cancelBubble||_===t||_===null)break;s=_}if(p){for(let N of m)queueMicrotask(()=>{throw N});throw p}}finally{e.__root=t,delete e.currentTarget,rn(h),Un(d)}}}function Pl(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function fr(e,t){var n=ft;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function Wn(e,t){var n=(t&ip)!==0,r=(t&by)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=Pl(s?e:"<!>"+e),n||(i=Ae(i)));var o=r||dp?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=Ae(o),c=o.lastChild;fr(u,c)}else fr(o,o);return o}}function iv(e,t,n="svg"){var r=!e.startsWith("<!>"),i=(t&ip)!==0,s=`<${n}>${r?e:"<!>"+e}</${n}>`,o;return()=>{if(!o){var u=Pl(s),c=Ae(u);if(i)for(o=document.createDocumentFragment();Ae(c);)o.appendChild(Ae(c));else o=Ae(c)}var l=o.cloneNode(!0);if(i){var h=Ae(l),d=l.lastChild;fr(h,d)}else fr(l,l);return l}}function ei(e,t){return iv(e,t,"svg")}function sv(e=""){{var t=Zo(e+"");return fr(t,t),t}}function Ka(){var e=document.createDocumentFragment(),t=document.createComment(""),n=Zo();return e.append(t,n),fr(t,n),e}function Ft(e,t){e!==null&&e.before(t)}function xr(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function ov(e,t){return av(e,t)}const Vr=new Map;function av(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:o=!0}){Dy();var u=new Set,c=d=>{for(var p=0;p<d.length;p++){var m=d[p];if(!u.has(m)){u.add(m);var _=Zy(m);t.addEventListener(m,Fs,{passive:_});var E=Vr.get(m);E===void 0?(document.addEventListener(m,Fs,{passive:_}),Vr.set(m,1)):Vr.set(m,E+1)}}};c(ml(Pp)),_u.add(c);var l=void 0,h=Uy(()=>{var d=n??t.appendChild(Zo());return Hi(()=>{if(s){op({});var p=pe;p.c=s}i&&(r.$$events=i),l=e(d,r)||{},s&&ap()}),()=>{var _;for(var p of u){t.removeEventListener(p,Fs);var m=Vr.get(p);--m===0?(document.removeEventListener(p,Fs),Vr.delete(p)):Vr.set(p,m)}_u.delete(c),d!==n&&((_=d.parentNode)==null||_.removeChild(d))}});return uv.set(l,h),l}let uv=new WeakMap;function Pn(e,t,[n,r]=[0,0]){var i=e,s=null,o=null,u=ce,c=n>0?wl:0,l=!1;const h=(p,m=!0)=>{l=!0,d(m,p)},d=(p,m)=>{u!==(u=p)&&(u?(s?go(s):m&&(s=Hi(()=>m(i))),o&&po(o,()=>{o=null})):(o?go(o):m&&(o=Hi(()=>m(i,[n+1,r]))),s&&po(s,()=>{s=null})))};Il(()=>{l=!1,t(h),l||d(null,null)},c)}function nr(e,t){return t}function lv(e,t,n,r){for(var i=[],s=t.length,o=0;o<s;o++)Rl(t[o].e,i,!0);var u=s>0&&i.length===0&&n!==null;if(u){var c=n.parentNode;ky(c),c.append(n),r.clear(),xn(e,t[0].prev,t[s-1].next)}Ep(i,()=>{for(var l=0;l<s;l++){var h=t[l];u||(r.delete(h.k),xn(e,h.prev,h.next)),Fn(h.e,!u)}})}function rr(e,t,n,r,i,s=null){var o=e,u={flags:t,items:new Map,first:null},c=(t&rp)!==0;if(c){var l=e;o=l.appendChild(Zo())}var h=null,d=!1,p=Py(()=>{var m=n();return gl(m)?m:m==null?[]:ml(m)});Il(()=>{var m=B(p),_=m.length;d&&_===0||(d=_===0,cv(m,u,o,i,t,r,n),s!==null&&(_===0?h?go(h):h=Hi(()=>s(o)):h!==null&&po(h,()=>{h=null})),B(p))})}function cv(e,t,n,r,i,s,o){var Y,F,J,lt;var u=(i&Ry)!==0,c=(i&(El|Tl))!==0,l=e.length,h=t.items,d=t.first,p=d,m,_=null,E,v=[],P=[],b,N,x,M;if(u)for(M=0;M<l;M+=1)b=e[M],N=s(b,M),x=h.get(N),x!==void 0&&((Y=x.a)==null||Y.measure(),(E??(E=new Set)).add(x));for(M=0;M<l;M+=1){if(b=e[M],N=s(b,M),x=h.get(N),x===void 0){var U=p?p.e.nodes_start:n;_=fv(U,t,_,_===null?t.first:_.next,b,N,M,r,i,o),h.set(N,_),v=[],P=[],p=_.next;continue}if(c&&hv(x,b,M,i),(x.e.f&gn)!==0&&(go(x.e),u&&((F=x.a)==null||F.unfix(),(E??(E=new Set)).delete(x))),x!==p){if(m!==void 0&&m.has(x)){if(v.length<P.length){var I=P[0],w;_=I.prev;var T=v[0],S=v[v.length-1];for(w=0;w<v.length;w+=1)Nh(v[w],I,n);for(w=0;w<P.length;w+=1)m.delete(P[w]);xn(t,T.prev,S.next),xn(t,_,T),xn(t,S,I),p=I,_=S,M-=1,v=[],P=[]}else m.delete(x),Nh(x,p,n),xn(t,x.prev,x.next),xn(t,x,_===null?t.first:_.next),xn(t,_,x),_=x;continue}for(v=[],P=[];p!==null&&p.k!==N;)(p.e.f&gn)===0&&(m??(m=new Set)).add(p),P.push(p),p=p.next;if(p===null)continue;x=p}v.push(x),_=x,p=x.next}if(p!==null||m!==void 0){for(var R=m===void 0?[]:ml(m);p!==null;)(p.e.f&gn)===0&&R.push(p),p=p.next;var C=R.length;if(C>0){var A=(i&rp)!==0&&l===0?n:null;if(u){for(M=0;M<C;M+=1)(J=R[M].a)==null||J.measure();for(M=0;M<C;M+=1)(lt=R[M].a)==null||lt.fix()}lv(t,R,A,h)}}u&&jy(()=>{var gt;if(E!==void 0)for(x of E)(gt=x.a)==null||gt.apply()}),ft.first=t.first&&t.first.e,ft.last=_&&_.e}function hv(e,t,n,r){(r&El)!==0&&gu(e.v,t),(r&Tl)!==0?gu(e.i,n):e.i=n}function fv(e,t,n,r,i,s,o,u,c,l){var h=(c&El)!==0,d=(c&Sy)===0,p=h?d?Vy(i,!1,!1):fo(i):i,m=(c&Tl)===0?o:fo(o),_={i:m,v:p,k:s,a:null,e:null,prev:n,next:r};try{return _.e=Hi(()=>u(e,p,m,l),Ny),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function Nh(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var o=ta(s);i.before(s),s=o}}function xn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function dv(e,t,n=!1,r=!1,i=!1){var s=e,o="";Me(()=>{var u=ft;if(o!==(o=t()??"")&&(u.nodes_start!==null&&(vp(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),o!=="")){var c=o+"";n?c=`<svg>${c}</svg>`:r&&(c=`<math>${c}</math>`);var l=Pl(c);if((n||r)&&(l=Ae(l)),fr(Ae(l),l.lastChild),n||r)for(;Ae(l);)s.before(Ae(l));else s.before(l)}})}const Dh=[...` 	
\r\fÂ \v\uFEFF`];function pv(e,t,n){var r=""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,o=0;(o=r.indexOf(i,o))>=0;){var u=o+s;(o===0||Dh.includes(r[o-1]))&&(u===r.length||Dh.includes(r[u]))?r=(o===0?"":r.substring(0,o))+r.substring(u+1):o=u}}return r===""?null:r}function gv(e,t){return e==null?null:String(e)}function mv(e,t,n,r,i,s){var o=e.__className;if(o!==n||o===void 0){var u=pv(n,r,s);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(s&&i!==s)for(var c in s){var l=!!s[c];(i==null||l!==!!i[c])&&e.classList.toggle(c,l)}return s}function kh(e,t,n,r){var i=e.__style;if(i!==t){var s=gv(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return r}const _v=Symbol("is custom element"),yv=Symbol("is html");function se(e,t,n,r){var i=vv(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[gy]=n),n==null?e.removeAttribute(t):typeof n!="string"&&wv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function vv(e){return e.__attributes??(e.__attributes={[_v]:e.nodeName.includes("-"),[yv]:e.namespaceURI===Cy})}var Oh=new Map;function wv(e){var t=Oh.get(e.nodeName);if(t)return t;Oh.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=cy(r);for(var s in n)n[s].set&&t.push(s);r=Xd(r)}return t}function Ev(e,t,n=t){nv(e,"input",r=>{var i=r?e.defaultValue:e.value;if(i=Qa(e)?Xa(i):i,n(i),i!==(i=t())){var s=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(o,e.value.length))}}),Cl(t)==null&&e.value&&n(Qa(e)?Xa(e.value):e.value),By(()=>{var r=t();Qa(e)&&r===Xa(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Qa(e){var t=e.type;return t==="number"||t==="range"}function Xa(e){return e===""?null:+e}function yu(e){pe===null&&sp(),Fy(()=>{const t=Cl(e);if(typeof t=="function")return t})}function Tv(e){pe===null&&sp(),yu(()=>()=>Cl(e))}const Av="5";var Qd;typeof window<"u"&&((Qd=window.__svelte??(window.__svelte={})).v??(Qd.v=new Set)).add(Av);const Iv=()=>{};var Mh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},Rv=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],o=e[n++],u=e[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},Vp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,u=o?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,h=s>>2,d=(s&3)<<4|u>>4;let p=(u&15)<<2|l>>6,m=l&63;c||(m=64,o||(p=64)),r.push(n[h],n[d],n[p],n[m])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(xp(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Rv(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],u=i<e.length?n[e.charAt(i)]:0;++i;const l=i<e.length?n[e.charAt(i)]:64;++i;const d=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||u==null||l==null||d==null)throw new Sv;const p=s<<2|u>>4;if(r.push(p),l!==64){const m=u<<4&240|l>>2;if(r.push(m),d!==64){const _=l<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Sv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bv=function(e){const t=xp(e);return Vp.encodeByteArray(t,!0)},wo=function(e){return bv(e).replace(/\./g,"")},Cv=function(e){try{return Vp.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv=()=>Pv().__FIREBASE_DEFAULTS__,Vv=()=>{if(typeof process>"u"||typeof Mh>"u")return;const e=Mh.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Nv=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Cv(e[1]);return t&&JSON.parse(t)},xl=()=>{try{return Iv()||xv()||Vv()||Nv()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Dv=e=>{var t,n;return(n=(t=xl())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},kv=e=>{const t=Dv(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Np=()=>{var e;return(e=xl())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Mv(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[wo(JSON.stringify(n)),wo(JSON.stringify(o)),""].join(".")}const Ui={};function Fv(){const e={prod:[],emulator:[]};for(const t of Object.keys(Ui))Ui[t]?e.emulator.push(t):e.prod.push(t);return e}function Uv(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let Lh=!1;function Bv(e,t){if(typeof window>"u"||typeof document>"u"||!Vl(window.location.host)||Ui[e]===t||Ui[e]||Lh)return;Ui[e]=t;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=Fv().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function u(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function l(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Lh=!0,o()},p}function h(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=Uv(r),m=n("text"),_=document.getElementById(m)||document.createElement("span"),E=n("learnmore"),v=document.getElementById(E)||document.createElement("a"),P=n("preprendIcon"),b=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;u(N),h(v,E);const x=l();c(b,P),N.append(b,_,v,x),document.body.appendChild(N)}s?(_.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qv(){var e;const t=(e=xl())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jv(){return!qv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zv(){try{return typeof indexedDB=="object"}catch{return!1}}function Hv(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="FirebaseError";class ni extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Gv,Object.setPrototypeOf(this,ni.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dp.prototype.create)}}class Dp{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?Wv(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new ni(i,u,r)}}function Wv(e,t){return e.replace(Kv,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const Kv=/\{\$([^}]+)}/g;function Eo(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],o=t[i];if(Fh(s)&&Fh(o)){if(!Eo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Fh(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(e){return e&&e._delegate?e._delegate:e}class Gi{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new Ov;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Yv(t))try{this.getOrInitializeService({instanceIdentifier:ir})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=ir){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ir){return this.instances.has(t)}getOptions(t=ir){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Xv(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=ir){return this.component?this.component.multipleInstances?t:ir:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Xv(e){return e===ir?void 0:e}function Yv(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Qv(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(it||(it={}));const Zv={debug:it.DEBUG,verbose:it.VERBOSE,info:it.INFO,warn:it.WARN,error:it.ERROR,silent:it.SILENT},t0=it.INFO,e0={[it.DEBUG]:"log",[it.VERBOSE]:"log",[it.INFO]:"info",[it.WARN]:"warn",[it.ERROR]:"error"},n0=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=e0[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class kp{constructor(t){this.name=t,this._logLevel=t0,this._logHandler=n0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in it))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Zv[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,it.DEBUG,...t),this._logHandler(this,it.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,it.VERBOSE,...t),this._logHandler(this,it.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,it.INFO,...t),this._logHandler(this,it.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,it.WARN,...t),this._logHandler(this,it.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,it.ERROR,...t),this._logHandler(this,it.ERROR,...t)}}const r0=(e,t)=>t.some(n=>e instanceof n);let Uh,Bh;function i0(){return Uh||(Uh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s0(){return Bh||(Bh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Op=new WeakMap,vu=new WeakMap,Mp=new WeakMap,Ya=new WeakMap,Nl=new WeakMap;function o0(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(kn(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Op.set(n,e)}).catch(()=>{}),Nl.set(t,e),t}function a0(e){if(vu.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});vu.set(e,t)}let wu={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return vu.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Mp.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function u0(e){wu=e(wu)}function l0(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(Ja(this),t,...n);return Mp.set(r,t.sort?t.sort():[t]),kn(r)}:s0().includes(e)?function(...t){return e.apply(Ja(this),t),kn(Op.get(this))}:function(...t){return kn(e.apply(Ja(this),t))}}function c0(e){return typeof e=="function"?l0(e):(e instanceof IDBTransaction&&a0(e),r0(e,i0())?new Proxy(e,wu):e)}function kn(e){if(e instanceof IDBRequest)return o0(e);if(Ya.has(e))return Ya.get(e);const t=c0(e);return t!==e&&(Ya.set(e,t),Nl.set(t,e)),t}const Ja=e=>Nl.get(e);function h0(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),u=kn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(kn(o.result),c.oldVersion,c.newVersion,kn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),u}const f0=["get","getKey","getAll","getAllKeys","count"],d0=["put","add","delete","clear"],Za=new Map;function $h(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Za.get(t))return Za.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=d0.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||f0.includes(n)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(u.shift())),(await Promise.all([l[n](...u),i&&c.done]))[0]};return Za.set(t,s),s}u0(e=>({...e,get:(t,n,r)=>$h(t,n)||e.get(t,n,r),has:(t,n)=>!!$h(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(g0(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function g0(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Eu="@firebase/app",qh="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn=new kp("@firebase/app"),m0="@firebase/app-compat",_0="@firebase/analytics-compat",y0="@firebase/analytics",v0="@firebase/app-check-compat",w0="@firebase/app-check",E0="@firebase/auth",T0="@firebase/auth-compat",A0="@firebase/database",I0="@firebase/data-connect",R0="@firebase/database-compat",S0="@firebase/functions",b0="@firebase/functions-compat",C0="@firebase/installations",P0="@firebase/installations-compat",x0="@firebase/messaging",V0="@firebase/messaging-compat",N0="@firebase/performance",D0="@firebase/performance-compat",k0="@firebase/remote-config",O0="@firebase/remote-config-compat",M0="@firebase/storage",L0="@firebase/storage-compat",F0="@firebase/firestore",U0="@firebase/ai",B0="@firebase/firestore-compat",$0="firebase",q0="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu="[DEFAULT]",j0={[Eu]:"fire-core",[m0]:"fire-core-compat",[y0]:"fire-analytics",[_0]:"fire-analytics-compat",[w0]:"fire-app-check",[v0]:"fire-app-check-compat",[E0]:"fire-auth",[T0]:"fire-auth-compat",[A0]:"fire-rtdb",[I0]:"fire-data-connect",[R0]:"fire-rtdb-compat",[S0]:"fire-fn",[b0]:"fire-fn-compat",[C0]:"fire-iid",[P0]:"fire-iid-compat",[x0]:"fire-fcm",[V0]:"fire-fcm-compat",[N0]:"fire-perf",[D0]:"fire-perf-compat",[k0]:"fire-rc",[O0]:"fire-rc-compat",[M0]:"fire-gcs",[L0]:"fire-gcs-compat",[F0]:"fire-fst",[B0]:"fire-fst-compat",[U0]:"fire-vertex","fire-js":"fire-js",[$0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=new Map,z0=new Map,Au=new Map;function jh(e,t){try{e.container.addComponent(t)}catch(n){vn.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ao(e){const t=e.name;if(Au.has(t))return vn.debug(`There were multiple attempts to register component ${t}.`),!1;Au.set(t,e);for(const n of To.values())jh(n,e);for(const n of z0.values())jh(n,e);return!0}function H0(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function G0(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},On=new Dp("app","Firebase",W0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Gi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw On.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=q0;function Lp(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Tu,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw On.create("bad-app-name",{appName:String(i)});if(n||(n=Np()),!n)throw On.create("no-options");const s=To.get(i);if(s){if(Eo(n,s.options)&&Eo(r,s.config))return s;throw On.create("duplicate-app",{appName:i})}const o=new Jv(i);for(const c of Au.values())o.addComponent(c);const u=new K0(n,r,o);return To.set(i,u),u}function X0(e=Tu){const t=To.get(e);if(!t&&e===Tu&&Np())return Lp();if(!t)throw On.create("no-app",{appName:e});return t}function Ur(e,t,n){var r;let i=(r=j0[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${t}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),vn.warn(u.join(" "));return}Ao(new Gi(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="firebase-heartbeat-database",J0=1,Wi="firebase-heartbeat-store";let tu=null;function Fp(){return tu||(tu=h0(Y0,J0,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Wi)}catch(n){console.warn(n)}}}}).catch(e=>{throw On.create("idb-open",{originalErrorMessage:e.message})})),tu}async function Z0(e){try{const n=(await Fp()).transaction(Wi),r=await n.objectStore(Wi).get(Up(e));return await n.done,r}catch(t){if(t instanceof ni)vn.warn(t.message);else{const n=On.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});vn.warn(n.message)}}}async function zh(e,t){try{const r=(await Fp()).transaction(Wi,"readwrite");await r.objectStore(Wi).put(t,Up(e)),await r.done}catch(n){if(n instanceof ni)vn.warn(n.message);else{const r=On.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});vn.warn(r.message)}}}function Up(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=1024,ew=30;class nw{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new iw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Hh();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>ew){const o=sw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){vn.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Hh(),{heartbeatsToSend:r,unsentEntries:i}=rw(this._heartbeatsCache.heartbeats),s=wo(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return vn.warn(n),""}}}function Hh(){return new Date().toISOString().substring(0,10)}function rw(e,t=tw){const n=[];let r=e.slice();for(const i of e){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Gh(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Gh(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class iw{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zv()?Hv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Z0(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return zh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return zh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Gh(e){return wo(JSON.stringify({version:2,heartbeats:e})).length}function sw(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(e){Ao(new Gi("platform-logger",t=>new p0(t),"PRIVATE")),Ao(new Gi("heartbeat",t=>new nw(t),"PRIVATE")),Ur(Eu,qh,e),Ur(Eu,qh,"esm2017"),Ur("fire-js","")}ow("");var aw="firebase",uw="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ur(aw,uw,"app");var Wh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Mn,Bp;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,w){function T(){}T.prototype=w.prototype,I.D=w.prototype,I.prototype=new T,I.prototype.constructor=I,I.C=function(S,R,C){for(var A=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)A[Y-2]=arguments[Y];return w.prototype[R].apply(S,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,w,T){T||(T=0);var S=Array(16);if(typeof w=="string")for(var R=0;16>R;++R)S[R]=w.charCodeAt(T++)|w.charCodeAt(T++)<<8|w.charCodeAt(T++)<<16|w.charCodeAt(T++)<<24;else for(R=0;16>R;++R)S[R]=w[T++]|w[T++]<<8|w[T++]<<16|w[T++]<<24;w=I.g[0],T=I.g[1],R=I.g[2];var C=I.g[3],A=w+(C^T&(R^C))+S[0]+3614090360&4294967295;w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[1]+3905402710&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[2]+606105819&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[3]+3250441966&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[4]+4118548399&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[5]+1200080426&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[6]+2821735955&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[7]+4249261313&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[8]+1770035416&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[9]+2336552879&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[10]+4294925233&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[11]+2304563134&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[12]+1804603682&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[13]+4254626195&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[14]+2792965006&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[15]+1236535329&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(R^C&(T^R))+S[1]+4129170786&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[6]+3225465664&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[11]+643717713&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[0]+3921069994&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[5]+3593408605&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[10]+38016083&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[15]+3634488961&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[4]+3889429448&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[9]+568446438&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[14]+3275163606&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[3]+4107603335&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[8]+1163531501&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[13]+2850285829&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[2]+4243563512&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[7]+1735328473&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[12]+2368359562&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(T^R^C)+S[5]+4294588738&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[8]+2272392833&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[11]+1839030562&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[14]+4259657740&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[1]+2763975236&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[4]+1272893353&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[7]+4139469664&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[10]+3200236656&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[13]+681279174&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[0]+3936430074&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[3]+3572445317&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[6]+76029189&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[9]+3654602809&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[12]+3873151461&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[15]+530742520&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[2]+3299628645&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(R^(T|~C))+S[0]+4096336452&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[7]+1126891415&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[14]+2878612391&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[5]+4237533241&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[12]+1700485571&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[3]+2399980690&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[10]+4293915773&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[1]+2240044497&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[8]+1873313359&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[15]+4264355552&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[6]+2734768916&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[13]+1309151649&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[4]+4149444226&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[11]+3174756917&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[2]+718787259&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[9]+3951481745&4294967295,I.g[0]=I.g[0]+w&4294967295,I.g[1]=I.g[1]+(R+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+C&4294967295}r.prototype.u=function(I,w){w===void 0&&(w=I.length);for(var T=w-this.blockSize,S=this.B,R=this.h,C=0;C<w;){if(R==0)for(;C<=T;)i(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<w;)if(S[R++]=I.charCodeAt(C++),R==this.blockSize){i(this,S),R=0;break}}else for(;C<w;)if(S[R++]=I[C++],R==this.blockSize){i(this,S),R=0;break}}this.h=R,this.o+=w},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var w=1;w<I.length-8;++w)I[w]=0;var T=8*this.o;for(w=I.length-8;w<I.length;++w)I[w]=T&255,T/=256;for(this.u(I),I=Array(16),w=T=0;4>w;++w)for(var S=0;32>S;S+=8)I[T++]=this.g[w]>>>S&255;return I};function s(I,w){var T=u;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=w(I)}function o(I,w){this.h=w;for(var T=[],S=!0,R=I.length-1;0<=R;R--){var C=I[R]|0;S&&C==w||(T[R]=C,S=!1)}this.g=T}var u={};function c(I){return-128<=I&&128>I?s(I,function(w){return new o([w|0],0>w?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return v(l(-I));for(var w=[],T=1,S=0;I>=T;S++)w[S]=I/T|0,T*=4294967296;return new o(w,0)}function h(I,w){if(I.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(I.charAt(0)=="-")return v(h(I.substring(1),w));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=l(Math.pow(w,8)),S=d,R=0;R<I.length;R+=8){var C=Math.min(8,I.length-R),A=parseInt(I.substring(R,R+C),w);8>C?(C=l(Math.pow(w,C)),S=S.j(C).add(l(A))):(S=S.j(T),S=S.add(l(A)))}return S}var d=c(0),p=c(1),m=c(16777216);e=o.prototype,e.m=function(){if(E(this))return-v(this).m();for(var I=0,w=1,T=0;T<this.g.length;T++){var S=this.i(T);I+=(0<=S?S:4294967296+S)*w,w*=4294967296}return I},e.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(E(this))return"-"+v(this).toString(I);for(var w=l(Math.pow(I,6)),T=this,S="";;){var R=x(T,w).g;T=P(T,R.j(w));var C=((0<T.g.length?T.g[0]:T.h)>>>0).toString(I);if(T=R,_(T))return C+S;for(;6>C.length;)C="0"+C;S=C+S}},e.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var w=0;w<I.g.length;w++)if(I.g[w]!=0)return!1;return!0}function E(I){return I.h==-1}e.l=function(I){return I=P(this,I),E(I)?-1:_(I)?0:1};function v(I){for(var w=I.g.length,T=[],S=0;S<w;S++)T[S]=~I.g[S];return new o(T,~I.h).add(p)}e.abs=function(){return E(this)?v(this):this},e.add=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0,R=0;R<=w;R++){var C=S+(this.i(R)&65535)+(I.i(R)&65535),A=(C>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);S=A>>>16,C&=65535,A&=65535,T[R]=A<<16|C}return new o(T,T[T.length-1]&-2147483648?-1:0)};function P(I,w){return I.add(v(w))}e.j=function(I){if(_(this)||_(I))return d;if(E(this))return E(I)?v(this).j(v(I)):v(v(this).j(I));if(E(I))return v(this.j(v(I)));if(0>this.l(m)&&0>I.l(m))return l(this.m()*I.m());for(var w=this.g.length+I.g.length,T=[],S=0;S<2*w;S++)T[S]=0;for(S=0;S<this.g.length;S++)for(var R=0;R<I.g.length;R++){var C=this.i(S)>>>16,A=this.i(S)&65535,Y=I.i(R)>>>16,F=I.i(R)&65535;T[2*S+2*R]+=A*F,b(T,2*S+2*R),T[2*S+2*R+1]+=C*F,b(T,2*S+2*R+1),T[2*S+2*R+1]+=A*Y,b(T,2*S+2*R+1),T[2*S+2*R+2]+=C*Y,b(T,2*S+2*R+2)}for(S=0;S<w;S++)T[S]=T[2*S+1]<<16|T[2*S];for(S=w;S<2*w;S++)T[S]=0;return new o(T,0)};function b(I,w){for(;(I[w]&65535)!=I[w];)I[w+1]+=I[w]>>>16,I[w]&=65535,w++}function N(I,w){this.g=I,this.h=w}function x(I,w){if(_(w))throw Error("division by zero");if(_(I))return new N(d,d);if(E(I))return w=x(v(I),w),new N(v(w.g),v(w.h));if(E(w))return w=x(I,v(w)),new N(v(w.g),w.h);if(30<I.g.length){if(E(I)||E(w))throw Error("slowDivide_ only works with positive integers.");for(var T=p,S=w;0>=S.l(I);)T=M(T),S=M(S);var R=U(T,1),C=U(S,1);for(S=U(S,2),T=U(T,2);!_(S);){var A=C.add(S);0>=A.l(I)&&(R=R.add(T),C=A),S=U(S,1),T=U(T,1)}return w=P(I,R.j(w)),new N(R,w)}for(R=d;0<=I.l(w);){for(T=Math.max(1,Math.floor(I.m()/w.m())),S=Math.ceil(Math.log(T)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),C=l(T),A=C.j(w);E(A)||0<A.l(I);)T-=S,C=l(T),A=C.j(w);_(C)&&(C=p),R=R.add(C),I=P(I,A)}return new N(R,I)}e.A=function(I){return x(this,I).h},e.and=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)&I.i(S);return new o(T,this.h&I.h)},e.or=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)|I.i(S);return new o(T,this.h|I.h)},e.xor=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)^I.i(S);return new o(T,this.h^I.h)};function M(I){for(var w=I.g.length+1,T=[],S=0;S<w;S++)T[S]=I.i(S)<<1|I.i(S-1)>>>31;return new o(T,I.h)}function U(I,w){var T=w>>5;w%=32;for(var S=I.g.length-T,R=[],C=0;C<S;C++)R[C]=0<w?I.i(C+T)>>>w|I.i(C+T+1)<<32-w:I.i(C+T);return new o(R,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Bp=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=h,Mn=o}).apply(typeof Wh<"u"?Wh:typeof self<"u"?self:typeof window<"u"?window:{});var Us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $p,Si,qp,Js,Iu,jp,zp,Hp;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,g){return a==Array.prototype||a==Object.prototype||(a[f]=g.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Us=="object"&&Us];for(var f=0;f<a.length;++f){var g=a[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(a,f){if(f)t:{var g=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var V=a[y];if(!(V in g))break t;g=g[V]}a=a[a.length-1],y=g[a],f=f(y),f!=y&&f!=null&&t(g,a,{configurable:!0,writable:!0,value:f})}}function s(a,f){a instanceof String&&(a+="");var g=0,y=!1,V={next:function(){if(!y&&g<a.length){var k=g++;return{value:f(k,a[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(a){return a||function(){return s(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function l(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,g){return a.call.apply(a.bind,arguments)}function d(a,f,g){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,y),a.apply(f,V)}}return function(){return a.apply(f,arguments)}}function p(a,f,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function m(a,f){var g=Array.prototype.slice.call(arguments,1);return function(){var y=g.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function _(a,f){function g(){}g.prototype=f.prototype,a.aa=f.prototype,a.prototype=new g,a.prototype.constructor=a,a.Qb=function(y,V,k){for(var $=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)$[dt-2]=arguments[dt];return f.prototype[V].apply(y,$)}}function E(a){const f=a.length;if(0<f){const g=Array(f);for(let y=0;y<f;y++)g[y]=a[y];return g}return[]}function v(a,f){for(let g=1;g<arguments.length;g++){const y=arguments[g];if(c(y)){const V=a.length||0,k=y.length||0;a.length=V+k;for(let $=0;$<k;$++)a[V+$]=y[$]}else a.push(y)}}class P{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function b(a){return/^[\s\xa0]*$/.test(a)}function N(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function x(a){return x[" "](a),a}x[" "]=function(){};var M=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function U(a,f,g){for(const y in a)f.call(g,a[y],y,a)}function I(a,f){for(const g in a)f.call(void 0,a[g],g,a)}function w(a){const f={};for(const g in a)f[g]=a[g];return f}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(a,f){let g,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(g in y)a[g]=y[g];for(let k=0;k<T.length;k++)g=T[k],Object.prototype.hasOwnProperty.call(y,g)&&(a[g]=y[g])}}function R(a){var f=1;a=a.split(":");const g=[];for(;0<f&&a.length;)g.push(a.shift()),f--;return a.length&&g.push(a.join(":")),g}function C(a){u.setTimeout(()=>{throw a},0)}function A(){var a=kt;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class Y{constructor(){this.h=this.g=null}add(f,g){const y=F.get();y.set(f,g),this.h?this.h.next=y:this.g=y,this.h=y}}var F=new P(()=>new J,a=>a.reset());class J{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let lt,gt=!1,kt=new Y,qe=()=>{const a=u.Promise.resolve(void 0);lt=()=>{a.then(_e)}};var _e=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(g){C(g)}var f=F;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}gt=!1};function Lt(){this.s=this.s,this.C=this.C}Lt.prototype.s=!1,Lt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Lt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ht(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}ht.prototype.h=function(){this.defaultPrevented=!0};var Rn=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const g=()=>{};u.addEventListener("test",g,f),u.removeEventListener("test",g,f)}catch{}return a}();function le(a,f){if(ht.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var g=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(M){t:{try{x(f.nodeName);var V=!0;break t}catch{}V=!1}V||(f=null)}}else g=="mouseover"?f=a.fromElement:g=="mouseout"&&(f=a.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:ba[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&le.aa.h.call(this)}}_(le,ht);var ba={2:"touch",3:"pen",4:"mouse"};le.prototype.h=function(){le.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Yn="closure_listenable_"+(1e6*Math.random()|0),Ca=0;function Es(a,f,g,y,V){this.listener=a,this.proxy=null,this.src=f,this.type=g,this.capture=!!y,this.ha=V,this.key=++Ca,this.da=this.fa=!1}function Ar(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Ir(a){this.src=a,this.g={},this.h=0}Ir.prototype.add=function(a,f,g,y,V){var k=a.toString();a=this.g[k],a||(a=this.g[k]=[],this.h++);var $=H(a,f,y,V);return-1<$?(f=a[$],g||(f.fa=!1)):(f=new Es(f,this.src,k,!!y,V),f.fa=g,a.push(f)),f};function ci(a,f){var g=f.type;if(g in a.g){var y=a.g[g],V=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=V)&&Array.prototype.splice.call(y,V,1),k&&(Ar(f),a.g[g].length==0&&(delete a.g[g],a.h--))}}function H(a,f,g,y){for(var V=0;V<a.length;++V){var k=a[V];if(!k.da&&k.listener==f&&k.capture==!!g&&k.ha==y)return V}return-1}var z="closure_lm_"+(1e6*Math.random()|0),X={};function ct(a,f,g,y,V){if(Array.isArray(f)){for(var k=0;k<f.length;k++)ct(a,f[k],g,y,V);return null}return g=un(g),a&&a[Yn]?a.K(f,g,l(y)?!!y.capture:!1,V):Gt(a,f,g,!1,y,V)}function Gt(a,f,g,y,V,k){if(!f)throw Error("Invalid event type");var $=l(V)?!!V.capture:!!V,dt=re(a);if(dt||(a[z]=dt=new Ir(a)),g=dt.add(f,g,y,$,k),g.proxy)return g;if(y=Wt(),g.proxy=y,y.src=a,y.listener=g,a.addEventListener)Rn||(V=$),V===void 0&&(V=!1),a.addEventListener(f.toString(),y,V);else if(a.attachEvent)a.attachEvent(ne(f.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Wt(){function a(g){return f.call(a.src,a.listener,g)}const f=ke;return a}function Kt(a,f,g,y,V){if(Array.isArray(f))for(var k=0;k<f.length;k++)Kt(a,f[k],g,y,V);else y=l(y)?!!y.capture:!!y,g=un(g),a&&a[Yn]?(a=a.i,f=String(f).toString(),f in a.g&&(k=a.g[f],g=H(k,g,y,V),-1<g&&(Ar(k[g]),Array.prototype.splice.call(k,g,1),k.length==0&&(delete a.g[f],a.h--)))):a&&(a=re(a))&&(f=a.g[f.toString()],a=-1,f&&(a=H(f,g,y,V)),(g=-1<a?f[a]:null)&&St(g))}function St(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[Yn])ci(f.i,a);else{var g=a.type,y=a.proxy;f.removeEventListener?f.removeEventListener(g,y,a.capture):f.detachEvent?f.detachEvent(ne(g),y):f.addListener&&f.removeListener&&f.removeListener(y),(g=re(f))?(ci(g,a),g.h==0&&(g.src=null,f[z]=null)):Ar(a)}}}function ne(a){return a in X?X[a]:X[a]="on"+a}function ke(a,f){if(a.da)a=!0;else{f=new le(f,this);var g=a.listener,y=a.ha||a.src;a.fa&&St(a),a=g.call(y,f)}return a}function re(a){return a=a[z],a instanceof Ir?a:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function un(a){return typeof a=="function"?a:(a[Qt]||(a[Qt]=function(f){return a.handleEvent(f)}),a[Qt])}function vt(){Lt.call(this),this.i=new Ir(this),this.M=this,this.F=null}_(vt,Lt),vt.prototype[Yn]=!0,vt.prototype.removeEventListener=function(a,f,g,y){Kt(this,a,f,g,y)};function At(a,f){var g,y=a.F;if(y)for(g=[];y;y=y.F)g.push(y);if(a=a.M,y=f.type||f,typeof f=="string")f=new ht(f,a);else if(f instanceof ht)f.target=f.target||a;else{var V=f;f=new ht(y,a),S(f,V)}if(V=!0,g)for(var k=g.length-1;0<=k;k--){var $=f.g=g[k];V=ye($,y,!0,f)&&V}if($=f.g=a,V=ye($,y,!0,f)&&V,V=ye($,y,!1,f)&&V,g)for(k=0;k<g.length;k++)$=f.g=g[k],V=ye($,y,!1,f)&&V}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var g=a.g[f],y=0;y<g.length;y++)Ar(g[y]);delete a.g[f],a.h--}}this.F=null},vt.prototype.K=function(a,f,g,y){return this.i.add(String(a),f,!1,g,y)},vt.prototype.L=function(a,f,g,y){return this.i.add(String(a),f,!0,g,y)};function ye(a,f,g,y){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var V=!0,k=0;k<f.length;++k){var $=f[k];if($&&!$.da&&$.capture==g){var dt=$.listener,$t=$.ha||$.src;$.fa&&ci(a.i,$),V=dt.call($t,y)!==!1&&V}}return V&&!y.defaultPrevented}function je(a,f,g){if(typeof a=="function")g&&(a=p(a,g));else if(a&&typeof a.handleEvent=="function")a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:u.setTimeout(a,f||0)}function ve(a){a.g=je(()=>{a.g=null,a.i&&(a.i=!1,ve(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class Rr extends Lt{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ve(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ze(a){Lt.call(this),this.h=a,this.g={}}_(ze,Lt);var Nc=[];function Dc(a){U(a.g,function(f,g){this.g.hasOwnProperty(g)&&St(f)},a),a.g={}}ze.prototype.N=function(){ze.aa.N.call(this),Dc(this)},ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pa=u.JSON.stringify,O_=u.JSON.parse,M_=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function xa(){}xa.prototype.h=null;function kc(a){return a.h||(a.h=a.i())}function Oc(){}var hi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Va(){ht.call(this,"d")}_(Va,ht);function Na(){ht.call(this,"c")}_(Na,ht);var Jn={},Mc=null;function Ts(){return Mc=Mc||new vt}Jn.La="serverreachability";function Lc(a){ht.call(this,Jn.La,a)}_(Lc,ht);function fi(a){const f=Ts();At(f,new Lc(f))}Jn.STAT_EVENT="statevent";function Fc(a,f){ht.call(this,Jn.STAT_EVENT,a),this.stat=f}_(Fc,ht);function ie(a){const f=Ts();At(f,new Fc(f,a))}Jn.Ma="timingevent";function Uc(a,f){ht.call(this,Jn.Ma,a),this.size=f}_(Uc,ht);function di(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},f)}function pi(){this.g=!0}pi.prototype.xa=function(){this.g=!1};function L_(a,f,g,y,V,k){a.info(function(){if(a.g)if(k)for(var $="",dt=k.split("&"),$t=0;$t<dt.length;$t++){var ot=dt[$t].split("=");if(1<ot.length){var Xt=ot[0];ot=ot[1];var Yt=Xt.split("_");$=2<=Yt.length&&Yt[1]=="type"?$+(Xt+"="+ot+"&"):$+(Xt+"=redacted&")}}else $=null;else $=k;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+f+`
`+g+`
`+$})}function F_(a,f,g,y,V,k,$){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+f+`
`+g+`
`+k+" "+$})}function Sr(a,f,g,y){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+B_(a,g)+(y?" "+y:"")})}function U_(a,f){a.info(function(){return"TIMEOUT: "+f})}pi.prototype.info=function(){};function B_(a,f){if(!a.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(a=0;a<g.length;a++)if(Array.isArray(g[a])){var y=g[a];if(!(2>y.length)){var V=y[1];if(Array.isArray(V)&&!(1>V.length)){var k=V[0];if(k!="noop"&&k!="stop"&&k!="close")for(var $=1;$<V.length;$++)V[$]=""}}}}return Pa(g)}catch{return f}}var As={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Bc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Da;function Is(){}_(Is,xa),Is.prototype.g=function(){return new XMLHttpRequest},Is.prototype.i=function(){return{}},Da=new Is;function Sn(a,f,g,y){this.j=a,this.i=f,this.l=g,this.R=y||1,this.U=new ze(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $c}function $c(){this.i=null,this.g="",this.h=!1}var qc={},ka={};function Oa(a,f,g){a.L=1,a.v=Cs(ln(f)),a.m=g,a.P=!0,jc(a,null)}function jc(a,f){a.F=Date.now(),Rs(a),a.A=ln(a.v);var g=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),rh(g.i,"t",y),a.C=0,g=a.j.J,a.h=new $c,a.g=Eh(a.j,g?f:null,!a.m),0<a.O&&(a.M=new Rr(p(a.Y,a,a.g),a.O)),f=a.U,g=a.g,y=a.ca;var V="readystatechange";Array.isArray(V)||(V&&(Nc[0]=V.toString()),V=Nc);for(var k=0;k<V.length;k++){var $=ct(g,V[k],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),fi(),L_(a.i,a.u,a.A,a.l,a.R,a.m)}Sn.prototype.ca=function(a){a=a.target;const f=this.M;f&&cn(a)==3?f.j():this.Y(a)},Sn.prototype.Y=function(a){try{if(a==this.g)t:{const Yt=cn(this.g);var f=this.g.Ba();const Pr=this.g.Z();if(!(3>Yt)&&(Yt!=3||this.g&&(this.h.h||this.g.oa()||ch(this.g)))){this.J||Yt!=4||f==7||(f==8||0>=Pr?fi(3):fi(2)),Ma(this);var g=this.g.Z();this.X=g;e:if(zc(this)){var y=ch(this.g);a="";var V=y.length,k=cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zn(this),gi(this);var $="";break e}this.h.i=new u.TextDecoder}for(f=0;f<V;f++)this.h.h=!0,a+=this.h.i.decode(y[f],{stream:!(k&&f==V-1)});y.length=0,this.h.g+=a,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=g==200,F_(this.i,this.u,this.A,this.l,this.R,Yt,g),this.o){if(this.T&&!this.K){e:{if(this.g){var dt,$t=this.g;if((dt=$t.g?$t.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(dt)){var ot=dt;break e}}ot=null}if(g=ot)Sr(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,La(this,g);else{this.o=!1,this.s=3,ie(12),Zn(this),gi(this);break t}}if(this.P){g=!0;let Oe;for(;!this.J&&this.C<$.length;)if(Oe=$_(this,$),Oe==ka){Yt==4&&(this.s=4,ie(14),g=!1),Sr(this.i,this.l,null,"[Incomplete Response]");break}else if(Oe==qc){this.s=4,ie(15),Sr(this.i,this.l,$,"[Invalid Chunk]"),g=!1;break}else Sr(this.i,this.l,Oe,null),La(this,Oe);if(zc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yt!=4||$.length!=0||this.h.h||(this.s=1,ie(16),g=!1),this.o=this.o&&g,!g)Sr(this.i,this.l,$,"[Invalid Chunked Response]"),Zn(this),gi(this);else if(0<$.length&&!this.W){this.W=!0;var Xt=this.j;Xt.g==this&&Xt.ba&&!Xt.M&&(Xt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),ja(Xt),Xt.M=!0,ie(11))}}else Sr(this.i,this.l,$,null),La(this,$);Yt==4&&Zn(this),this.o&&!this.J&&(Yt==4?_h(this.j,this):(this.o=!1,Rs(this)))}else iy(this.g),g==400&&0<$.indexOf("Unknown SID")?(this.s=3,ie(12)):(this.s=0,ie(13)),Zn(this),gi(this)}}}catch{}finally{}};function zc(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function $_(a,f){var g=a.C,y=f.indexOf(`
`,g);return y==-1?ka:(g=Number(f.substring(g,y)),isNaN(g)?qc:(y+=1,y+g>f.length?ka:(f=f.slice(y,y+g),a.C=y+g,f)))}Sn.prototype.cancel=function(){this.J=!0,Zn(this)};function Rs(a){a.S=Date.now()+a.I,Hc(a,a.I)}function Hc(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=di(p(a.ba,a),f)}function Ma(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Sn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(U_(this.i,this.A),this.L!=2&&(fi(),ie(17)),Zn(this),this.s=2,gi(this)):Hc(this,this.S-a)};function gi(a){a.j.G==0||a.J||_h(a.j,a)}function Zn(a){Ma(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,Dc(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function La(a,f){try{var g=a.j;if(g.G!=0&&(g.g==a||Fa(g.h,a))){if(!a.K&&Fa(g.h,a)&&g.G==3){try{var y=g.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){t:if(!g.u){if(g.g)if(g.g.F+3e3<a.F)ks(g),Ns(g);else break t;qa(g),ie(18)}}else g.za=V[1],0<g.za-g.T&&37500>V[2]&&g.F&&g.v==0&&!g.C&&(g.C=di(p(g.Za,g),6e3));if(1>=Kc(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else er(g,11)}else if((a.K||g.g==a)&&ks(g),!b(f))for(V=g.Da.g.parse(f),f=0;f<V.length;f++){let ot=V[f];if(g.T=ot[0],ot=ot[1],g.G==2)if(ot[0]=="c"){g.K=ot[1],g.ia=ot[2];const Xt=ot[3];Xt!=null&&(g.la=Xt,g.j.info("VER="+g.la));const Yt=ot[4];Yt!=null&&(g.Aa=Yt,g.j.info("SVER="+g.Aa));const Pr=ot[5];Pr!=null&&typeof Pr=="number"&&0<Pr&&(y=1.5*Pr,g.L=y,g.j.info("backChannelRequestTimeoutMs_="+y)),y=g;const Oe=a.g;if(Oe){const Ms=Oe.g?Oe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ms){var k=y.h;k.g||Ms.indexOf("spdy")==-1&&Ms.indexOf("quic")==-1&&Ms.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(Ua(k,k.h),k.h=null))}if(y.D){const za=Oe.g?Oe.g.getResponseHeader("X-HTTP-Session-Id"):null;za&&(y.ya=za,_t(y.I,y.D,za))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-a.F,g.j.info("Handshake RTT: "+g.R+"ms")),y=g;var $=a;if(y.qa=wh(y,y.J?y.ia:null,y.W),$.K){Qc(y.h,$);var dt=$,$t=y.L;$t&&(dt.I=$t),dt.B&&(Ma(dt),Rs(dt)),y.g=$}else gh(y);0<g.i.length&&Ds(g)}else ot[0]!="stop"&&ot[0]!="close"||er(g,7);else g.G==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?er(g,7):$a(g):ot[0]!="noop"&&g.l&&g.l.ta(ot),g.v=0)}}fi(4)}catch{}}var q_=class{constructor(a,f){this.g=a,this.map=f}};function Gc(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wc(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Kc(a){return a.h?1:a.g?a.g.size:0}function Fa(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function Ua(a,f){a.g?a.g.add(f):a.h=f}function Qc(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}Gc.prototype.cancel=function(){if(this.i=Xc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Xc(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const g of a.g.values())f=f.concat(g.D);return f}return E(a.i)}function j_(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var f=[],g=a.length,y=0;y<g;y++)f.push(a[y]);return f}f=[],g=0;for(y in a)f[g++]=a[y];return f}function z_(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var f=[];a=a.length;for(var g=0;g<a;g++)f.push(g);return f}f=[],g=0;for(const y in a)f[g++]=y;return f}}}function Yc(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var g=z_(a),y=j_(a),V=y.length,k=0;k<V;k++)f.call(void 0,y[k],g&&g[k],a)}var Jc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function H_(a,f){if(a){a=a.split("&");for(var g=0;g<a.length;g++){var y=a[g].indexOf("="),V=null;if(0<=y){var k=a[g].substring(0,y);V=a[g].substring(y+1)}else k=a[g];f(k,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function tr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof tr){this.h=a.h,Ss(this,a.j),this.o=a.o,this.g=a.g,bs(this,a.s),this.l=a.l;var f=a.i,g=new yi;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),Zc(this,g),this.m=a.m}else a&&(f=String(a).match(Jc))?(this.h=!1,Ss(this,f[1]||"",!0),this.o=mi(f[2]||""),this.g=mi(f[3]||"",!0),bs(this,f[4]),this.l=mi(f[5]||"",!0),Zc(this,f[6]||"",!0),this.m=mi(f[7]||"")):(this.h=!1,this.i=new yi(null,this.h))}tr.prototype.toString=function(){var a=[],f=this.j;f&&a.push(_i(f,th,!0),":");var g=this.g;return(g||f=="file")&&(a.push("//"),(f=this.o)&&a.push(_i(f,th,!0),"@"),a.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&a.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&a.push("/"),a.push(_i(g,g.charAt(0)=="/"?K_:W_,!0))),(g=this.i.toString())&&a.push("?",g),(g=this.m)&&a.push("#",_i(g,X_)),a.join("")};function ln(a){return new tr(a)}function Ss(a,f,g){a.j=g?mi(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function bs(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function Zc(a,f,g){f instanceof yi?(a.i=f,Y_(a.i,a.h)):(g||(f=_i(f,Q_)),a.i=new yi(f,a.h))}function _t(a,f,g){a.i.set(f,g)}function Cs(a){return _t(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function mi(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function _i(a,f,g){return typeof a=="string"?(a=encodeURI(a).replace(f,G_),g&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function G_(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var th=/[#\/\?@]/g,W_=/[#\?:]/g,K_=/[#\?]/g,Q_=/[#\?@]/g,X_=/#/g;function yi(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function bn(a){a.g||(a.g=new Map,a.h=0,a.i&&H_(a.i,function(f,g){a.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}e=yi.prototype,e.add=function(a,f){bn(this),this.i=null,a=br(this,a);var g=this.g.get(a);return g||this.g.set(a,g=[]),g.push(f),this.h+=1,this};function eh(a,f){bn(a),f=br(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function nh(a,f){return bn(a),f=br(a,f),a.g.has(f)}e.forEach=function(a,f){bn(this),this.g.forEach(function(g,y){g.forEach(function(V){a.call(f,V,y,this)},this)},this)},e.na=function(){bn(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let y=0;y<f.length;y++){const V=a[y];for(let k=0;k<V.length;k++)g.push(f[y])}return g},e.V=function(a){bn(this);let f=[];if(typeof a=="string")nh(this,a)&&(f=f.concat(this.g.get(br(this,a))));else{a=Array.from(this.g.values());for(let g=0;g<a.length;g++)f=f.concat(a[g])}return f},e.set=function(a,f){return bn(this),this.i=null,a=br(this,a),nh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},e.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function rh(a,f,g){eh(a,f),0<g.length&&(a.i=null,a.g.set(br(a,f),E(g)),a.h+=g.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var y=f[g];const k=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var V=k;$[y]!==""&&(V+="="+encodeURIComponent(String($[y]))),a.push(V)}}return this.i=a.join("&")};function br(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function Y_(a,f){f&&!a.j&&(bn(a),a.i=null,a.g.forEach(function(g,y){var V=y.toLowerCase();y!=V&&(eh(this,y),rh(this,V,g))},a)),a.j=f}function J_(a,f){const g=new pi;if(u.Image){const y=new Image;y.onload=m(Cn,g,"TestLoadImage: loaded",!0,f,y),y.onerror=m(Cn,g,"TestLoadImage: error",!1,f,y),y.onabort=m(Cn,g,"TestLoadImage: abort",!1,f,y),y.ontimeout=m(Cn,g,"TestLoadImage: timeout",!1,f,y),u.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else f(!1)}function Z_(a,f){const g=new pi,y=new AbortController,V=setTimeout(()=>{y.abort(),Cn(g,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:y.signal}).then(k=>{clearTimeout(V),k.ok?Cn(g,"TestPingServer: ok",!0,f):Cn(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),Cn(g,"TestPingServer: error",!1,f)})}function Cn(a,f,g,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(g)}catch{}}function ty(){this.g=new M_}function ey(a,f,g){const y=g||"";try{Yc(a,function(V,k){let $=V;l(V)&&($=Pa(V)),f.push(y+k+"="+encodeURIComponent($))})}catch(V){throw f.push(y+"type="+encodeURIComponent("_badmap")),V}}function Ps(a){this.l=a.Ub||null,this.j=a.eb||!1}_(Ps,xa),Ps.prototype.g=function(){return new xs(this.l,this.j)},Ps.prototype.i=function(a){return function(){return a}}({});function xs(a,f){vt.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(xs,vt),e=xs.prototype,e.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,wi(this)},e.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||u).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vi(this)),this.readyState=0},e.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,wi(this)),this.g&&(this.readyState=3,wi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ih(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function ih(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}e.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?vi(this):wi(this),this.readyState==3&&ih(this)}},e.Ra=function(a){this.g&&(this.response=this.responseText=a,vi(this))},e.Qa=function(a){this.g&&(this.response=a,vi(this))},e.ga=function(){this.g&&vi(this)};function vi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,wi(a)}e.setRequestHeader=function(a,f){this.u.append(a,f)},e.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,a.push(g[0]+": "+g[1]),g=f.next();return a.join(`\r
`)};function wi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(xs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function sh(a){let f="";return U(a,function(g,y){f+=y,f+=":",f+=g,f+=`\r
`}),f}function Ba(a,f,g){t:{for(y in g){var y=!1;break t}y=!0}y||(g=sh(g),typeof a=="string"?g!=null&&encodeURIComponent(String(g)):_t(a,f,g))}function It(a){vt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(It,vt);var ny=/^https?$/i,ry=["POST","PUT"];e=It.prototype,e.Ha=function(a){this.J=a},e.ea=function(a,f,g,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Da.g(),this.v=this.o?kc(this.o):kc(Da),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(k){oh(this,k);return}if(a=g||"",g=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)g.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const k of y.keys())g.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(g.keys()).find(k=>k.toLowerCase()=="content-type"),V=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(ry,f,void 0))||y||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,$]of g)this.g.setRequestHeader(k,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{lh(this),this.u=!0,this.g.send(a),this.u=!1}catch(k){oh(this,k)}};function oh(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,ah(a),Vs(a)}function ah(a){a.A||(a.A=!0,At(a,"complete"),At(a,"error"))}e.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,At(this,"complete"),At(this,"abort"),Vs(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vs(this,!0)),It.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?uh(this):this.bb())},e.bb=function(){uh(this)};function uh(a){if(a.h&&typeof o<"u"&&(!a.v[1]||cn(a)!=4||a.Z()!=2)){if(a.u&&cn(a)==4)je(a.Ea,0,a);else if(At(a,"readystatechange"),cn(a)==4){a.h=!1;try{const $=a.Z();t:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var g;if(!(g=f)){var y;if(y=$===0){var V=String(a.D).match(Jc)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),y=!ny.test(V?V.toLowerCase():"")}g=y}if(g)At(a,"complete"),At(a,"success");else{a.m=6;try{var k=2<cn(a)?a.g.statusText:""}catch{k=""}a.l=k+" ["+a.Z()+"]",ah(a)}}finally{Vs(a)}}}}function Vs(a,f){if(a.g){lh(a);const g=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||At(a,"ready");try{g.onreadystatechange=y}catch{}}}function lh(a){a.I&&(u.clearTimeout(a.I),a.I=null)}e.isActive=function(){return!!this.g};function cn(a){return a.g?a.g.readyState:0}e.Z=function(){try{return 2<cn(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),O_(f)}};function ch(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function iy(a){const f={};a=(a.g&&2<=cn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(b(a[y]))continue;var g=R(a[y]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const k=f[V]||[];f[V]=k,k.push(g)}I(f,function(y){return y.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ei(a,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[a]||f}function hh(a){this.Aa=0,this.i=[],this.j=new pi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ei("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ei("baseRetryDelayMs",5e3,a),this.cb=Ei("retryDelaySeedMs",1e4,a),this.Wa=Ei("forwardChannelMaxRetries",2,a),this.wa=Ei("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Gc(a&&a.concurrentRequestLimit),this.Da=new ty,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=hh.prototype,e.la=8,e.G=1,e.connect=function(a,f,g,y){ie(0),this.W=a,this.H=f||{},g&&y!==void 0&&(this.H.OSID=g,this.H.OAID=y),this.F=this.X,this.I=wh(this,null,this.W),Ds(this)};function $a(a){if(fh(a),a.G==3){var f=a.U++,g=ln(a.I);if(_t(g,"SID",a.K),_t(g,"RID",f),_t(g,"TYPE","terminate"),Ti(a,g),f=new Sn(a,a.j,f),f.L=2,f.v=Cs(ln(g)),g=!1,u.navigator&&u.navigator.sendBeacon)try{g=u.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&u.Image&&(new Image().src=f.v,g=!0),g||(f.g=Eh(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Rs(f)}vh(a)}function Ns(a){a.g&&(ja(a),a.g.cancel(),a.g=null)}function fh(a){Ns(a),a.u&&(u.clearTimeout(a.u),a.u=null),ks(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Ds(a){if(!Wc(a.h)&&!a.s){a.s=!0;var f=a.Ga;lt||qe(),gt||(lt(),gt=!0),kt.add(f,a),a.B=0}}function sy(a,f){return Kc(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=di(p(a.Ga,a,f),yh(a,a.B)),a.B++,!0)}e.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new Sn(this,this.j,a);let k=this.o;if(this.S&&(k?(k=w(k),S(k,this.S)):k=this.S),this.m!==null||this.O||(V.H=k,k=null),this.P)t:{for(var f=0,g=0;g<this.i.length;g++){e:{var y=this.i[g];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break e}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=g;break t}if(f===4096||g===this.i.length-1){f=g+1;break t}}f=1e3}else f=1e3;f=ph(this,V,f),g=ln(this.I),_t(g,"RID",a),_t(g,"CVER",22),this.D&&_t(g,"X-HTTP-Session-Id",this.D),Ti(this,g),k&&(this.O?f="headers="+encodeURIComponent(String(sh(k)))+"&"+f:this.m&&Ba(g,this.m,k)),Ua(this.h,V),this.Ua&&_t(g,"TYPE","init"),this.P?(_t(g,"$req",f),_t(g,"SID","null"),V.T=!0,Oa(V,g,null)):Oa(V,g,f),this.G=2}}else this.G==3&&(a?dh(this,a):this.i.length==0||Wc(this.h)||dh(this))};function dh(a,f){var g;f?g=f.l:g=a.U++;const y=ln(a.I);_t(y,"SID",a.K),_t(y,"RID",g),_t(y,"AID",a.T),Ti(a,y),a.m&&a.o&&Ba(y,a.m,a.o),g=new Sn(a,a.j,g,a.B+1),a.m===null&&(g.H=a.o),f&&(a.i=f.D.concat(a.i)),f=ph(a,g,1e3),g.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ua(a.h,g),Oa(g,y,f)}function Ti(a,f){a.H&&U(a.H,function(g,y){_t(f,y,g)}),a.l&&Yc({},function(g,y){_t(f,y,g)})}function ph(a,f,g){g=Math.min(a.i.length,g);var y=a.l?p(a.l.Na,a.l,a):null;t:{var V=a.i;let k=-1;for(;;){const $=["count="+g];k==-1?0<g?(k=V[0].g,$.push("ofs="+k)):k=0:$.push("ofs="+k);let dt=!0;for(let $t=0;$t<g;$t++){let ot=V[$t].g;const Xt=V[$t].map;if(ot-=k,0>ot)k=Math.max(0,V[$t].g-100),dt=!1;else try{ey(Xt,$,"req"+ot+"_")}catch{y&&y(Xt)}}if(dt){y=$.join("&");break t}}}return a=a.i.splice(0,g),f.D=a,y}function gh(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;lt||qe(),gt||(lt(),gt=!0),kt.add(f,a),a.v=0}}function qa(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=di(p(a.Fa,a),yh(a,a.v)),a.v++,!0)}e.Fa=function(){if(this.u=null,mh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=di(p(this.ab,this),a)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ie(10),Ns(this),mh(this))};function ja(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function mh(a){a.g=new Sn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=ln(a.qa);_t(f,"RID","rpc"),_t(f,"SID",a.K),_t(f,"AID",a.T),_t(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&_t(f,"TO",a.ja),_t(f,"TYPE","xmlhttp"),Ti(a,f),a.m&&a.o&&Ba(f,a.m,a.o),a.L&&(a.g.I=a.L);var g=a.g;a=a.ia,g.L=1,g.v=Cs(ln(f)),g.m=null,g.P=!0,jc(g,a)}e.Za=function(){this.C!=null&&(this.C=null,Ns(this),qa(this),ie(19))};function ks(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function _h(a,f){var g=null;if(a.g==f){ks(a),ja(a),a.g=null;var y=2}else if(Fa(a.h,f))g=f.D,Qc(a.h,f),y=1;else return;if(a.G!=0){if(f.o)if(y==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var V=a.B;y=Ts(),At(y,new Uc(y,g)),Ds(a)}else gh(a);else if(V=f.s,V==3||V==0&&0<f.X||!(y==1&&sy(a,f)||y==2&&qa(a)))switch(g&&0<g.length&&(f=a.h,f.i=f.i.concat(g)),V){case 1:er(a,5);break;case 4:er(a,10);break;case 3:er(a,6);break;default:er(a,2)}}}function yh(a,f){let g=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(g*=2),g*f}function er(a,f){if(a.j.info("Error code "+f),f==2){var g=p(a.fb,a),y=a.Xa;const V=!y;y=new tr(y||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ss(y,"https"),Cs(y),V?J_(y.toString(),g):Z_(y.toString(),g)}else ie(2);a.G=0,a.l&&a.l.sa(f),vh(a),fh(a)}e.fb=function(a){a?(this.j.info("Successfully pinged google.com"),ie(2)):(this.j.info("Failed to ping google.com"),ie(1))};function vh(a){if(a.G=0,a.ka=[],a.l){const f=Xc(a.h);(f.length!=0||a.i.length!=0)&&(v(a.ka,f),v(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function wh(a,f,g){var y=g instanceof tr?ln(g):new tr(g);if(y.g!="")f&&(y.g=f+"."+y.g),bs(y,y.s);else{var V=u.location;y=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;var k=new tr(null);y&&Ss(k,y),f&&(k.g=f),V&&bs(k,V),g&&(k.l=g),y=k}return g=a.D,f=a.ya,g&&f&&_t(y,g,f),_t(y,"VER",a.la),Ti(a,y),y}function Eh(a,f,g){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new It(new Ps({eb:g})):new It(a.pa),f.Ha(a.J),f}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Th(){}e=Th.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Os(){}Os.prototype.g=function(a,f){return new we(a,f)};function we(a,f){vt.call(this),this.g=new hh(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!b(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!b(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Cr(this)}_(we,vt),we.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},we.prototype.close=function(){$a(this.g)},we.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var g={};g.__data__=a,a=g}else this.u&&(g={},g.__data__=Pa(a),a=g);f.i.push(new q_(f.Ya++,a)),f.G==3&&Ds(f)},we.prototype.N=function(){this.g.l=null,delete this.j,$a(this.g),delete this.g,we.aa.N.call(this)};function Ah(a){Va.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){t:{for(const g in f){a=g;break t}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}_(Ah,Va);function Ih(){Na.call(this),this.status=1}_(Ih,Na);function Cr(a){this.g=a}_(Cr,Th),Cr.prototype.ua=function(){At(this.g,"a")},Cr.prototype.ta=function(a){At(this.g,new Ah(a))},Cr.prototype.sa=function(a){At(this.g,new Ih)},Cr.prototype.ra=function(){At(this.g,"b")},Os.prototype.createWebChannel=Os.prototype.g,we.prototype.send=we.prototype.o,we.prototype.open=we.prototype.m,we.prototype.close=we.prototype.close,Hp=function(){return new Os},zp=function(){return Ts()},jp=Jn,Iu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},As.NO_ERROR=0,As.TIMEOUT=8,As.HTTP_ERROR=6,Js=As,Bc.COMPLETE="complete",qp=Bc,Oc.EventType=hi,hi.OPEN="a",hi.CLOSE="b",hi.ERROR="c",hi.MESSAGE="d",vt.prototype.listen=vt.prototype.K,Si=Oc,It.prototype.listenOnce=It.prototype.L,It.prototype.getLastError=It.prototype.Ka,It.prototype.getLastErrorCode=It.prototype.Ba,It.prototype.getStatus=It.prototype.Z,It.prototype.getResponseJson=It.prototype.Oa,It.prototype.getResponseText=It.prototype.oa,It.prototype.send=It.prototype.ea,It.prototype.setWithCredentials=It.prototype.Ha,$p=It}).apply(typeof Us<"u"?Us:typeof self<"u"?self:typeof window<"u"?window:{});const Kh="@firebase/firestore",Qh="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Zt.UNAUTHENTICATED=new Zt(null),Zt.GOOGLE_CREDENTIALS=new Zt("google-credentials-uid"),Zt.FIRST_PARTY=new Zt("first-party-uid"),Zt.MOCK_USER=new Zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ri="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr=new kp("@firebase/firestore");function Nr(){return dr.logLevel}function j(e,...t){if(dr.logLevel<=it.DEBUG){const n=t.map(Dl);dr.debug(`Firestore (${ri}): ${e}`,...n)}}function wn(e,...t){if(dr.logLevel<=it.ERROR){const n=t.map(Dl);dr.error(`Firestore (${ri}): ${e}`,...n)}}function Bn(e,...t){if(dr.logLevel<=it.WARN){const n=t.map(Dl);dr.warn(`Firestore (${ri}): ${e}`,...n)}}function Dl(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,Gp(e,r,n)}function Gp(e,t,n){let r=`FIRESTORE (${ri}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw wn(r),new Error(r)}function ut(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||Gp(t,i,r)}function Q(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends ni{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class lw{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Zt.UNAUTHENTICATED))}shutdown(){}}class cw{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class hw{constructor(t){this.t=t,this.currentUser=Zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ut(this.o===void 0,42304);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new mn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mn,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;t.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mn)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ut(typeof r.accessToken=="string",31837,{l:r}),new Wp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ut(t===null||typeof t=="string",2055,{h:t}),new Zt(t)}}class fw{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=Zt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class dw{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new fw(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(Zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Xh{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pw{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,G0(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ut(this.o===void 0,3512);const r=s=>{s.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Xh(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ut(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Xh(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=gw(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%62))}return r}}function tt(e,t){return e<t?-1:e>t?1:0}function Ru(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return tt(r,i);{const s=Kp(),o=mw(s.encode(Yh(e,n)),s.encode(Yh(t,n)));return o!==0?o:tt(r,i)}}n+=r>65535?2:1}return tt(e.length,t.length)}function Yh(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function mw(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return tt(e[n],t[n]);return tt(e.length,t.length)}function jr(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh="__name__";class Ge{constructor(t,n,r){n===void 0?n=0:n>t.length&&W(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&W(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return Ge.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Ge?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const s=Ge.compareSegments(t.get(i),n.get(i));if(s!==0)return s}return tt(t.length,n.length)}static compareSegments(t,n){const r=Ge.isNumericId(t),i=Ge.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Ge.extractNumericId(t).compare(Ge.extractNumericId(n)):Ru(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Mn.fromString(t.substring(4,t.length-2))}}class mt extends Ge{construct(t,n,r){return new mt(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new q(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new mt(n)}static emptyPath(){return new mt([])}}const _w=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Ge{construct(t,n,r){return new zt(t,n,r)}static isValidIdentifier(t){return _w.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Jh}static keyField(){return new zt([Jh])}static fromServerFormat(t){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new q(O.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new q(O.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zt(n)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(t){this.path=t}static fromPath(t){return new G(mt.fromString(t))}static fromName(t){return new G(mt.fromString(t).popFirst(5))}static empty(){return new G(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&mt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return mt.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new G(new mt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qp(e,t,n){if(!n)throw new q(O.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function yw(e,t,n,r){if(t===!0&&r===!0)throw new q(O.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Zh(e){if(!G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function tf(e){if(G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Xp(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function na(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":W(12329,{type:typeof e})}function En(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new q(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=na(e);throw new q(O.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function vw(e,t){if(t<=0)throw new q(O.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(e,t){const n={typeString:e};return t&&(n.value=t),n}function cs(e,t){if(!Xp(e))throw new q(O.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new q(O.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef=-62135596800,nf=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(t){return yt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*nf);return new yt(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<ef)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/nf}_compareTo(t){return this.seconds===t.seconds?tt(this.nanoseconds,t.nanoseconds):tt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(cs(t,yt._jsonSchema))return new yt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-ef;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:Dt("string",yt._jsonSchemaVersion),seconds:Dt("number"),nanoseconds:Dt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{static fromTimestamp(t){return new K(t)}static min(){return new K(new yt(0,0))}static max(){return new K(new yt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki=-1;function ww(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new yt(n+1,0):new yt(n,r));return new $n(i,G.empty(),t)}function Ew(e){return new $n(e.readTime,e.key,Ki)}class $n{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new $n(K.min(),G.empty(),Ki)}static max(){return new $n(K.max(),G.empty(),Ki)}}function Tw(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=G.comparator(e.documentKey,t.documentKey),n!==0?n:tt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Iw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ii(e){if(e.code!==O.FAILED_PRECONDITION||e.message!==Aw)throw e;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&W(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):L.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):L.reject(n)}static resolve(t){return new L((n,r)=>{n(t)})}static reject(t){return new L((n,r)=>{r(t)})}static waitFor(t){return new L((n,r)=>{let i=0,s=0,o=!1;t.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(t){let n=L.resolve(!1);for(const r of t)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new L((r,i)=>{const s=t.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const l=c;n(t[l]).next(h=>{o[l]=h,++u,u===s&&r(o)},h=>i(h))}})}static doWhile(t,n){return new L((r,i)=>{const s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}}function Rw(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function si(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}ra.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol=-1;function ia(e){return e==null}function Io(e){return e===0&&1/e==-1/0}function Sw(e){return typeof e=="number"&&Number.isInteger(e)&&!Io(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="";function bw(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=rf(t)),t=Cw(e.get(n),t);return rf(t)}function Cw(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const s=e.charAt(i);switch(s){case"\0":n+="";break;case Yp:n+="";break;default:n+=s}}return n}function rf(e){return e+Yp+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Kn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Jp(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(t,n){this.comparator=t,this.root=n||jt.EMPTY}insert(t,n){return new Tt(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(t){return new Tt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,jt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Bs(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Bs(this.root,t,this.comparator,!1)}getReverseIterator(){return new Bs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Bs(this.root,t,this.comparator,!0)}}class Bs{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class jt{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??jt.RED,this.left=i??jt.EMPTY,this.right=s??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new jt(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return jt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw W(43730,{key:this.key,value:this.value});if(this.right.isRed())throw W(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw W(27949);return t+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw W(57766)}get value(){throw W(16141)}get color(){throw W(16727)}get left(){throw W(29726)}get right(){throw W(36894)}copy(t,n,r,i,s){return this}insert(t,n,r){return new jt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(t){this.comparator=t,this.data=new Tt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new of(this.data.getIterator())}getIteratorFrom(t){return new of(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Mt)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Mt(this.comparator);return n.data=t,n}}class of{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(t){this.fields=t,t.sort(zt.comparator)}static empty(){return new Ie([])}unionWith(t){let n=new Mt(zt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Ie(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return jr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Zp("Invalid base64 string: "+s):s}}(t);return new Ht(n)}static fromUint8Array(t){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new Ht(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return tt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ht.EMPTY_BYTE_STRING=new Ht("");const Pw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qn(e){if(ut(!!e,39018),typeof e=="string"){let t=0;const n=Pw.exec(e);if(ut(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:bt(e.seconds),nanos:bt(e.nanos)}}function bt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function jn(e){return typeof e=="string"?Ht.fromBase64String(e):Ht.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tg="server_timestamp",eg="__type__",ng="__previous_value__",rg="__local_write_time__";function Ml(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[eg])===null||n===void 0?void 0:n.stringValue)===tg}function sa(e){const t=e.mapValue.fields[ng];return Ml(t)?sa(t):t}function Qi(e){const t=qn(e.mapValue.fields[rg].timestampValue);return new yt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(t,n,r,i,s,o,u,c,l,h){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=h}}const Ro="(default)";class Xi{constructor(t,n){this.projectId=t,this.database=n||Ro}static empty(){return new Xi("","")}get isDefaultDatabase(){return this.database===Ro}isEqual(t){return t instanceof Xi&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig="__type__",Vw="__max__",$s={mapValue:{}},sg="__vector__",So="value";function zn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ml(e)?4:Dw(e)?9007199254740991:Nw(e)?10:11:W(28295,{value:e})}function on(e,t){if(e===t)return!0;const n=zn(e);if(n!==zn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Qi(e).isEqual(Qi(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=qn(i.timestampValue),u=qn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return jn(i.bytesValue).isEqual(jn(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return bt(i.geoPointValue.latitude)===bt(s.geoPointValue.latitude)&&bt(i.geoPointValue.longitude)===bt(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return bt(i.integerValue)===bt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=bt(i.doubleValue),u=bt(s.doubleValue);return o===u?Io(o)===Io(u):isNaN(o)&&isNaN(u)}return!1}(e,t);case 9:return jr(e.arrayValue.values||[],t.arrayValue.values||[],on);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(sf(o)!==sf(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!on(o[c],u[c])))return!1;return!0}(e,t);default:return W(52216,{left:e})}}function Yi(e,t){return(e.values||[]).find(n=>on(n,t))!==void 0}function zr(e,t){if(e===t)return 0;const n=zn(e),r=zn(t);if(n!==r)return tt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tt(e.booleanValue,t.booleanValue);case 2:return function(s,o){const u=bt(s.integerValue||s.doubleValue),c=bt(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(e,t);case 3:return af(e.timestampValue,t.timestampValue);case 4:return af(Qi(e),Qi(t));case 5:return Ru(e.stringValue,t.stringValue);case 6:return function(s,o){const u=jn(s),c=jn(o);return u.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let l=0;l<u.length&&l<c.length;l++){const h=tt(u[l],c[l]);if(h!==0)return h}return tt(u.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const u=tt(bt(s.latitude),bt(o.latitude));return u!==0?u:tt(bt(s.longitude),bt(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return uf(e.arrayValue,t.arrayValue);case 10:return function(s,o){var u,c,l,h;const d=s.fields||{},p=o.fields||{},m=(u=d[So])===null||u===void 0?void 0:u.arrayValue,_=(c=p[So])===null||c===void 0?void 0:c.arrayValue,E=tt(((l=m==null?void 0:m.values)===null||l===void 0?void 0:l.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:uf(m,_)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===$s.mapValue&&o===$s.mapValue)return 0;if(s===$s.mapValue)return 1;if(o===$s.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),l=o.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const p=Ru(c[d],h[d]);if(p!==0)return p;const m=zr(u[c[d]],l[h[d]]);if(m!==0)return m}return tt(c.length,h.length)}(e.mapValue,t.mapValue);default:throw W(23264,{le:n})}}function af(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return tt(e,t);const n=qn(e),r=qn(t),i=tt(n.seconds,r.seconds);return i!==0?i:tt(n.nanos,r.nanos)}function uf(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=zr(n[i],r[i]);if(s)return s}return tt(n.length,r.length)}function Hr(e){return Su(e)}function Su(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=qn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return jn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return G.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Su(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Su(n.fields[o])}`;return i+"}"}(e.mapValue):W(61005,{value:e})}function Zs(e){switch(zn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=sa(e);return t?16+Zs(t):16;case 5:return 2*e.stringValue.length;case 6:return jn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Zs(s),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return Kn(r.fields,(s,o)=>{i+=s.length+Zs(o)}),i}(e.mapValue);default:throw W(13486,{value:e})}}function lf(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function bu(e){return!!e&&"integerValue"in e}function Ll(e){return!!e&&"arrayValue"in e}function cf(e){return!!e&&"nullValue"in e}function hf(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function to(e){return!!e&&"mapValue"in e}function Nw(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[ig])===null||n===void 0?void 0:n.stringValue)===sg}function Bi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Kn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=Bi(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Bi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Dw(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Vw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(t){this.value=t}static empty(){return new fe({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!to(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Bi(n)}setAll(t){let n=zt.emptyPath(),r={},i=[];t.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=Bi(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){const n=this.field(t.popLast());to(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return on(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];to(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){Kn(n,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new fe(Bi(this.value))}}function og(e){const t=[];return Kn(e.fields,(n,r)=>{const i=new zt([n]);if(to(r)){const s=og(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new Ie(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(t,n,r,i,s,o,u){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(t){return new te(t,0,K.min(),K.min(),K.min(),fe.empty(),0)}static newFoundDocument(t,n,r,i){return new te(t,1,n,K.min(),r,i,0)}static newNoDocument(t,n){return new te(t,2,n,K.min(),K.min(),fe.empty(),0)}static newUnknownDocument(t,n){return new te(t,3,n,K.min(),K.min(),fe.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=fe.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=fe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof te&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new te(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(t,n){this.position=t,this.inclusive=n}}function ff(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=zr(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function df(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!on(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(t,n="asc"){this.field=t,this.dir=n}}function kw(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{}class Nt extends ag{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new Mw(t,n,r):n==="array-contains"?new Uw(t,r):n==="in"?new Bw(t,r):n==="not-in"?new $w(t,r):n==="array-contains-any"?new qw(t,r):new Nt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new Lw(t,r):new Fw(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(zr(n,this.value)):n!==null&&zn(this.value)===zn(n)&&this.matchesComparison(zr(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fe extends ag{constructor(t,n){super(),this.filters=t,this.op=n,this.he=null}static create(t,n){return new Fe(t,n)}matches(t){return ug(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ug(e){return e.op==="and"}function lg(e){return Ow(e)&&ug(e)}function Ow(e){for(const t of e.filters)if(t instanceof Fe)return!1;return!0}function Cu(e){if(e instanceof Nt)return e.field.canonicalString()+e.op.toString()+Hr(e.value);if(lg(e))return e.filters.map(t=>Cu(t)).join(",");{const t=e.filters.map(n=>Cu(n)).join(",");return`${e.op}(${t})`}}function cg(e,t){return e instanceof Nt?function(r,i){return i instanceof Nt&&r.op===i.op&&r.field.isEqual(i.field)&&on(r.value,i.value)}(e,t):e instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&cg(o,i.filters[u]),!0):!1}(e,t):void W(19439)}function hg(e){return e instanceof Nt?function(n){return`${n.field.canonicalString()} ${n.op} ${Hr(n.value)}`}(e):e instanceof Fe?function(n){return n.op.toString()+" {"+n.getFilters().map(hg).join(" ,")+"}"}(e):"Filter"}class Mw extends Nt{constructor(t,n,r){super(t,n,r),this.key=G.fromName(r.referenceValue)}matches(t){const n=G.comparator(t.key,this.key);return this.matchesComparison(n)}}class Lw extends Nt{constructor(t,n){super(t,"in",n),this.keys=fg("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class Fw extends Nt{constructor(t,n){super(t,"not-in",n),this.keys=fg("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function fg(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class Uw extends Nt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return Ll(n)&&Yi(n.arrayValue,this.value)}}class Bw extends Nt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Yi(this.value.arrayValue,n)}}class $w extends Nt{constructor(t,n){super(t,"not-in",n)}matches(t){if(Yi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Yi(this.value.arrayValue,n)}}class qw extends Nt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!Ll(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Yi(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(t,n=null,r=[],i=[],s=null,o=null,u=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.Pe=null}}function pf(e,t=null,n=[],r=[],i=null,s=null,o=null){return new jw(e,t,n,r,i,s,o)}function Fl(e){const t=Q(e);if(t.Pe===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>Cu(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ia(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Hr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Hr(r)).join(",")),t.Pe=n}return t.Pe}function Ul(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!kw(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!cg(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!df(e.startAt,t.startAt)&&df(e.endAt,t.endAt)}function Pu(e){return G.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(t,n=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function zw(e,t,n,r,i,s,o,u){return new oi(e,t,n,r,i,s,o,u)}function Bl(e){return new oi(e)}function gf(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function dg(e){return e.collectionGroup!==null}function $i(e){const t=Q(e);if(t.Te===null){t.Te=[];const n=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Mt(zt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(u=u.add(l.field))})}),u})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Te.push(new Ji(s,r))}),n.has(zt.keyField().canonicalString())||t.Te.push(new Ji(zt.keyField(),r))}return t.Te}function Ye(e){const t=Q(e);return t.Ie||(t.Ie=Hw(t,$i(e))),t.Ie}function Hw(e,t){if(e.limitType==="F")return pf(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ji(i.field,s)});const n=e.endAt?new bo(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new bo(e.startAt.position,e.startAt.inclusive):null;return pf(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function xu(e,t){const n=e.filters.concat([t]);return new oi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Co(e,t,n){return new oi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function oa(e,t){return Ul(Ye(e),Ye(t))&&e.limitType===t.limitType}function pg(e){return`${Fl(Ye(e))}|lt:${e.limitType}`}function Dr(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>hg(i)).join(", ")}]`),ia(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Hr(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Hr(i)).join(",")),`Target(${r})`}(Ye(e))}; limitType=${e.limitType})`}function aa(e,t){return t.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(const s of $i(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,u,c){const l=ff(o,u,c);return o.inclusive?l<=0:l<0}(r.startAt,$i(r),i)||r.endAt&&!function(o,u,c){const l=ff(o,u,c);return o.inclusive?l>=0:l>0}(r.endAt,$i(r),i))}(e,t)}function Gw(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function gg(e){return(t,n)=>{let r=!1;for(const i of $i(e)){const s=Ww(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Ww(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(s,o,u){const c=o.data.field(s),l=u.data.field(s);return c!==null&&l!==null?zr(c,l):W(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return W(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Kn(this.inner,(n,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return Jp(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=new Tt(G.comparator);function Tn(){return Kw}const mg=new Tt(G.comparator);function bi(...e){let t=mg;for(const n of e)t=t.insert(n.key,n);return t}function _g(e){let t=mg;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function sr(){return qi()}function yg(){return qi()}function qi(){return new wr(e=>e.toString(),(e,t)=>e.isEqual(t))}const Qw=new Tt(G.comparator),Xw=new Mt(G.comparator);function et(...e){let t=Xw;for(const n of e)t=t.add(n);return t}const Yw=new Mt(tt);function Jw(){return Yw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Io(t)?"-0":t}}function vg(e){return{integerValue:""+e}}function Zw(e,t){return Sw(t)?vg(t):$l(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(){this._=void 0}}function tE(e,t,n){return e instanceof Po?function(i,s){const o={fields:{[eg]:{stringValue:tg},[rg]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ml(s)&&(s=sa(s)),s&&(o.fields[ng]=s),{mapValue:o}}(n,t):e instanceof Zi?Eg(e,t):e instanceof ts?Tg(e,t):function(i,s){const o=wg(i,s),u=mf(o)+mf(i.Ee);return bu(o)&&bu(i.Ee)?vg(u):$l(i.serializer,u)}(e,t)}function eE(e,t,n){return e instanceof Zi?Eg(e,t):e instanceof ts?Tg(e,t):n}function wg(e,t){return e instanceof xo?function(r){return bu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}class Po extends ua{}class Zi extends ua{constructor(t){super(),this.elements=t}}function Eg(e,t){const n=Ag(t);for(const r of e.elements)n.some(i=>on(i,r))||n.push(r);return{arrayValue:{values:n}}}class ts extends ua{constructor(t){super(),this.elements=t}}function Tg(e,t){let n=Ag(t);for(const r of e.elements)n=n.filter(i=>!on(i,r));return{arrayValue:{values:n}}}class xo extends ua{constructor(t,n){super(),this.serializer=t,this.Ee=n}}function mf(e){return bt(e.integerValue||e.doubleValue)}function Ag(e){return Ll(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function nE(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof Zi&&i instanceof Zi||r instanceof ts&&i instanceof ts?jr(r.elements,i.elements,on):r instanceof xo&&i instanceof xo?on(r.Ee,i.Ee):r instanceof Po&&i instanceof Po}(e.transform,t.transform)}class rE{constructor(t,n){this.version=t,this.transformResults=n}}class Je{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Je}static exists(t){return new Je(void 0,t)}static updateTime(t){return new Je(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function eo(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class la{}function Ig(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Sg(e.key,Je.none()):new hs(e.key,e.data,Je.none());{const n=e.data,r=fe.empty();let i=new Mt(zt.comparator);for(let s of t.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Qn(e.key,r,new Ie(i.toArray()),Je.none())}}function iE(e,t,n){e instanceof hs?function(i,s,o){const u=i.value.clone(),c=yf(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,n):e instanceof Qn?function(i,s,o){if(!eo(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=yf(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Rg(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function ji(e,t,n,r){return e instanceof hs?function(s,o,u,c){if(!eo(s.precondition,o))return u;const l=s.value.clone(),h=vf(s.fieldTransforms,c,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(e,t,n,r):e instanceof Qn?function(s,o,u,c){if(!eo(s.precondition,o))return u;const l=vf(s.fieldTransforms,c,o),h=o.data;return h.setAll(Rg(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,r):function(s,o,u){return eo(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(e,t,n)}function sE(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),s=wg(r.transform,i||null);s!=null&&(n===null&&(n=fe.empty()),n.set(r.field,s))}return n||null}function _f(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&jr(r,i,(s,o)=>nE(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class hs extends la{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Qn extends la{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Rg(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function yf(e,t,n){const r=new Map;ut(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,u=t.data.field(s.field);r.set(s.field,eE(o,u,n[i]))}return r}function vf(e,t,n){const r=new Map;for(const i of e){const s=i.transform,o=n.data.field(i.field);r.set(i.field,tE(s,o,t))}return r}class Sg extends la{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oE extends la{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&iE(s,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=ji(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=ji(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=yg();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const c=Ig(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),et())}isEqual(t){return this.batchId===t.batchId&&jr(this.mutations,t.mutations,(n,r)=>_f(n,r))&&jr(this.baseMutations,t.baseMutations,(n,r)=>_f(n,r))}}class ql{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){ut(t.mutations.length===r.length,58842,{Ve:t.mutations.length,me:r.length});let i=function(){return Qw}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new ql(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt,rt;function cE(e){switch(e){case O.OK:return W(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return W(15467,{code:e})}}function bg(e){if(e===void 0)return wn("GRPC error has no .code"),O.UNKNOWN;switch(e){case Vt.OK:return O.OK;case Vt.CANCELLED:return O.CANCELLED;case Vt.UNKNOWN:return O.UNKNOWN;case Vt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Vt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Vt.INTERNAL:return O.INTERNAL;case Vt.UNAVAILABLE:return O.UNAVAILABLE;case Vt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Vt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Vt.NOT_FOUND:return O.NOT_FOUND;case Vt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Vt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Vt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Vt.ABORTED:return O.ABORTED;case Vt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Vt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Vt.DATA_LOSS:return O.DATA_LOSS;default:return W(39323,{code:e})}}(rt=Vt||(Vt={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE=new Mn([4294967295,4294967295],0);function wf(e){const t=Kp().encode(e),n=new Bp;return n.update(t),new Uint8Array(n.digest())}function Ef(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Mn([n,r],0),new Mn([i,s],0)]}class jl{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ci(`Invalid padding: ${n}`);if(r<0)throw new Ci(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Ci(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Ci(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*t.length-n,this.ge=Mn.fromNumber(this.fe)}pe(t,n,r){let i=t.add(n.multiply(Mn.fromNumber(r)));return i.compare(hE)===1&&(i=new Mn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const n=wf(t),[r,i]=Ef(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(t,n,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new jl(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(t){if(this.fe===0)return;const n=wf(t),[r,i]=Ef(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Ci extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const i=new Map;return i.set(t,fs.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new ca(K.min(),i,new Tt(tt),Tn(),et())}}class fs{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new fs(r,n,et(),et(),et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(t,n,r,i){this.Se=t,this.removedTargetIds=n,this.key=r,this.be=i}}class Cg{constructor(t,n){this.targetId=t,this.De=n}}class Pg{constructor(t,n,r=Ht.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Tf{constructor(){this.ve=0,this.Ce=Af(),this.Fe=Ht.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=et(),n=et(),r=et();return this.Ce.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:W(38017,{changeType:s})}}),new fs(this.Fe,this.Me,t,n,r)}ke(){this.xe=!1,this.Ce=Af()}qe(t,n){this.xe=!0,this.Ce=this.Ce.insert(t,n)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,ut(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class fE{constructor(t){this.We=t,this.Ge=new Map,this.ze=Tn(),this.je=qs(),this.Je=qs(),this.He=new Tt(tt)}Ye(t){for(const n of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(n,t.be):this.Xe(n,t.key,t.be);for(const n of t.removedTargetIds)this.Xe(n,t.key,t.be)}et(t){this.forEachTarget(t,n=>{const r=this.tt(n);switch(t.state){case 0:this.nt(n)&&r.Be(t.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(t.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(t.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(t.resumeToken));break;default:W(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(t){const n=t.targetId,r=t.De.count,i=this.st(n);if(i){const s=i.target;if(Pu(s))if(r===0){const o=new G(s.path);this.Xe(n,o,te.newNoDocument(o,K.min()))}else ut(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const u=this._t(t),c=u?this.ut(u,t,o):1;if(c!==0){this.rt(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,l)}}}}}_t(t){const n=t.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=jn(r).toUint8Array()}catch(c){if(c instanceof Zp)return Bn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new jl(o,i,s)}catch(c){return Bn(c instanceof Ci?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.fe===0?null:u}ut(t,n,r){return n.De.count===r-this.ht(t,n.targetId)?0:2}ht(t,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(u)||(this.Xe(n,s,null),i++)}),i}Pt(t){const n=new Map;this.Ge.forEach((s,o)=>{const u=this.st(o);if(u){if(s.current&&Pu(u.target)){const c=new G(u.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,te.newNoDocument(c,t))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=et();this.Je.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const l=this.st(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(t));const i=new ca(t,n,this.He,this.ze,r);return this.ze=Tn(),this.je=qs(),this.Je=qs(),this.He=new Tt(tt),i}Ze(t,n){if(!this.nt(t))return;const r=this.It(t,n.key)?2:0;this.tt(t).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(t)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(t))}Xe(t,n,r){if(!this.nt(t))return;const i=this.tt(t);this.It(t,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(t)),this.Je=this.Je.insert(n,this.dt(n).add(t)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(t){this.Ge.delete(t)}ot(t){const n=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let n=this.Ge.get(t);return n||(n=new Tf,this.Ge.set(t,n)),n}dt(t){let n=this.Je.get(t);return n||(n=new Mt(tt),this.Je=this.Je.insert(t,n)),n}Tt(t){let n=this.je.get(t);return n||(n=new Mt(tt),this.je=this.je.insert(t,n)),n}nt(t){const n=this.st(t)!==null;return n||j("WatchChangeAggregator","Detected inactive target",t),n}st(t){const n=this.Ge.get(t);return n&&n.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new Tf),this.We.getRemoteKeysForTarget(t).forEach(n=>{this.Xe(t,n,null)})}It(t,n){return this.We.getRemoteKeysForTarget(t).has(n)}}function qs(){return new Tt(G.comparator)}function Af(){return new Tt(G.comparator)}const dE={asc:"ASCENDING",desc:"DESCENDING"},pE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gE={and:"AND",or:"OR"};class mE{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function Vu(e,t){return e.useProto3Json||ia(t)?t:{value:t}}function Vo(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function xg(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function _E(e,t){return Vo(e,t.toTimestamp())}function Ze(e){return ut(!!e,49232),K.fromTimestamp(function(n){const r=qn(n);return new yt(r.seconds,r.nanos)}(e))}function zl(e,t){return Nu(e,t).canonicalString()}function Nu(e,t){const n=function(i){return new mt(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Vg(e){const t=mt.fromString(e);return ut(Mg(t),10190,{key:t.toString()}),t}function Du(e,t){return zl(e.databaseId,t.path)}function eu(e,t){const n=Vg(t);if(n.get(1)!==e.databaseId.projectId)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new G(Dg(n))}function Ng(e,t){return zl(e.databaseId,t)}function yE(e){const t=Vg(e);return t.length===4?mt.emptyPath():Dg(t)}function ku(e){return new mt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Dg(e){return ut(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function If(e,t,n){return{name:Du(e,t),fields:n.value.mapValue.fields}}function vE(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:W(39313,{state:l})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(l,h){return l.useProto3Json?(ut(h===void 0||typeof h=="string",58123),Ht.fromBase64String(h||"")):(ut(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Ht.fromUint8Array(h||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(l){const h=l.code===void 0?O.UNKNOWN:bg(l.code);return new q(h,l.message||"")}(o);n=new Pg(r,i,s,u||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=eu(e,r.document.name),s=Ze(r.document.updateTime),o=r.document.createTime?Ze(r.document.createTime):K.min(),u=new fe({mapValue:{fields:r.document.fields}}),c=te.newFoundDocument(i,s,o,u),l=r.targetIds||[],h=r.removedTargetIds||[];n=new no(l,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=eu(e,r.document),s=r.readTime?Ze(r.readTime):K.min(),o=te.newNoDocument(i,s),u=r.removedTargetIds||[];n=new no([],u,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=eu(e,r.document),s=r.removedTargetIds||[];n=new no([],s,i,null)}else{if(!("filter"in t))return W(11601,{At:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new lE(i,s),u=r.targetId;n=new Cg(u,o)}}return n}function wE(e,t){let n;if(t instanceof hs)n={update:If(e,t.key,t.value)};else if(t instanceof Sg)n={delete:Du(e,t.key)};else if(t instanceof Qn)n={update:If(e,t.key,t.data),updateMask:PE(t.fieldMask)};else{if(!(t instanceof oE))return W(16599,{Rt:t.type});n={verify:Du(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Po)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Zi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ts)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof xo)return{fieldPath:o.field.canonicalString(),increment:u.Ee};throw W(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_E(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W(27497)}(e,t.precondition)),n}function EE(e,t){return e&&e.length>0?(ut(t!==void 0,14353),e.map(n=>function(i,s){let o=i.updateTime?Ze(i.updateTime):Ze(s);return o.isEqual(K.min())&&(o=Ze(s)),new rE(o,i.transformResults||[])}(n,t))):[]}function TE(e,t){return{documents:[Ng(e,t.path)]}}function AE(e,t){const n={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ng(e,i);const s=function(l){if(l.length!==0)return Og(Fe.create(l,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(l){if(l.length!==0)return l.map(h=>function(p){return{field:kr(p.field),direction:SE(p.dir)}}(h))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const u=Vu(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{Vt:n,parent:i}}function IE(e){let t=yE(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ut(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let s=[];n.where&&(s=function(d){const p=kg(d);return p instanceof Fe&&lg(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(_){return new Ji(Or(_.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(p))}(n.orderBy));let u=null;n.limit&&(u=function(d){let p;return p=typeof d=="object"?d.value:d,ia(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(d){const p=!!d.before,m=d.values||[];return new bo(m,p)}(n.startAt));let l=null;return n.endAt&&(l=function(d){const p=!d.before,m=d.values||[];return new bo(m,p)}(n.endAt)),zw(t,i,o,s,u,"F",c,l)}function RE(e,t){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W(28987,{purpose:i})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function kg(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Or(n.unaryFilter.field);return Nt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Or(n.unaryFilter.field);return Nt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Or(n.unaryFilter.field);return Nt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Or(n.unaryFilter.field);return Nt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return W(61313);default:return W(60726)}}(e):e.fieldFilter!==void 0?function(n){return Nt.create(Or(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return W(58110);default:return W(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Fe.create(n.compositeFilter.filters.map(r=>kg(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W(1026)}}(n.compositeFilter.op))}(e):W(30097,{filter:e})}function SE(e){return dE[e]}function bE(e){return pE[e]}function CE(e){return gE[e]}function kr(e){return{fieldPath:e.canonicalString()}}function Or(e){return zt.fromServerFormat(e.fieldPath)}function Og(e){return e instanceof Nt?function(n){if(n.op==="=="){if(hf(n.value))return{unaryFilter:{field:kr(n.field),op:"IS_NAN"}};if(cf(n.value))return{unaryFilter:{field:kr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(hf(n.value))return{unaryFilter:{field:kr(n.field),op:"IS_NOT_NAN"}};if(cf(n.value))return{unaryFilter:{field:kr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:kr(n.field),op:bE(n.op),value:n.value}}}(e):e instanceof Fe?function(n){const r=n.getFilters().map(i=>Og(i));return r.length===1?r[0]:{compositeFilter:{op:CE(n.op),filters:r}}}(e):W(54877,{filter:e})}function PE(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Mg(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(t,n,r,i,s=K.min(),o=K.min(),u=Ht.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(t){return new Dn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new Dn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(t){this.gt=t}}function VE(e){const t=IE({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Co(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this.Dn=new DE}addToCollectionParentIndex(t,n){return this.Dn.add(n),L.resolve()}getCollectionParents(t,n){return L.resolve(this.Dn.getEntries(n))}addFieldIndex(t,n){return L.resolve()}deleteFieldIndex(t,n){return L.resolve()}deleteAllFieldIndexes(t){return L.resolve()}createTargetIndexes(t,n){return L.resolve()}getDocumentsMatchingTarget(t,n){return L.resolve(null)}getIndexType(t,n){return L.resolve(0)}getFieldIndexes(t,n){return L.resolve([])}getNextCollectionGroupToUpdate(t){return L.resolve(null)}getMinOffset(t,n){return L.resolve($n.min())}getMinOffsetFromCollectionGroup(t,n){return L.resolve($n.min())}updateCollectionGroup(t,n,r){return L.resolve()}updateIndexEntries(t,n){return L.resolve()}}class DE{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new Mt(mt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new Mt(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Lg=41943040;class he{static withCacheSize(t){return new he(t,he.DEFAULT_COLLECTION_PERCENTILE,he.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */he.DEFAULT_COLLECTION_PERCENTILE=10,he.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,he.DEFAULT=new he(Lg,he.DEFAULT_COLLECTION_PERCENTILE,he.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),he.DISABLED=new he(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Gr(0)}static ur(){return new Gr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf="LruGarbageCollector",kE=1048576;function bf([e,t],[n,r]){const i=tt(e,n);return i===0?tt(t,r):i}class OE{constructor(t){this.Tr=t,this.buffer=new Mt(bf),this.Ir=0}dr(){return++this.Ir}Er(t){const n=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();bf(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ME{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){j(Sf,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){si(n)?j(Sf,"Ignoring IndexedDB error during garbage collection: ",n):await ii(n)}await this.Rr(3e5)})}}class LE{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.mr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return L.resolve(ra.ue);const r=new OE(n);return this.Vr.forEachTarget(t,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(t,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.Vr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(Rf)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Rf):this.pr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,n){let r,i,s,o,u,c,l;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(r=d,u=Date.now(),this.removeTargets(t,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(t,r))).next(d=>(l=Date.now(),Nr()<=it.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function FE(e,t){return new LE(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this.changes=new wr(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,te.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&ji(r.mutation,i,Ie.empty(),yt.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,et()).next(()=>r))}getLocalViewOfDocuments(t,n,r=et()){const i=sr();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let o=bi();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=sr();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,et()))}populateOverlays(t,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(t,n,r,i){let s=Tn();const o=qi(),u=function(){return qi()}();return n.forEach((c,l)=>{const h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof Qn)?s=s.insert(l.key,l):h!==void 0?(o.set(l.key,h.mutation.getFieldMask()),ji(h.mutation,l,h.mutation.getFieldMask(),yt.now())):o.set(l.key,Ie.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((l,h)=>o.set(l,h)),n.forEach((l,h)=>{var d;return u.set(l,new BE(h,(d=o.get(l))!==null&&d!==void 0?d:null))}),u))}recalculateAndSaveOverlays(t,n){const r=qi();let i=new Tt((o,u)=>o-u),s=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let h=r.get(c)||Ie.empty();h=u.applyToLocalView(l,h),r.set(c,h);const d=(i.get(u.batchId)||et()).add(c);i=i.insert(u.batchId,d)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),l=c.key,h=c.value,d=yg();h.forEach(p=>{if(!s.has(p)){const m=Ig(n.get(p),r.get(p));m!==null&&d.set(p,m),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,d))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):dg(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):L.resolve(sr());let u=Ki,c=s;return o.next(l=>L.forEach(l,(h,d)=>(u<d.largestBatchId&&(u=d.largestBatchId),s.get(h)?L.resolve():this.remoteDocumentCache.getEntry(t,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(t,l,s)).next(()=>this.computeViews(t,c,l,et())).next(h=>({batchId:u,changes:_g(h)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new G(n)).next(r=>{let i=bi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const s=n.collectionGroup;let o=bi();return this.indexManager.getCollectionParents(t,s).next(u=>L.forEach(u,c=>{const l=function(d,p){return new oi(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,r,i).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(o=>{s.forEach((c,l)=>{const h=l.getKey();o.get(h)===null&&(o=o.insert(h,te.newInvalidDocument(h)))});let u=bi();return o.forEach((c,l)=>{const h=s.get(c);h!==void 0&&ji(h.mutation,l,Ie.empty(),yt.now()),aa(n,l)&&(u=u.insert(c,l))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,n){return L.resolve(this.Br.get(n))}saveBundleMetadata(t,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ze(i.createTime)}}(n)),L.resolve()}getNamedQuery(t,n){return L.resolve(this.Lr.get(n))}saveNamedQuery(t,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:VE(i.bundledQuery),readTime:Ze(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.overlays=new Tt(G.comparator),this.kr=new Map}getOverlay(t,n){return L.resolve(this.overlays.get(n))}getOverlays(t,n){const r=sr();return L.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.wt(t,n,s)}),L.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),L.resolve()}getOverlaysForCollection(t,n,r){const i=sr(),s=n.length+1,o=new G(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new Tt((l,h)=>l-h);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let h=s.get(l.largestBatchId);h===null&&(h=sr(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const u=sr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>u.set(l,h)),!(u.size()>=i)););return L.resolve(u)}wt(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new uE(n,r));let s=this.kr.get(n);s===void 0&&(s=et(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.sessionToken=Ht.EMPTY_BYTE_STRING}getSessionToken(t){return L.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(){this.qr=new Mt(Ut.Qr),this.$r=new Mt(Ut.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,n){const r=new Ut(t,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Wr(new Ut(t,n))}Gr(t,n){t.forEach(r=>this.removeReference(r,n))}zr(t){const n=new G(new mt([])),r=new Ut(n,t),i=new Ut(n,t+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const n=new G(new mt([])),r=new Ut(n,t),i=new Ut(n,t+1);let s=et();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new Ut(t,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class Ut{constructor(t,n){this.key=t,this.Hr=n}static Qr(t,n){return G.comparator(t.key,n.key)||tt(t.Hr,n.Hr)}static Ur(t,n){return tt(t.Hr,n.Hr)||G.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Mt(Ut.Qr)}checkEmpty(t){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new aE(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.Yr=this.Yr.add(new Ut(u.key,s)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return L.resolve(o)}lookupMutationBatch(t,n){return L.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?Ol:this.er-1)}getAllMutationBatches(t){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new Ut(n,0),i=new Ut(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const u=this.Zr(o.Hr);s.push(u)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Mt(tt);return n.forEach(i=>{const s=new Ut(i,0),o=new Ut(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],u=>{r=r.add(u.Hr)})}),L.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new Ut(new G(s),0);let u=new Mt(tt);return this.Yr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(u=u.add(c.Hr)),!0)},o),L.resolve(this.ei(u))}ei(t){const n=[];return t.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){ut(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return L.forEach(n.mutations,i=>{const s=new Ut(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Yr=r})}rr(t){}containsKey(t,n){const r=new Ut(n,0),i=this.Yr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,L.resolve()}ti(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(t){this.ni=t,this.docs=function(){return new Tt(G.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():te.newInvalidDocument(n))}getEntries(t,n){let r=Tn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():te.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=Tn();const o=n.path,u=new G(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:l,value:{document:h}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Tw(Ew(h),r)<=0||(i.has(h.key)||aa(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(t,n,r,i){W(9500)}ri(t,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new WE(this)}getSize(t){return L.resolve(this.size)}}class WE extends UE{constructor(t){super(),this.Or=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(t,i)):this.Or.removeEntry(r)}),L.waitFor(n)}getFromCache(t,n){return this.Or.getEntry(t,n)}getAllFromCache(t,n){return this.Or.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(t){this.persistence=t,this.ii=new wr(n=>Fl(n),Ul),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.si=0,this.oi=new Hl,this.targetCount=0,this._i=Gr.ar()}forEachTarget(t,n){return this.ii.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(t){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return L.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),L.resolve()}hr(t){this.ii.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this._i=new Gr(n),this.highestTargetId=n),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,n){return this.hr(n),this.targetCount+=1,L.resolve()}updateTargetData(t,n){return this.hr(n),L.resolve()}removeTargetData(t,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(t,n,r){let i=0;const s=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(t){return L.resolve(this.targetCount)}getTargetData(t,n){const r=this.ii.get(n)||null;return L.resolve(r)}addMatchingKeys(t,n,r){return this.oi.Kr(n,r),L.resolve()}removeMatchingKeys(t,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.oi.zr(n),L.resolve()}getMatchingKeysForTargetId(t,n){const r=this.oi.Jr(n);return L.resolve(r)}containsKey(t,n){return L.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(t,n){this.ai={},this.overlays={},this.ui=new ra(0),this.ci=!1,this.ci=!0,this.li=new zE,this.referenceDelegate=t(this),this.hi=new KE(this),this.indexManager=new NE,this.remoteDocumentCache=function(i){return new GE(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new xE(n),this.Ti=new qE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new jE,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ai[t.toKey()];return r||(r=new HE(n,this.referenceDelegate),this.ai[t.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,n,r){j("MemoryPersistence","Starting transaction:",t);const i=new QE(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(t,n){return L.or(Object.values(this.ai).map(r=>()=>r.containsKey(t,n)))}}class QE extends Iw{constructor(t){super(),this.currentSequenceNumber=t}}class Gl{constructor(t){this.persistence=t,this.Ai=new Hl,this.Ri=null}static Vi(t){return new Gl(t)}get mi(){if(this.Ri)return this.Ri;throw W(60996)}addReference(t,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),L.resolve()}removeReference(t,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(t,n){return this.mi.add(n.toString()),L.resolve()}removeTarget(t,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ii(){this.Ri=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.mi,r=>{const i=G.fromPath(r);return this.fi(t,i).next(s=>{s||n.removeEntry(i,K.min())})}).next(()=>(this.Ri=null,n.apply(t)))}updateLimboDocument(t,n){return this.fi(t,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(t){return 0}fi(t,n){return L.or([()=>L.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class No{constructor(t,n){this.persistence=t,this.gi=new wr(r=>bw(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=FE(this,n)}static Vi(t,n){return new No(t,n)}Ii(){}di(t){return L.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}mr(t){const n=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}yr(t){let n=0;return this.gr(t,r=>{n++}).next(()=>n)}gr(t,n){return L.forEach(this.gi,(r,i)=>this.Sr(t,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(t,o=>this.Sr(t,o,n).next(u=>{u||(r++,s.removeEntry(o,K.min()))})).next(()=>s.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}removeReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}updateLimboDocument(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}Pi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=Zs(t.data.value)),n}Sr(t,n,r){return L.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.gi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.Is=r,this.ds=i}static Es(t,n){let r=et(),i=et();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Wl(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return jv()?8:Rw($v())>0?6:4}()}initialize(t,n){this.gs=t,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(t,n,r,i){const s={result:null};return this.ps(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(t,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new XE;return this.ws(t,n,o).next(u=>{if(s.result=u,this.Rs)return this.Ss(t,n,o,u.size)})}).next(()=>s.result)}Ss(t,n,r,i){return r.documentReadCount<this.Vs?(Nr()<=it.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",Dr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),L.resolve()):(Nr()<=it.DEBUG&&j("QueryEngine","Query:",Dr(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Nr()<=it.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",Dr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ye(n))):L.resolve())}ps(t,n){if(gf(n))return L.resolve(null);let r=Ye(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Co(n,null,"F"),r=Ye(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const o=et(...s);return this.gs.getDocuments(t,o).next(u=>this.indexManager.getMinOffset(t,r).next(c=>{const l=this.bs(n,u);return this.Ds(n,l,o,c.readTime)?this.ps(t,Co(n,null,"F")):this.vs(t,l,n,c)}))})))}ys(t,n,r,i){return gf(n)||i.isEqual(K.min())?L.resolve(null):this.gs.getDocuments(t,r).next(s=>{const o=this.bs(n,s);return this.Ds(n,o,r,i)?L.resolve(null):(Nr()<=it.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Dr(n)),this.vs(t,o,n,ww(i,Ki)).next(u=>u))})}bs(t,n){let r=new Mt(gg(t));return n.forEach((i,s)=>{aa(t,s)&&(r=r.add(s))}),r}Ds(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(t,n,r){return Nr()<=it.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Dr(n)),this.gs.getDocumentsMatchingQuery(t,n,$n.min(),r)}vs(t,n,r,i){return this.gs.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kl="LocalStore",JE=3e8;class ZE{constructor(t,n,r,i){this.persistence=t,this.Cs=n,this.serializer=i,this.Fs=new Tt(tt),this.Ms=new wr(s=>Fl(s),Ul),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(r)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new $E(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Fs))}}function tT(e,t,n,r){return new ZE(e,t,n,r)}async function Ug(e,t){const n=Q(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=et();for(const l of i){o.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}for(const l of s){u.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Bs:l,removedBatchIds:o,addedBatchIds:u}))})})}function eT(e,t){const n=Q(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,c,l,h){const d=l.batch,p=d.keys();let m=L.resolve();return p.forEach(_=>{m=m.next(()=>h.getEntry(c,_)).next(E=>{const v=l.docVersions.get(_);ut(v!==null,48541),E.version.compareTo(v)<0&&(d.applyToRemoteDocument(E,l),E.isValidDocument()&&(E.setReadTime(l.commitVersion),h.addEntry(E)))})}),m.next(()=>u.mutationQueue.removeMutationBatch(c,d))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=et();for(let l=0;l<u.mutationResults.length;++l)u.mutationResults[l].transformResults.length>0&&(c=c.add(u.batch.mutations[l].key));return c}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function Bg(e){const t=Q(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.hi.getLastRemoteSnapshotVersion(n))}function nT(e,t){const n=Q(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const u=[];t.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;u.push(n.hi.removeMatchingKeys(s,h.removedDocuments,d).next(()=>n.hi.addMatchingKeys(s,h.addedDocuments,d)));let m=p.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(Ht.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,r)),i=i.insert(d,m),function(E,v,P){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=JE?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(p,m,h)&&u.push(n.hi.updateTargetData(s,m))});let c=Tn(),l=et();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),u.push(rT(s,o,t.documentUpdates).next(h=>{c=h.Ls,l=h.ks})),!r.isEqual(K.min())){const h=n.hi.getLastRemoteSnapshotVersion(s).next(d=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(h)}return L.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.Fs=i,s))}function rT(e,t,n){let r=et(),i=et();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let o=Tn();return n.forEach((u,c)=>{const l=s.get(u);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(K.min())?(t.removeEntry(u,c.readTime),o=o.insert(u,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(u,c)):j(Kl,"Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function iT(e,t){const n=Q(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=Ol),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function sT(e,t){const n=Q(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,t).next(s=>s?(i=s,L.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new Dn(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(t,r.targetId)),r})}async function Ou(e,t,n){const r=Q(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!si(o))throw o;j(Kl,`Failed to update sequence numbers for target ${t}: ${o}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function Cf(e,t,n){const r=Q(e);let i=K.min(),s=et();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,h){const d=Q(c),p=d.Ms.get(h);return p!==void 0?L.resolve(d.Fs.get(p)):d.hi.getTargetData(l,h)}(r,o,Ye(t)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,t,n?i:K.min(),n?s:et())).next(u=>(oT(r,Gw(t),u),{documents:u,qs:s})))}function oT(e,t,n){let r=e.xs.get(t)||K.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.xs.set(t,r)}class Pf{constructor(){this.activeTargetIds=Jw()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class aT{constructor(){this.Fo=new Pf,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,n,r){this.Mo[t]=n}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new Pf,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xf="ConnectivityMonitor";class Vf{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){j(xf,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){j(xf,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let js=null;function Mu(){return js===null?js=function(){return 268435456+Math.round(2147483648*Math.random())}():js++,"0x"+js.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nu="RestConnection",lT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cT{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Ro?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,n,r,i,s){const o=Mu(),u=this.Go(t,n.toUriEncodedString());j(nu,`Sending RPC '${t}' ${o}:`,u,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);const{host:l}=new URL(u),h=Vl(l);return this.jo(t,u,c,r,h).then(d=>(j(nu,`Received RPC '${t}' ${o}: `,d),d),d=>{throw Bn(nu,`RPC '${t}' ${o} failed with error: `,d,"url: ",u,"request:",r),d})}Jo(t,n,r,i,s,o){return this.Wo(t,n,r,i,s)}zo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ri}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}Go(t,n){const r=lT[t];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="WebChannelConnection";class fT extends cT{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,n,r,i,s){const o=Mu();return new Promise((u,c)=>{const l=new $p;l.setWithCredentials(!0),l.listenOnce(qp.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Js.NO_ERROR:const d=l.getResponseJson();j(Jt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),u(d);break;case Js.TIMEOUT:j(Jt,`RPC '${t}' ${o} timed out`),c(new q(O.DEADLINE_EXCEEDED,"Request time out"));break;case Js.HTTP_ERROR:const p=l.getStatus();if(j(Jt,`RPC '${t}' ${o} failed with status:`,p,"response text:",l.getResponseText()),p>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const E=function(P){const b=P.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(b)>=0?b:O.UNKNOWN}(_.status);c(new q(E,_.message))}else c(new q(O.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new q(O.UNAVAILABLE,"Connection failed."));break;default:W(9055,{c_:t,streamId:o,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{j(Jt,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);j(Jt,`RPC '${t}' ${o} sending request:`,i),l.send(n,"POST",h,r,15)})}P_(t,n,r){const i=Mu(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Hp(),u=zp(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=s.join("");j(Jt,`Creating RPC '${t}' stream ${i}: ${h}`,c);const d=o.createWebChannel(h,c);this.T_(d);let p=!1,m=!1;const _=new hT({Ho:v=>{m?j(Jt,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(p||(j(Jt,`Opening RPC '${t}' stream ${i} transport.`),d.open(),p=!0),j(Jt,`RPC '${t}' stream ${i} sending:`,v),d.send(v))},Yo:()=>d.close()}),E=(v,P,b)=>{v.listen(P,N=>{try{b(N)}catch(x){setTimeout(()=>{throw x},0)}})};return E(d,Si.EventType.OPEN,()=>{m||(j(Jt,`RPC '${t}' stream ${i} transport opened.`),_.s_())}),E(d,Si.EventType.CLOSE,()=>{m||(m=!0,j(Jt,`RPC '${t}' stream ${i} transport closed`),_.__(),this.I_(d))}),E(d,Si.EventType.ERROR,v=>{m||(m=!0,Bn(Jt,`RPC '${t}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),_.__(new q(O.UNAVAILABLE,"The operation could not be completed")))}),E(d,Si.EventType.MESSAGE,v=>{var P;if(!m){const b=v.data[0];ut(!!b,16349);const N=b,x=(N==null?void 0:N.error)||((P=N[0])===null||P===void 0?void 0:P.error);if(x){j(Jt,`RPC '${t}' stream ${i} received error:`,x);const M=x.status;let U=function(T){const S=Vt[T];if(S!==void 0)return bg(S)}(M),I=x.message;U===void 0&&(U=O.INTERNAL,I="Unknown error status: "+M+" with message "+x.message),m=!0,_.__(new q(U,I)),d.close()}else j(Jt,`RPC '${t}' stream ${i} received:`,b),_.a_(b)}}),E(u,jp.STAT_EVENT,v=>{v.stat===Iu.PROXY?j(Jt,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===Iu.NOPROXY&&j(Jt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.o_()},0),_}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(n=>n===t)}}function ru(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(e){return new mE(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(t,n,r=1e3,i=1.5,s=6e4){this.Fi=t,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&j("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="PersistentStream";class qg{constructor(t,n,r,i,s,o,u,c){this.Fi=t,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new $g(t,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():n&&n.code===O.RESOURCE_EXHAUSTED?(wn(n.toString()),wn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(n)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{t(()=>{const i=new q(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(t,n){const r=this.K_(this.b_);this.stream=this.z_(t,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return j(Nf,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return n=>{this.Fi.enqueueAndForget(()=>this.b_===t?n():(j(Nf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dT extends qg{constructor(t,n,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(t,n){return this.connection.P_("Listen",t,n)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const n=vE(this.serializer,t),r=function(s){if(!("targetChange"in s))return K.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?K.min():o.readTime?Ze(o.readTime):K.min()}(t);return this.listener.J_(n,r)}H_(t){const n={};n.database=ku(this.serializer),n.addTarget=function(s,o){let u;const c=o.target;if(u=Pu(c)?{documents:TE(s,c)}:{query:AE(s,c).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=xg(s,o.resumeToken);const l=Vu(s,o.expectedCount);l!==null&&(u.expectedCount=l)}else if(o.snapshotVersion.compareTo(K.min())>0){u.readTime=Vo(s,o.snapshotVersion.toTimestamp());const l=Vu(s,o.expectedCount);l!==null&&(u.expectedCount=l)}return u}(this.serializer,t);const r=RE(this.serializer,t);r&&(n.labels=r),this.k_(n)}Y_(t){const n={};n.database=ku(this.serializer),n.removeTarget=t,this.k_(n)}}class pT extends qg{constructor(t,n,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,n){return this.connection.P_("Write",t,n)}j_(t){return ut(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ut(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){ut(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const n=EE(t.writeResults,t.commitTime),r=Ze(t.commitTime);return this.listener.ta(r,n)}na(){const t={};t.database=ku(this.serializer),this.k_(t)}X_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>wE(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{}class mT extends gT{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,Nu(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(O.UNKNOWN,s.toString())})}Jo(t,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(t,Nu(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(O.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class _T{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(wn(n),this._a=!1):j("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr="RemoteStore";class yT{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Er(this)&&(j(pr,"Restarting streams for network reachability change."),await async function(c){const l=Q(c);l.Ia.add(4),await ds(l),l.Aa.set("Unknown"),l.Ia.delete(4),await fa(l)}(this))})}),this.Aa=new _T(r,i)}}async function fa(e){if(Er(e))for(const t of e.da)await t(!0)}async function ds(e){for(const t of e.da)await t(!1)}function jg(e,t){const n=Q(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),Jl(n)?Yl(n):ai(n).x_()&&Xl(n,t))}function Ql(e,t){const n=Q(e),r=ai(n);n.Ta.delete(t),r.x_()&&zg(n,t),n.Ta.size===0&&(r.x_()?r.B_():Er(n)&&n.Aa.set("Unknown"))}function Xl(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(K.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ai(e).H_(t)}function zg(e,t){e.Ra.$e(t),ai(e).Y_(t)}function Yl(e){e.Ra=new fE({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),ai(e).start(),e.Aa.aa()}function Jl(e){return Er(e)&&!ai(e).M_()&&e.Ta.size>0}function Er(e){return Q(e).Ia.size===0}function Hg(e){e.Ra=void 0}async function vT(e){e.Aa.set("Online")}async function wT(e){e.Ta.forEach((t,n)=>{Xl(e,t)})}async function ET(e,t){Hg(e),Jl(e)?(e.Aa.la(t),Yl(e)):e.Aa.set("Unknown")}async function TT(e,t,n){if(e.Aa.set("Online"),t instanceof Pg&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.Ta.delete(u),i.Ra.removeTarget(u))}(e,t)}catch(r){j(pr,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Do(e,r)}else if(t instanceof no?e.Ra.Ye(t):t instanceof Cg?e.Ra.it(t):e.Ra.et(t),!n.isEqual(K.min()))try{const r=await Bg(e.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Ra.Pt(o);return u.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.Ta.get(l);h&&s.Ta.set(l,h.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,l)=>{const h=s.Ta.get(c);if(!h)return;s.Ta.set(c,h.withResumeToken(Ht.EMPTY_BYTE_STRING,h.snapshotVersion)),zg(s,c);const d=new Dn(h.target,c,l,h.sequenceNumber);Xl(s,d)}),s.remoteSyncer.applyRemoteEvent(u)}(e,n)}catch(r){j(pr,"Failed to raise snapshot:",r),await Do(e,r)}}async function Do(e,t,n){if(!si(t))throw t;e.Ia.add(1),await ds(e),e.Aa.set("Offline"),n||(n=()=>Bg(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{j(pr,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await fa(e)})}function Gg(e,t){return t().catch(n=>Do(e,n,t))}async function da(e){const t=Q(e),n=Hn(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Ol;for(;AT(t);)try{const i=await iT(t.localStore,r);if(i===null){t.Pa.length===0&&n.B_();break}r=i.batchId,IT(t,i)}catch(i){await Do(t,i)}Wg(t)&&Kg(t)}function AT(e){return Er(e)&&e.Pa.length<10}function IT(e,t){e.Pa.push(t);const n=Hn(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function Wg(e){return Er(e)&&!Hn(e).M_()&&e.Pa.length>0}function Kg(e){Hn(e).start()}async function RT(e){Hn(e).na()}async function ST(e){const t=Hn(e);for(const n of e.Pa)t.X_(n.mutations)}async function bT(e,t,n){const r=e.Pa.shift(),i=ql.from(r,t,n);await Gg(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await da(e)}async function CT(e,t){t&&Hn(e).Z_&&await async function(r,i){if(function(o){return cE(o)&&o!==O.ABORTED}(i.code)){const s=r.Pa.shift();Hn(r).N_(),await Gg(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await da(r)}}(e,t),Wg(e)&&Kg(e)}async function Df(e,t){const n=Q(e);n.asyncQueue.verifyOperationInProgress(),j(pr,"RemoteStore received new credentials");const r=Er(n);n.Ia.add(3),await ds(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await fa(n)}async function PT(e,t){const n=Q(e);t?(n.Ia.delete(2),await fa(n)):t||(n.Ia.add(2),await ds(n),n.Aa.set("Unknown"))}function ai(e){return e.Va||(e.Va=function(n,r,i){const s=Q(n);return s.ia(),new dT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:vT.bind(null,e),e_:wT.bind(null,e),n_:ET.bind(null,e),J_:TT.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),Jl(e)?Yl(e):e.Aa.set("Unknown")):(await e.Va.stop(),Hg(e))})),e.Va}function Hn(e){return e.ma||(e.ma=function(n,r,i){const s=Q(n);return s.ia(),new pT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:RT.bind(null,e),n_:CT.bind(null,e),ea:ST.bind(null,e),ta:bT.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await da(e)):(await e.ma.stop(),e.Pa.length>0&&(j(pr,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){const o=Date.now()+r,u=new Zl(t,n,o,i,s);return u.start(r),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(O.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tc(e,t){if(wn("AsyncQueue",`${t}: ${e}`),si(e))return new q(O.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{static emptySet(t){return new Br(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=bi(),this.sortedSet=new Tt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Br)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new Br;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(){this.fa=new Tt(G.comparator)}track(t){const n=t.doc.key,r=this.fa.get(n);r?t.type!==0&&r.type===3?this.fa=this.fa.insert(n,t):t.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.fa=this.fa.remove(n):t.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):W(63341,{At:t,ga:r}):this.fa=this.fa.insert(n,t)}pa(){const t=[];return this.fa.inorderTraversal((n,r)=>{t.push(r)}),t}}class Wr{constructor(t,n,r,i,s,o,u,c,l){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new Wr(t,n,Br.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&oa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class VT{constructor(){this.queries=Of(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=Q(n),s=i.queries;i.queries=Of(),s.forEach((o,u)=>{for(const c of u.wa)c.onError(r)})})(this,new q(O.ABORTED,"Firestore shutting down"))}}function Of(){return new wr(e=>pg(e),oa)}async function Qg(e,t){const n=Q(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new xT,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=tc(o,`Initialization of query '${Dr(t.query)}' failed`);return void t.onError(u)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&ec(n)}async function Xg(e,t){const n=Q(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const o=s.wa.indexOf(t);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function NT(e,t){const n=Q(e);let r=!1;for(const i of t){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.wa)u.Ca(i)&&(r=!0);o.ya=i}}r&&ec(n)}function DT(e,t,n){const r=Q(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function ec(e){e.Da.forEach(t=>{t.next()})}var Lu,Mf;(Mf=Lu||(Lu={})).Fa="default",Mf.Cache="cache";class Yg{constructor(t,n,r){this.query=t,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new Wr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),n=!0):this.Ba(t,this.onlineState)&&(this.La(t),n=!0),this.Oa=t,n}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),n=!0),n}Ba(t,n){if(!t.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(t){t=Wr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==Lu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(t){this.key=t}}class Zg{constructor(t){this.key=t}}class kT{constructor(t,n){this.query=t,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=et(),this.mutatedKeys=et(),this.Xa=gg(t),this.eu=new Br(this.Xa)}get tu(){return this.Ha}nu(t,n){const r=n?n.ru:new kf,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const p=i.get(h),m=aa(this.query,d)?d:null,_=!!p&&this.mutatedKeys.has(p.key),E=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let v=!1;p&&m?p.data.isEqual(m.data)?_!==E&&(r.track({type:3,doc:m}),v=!0):this.iu(p,m)||(r.track({type:2,doc:m}),v=!0,(c&&this.Xa(m,c)>0||l&&this.Xa(m,l)<0)&&(u=!0)):!p&&m?(r.track({type:0,doc:m}),v=!0):p&&!m&&(r.track({type:1,doc:p}),v=!0,(c||l)&&(u=!0)),v&&(m?(o=o.add(m),s=E?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:u,mutatedKeys:s}}iu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const o=t.ru.pa();o.sort((h,d)=>function(m,_){const E=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W(20277,{At:v})}};return E(m)-E(_)}(h.type,d.type)||this.Xa(h.doc,d.doc)),this.su(r),i=i!=null&&i;const u=n&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,l=c!==this.Ya;return this.Ya=c,o.length!==0||l?{snapshot:new Wr(this.query,t.eu,s,o,t.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new kf,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=et(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return t.forEach(r=>{this.Za.has(r)||n.push(new Zg(r))}),this.Za.forEach(r=>{t.has(r)||n.push(new Jg(r))}),n}uu(t){this.Ha=t.qs,this.Za=et();const n=this.nu(t.documents);return this.applyChanges(n,!0)}cu(){return Wr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const nc="SyncEngine";class OT{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class MT{constructor(t){this.key=t,this.lu=!1}}class LT{constructor(t,n,r,i,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new wr(u=>pg(u),oa),this.Tu=new Map,this.Iu=new Set,this.du=new Tt(G.comparator),this.Eu=new Map,this.Au=new Hl,this.Ru={},this.Vu=new Map,this.mu=Gr.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function FT(e,t,n=!0){const r=sm(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await tm(r,t,n,!0),i}async function UT(e,t){const n=sm(e);await tm(n,t,!0,!1)}async function tm(e,t,n,r){const i=await sT(e.localStore,Ye(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await BT(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&n&&jg(e.remoteStore,i),u}async function BT(e,t,n,r,i){e.gu=(d,p,m)=>async function(E,v,P,b){let N=v.view.nu(P);N.Ds&&(N=await Cf(E.localStore,v.query,!1).then(({documents:I})=>v.view.nu(I,N)));const x=b&&b.targetChanges.get(v.targetId),M=b&&b.targetMismatches.get(v.targetId)!=null,U=v.view.applyChanges(N,E.isPrimaryClient,x,M);return Ff(E,v.targetId,U._u),U.snapshot}(e,d,p,m);const s=await Cf(e.localStore,t,!0),o=new kT(t,s.qs),u=o.nu(s.documents),c=fs.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),l=o.applyChanges(u,e.isPrimaryClient,c);Ff(e,n,l._u);const h=new OT(t,n,o);return e.Pu.set(t,h),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),l.snapshot}async function $T(e,t,n){const r=Q(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!oa(o,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ou(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ql(r.remoteStore,i.targetId),Fu(r,i.targetId)}).catch(ii)):(Fu(r,i.targetId),await Ou(r.localStore,i.targetId,!0))}async function qT(e,t){const n=Q(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ql(n.remoteStore,r.targetId))}async function jT(e,t,n){const r=XT(e);try{const i=await function(o,u){const c=Q(o),l=yt.now(),h=u.reduce((m,_)=>m.add(_.key),et());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let _=Tn(),E=et();return c.Os.getEntries(m,h).next(v=>{_=v,_.forEach((P,b)=>{b.isValidDocument()||(E=E.add(P))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,_)).next(v=>{d=v;const P=[];for(const b of u){const N=sE(b,d.get(b.key).overlayedDocument);N!=null&&P.push(new Qn(b.key,N,og(N.value.mapValue),Je.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,P,u)}).next(v=>{p=v;const P=v.applyToLocalDocumentSet(d,E);return c.documentOverlayCache.saveOverlays(m,v.batchId,P)})}).then(()=>({batchId:p.batchId,changes:_g(d)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let l=o.Ru[o.currentUser.toKey()];l||(l=new Tt(tt)),l=l.insert(u,c),o.Ru[o.currentUser.toKey()]=l}(r,i.batchId,n),await ps(r,i.changes),await da(r.remoteStore)}catch(i){const s=tc(i,"Failed to persist write");n.reject(s)}}async function em(e,t){const n=Q(e);try{const r=await nT(n.localStore,t);t.targetChanges.forEach((i,s)=>{const o=n.Eu.get(s);o&&(ut(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?ut(o.lu,14607):i.removedDocuments.size>0&&(ut(o.lu,42227),o.lu=!1))}),await ps(n,r,t)}catch(r){await ii(r)}}function Lf(e,t,n){const r=Q(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,o)=>{const u=o.view.va(t);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=Q(o);c.onlineState=u;let l=!1;c.queries.forEach((h,d)=>{for(const p of d.wa)p.va(u)&&(l=!0)}),l&&ec(c)}(r.eventManager,t),i.length&&r.hu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function zT(e,t,n){const r=Q(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let o=new Tt(G.comparator);o=o.insert(s,te.newNoDocument(s,K.min()));const u=et().add(s),c=new ca(K.min(),new Map,new Tt(tt),o,u);await em(r,c),r.du=r.du.remove(s),r.Eu.delete(t),rc(r)}else await Ou(r.localStore,t,!1).then(()=>Fu(r,t,n)).catch(ii)}async function HT(e,t){const n=Q(e),r=t.batch.batchId;try{const i=await eT(n.localStore,t);rm(n,r,null),nm(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ps(n,i)}catch(i){await ii(i)}}async function GT(e,t,n){const r=Q(e);try{const i=await function(o,u){const c=Q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,u).next(d=>(ut(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,t);rm(r,t,n),nm(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await ps(r,i)}catch(i){await ii(i)}}function nm(e,t){(e.Vu.get(t)||[]).forEach(n=>{n.resolve()}),e.Vu.delete(t)}function rm(e,t,n){const r=Q(e);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function Fu(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(r=>{e.Au.containsKey(r)||im(e,r)})}function im(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(Ql(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),rc(e))}function Ff(e,t,n){for(const r of n)r instanceof Jg?(e.Au.addReference(r.key,t),WT(e,r)):r instanceof Zg?(j(nc,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||im(e,r.key)):W(19791,{yu:r})}function WT(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(j(nc,"New document in limbo: "+n),e.Iu.add(r),rc(e))}function rc(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new G(mt.fromString(t)),r=e.mu.next();e.Eu.set(r,new MT(n)),e.du=e.du.insert(n,r),jg(e.remoteStore,new Dn(Ye(Bl(n.path)),r,"TargetPurposeLimboResolution",ra.ue))}}async function ps(e,t,n){const r=Q(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,c)=>{o.push(r.gu(c,t,n).then(l=>{var h;if((l||n)&&r.isPrimaryClient){const d=l?!l.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);const d=Wl.Es(c.targetId,l);s.push(d)}}))}),await Promise.all(o),r.hu.J_(i),await async function(c,l){const h=Q(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>L.forEach(l,p=>L.forEach(p.Is,m=>h.persistence.referenceDelegate.addReference(d,p.targetId,m)).next(()=>L.forEach(p.ds,m=>h.persistence.referenceDelegate.removeReference(d,p.targetId,m)))))}catch(d){if(!si(d))throw d;j(Kl,"Failed to update sequence numbers: "+d)}for(const d of l){const p=d.targetId;if(!d.fromCache){const m=h.Fs.get(p),_=m.snapshotVersion,E=m.withLastLimboFreeSnapshotVersion(_);h.Fs=h.Fs.insert(p,E)}}}(r.localStore,s))}async function KT(e,t){const n=Q(e);if(!n.currentUser.isEqual(t)){j(nc,"User change. New user:",t.toKey());const r=await Ug(n.localStore,t);n.currentUser=t,function(s,o){s.Vu.forEach(u=>{u.forEach(c=>{c.reject(new q(O.CANCELLED,o))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await ps(n,r.Bs)}}function QT(e,t){const n=Q(e),r=n.Eu.get(t);if(r&&r.lu)return et().add(r.key);{let i=et();const s=n.Tu.get(t);if(!s)return i;for(const o of s){const u=n.Pu.get(o);i=i.unionWith(u.view.tu)}return i}}function sm(e){const t=Q(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=em.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=QT.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=zT.bind(null,t),t.hu.J_=NT.bind(null,t.eventManager),t.hu.pu=DT.bind(null,t.eventManager),t}function XT(e){const t=Q(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=HT.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=GT.bind(null,t),t}class ko{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ha(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,n){return null}Fu(t,n){return null}vu(t){return tT(this.persistence,new YE,t.initialUser,this.serializer)}Du(t){return new Fg(Gl.Vi,this.serializer)}bu(t){return new aT}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ko.provider={build:()=>new ko};class YT extends ko{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,n){ut(this.persistence.referenceDelegate instanceof No,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ME(r,t.asyncQueue,n)}Du(t){const n=this.cacheSizeBytes!==void 0?he.withCacheSize(this.cacheSizeBytes):he.DEFAULT;return new Fg(r=>No.Vi(r,n),this.serializer)}}class Uu{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Lf(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=KT.bind(null,this.syncEngine),await PT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new VT}()}createDatastore(t){const n=ha(t.databaseInfo.databaseId),r=function(s){return new fT(s)}(t.databaseInfo);return function(s,o,u,c){return new mT(s,o,u,c)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,o,u){return new yT(r,i,s,o,u)}(this.localStore,this.datastore,t.asyncQueue,n=>Lf(this.syncEngine,n,0),function(){return Vf.C()?new Vf:new uT}())}createSyncEngine(t,n){return function(i,s,o,u,c,l,h){const d=new LT(i,s,o,u,c,l);return h&&(d.fu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const s=Q(i);j(pr,"RemoteStore shutting down."),s.Ia.add(5),await ds(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Uu.provider={build:()=>new Uu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):wn("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="FirestoreClient";class JT{constructor(t,n,r,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Zt.UNAUTHENTICATED,this.clientId=kl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{j(Gn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(j(Gn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new mn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=tc(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function iu(e,t){e.asyncQueue.verifyOperationInProgress(),j(Gn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Ug(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>{Bn("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{j("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Bn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),e._offlineComponents=t}async function Uf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ZT(e);j(Gn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>Df(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>Df(t.remoteStore,i)),e._onlineComponents=t}async function ZT(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){j(Gn,"Using user provided OfflineComponentProvider");try{await iu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===O.FAILED_PRECONDITION||i.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Bn("Error using user provided cache. Falling back to memory cache: "+n),await iu(e,new ko)}}else j(Gn,"Using default OfflineComponentProvider"),await iu(e,new YT(void 0));return e._offlineComponents}async function am(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(j(Gn,"Using user provided OnlineComponentProvider"),await Uf(e,e._uninitializedComponentsProvider._online)):(j(Gn,"Using default OnlineComponentProvider"),await Uf(e,new Uu))),e._onlineComponents}function t1(e){return am(e).then(t=>t.syncEngine)}async function um(e){const t=await am(e),n=t.eventManager;return n.onListen=FT.bind(null,t.syncEngine),n.onUnlisten=$T.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=UT.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=qT.bind(null,t.syncEngine),n}function e1(e,t,n={}){const r=new mn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new om({next:p=>{h.Ou(),o.enqueueAndForget(()=>Xg(s,d));const m=p.docs.has(u);!m&&p.fromCache?l.reject(new q(O.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&c&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new Yg(Bl(u.path),h,{includeMetadataChanges:!0,ka:!0});return Qg(s,d)}(await um(e),e.asyncQueue,t,n,r)),r.promise}function n1(e,t,n={}){const r=new mn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new om({next:p=>{h.Ou(),o.enqueueAndForget(()=>Xg(s,d)),p.fromCache&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new Yg(u,h,{includeMetadataChanges:!0,ka:!0});return Qg(s,d)}(await um(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lm(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="firestore.googleapis.com",$f=!0;class qf{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new q(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=cm,this.ssl=$f}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:$f;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Lg;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<kE)throw new q(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}yw("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lm((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class pa{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new q(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qf(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lw;switch(r.type){case"firstParty":return new dw(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Bf.get(n);r&&(j("ComponentProvider","Removing Datastore"),Bf.delete(n),r.terminate())}(this),Promise.resolve()}}function r1(e,t,n,r={}){var i;e=En(e,pa);const s=Vl(t),o=e._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),c=`${t}:${n}`;s&&(Mv(`https://${c}`),Bv("Firestore",!0)),o.host!==cm&&o.host!==c&&Bn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!Eo(l,u)&&(e._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Zt.MOCK_USER;else{h=Lv(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new q(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Zt(p)}e._authCredentials=new cw(new Wp(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Xn(this.firestore,t,this._query)}}class xt{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ln(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new xt(this.firestore,t,this._key)}toJSON(){return{type:xt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(cs(n,xt._jsonSchema))return new xt(t,r||null,new G(mt.fromString(n.referencePath)))}}xt._jsonSchemaVersion="firestore/documentReference/1.0",xt._jsonSchema={type:Dt("string",xt._jsonSchemaVersion),referencePath:Dt("string")};class Ln extends Xn{constructor(t,n,r){super(t,n,Bl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new xt(this.firestore,null,new G(t))}withConverter(t){return new Ln(this.firestore,t,this._path)}}function hm(e,t,...n){if(e=yn(e),Qp("collection","path",t),e instanceof pa){const r=mt.fromString(t,...n);return tf(r),new Ln(e,null,r)}{if(!(e instanceof xt||e instanceof Ln))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(mt.fromString(t,...n));return tf(r),new Ln(e.firestore,null,r)}}function i1(e,t,...n){if(e=yn(e),arguments.length===1&&(t=kl.newId()),Qp("doc","path",t),e instanceof pa){const r=mt.fromString(t,...n);return Zh(r),new xt(e,null,new G(r))}{if(!(e instanceof xt||e instanceof Ln))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(mt.fromString(t,...n));return Zh(r),new xt(e.firestore,e instanceof Ln?e.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf="AsyncQueue";class zf{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new $g(this,"async_queue_retry"),this.oc=()=>{const r=ru();r&&j(jf,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=t;const n=ru();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const n=ru();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new mn;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!si(t))throw t;j(jf,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const n=this._c.then(()=>(this.nc=!0,t().catch(r=>{throw this.tc=r,this.nc=!1,wn("INTERNAL UNHANDLED ERROR: ",Hf(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(t,n,r){this.ac(),this.sc.indexOf(t)>-1&&(n=0);const i=Zl.createAndSchedule(this,t,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&W(47125,{hc:Hf(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const n of this.ec)if(n.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const n=this.ec.indexOf(t);this.ec.splice(n,1)}}function Hf(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class gs extends pa{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new zf,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new zf(t),this._firestoreClient=void 0,await t}}}function s1(e,t){const n=typeof e=="object"?e:X0(),r=typeof e=="string"?e:Ro,i=H0(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=kv("firestore");s&&r1(i,...s)}return i}function ic(e){if(e._terminated)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||o1(e),e._firestoreClient}function o1(e){var t,n,r;const i=e._freezeSettings(),s=function(u,c,l,h){return new xw(u,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,lm(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new JT(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(t){this._byteString=t}static fromBase64String(t){try{return new be(Ht.fromBase64String(t))}catch(n){throw new q(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new be(Ht.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:be._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(cs(t,be._jsonSchema))return be.fromBase64String(t.bytes)}}be._jsonSchemaVersion="firestore/bytes/1.0",be._jsonSchema={type:Dt("string",be._jsonSchemaVersion),bytes:Dt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new q(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new q(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new q(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return tt(this._lat,t._lat)||tt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:tn._jsonSchemaVersion}}static fromJSON(t){if(cs(t,tn._jsonSchema))return new tn(t.latitude,t.longitude)}}tn._jsonSchemaVersion="firestore/geoPoint/1.0",tn._jsonSchema={type:Dt("string",tn._jsonSchemaVersion),latitude:Dt("number"),longitude:Dt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:en._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(cs(t,en._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new en(t.vectorValues);throw new q(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}en._jsonSchemaVersion="firestore/vectorValue/1.0",en._jsonSchema={type:Dt("string",en._jsonSchemaVersion),vectorValues:Dt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=/^__.*__$/;class u1{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Qn(t,this.data,this.fieldMask,n,this.fieldTransforms):new hs(t,this.data,n,this.fieldTransforms)}}class fm{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Qn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function dm(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W(40011,{Ec:e})}}class oc{constructor(t,n,r,i,s,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new oc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.fc(t),i}gc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return Oo(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(dm(this.Ec)&&a1.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class l1{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||ha(t)}Dc(t,n,r,i=!1){return new oc({Ec:t,methodName:n,bc:r,path:zt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ac(e){const t=e._freezeSettings(),n=ha(e._databaseId);return new l1(e._databaseId,!!t.ignoreUndefinedProperties,n)}function c1(e,t,n,r,i,s={}){const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);uc("Data must be an object, but it was:",o,r);const u=pm(r,o);let c,l;if(s.merge)c=new Ie(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=Bu(t,d,n);if(!o.contains(p))throw new q(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);mm(h,p)||h.push(p)}c=new Ie(h),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new u1(new fe(u),c,l)}class ma extends sc{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ma}}function h1(e,t,n,r){const i=e.Dc(1,t,n);uc("Data must be an object, but it was:",i,r);const s=[],o=fe.empty();Kn(r,(c,l)=>{const h=lc(t,c,n);l=yn(l);const d=i.gc(h);if(l instanceof ma)s.push(h);else{const p=ms(l,d);p!=null&&(s.push(h),o.set(h,p))}});const u=new Ie(s);return new fm(o,u,i.fieldTransforms)}function f1(e,t,n,r,i,s){const o=e.Dc(1,t,n),u=[Bu(t,r,n)],c=[i];if(s.length%2!=0)throw new q(O.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)u.push(Bu(t,s[p])),c.push(s[p+1]);const l=[],h=fe.empty();for(let p=u.length-1;p>=0;--p)if(!mm(l,u[p])){const m=u[p];let _=c[p];_=yn(_);const E=o.gc(m);if(_ instanceof ma)l.push(m);else{const v=ms(_,E);v!=null&&(l.push(m),h.set(m,v))}}const d=new Ie(l);return new fm(h,d,o.fieldTransforms)}function d1(e,t,n,r=!1){return ms(n,e.Dc(r?4:3,t))}function ms(e,t){if(gm(e=yn(e)))return uc("Unsupported field value:",t,e),pm(e,t);if(e instanceof sc)return function(r,i){if(!dm(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=ms(u,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=yn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Zw(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=yt.fromDate(r);return{timestampValue:Vo(i.serializer,s)}}if(r instanceof yt){const s=new yt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vo(i.serializer,s)}}if(r instanceof tn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof be)return{bytesValue:xg(i.serializer,r._byteString)};if(r instanceof xt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof en)return function(o,u){return{mapValue:{fields:{[ig]:{stringValue:sg},[So]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw u.wc("VectorValues must only contain numeric values.");return $l(u.serializer,l)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${na(r)}`)}(e,t)}function pm(e,t){const n={};return Jp(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Kn(e,(r,i)=>{const s=ms(i,t.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function gm(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof yt||e instanceof tn||e instanceof be||e instanceof xt||e instanceof sc||e instanceof en)}function uc(e,t,n){if(!gm(n)||!Xp(n)){const r=na(n);throw r==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function Bu(e,t,n){if((t=yn(t))instanceof ga)return t._internalPath;if(typeof t=="string")return lc(e,t);throw Oo("Field path arguments must be of type string or ",e,!1,void 0,n)}const p1=new RegExp("[~\\*/\\[\\]]");function lc(e,t,n){if(t.search(p1)>=0)throw Oo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new ga(...t.split("."))._internalPath}catch{throw Oo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Oo(e,t,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${t}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new q(O.INVALID_ARGUMENT,u+e+c)}function mm(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new g1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(cc("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class g1 extends _m{data(){return super.data()}}function cc(e,t){return typeof t=="string"?lc(e,t):t instanceof ga?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new q(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hc{}class fc extends hc{}function _1(e,t,...n){let r=[];t instanceof hc&&r.push(t),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof pc).length,u=s.filter(c=>c instanceof dc).length;if(o>1||o>0&&u>0)throw new q(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class dc extends fc{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new dc(t,n,r)}_apply(t){const n=this._parse(t);return ym(t._query,n),new Xn(t.firestore,t.converter,xu(t._query,n))}_parse(t){const n=ac(t.firestore);return function(s,o,u,c,l,h,d){let p;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Wf(d,h);const _=[];for(const E of d)_.push(Gf(c,s,E));p={arrayValue:{values:_}}}else p=Gf(c,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Wf(d,h),p=d1(u,o,d,h==="in"||h==="not-in");return Nt.create(l,h,p)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class pc extends hc{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new pc(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Fe.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)ym(o,c),o=xu(o,c)}(t._query,n),new Xn(t.firestore,t.converter,xu(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class gc extends fc{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new gc(t,n)}_apply(t){const n=function(i,s,o){if(i.startAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ji(s,o)}(t._query,this._field,this._direction);return new Xn(t.firestore,t.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new oi(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function y1(e,t="asc"){const n=t,r=cc("orderBy",e);return gc._create(r,n)}class mc extends fc{constructor(t,n,r){super(),this.type=t,this._limit=n,this._limitType=r}static _create(t,n,r){return new mc(t,n,r)}_apply(t){return new Xn(t.firestore,t.converter,Co(t._query,this._limit,this._limitType))}}function v1(e){return vw("limit",e),mc._create("limit",e,"F")}function Gf(e,t,n){if(typeof(n=yn(n))=="string"){if(n==="")throw new q(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dg(t)&&n.indexOf("/")!==-1)throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(mt.fromString(n));if(!G.isDocumentKey(r))throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return lf(e,new G(r))}if(n instanceof xt)return lf(e,n._key);throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${na(n)}.`)}function Wf(e,t){if(!Array.isArray(e)||e.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function ym(e,t){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class w1{convertValue(t,n="none"){switch(zn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(jn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw W(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Kn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(t){var n,r,i;const s=(i=(r=(n=t.fields)===null||n===void 0?void 0:n[So].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>bt(o.doubleValue));return new en(s)}convertGeoPoint(t){return new tn(bt(t.latitude),bt(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=sa(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Qi(t));default:return null}}convertTimestamp(t){const n=qn(t);return new yt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=mt.fromString(t);ut(Mg(r),9688,{name:t});const i=new Xi(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||wn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class Pi{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class lr extends _m{constructor(t,n,r,i,s,o){super(t,n,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new ro(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(cc("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=lr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}lr._jsonSchemaVersion="firestore/documentSnapshot/1.0",lr._jsonSchema={type:Dt("string",lr._jsonSchemaVersion),bundleSource:Dt("string","DocumentSnapshot"),bundleName:Dt("string"),bundle:Dt("string")};class ro extends lr{data(t={}){return super.data(t)}}class $r{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Pi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new ro(this._firestore,this._userDataWriter,r.key,r,new Pi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new ro(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Pi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new ro(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Pi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return u.type!==0&&(l=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),h=o.indexOf(u.doc.key)),{type:T1(u.type),doc:c,oldIndex:l,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=$r._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=kl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function T1(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(e){e=En(e,xt);const t=En(e.firestore,gs);return e1(ic(t),e._key).then(n=>S1(t,e,n))}$r._jsonSchemaVersion="firestore/querySnapshot/1.0",$r._jsonSchema={type:Dt("string",$r._jsonSchemaVersion),bundleSource:Dt("string","QuerySnapshot"),bundleName:Dt("string"),bundle:Dt("string")};class vm extends w1{constructor(t){super(),this.firestore=t}convertBytes(t){return new be(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new xt(this.firestore,null,n)}}function wm(e){e=En(e,Xn);const t=En(e.firestore,gs),n=ic(t),r=new vm(t);return m1(e._query),n1(n,e._query).then(i=>new $r(t,r,e,i))}function I1(e,t,n){e=En(e,xt);const r=En(e.firestore,gs),i=E1(e.converter,t);return Em(r,[c1(ac(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,Je.none())])}function R1(e,t,n,...r){e=En(e,xt);const i=En(e.firestore,gs),s=ac(i);let o;return o=typeof(t=yn(t))=="string"||t instanceof ga?f1(s,"updateDoc",e._key,t,n,r):h1(s,"updateDoc",e._key,t),Em(i,[o.toMutation(e._key,Je.exists(!0))])}function Em(e,t){return function(r,i){const s=new mn;return r.asyncQueue.enqueueAndForget(async()=>jT(await t1(r),i,s)),s.promise}(ic(e),t)}function S1(e,t,n){const r=n.docs.get(t._key),i=new vm(e);return new lr(e,i,t._key,r,new Pi(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){ri=i})(Q0),Ao(new Gi("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new gs(new hw(r.getProvider("auth-internal")),new pw(o,r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new q(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xi(l.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Ur(Kh,Qh,t),Ur(Kh,Qh,"esm2017")})();const b1={apiKey:"AIzaSyAZsdXZU6WbM33SaKP5PoYm7G0V2ABYUSU",authDomain:"great-wave-everywhere.firebaseapp.com",projectId:"great-wave-everywhere",storageBucket:"great-wave-everywhere.firebasestorage.app",messagingSenderId:"636756607685",appId:"1:636756607685:web:2199075bc12821f89466ac",measurementId:"G-XRVYGKFWJ8"},C1=Lp(b1),_c=s1(C1);async function P1(e){const t=i1(_c,"words",e.toLowerCase()),n=await A1(t);n.exists()?await R1(t,{count:n.data().count+1}):await I1(t,{count:1})}async function Kf(){return(await wm(hm(_c,"words"))).docs.map(t=>({id:t.id,count:t.data().count}))}async function Qf(e=5){const t=_1(hm(_c,"words"),y1("count","desc"),v1(e));return(await wm(t)).docs.map(r=>({id:r.id,count:r.data().count}))}function Tm(e,t){return function(){return e.apply(t,arguments)}}const{toString:x1}=Object.prototype,{getPrototypeOf:yc}=Object,{iterator:_a,toStringTag:Am}=Symbol,ya=(e=>t=>{const n=x1.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Be=e=>(e=e.toLowerCase(),t=>ya(t)===e),va=e=>t=>typeof t===e,{isArray:ui}=Array,es=va("undefined");function V1(e){return e!==null&&!es(e)&&e.constructor!==null&&!es(e.constructor)&&ge(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Im=Be("ArrayBuffer");function N1(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Im(e.buffer),t}const D1=va("string"),ge=va("function"),Rm=va("number"),wa=e=>e!==null&&typeof e=="object",k1=e=>e===!0||e===!1,io=e=>{if(ya(e)!=="object")return!1;const t=yc(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Am in e)&&!(_a in e)},O1=Be("Date"),M1=Be("File"),L1=Be("Blob"),F1=Be("FileList"),U1=e=>wa(e)&&ge(e.pipe),B1=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ge(e.append)&&((t=ya(e))==="formdata"||t==="object"&&ge(e.toString)&&e.toString()==="[object FormData]"))},$1=Be("URLSearchParams"),[q1,j1,z1,H1]=["ReadableStream","Request","Response","Headers"].map(Be),G1=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _s(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),ui(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],t.call(null,e[u],u,e)}}function Sm(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const or=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,bm=e=>!es(e)&&e!==or;function $u(){const{caseless:e}=bm(this)&&this||{},t={},n=(r,i)=>{const s=e&&Sm(t,i)||i;io(t[s])&&io(r)?t[s]=$u(t[s],r):io(r)?t[s]=$u({},r):ui(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&_s(arguments[r],n);return t}const W1=(e,t,n,{allOwnKeys:r}={})=>(_s(t,(i,s)=>{n&&ge(i)?e[s]=Tm(i,n):e[s]=i},{allOwnKeys:r}),e),K1=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Q1=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},X1=(e,t,n,r)=>{let i,s,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&yc(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Y1=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},J1=e=>{if(!e)return null;if(ui(e))return e;let t=e.length;if(!Rm(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Z1=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&yc(Uint8Array)),tA=(e,t)=>{const r=(e&&e[_a]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},eA=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},nA=Be("HTMLFormElement"),rA=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Xf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),iA=Be("RegExp"),Cm=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};_s(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},sA=e=>{Cm(e,(t,n)=>{if(ge(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(ge(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},oA=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return ui(e)?r(e):r(String(e).split(t)),n},aA=()=>{},uA=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function lA(e){return!!(e&&ge(e.append)&&e[Am]==="FormData"&&e[_a])}const cA=e=>{const t=new Array(10),n=(r,i)=>{if(wa(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=ui(r)?[]:{};return _s(r,(o,u)=>{const c=n(o,i+1);!es(c)&&(s[u]=c)}),t[i]=void 0,s}}return r};return n(e,0)},hA=Be("AsyncFunction"),fA=e=>e&&(wa(e)||ge(e))&&ge(e.then)&&ge(e.catch),Pm=((e,t)=>e?setImmediate:t?((n,r)=>(or.addEventListener("message",({source:i,data:s})=>{i===or&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),or.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",ge(or.postMessage)),dA=typeof queueMicrotask<"u"?queueMicrotask.bind(or):typeof process<"u"&&process.nextTick||Pm,pA=e=>e!=null&&ge(e[_a]),D={isArray:ui,isArrayBuffer:Im,isBuffer:V1,isFormData:B1,isArrayBufferView:N1,isString:D1,isNumber:Rm,isBoolean:k1,isObject:wa,isPlainObject:io,isReadableStream:q1,isRequest:j1,isResponse:z1,isHeaders:H1,isUndefined:es,isDate:O1,isFile:M1,isBlob:L1,isRegExp:iA,isFunction:ge,isStream:U1,isURLSearchParams:$1,isTypedArray:Z1,isFileList:F1,forEach:_s,merge:$u,extend:W1,trim:G1,stripBOM:K1,inherits:Q1,toFlatObject:X1,kindOf:ya,kindOfTest:Be,endsWith:Y1,toArray:J1,forEachEntry:tA,matchAll:eA,isHTMLForm:nA,hasOwnProperty:Xf,hasOwnProp:Xf,reduceDescriptors:Cm,freezeMethods:sA,toObjectSet:oA,toCamelCase:rA,noop:aA,toFiniteNumber:uA,findKey:Sm,global:or,isContextDefined:bm,isSpecCompliantForm:lA,toJSONObject:cA,isAsyncFn:hA,isThenable:fA,setImmediate:Pm,asap:dA,isIterable:pA};function Z(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}D.inherits(Z,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const xm=Z.prototype,Vm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Vm[e]={value:e}});Object.defineProperties(Z,Vm);Object.defineProperty(xm,"isAxiosError",{value:!0});Z.from=(e,t,n,r,i,s)=>{const o=Object.create(xm);return D.toFlatObject(e,o,function(c){return c!==Error.prototype},u=>u!=="isAxiosError"),Z.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const gA=null;function qu(e){return D.isPlainObject(e)||D.isArray(e)}function Nm(e){return D.endsWith(e,"[]")?e.slice(0,-2):e}function Yf(e,t,n){return e?e.concat(t).map(function(i,s){return i=Nm(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function mA(e){return D.isArray(e)&&!e.some(qu)}const _A=D.toFlatObject(D,{},null,function(t){return/^is[A-Z]/.test(t)});function Ea(e,t,n){if(!D.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=D.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,v){return!D.isUndefined(v[E])});const r=n.metaTokens,i=n.visitor||h,s=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(i))throw new TypeError("visitor must be a function");function l(_){if(_===null)return"";if(D.isDate(_))return _.toISOString();if(D.isBoolean(_))return _.toString();if(!c&&D.isBlob(_))throw new Z("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(_)||D.isTypedArray(_)?c&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,E,v){let P=_;if(_&&!v&&typeof _=="object"){if(D.endsWith(E,"{}"))E=r?E:E.slice(0,-2),_=JSON.stringify(_);else if(D.isArray(_)&&mA(_)||(D.isFileList(_)||D.endsWith(E,"[]"))&&(P=D.toArray(_)))return E=Nm(E),P.forEach(function(N,x){!(D.isUndefined(N)||N===null)&&t.append(o===!0?Yf([E],x,s):o===null?E:E+"[]",l(N))}),!1}return qu(_)?!0:(t.append(Yf(v,E,s),l(_)),!1)}const d=[],p=Object.assign(_A,{defaultVisitor:h,convertValue:l,isVisitable:qu});function m(_,E){if(!D.isUndefined(_)){if(d.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));d.push(_),D.forEach(_,function(P,b){(!(D.isUndefined(P)||P===null)&&i.call(t,P,D.isString(b)?b.trim():b,E,p))===!0&&m(P,E?E.concat(b):[b])}),d.pop()}}if(!D.isObject(e))throw new TypeError("data must be an object");return m(e),t}function Jf(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function vc(e,t){this._pairs=[],e&&Ea(e,this,t)}const Dm=vc.prototype;Dm.append=function(t,n){this._pairs.push([t,n])};Dm.toString=function(t){const n=t?function(r){return t.call(this,r,Jf)}:Jf;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function yA(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function km(e,t,n){if(!t)return e;const r=n&&n.encode||yA;D.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=D.isURLSearchParams(t)?t.toString():new vc(t,n).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Zf{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){D.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Om={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vA=typeof URLSearchParams<"u"?URLSearchParams:vc,wA=typeof FormData<"u"?FormData:null,EA=typeof Blob<"u"?Blob:null,TA={isBrowser:!0,classes:{URLSearchParams:vA,FormData:wA,Blob:EA},protocols:["http","https","file","blob","url","data"]},wc=typeof window<"u"&&typeof document<"u",ju=typeof navigator=="object"&&navigator||void 0,AA=wc&&(!ju||["ReactNative","NativeScript","NS"].indexOf(ju.product)<0),IA=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",RA=wc&&window.location.href||"http://localhost",SA=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wc,hasStandardBrowserEnv:AA,hasStandardBrowserWebWorkerEnv:IA,navigator:ju,origin:RA},Symbol.toStringTag,{value:"Module"})),ee={...SA,...TA};function bA(e,t){return Ea(e,new ee.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return ee.isNode&&D.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function CA(e){return D.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function PA(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function Mm(e){function t(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),c=s>=n.length;return o=!o&&D.isArray(i)?i.length:o,c?(D.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!D.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],s)&&D.isArray(i[o])&&(i[o]=PA(i[o])),!u)}if(D.isFormData(e)&&D.isFunction(e.entries)){const n={};return D.forEachEntry(e,(r,i)=>{t(CA(r),i,n,0)}),n}return null}function xA(e,t,n){if(D.isString(e))try{return(t||JSON.parse)(e),D.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const ys={transitional:Om,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=D.isObject(t);if(s&&D.isHTMLForm(t)&&(t=new FormData(t)),D.isFormData(t))return i?JSON.stringify(Mm(t)):t;if(D.isArrayBuffer(t)||D.isBuffer(t)||D.isStream(t)||D.isFile(t)||D.isBlob(t)||D.isReadableStream(t))return t;if(D.isArrayBufferView(t))return t.buffer;if(D.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return bA(t,this.formSerializer).toString();if((u=D.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Ea(u?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),xA(t)):t}],transformResponse:[function(t){const n=this.transitional||ys.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(D.isResponse(t)||D.isReadableStream(t))return t;if(t&&D.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Z.from(u,Z.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ee.classes.FormData,Blob:ee.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],e=>{ys.headers[e]={}});const VA=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NA=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&VA[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},td=Symbol("internals");function Ii(e){return e&&String(e).trim().toLowerCase()}function so(e){return e===!1||e==null?e:D.isArray(e)?e.map(so):String(e)}function DA(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const kA=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function su(e,t,n,r,i){if(D.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!D.isString(t)){if(D.isString(r))return t.indexOf(r)!==-1;if(D.isRegExp(r))return r.test(t)}}function OA(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function MA(e,t){const n=D.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,o){return this[r].call(this,t,i,s,o)},configurable:!0})})}let me=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,c,l){const h=Ii(c);if(!h)throw new Error("header name must be a non-empty string");const d=D.findKey(i,h);(!d||i[d]===void 0||l===!0||l===void 0&&i[d]!==!1)&&(i[d||c]=so(u))}const o=(u,c)=>D.forEach(u,(l,h)=>s(l,h,c));if(D.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(D.isString(t)&&(t=t.trim())&&!kA(t))o(NA(t),n);else if(D.isObject(t)&&D.isIterable(t)){let u={},c,l;for(const h of t){if(!D.isArray(h))throw TypeError("Object iterator must return a key-value pair");u[l=h[0]]=(c=u[l])?D.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(u,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=Ii(t),t){const r=D.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return DA(i);if(D.isFunction(n))return n.call(this,i,r);if(D.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ii(t),t){const r=D.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||su(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(o){if(o=Ii(o),o){const u=D.findKey(r,o);u&&(!n||su(r,r[u],u,n))&&(delete r[u],i=!0)}}return D.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||su(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return D.forEach(this,(i,s)=>{const o=D.findKey(r,s);if(o){n[o]=so(i),delete n[s];return}const u=t?OA(s):String(s).trim();u!==s&&delete n[s],n[u]=so(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return D.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&D.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[td]=this[td]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=Ii(o);r[u]||(MA(i,o),r[u]=!0)}return D.isArray(t)?t.forEach(s):s(t),this}};me.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(me.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});D.freezeMethods(me);function ou(e,t){const n=this||ys,r=t||n,i=me.from(r.headers);let s=r.data;return D.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function Lm(e){return!!(e&&e.__CANCEL__)}function li(e,t,n){Z.call(this,e??"canceled",Z.ERR_CANCELED,t,n),this.name="CanceledError"}D.inherits(li,Z,{__CANCEL__:!0});function Fm(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Z("Request failed with status code "+n.status,[Z.ERR_BAD_REQUEST,Z.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function LA(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function FA(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),h=r[s];o||(o=l),n[i]=c,r[i]=l;let d=s,p=0;for(;d!==i;)p+=n[d++],d=d%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),l-o<t)return;const m=h&&l-h;return m?Math.round(p*1e3/m):void 0}}function UA(e,t){let n=0,r=1e3/t,i,s;const o=(l,h=Date.now())=>{n=h,i=null,s&&(clearTimeout(s),s=null),e.apply(null,l)};return[(...l)=>{const h=Date.now(),d=h-n;d>=r?o(l,h):(i=l,s||(s=setTimeout(()=>{s=null,o(i)},r-d)))},()=>i&&o(i)]}const Mo=(e,t,n=3)=>{let r=0;const i=FA(50,250);return UA(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,c=o-r,l=i(c),h=o<=u;r=o;const d={loaded:o,total:u,progress:u?o/u:void 0,bytes:c,rate:l||void 0,estimated:l&&u&&h?(u-o)/l:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(d)},n)},ed=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},nd=e=>(...t)=>D.asap(()=>e(...t)),BA=ee.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ee.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ee.origin),ee.navigator&&/(msie|trident)/i.test(ee.navigator.userAgent)):()=>!0,$A=ee.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];D.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),D.isString(r)&&o.push("path="+r),D.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function qA(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function jA(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Um(e,t,n){let r=!qA(t);return e&&(r||n==!1)?jA(e,t):t}const rd=e=>e instanceof me?{...e}:e;function gr(e,t){t=t||{};const n={};function r(l,h,d,p){return D.isPlainObject(l)&&D.isPlainObject(h)?D.merge.call({caseless:p},l,h):D.isPlainObject(h)?D.merge({},h):D.isArray(h)?h.slice():h}function i(l,h,d,p){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l,d,p)}else return r(l,h,d,p)}function s(l,h){if(!D.isUndefined(h))return r(void 0,h)}function o(l,h){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l)}else return r(void 0,h)}function u(l,h,d){if(d in t)return r(l,h);if(d in e)return r(void 0,l)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(l,h,d)=>i(rd(l),rd(h),d,!0)};return D.forEach(Object.keys(Object.assign({},e,t)),function(h){const d=c[h]||i,p=d(e[h],t[h],h);D.isUndefined(p)&&d!==u||(n[h]=p)}),n}const Bm=e=>{const t=gr({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=t;t.headers=o=me.from(o),t.url=km(Um(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let c;if(D.isFormData(n)){if(ee.hasStandardBrowserEnv||ee.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[l,...h]=c?c.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([l||"multipart/form-data",...h].join("; "))}}if(ee.hasStandardBrowserEnv&&(r&&D.isFunction(r)&&(r=r(t)),r||r!==!1&&BA(t.url))){const l=i&&s&&$A.read(s);l&&o.set(i,l)}return t},zA=typeof XMLHttpRequest<"u",HA=zA&&function(e){return new Promise(function(n,r){const i=Bm(e);let s=i.data;const o=me.from(i.headers).normalize();let{responseType:u,onUploadProgress:c,onDownloadProgress:l}=i,h,d,p,m,_;function E(){m&&m(),_&&_(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(i.method.toUpperCase(),i.url,!0),v.timeout=i.timeout;function P(){if(!v)return;const N=me.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),M={data:!u||u==="text"||u==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:N,config:e,request:v};Fm(function(I){n(I),E()},function(I){r(I),E()},M),v=null}"onloadend"in v?v.onloadend=P:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(P)},v.onabort=function(){v&&(r(new Z("Request aborted",Z.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new Z("Network Error",Z.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let x=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const M=i.transitional||Om;i.timeoutErrorMessage&&(x=i.timeoutErrorMessage),r(new Z(x,M.clarifyTimeoutError?Z.ETIMEDOUT:Z.ECONNABORTED,e,v)),v=null},s===void 0&&o.setContentType(null),"setRequestHeader"in v&&D.forEach(o.toJSON(),function(x,M){v.setRequestHeader(M,x)}),D.isUndefined(i.withCredentials)||(v.withCredentials=!!i.withCredentials),u&&u!=="json"&&(v.responseType=i.responseType),l&&([p,_]=Mo(l,!0),v.addEventListener("progress",p)),c&&v.upload&&([d,m]=Mo(c),v.upload.addEventListener("progress",d),v.upload.addEventListener("loadend",m)),(i.cancelToken||i.signal)&&(h=N=>{v&&(r(!N||N.type?new li(null,e,v):N),v.abort(),v=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const b=LA(i.url);if(b&&ee.protocols.indexOf(b)===-1){r(new Z("Unsupported protocol "+b+":",Z.ERR_BAD_REQUEST,e));return}v.send(s||null)})},GA=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(l){if(!i){i=!0,u();const h=l instanceof Error?l:this.reason;r.abort(h instanceof Z?h:new li(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new Z(`timeout ${t} of ms exceeded`,Z.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(s):l.removeEventListener("abort",s)}),e=null)};e.forEach(l=>l.addEventListener("abort",s));const{signal:c}=r;return c.unsubscribe=()=>D.asap(u),c}},WA=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},KA=async function*(e,t){for await(const n of QA(e))yield*WA(n,t)},QA=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},id=(e,t,n,r)=>{const i=KA(e,t);let s=0,o,u=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:l,value:h}=await i.next();if(l){u(),c.close();return}let d=h.byteLength;if(n){let p=s+=d;n(p)}c.enqueue(new Uint8Array(h))}catch(l){throw u(l),l}},cancel(c){return u(c),i.return()}},{highWaterMark:2})},Ta=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",$m=Ta&&typeof ReadableStream=="function",XA=Ta&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),qm=(e,...t)=>{try{return!!e(...t)}catch{return!1}},YA=$m&&qm(()=>{let e=!1;const t=new Request(ee.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),sd=64*1024,zu=$m&&qm(()=>D.isReadableStream(new Response("").body)),Lo={stream:zu&&(e=>e.body)};Ta&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Lo[t]&&(Lo[t]=D.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Z(`Response type '${t}' is not supported`,Z.ERR_NOT_SUPPORT,r)})})})(new Response);const JA=async e=>{if(e==null)return 0;if(D.isBlob(e))return e.size;if(D.isSpecCompliantForm(e))return(await new Request(ee.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(D.isArrayBufferView(e)||D.isArrayBuffer(e))return e.byteLength;if(D.isURLSearchParams(e)&&(e=e+""),D.isString(e))return(await XA(e)).byteLength},ZA=async(e,t)=>{const n=D.toFiniteNumber(e.getContentLength());return n??JA(t)},tI=Ta&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:c,responseType:l,headers:h,withCredentials:d="same-origin",fetchOptions:p}=Bm(e);l=l?(l+"").toLowerCase():"text";let m=GA([i,s&&s.toAbortSignal()],o),_;const E=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(c&&YA&&n!=="get"&&n!=="head"&&(v=await ZA(h,r))!==0){let M=new Request(t,{method:"POST",body:r,duplex:"half"}),U;if(D.isFormData(r)&&(U=M.headers.get("content-type"))&&h.setContentType(U),M.body){const[I,w]=ed(v,Mo(nd(c)));r=id(M.body,sd,I,w)}}D.isString(d)||(d=d?"include":"omit");const P="credentials"in Request.prototype;_=new Request(t,{...p,signal:m,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:P?d:void 0});let b=await fetch(_,p);const N=zu&&(l==="stream"||l==="response");if(zu&&(u||N&&E)){const M={};["status","statusText","headers"].forEach(T=>{M[T]=b[T]});const U=D.toFiniteNumber(b.headers.get("content-length")),[I,w]=u&&ed(U,Mo(nd(u),!0))||[];b=new Response(id(b.body,sd,I,()=>{w&&w(),E&&E()}),M)}l=l||"text";let x=await Lo[D.findKey(Lo,l)||"text"](b,e);return!N&&E&&E(),await new Promise((M,U)=>{Fm(M,U,{data:x,headers:me.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:_})})}catch(P){throw E&&E(),P&&P.name==="TypeError"&&/Load failed|fetch/i.test(P.message)?Object.assign(new Z("Network Error",Z.ERR_NETWORK,e,_),{cause:P.cause||P}):Z.from(P,P&&P.code,e,_)}}),Hu={http:gA,xhr:HA,fetch:tI};D.forEach(Hu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const od=e=>`- ${e}`,eI=e=>D.isFunction(e)||e===null||e===!1,jm={getAdapter:e=>{e=D.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let o;if(r=n,!eI(n)&&(r=Hu[(o=String(n)).toLowerCase()],r===void 0))throw new Z(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,c])=>`adapter ${u} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(od).join(`
`):" "+od(s[0]):"as no adapter specified";throw new Z("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Hu};function au(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new li(null,e)}function ad(e){return au(e),e.headers=me.from(e.headers),e.data=ou.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),jm.getAdapter(e.adapter||ys.adapter)(e).then(function(r){return au(e),r.data=ou.call(e,e.transformResponse,r),r.headers=me.from(r.headers),r},function(r){return Lm(r)||(au(e),r&&r.response&&(r.response.data=ou.call(e,e.transformResponse,r.response),r.response.headers=me.from(r.response.headers))),Promise.reject(r)})}const zm="1.10.0",Aa={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Aa[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const ud={};Aa.transitional=function(t,n,r){function i(s,o){return"[Axios v"+zm+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(t===!1)throw new Z(i(o," has been removed"+(n?" in "+n:"")),Z.ERR_DEPRECATED);return n&&!ud[o]&&(ud[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,u):!0}};Aa.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function nI(e,t,n){if(typeof e!="object")throw new Z("options must be an object",Z.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const u=e[s],c=u===void 0||o(u,s,e);if(c!==!0)throw new Z("option "+s+" must be "+c,Z.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Z("Unknown option "+s,Z.ERR_BAD_OPTION)}}const oo={assertOptions:nI,validators:Aa},He=oo.validators;let cr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Zf,response:new Zf}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=gr(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&oo.assertOptions(r,{silentJSONParsing:He.transitional(He.boolean),forcedJSONParsing:He.transitional(He.boolean),clarifyTimeoutError:He.transitional(He.boolean)},!1),i!=null&&(D.isFunction(i)?n.paramsSerializer={serialize:i}:oo.assertOptions(i,{encode:He.function,serialize:He.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),oo.assertOptions(n,{baseUrl:He.spelling("baseURL"),withXsrfToken:He.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&D.merge(s.common,s[n.method]);s&&D.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),n.headers=me.concat(o,s);const u=[];let c=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(n)===!1||(c=c&&E.synchronous,u.unshift(E.fulfilled,E.rejected))});const l=[];this.interceptors.response.forEach(function(E){l.push(E.fulfilled,E.rejected)});let h,d=0,p;if(!c){const _=[ad.bind(this),void 0];for(_.unshift.apply(_,u),_.push.apply(_,l),p=_.length,h=Promise.resolve(n);d<p;)h=h.then(_[d++],_[d++]);return h}p=u.length;let m=n;for(d=0;d<p;){const _=u[d++],E=u[d++];try{m=_(m)}catch(v){E.call(this,v);break}}try{h=ad.call(this,m)}catch(_){return Promise.reject(_)}for(d=0,p=l.length;d<p;)h=h.then(l[d++],l[d++]);return h}getUri(t){t=gr(this.defaults,t);const n=Um(t.baseURL,t.url,t.allowAbsoluteUrls);return km(n,t.params,t.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(t){cr.prototype[t]=function(n,r){return this.request(gr(r||{},{method:t,url:n,data:(r||{}).data}))}});D.forEach(["post","put","patch"],function(t){function n(r){return function(s,o,u){return this.request(gr(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}cr.prototype[t]=n(),cr.prototype[t+"Form"]=n(!0)});let rI=class Hm{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},t(function(s,o,u){r.reason||(r.reason=new li(s,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Hm(function(i){t=i}),cancel:t}}};function iI(e){return function(n){return e.apply(null,n)}}function sI(e){return D.isObject(e)&&e.isAxiosError===!0}const Gu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Gu).forEach(([e,t])=>{Gu[t]=e});function Gm(e){const t=new cr(e),n=Tm(cr.prototype.request,t);return D.extend(n,cr.prototype,t,{allOwnKeys:!0}),D.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return Gm(gr(e,i))},n}const Rt=Gm(ys);Rt.Axios=cr;Rt.CanceledError=li;Rt.CancelToken=rI;Rt.isCancel=Lm;Rt.VERSION=zm;Rt.toFormData=Ea;Rt.AxiosError=Z;Rt.Cancel=Rt.CanceledError;Rt.all=function(t){return Promise.all(t)};Rt.spread=iI;Rt.isAxiosError=sI;Rt.mergeConfig=gr;Rt.AxiosHeaders=me;Rt.formToJSON=e=>Mm(D.isHTMLForm(e)?new FormData(e):e);Rt.getAdapter=jm.getAdapter;Rt.HttpStatusCode=Gu;Rt.default=Rt;const{Axios:fP,AxiosError:dP,CanceledError:pP,isCancel:gP,CancelToken:mP,VERSION:_P,all:yP,Cancel:vP,isAxiosError:wP,spread:EP,toFormData:TP,AxiosHeaders:AP,HttpStatusCode:IP,formToJSON:RP,getAdapter:SP,mergeConfig:bP}=Rt;class mr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,u=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);u&&(n[r++]=u),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function*oI(e){for(const t of e)yield*t}function Wm(e){return Array.from(oI(e))}var aI={value:()=>{}};function Ec(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ao(n)}function ao(e){this._=e}function uI(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ao.prototype=Ec.prototype={constructor:ao,on:function(e,t){var n=this._,r=uI(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=lI(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=ld(n[i],e.name,t);else if(t==null)for(i in n)n[i]=ld(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ao(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function lI(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function ld(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=aI,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Wu="http://www.w3.org/1999/xhtml";const cd={svg:"http://www.w3.org/2000/svg",xhtml:Wu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ia(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),cd.hasOwnProperty(t)?{space:cd[t],local:e}:e}function cI(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Wu&&t.documentElement.namespaceURI===Wu?t.createElement(e):t.createElementNS(n,e)}}function hI(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Km(e){var t=Ia(e);return(t.local?hI:cI)(t)}function fI(){}function Tc(e){return e==null?fI:function(){return this.querySelector(e)}}function dI(e){typeof e!="function"&&(e=Tc(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=new Array(o),c,l,h=0;h<o;++h)(c=s[h])&&(l=e.call(c,c.__data__,h,s))&&("__data__"in c&&(l.__data__=c.__data__),u[h]=l);return new Ue(r,this._parents)}function pI(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function gI(){return[]}function Qm(e){return e==null?gI:function(){return this.querySelectorAll(e)}}function mI(e){return function(){return pI(e.apply(this,arguments))}}function _I(e){typeof e=="function"?e=mI(e):e=Qm(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new Ue(r,i)}function Xm(e){return function(){return this.matches(e)}}function Ym(e){return function(t){return t.matches(e)}}var yI=Array.prototype.find;function vI(e){return function(){return yI.call(this.children,e)}}function wI(){return this.firstElementChild}function EI(e){return this.select(e==null?wI:vI(typeof e=="function"?e:Ym(e)))}var TI=Array.prototype.filter;function AI(){return Array.from(this.children)}function II(e){return function(){return TI.call(this.children,e)}}function RI(e){return this.selectAll(e==null?AI:II(typeof e=="function"?e:Ym(e)))}function SI(e){typeof e!="function"&&(e=Xm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new Ue(r,this._parents)}function Jm(e){return new Array(e.length)}function bI(){return new Ue(this._enter||this._groups.map(Jm),this._parents)}function Fo(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Fo.prototype={constructor:Fo,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function CI(e){return function(){return e}}function PI(e,t,n,r,i,s){for(var o=0,u,c=t.length,l=s.length;o<l;++o)(u=t[o])?(u.__data__=s[o],r[o]=u):n[o]=new Fo(e,s[o]);for(;o<c;++o)(u=t[o])&&(i[o]=u)}function xI(e,t,n,r,i,s,o){var u,c,l=new Map,h=t.length,d=s.length,p=new Array(h),m;for(u=0;u<h;++u)(c=t[u])&&(p[u]=m=o.call(c,c.__data__,u,t)+"",l.has(m)?i[u]=c:l.set(m,c));for(u=0;u<d;++u)m=o.call(e,s[u],u,s)+"",(c=l.get(m))?(r[u]=c,c.__data__=s[u],l.delete(m)):n[u]=new Fo(e,s[u]);for(u=0;u<h;++u)(c=t[u])&&l.get(p[u])===c&&(i[u]=c)}function VI(e){return e.__data__}function NI(e,t){if(!arguments.length)return Array.from(this,VI);var n=t?xI:PI,r=this._parents,i=this._groups;typeof e!="function"&&(e=CI(e));for(var s=i.length,o=new Array(s),u=new Array(s),c=new Array(s),l=0;l<s;++l){var h=r[l],d=i[l],p=d.length,m=DI(e.call(h,h&&h.__data__,l,r)),_=m.length,E=u[l]=new Array(_),v=o[l]=new Array(_),P=c[l]=new Array(p);n(h,d,E,v,P,m,t);for(var b=0,N=0,x,M;b<_;++b)if(x=E[b]){for(b>=N&&(N=b+1);!(M=v[N])&&++N<_;);x._next=M||null}}return o=new Ue(o,r),o._enter=u,o._exit=c,o}function DI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kI(){return new Ue(this._exit||this._groups.map(Jm),this._parents)}function OI(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function MI(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),u=new Array(i),c=0;c<o;++c)for(var l=n[c],h=r[c],d=l.length,p=u[c]=new Array(d),m,_=0;_<d;++_)(m=l[_]||h[_])&&(p[_]=m);for(;c<i;++c)u[c]=n[c];return new Ue(u,this._parents)}function LI(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function FI(e){e||(e=UI);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],u=o.length,c=i[s]=new Array(u),l,h=0;h<u;++h)(l=o[h])&&(c[h]=l);c.sort(t)}return new Ue(i,this._parents).order()}function UI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function BI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $I(){return Array.from(this)}function qI(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function jI(){let e=0;for(const t of this)++e;return e}function zI(){return!this.node()}function HI(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,u;s<o;++s)(u=i[s])&&e.call(u,u.__data__,s,i);return this}function GI(e){return function(){this.removeAttribute(e)}}function WI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function KI(e,t){return function(){this.setAttribute(e,t)}}function QI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function XI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function YI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function JI(e,t){var n=Ia(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?WI:GI:typeof t=="function"?n.local?YI:XI:n.local?QI:KI)(n,t))}function Zm(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ZI(e){return function(){this.style.removeProperty(e)}}function tR(e,t,n){return function(){this.style.setProperty(e,t,n)}}function eR(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function nR(e,t,n){return arguments.length>1?this.each((t==null?ZI:typeof t=="function"?eR:tR)(e,t,n??"")):Kr(this.node(),e)}function Kr(e,t){return e.style.getPropertyValue(t)||Zm(e).getComputedStyle(e,null).getPropertyValue(t)}function rR(e){return function(){delete this[e]}}function iR(e,t){return function(){this[e]=t}}function sR(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function oR(e,t){return arguments.length>1?this.each((t==null?rR:typeof t=="function"?sR:iR)(e,t)):this.node()[e]}function t_(e){return e.trim().split(/^|\s+/)}function Ac(e){return e.classList||new e_(e)}function e_(e){this._node=e,this._names=t_(e.getAttribute("class")||"")}e_.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function n_(e,t){for(var n=Ac(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function r_(e,t){for(var n=Ac(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function aR(e){return function(){n_(this,e)}}function uR(e){return function(){r_(this,e)}}function lR(e,t){return function(){(t.apply(this,arguments)?n_:r_)(this,e)}}function cR(e,t){var n=t_(e+"");if(arguments.length<2){for(var r=Ac(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?lR:t?aR:uR)(n,t))}function hR(){this.textContent=""}function fR(e){return function(){this.textContent=e}}function dR(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function pR(e){return arguments.length?this.each(e==null?hR:(typeof e=="function"?dR:fR)(e)):this.node().textContent}function gR(){this.innerHTML=""}function mR(e){return function(){this.innerHTML=e}}function _R(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function yR(e){return arguments.length?this.each(e==null?gR:(typeof e=="function"?_R:mR)(e)):this.node().innerHTML}function vR(){this.nextSibling&&this.parentNode.appendChild(this)}function wR(){return this.each(vR)}function ER(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function TR(){return this.each(ER)}function AR(e){var t=typeof e=="function"?e:Km(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function IR(){return null}function RR(e,t){var n=typeof e=="function"?e:Km(e),r=t==null?IR:typeof t=="function"?t:Tc(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function SR(){var e=this.parentNode;e&&e.removeChild(this)}function bR(){return this.each(SR)}function CR(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function PR(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xR(e){return this.select(e?PR:CR)}function VR(e){return arguments.length?this.property("__data__",e):this.node().__data__}function NR(e){return function(t){e.call(this,t,this.__data__)}}function DR(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function kR(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function OR(e,t,n){return function(){var r=this.__on,i,s=NR(t);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function MR(e,t,n){var r=DR(e+""),i,s=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,l=u.length,h;c<l;++c)for(i=0,h=u[c];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(u=t?OR:kR,i=0;i<s;++i)this.each(u(r[i],t,n));return this}function i_(e,t,n){var r=Zm(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function LR(e,t){return function(){return i_(this,e,t)}}function FR(e,t){return function(){return i_(this,e,t.apply(this,arguments))}}function UR(e,t){return this.each((typeof t=="function"?FR:LR)(e,t))}function*BR(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var $R=[null];function Ue(e,t){this._groups=e,this._parents=t}function vs(){return new Ue([[document.documentElement]],$R)}function qR(){return this}Ue.prototype=vs.prototype={constructor:Ue,select:dI,selectAll:_I,selectChild:EI,selectChildren:RI,filter:SI,data:NI,enter:bI,exit:kI,join:OI,merge:MI,selection:qR,order:LI,sort:FI,call:BI,nodes:$I,node:qI,size:jI,empty:zI,each:HI,attr:JI,style:nR,property:oR,classed:cR,text:pR,html:yR,raise:wR,lower:TR,append:AR,insert:RR,remove:bR,clone:xR,datum:VR,on:MR,dispatch:UR,[Symbol.iterator]:BR};function Ic(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function s_(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ws(){}var ns=.7,Uo=1/ns,qr="\\s*([+-]?\\d+)\\s*",rs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jR=/^#([0-9a-f]{3,8})$/,zR=new RegExp(`^rgb\\(${qr},${qr},${qr}\\)$`),HR=new RegExp(`^rgb\\(${nn},${nn},${nn}\\)$`),GR=new RegExp(`^rgba\\(${qr},${qr},${qr},${rs}\\)$`),WR=new RegExp(`^rgba\\(${nn},${nn},${nn},${rs}\\)$`),KR=new RegExp(`^hsl\\(${rs},${nn},${nn}\\)$`),QR=new RegExp(`^hsla\\(${rs},${nn},${nn},${rs}\\)$`),hd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ic(ws,is,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:fd,formatHex:fd,formatHex8:XR,formatHsl:YR,formatRgb:dd,toString:dd});function fd(){return this.rgb().formatHex()}function XR(){return this.rgb().formatHex8()}function YR(){return o_(this).formatHsl()}function dd(){return this.rgb().formatRgb()}function is(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=jR.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?pd(t):n===3?new de(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?zs(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?zs(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=zR.exec(e))?new de(t[1],t[2],t[3],1):(t=HR.exec(e))?new de(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=GR.exec(e))?zs(t[1],t[2],t[3],t[4]):(t=WR.exec(e))?zs(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=KR.exec(e))?_d(t[1],t[2]/100,t[3]/100,1):(t=QR.exec(e))?_d(t[1],t[2]/100,t[3]/100,t[4]):hd.hasOwnProperty(e)?pd(hd[e]):e==="transparent"?new de(NaN,NaN,NaN,0):null}function pd(e){return new de(e>>16&255,e>>8&255,e&255,1)}function zs(e,t,n,r){return r<=0&&(e=t=n=NaN),new de(e,t,n,r)}function JR(e){return e instanceof ws||(e=is(e)),e?(e=e.rgb(),new de(e.r,e.g,e.b,e.opacity)):new de}function Ku(e,t,n,r){return arguments.length===1?JR(e):new de(e,t,n,r??1)}function de(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ic(de,Ku,s_(ws,{brighter(e){return e=e==null?Uo:Math.pow(Uo,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ns:Math.pow(ns,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new de(hr(this.r),hr(this.g),hr(this.b),Bo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gd,formatHex:gd,formatHex8:ZR,formatRgb:md,toString:md}));function gd(){return`#${ar(this.r)}${ar(this.g)}${ar(this.b)}`}function ZR(){return`#${ar(this.r)}${ar(this.g)}${ar(this.b)}${ar((isNaN(this.opacity)?1:this.opacity)*255)}`}function md(){const e=Bo(this.opacity);return`${e===1?"rgb(":"rgba("}${hr(this.r)}, ${hr(this.g)}, ${hr(this.b)}${e===1?")":`, ${e})`}`}function Bo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ar(e){return e=hr(e),(e<16?"0":"")+e.toString(16)}function _d(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Le(e,t,n,r)}function o_(e){if(e instanceof Le)return new Le(e.h,e.s,e.l,e.opacity);if(e instanceof ws||(e=is(e)),!e)return new Le;if(e instanceof Le)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,u=s-i,c=(s+i)/2;return u?(t===s?o=(n-r)/u+(n<r)*6:n===s?o=(r-t)/u+2:o=(t-n)/u+4,u/=c<.5?s+i:2-s-i,o*=60):u=c>0&&c<1?0:o,new Le(o,u,c,e.opacity)}function tS(e,t,n,r){return arguments.length===1?o_(e):new Le(e,t,n,r??1)}function Le(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ic(Le,tS,s_(ws,{brighter(e){return e=e==null?Uo:Math.pow(Uo,e),new Le(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ns:Math.pow(ns,e),new Le(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new de(uu(e>=240?e-240:e+120,i,r),uu(e,i,r),uu(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Le(yd(this.h),Hs(this.s),Hs(this.l),Bo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Bo(this.opacity);return`${e===1?"hsl(":"hsla("}${yd(this.h)}, ${Hs(this.s)*100}%, ${Hs(this.l)*100}%${e===1?")":`, ${e})`}`}}));function yd(e){return e=(e||0)%360,e<0?e+360:e}function Hs(e){return Math.max(0,Math.min(1,e||0))}function uu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const a_=e=>()=>e;function eS(e,t){return function(n){return e+n*t}}function nS(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function rS(e){return(e=+e)==1?u_:function(t,n){return n-t?nS(t,n,e):a_(isNaN(t)?n:t)}}function u_(e,t){var n=t-e;return n?eS(e,n):a_(isNaN(e)?t:e)}const vd=function e(t){var n=rS(t);function r(i,s){var o=n((i=Ku(i)).r,(s=Ku(s)).r),u=n(i.g,s.g),c=n(i.b,s.b),l=u_(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=u(h),i.b=c(h),i.opacity=l(h),i+""}}return r.gamma=e,r}(1);function Vn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Qu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lu=new RegExp(Qu.source,"g");function iS(e){return function(){return e}}function sS(e){return function(t){return e(t)+""}}function oS(e,t){var n=Qu.lastIndex=lu.lastIndex=0,r,i,s,o=-1,u=[],c=[];for(e=e+"",t=t+"";(r=Qu.exec(e))&&(i=lu.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),u[o]?u[o]+=s:u[++o]=s),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,c.push({i:o,x:Vn(r,i)})),n=lu.lastIndex;return n<t.length&&(s=t.slice(n),u[o]?u[o]+=s:u[++o]=s),u.length<2?c[0]?sS(c[0].x):iS(t):(t=c.length,function(l){for(var h=0,d;h<t;++h)u[(d=c[h]).i]=d.x(l);return u.join("")})}var wd=180/Math.PI,Xu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function l_(e,t,n,r,i,s){var o,u,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,c/=u),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*wd,skewX:Math.atan(c)*wd,scaleX:o,scaleY:u}}var Gs;function aS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Xu:l_(t.a,t.b,t.c,t.d,t.e,t.f)}function uS(e){return e==null||(Gs||(Gs=document.createElementNS("http://www.w3.org/2000/svg","g")),Gs.setAttribute("transform",e),!(e=Gs.transform.baseVal.consolidate()))?Xu:(e=e.matrix,l_(e.a,e.b,e.c,e.d,e.e,e.f))}function c_(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,h,d,p,m,_){if(l!==d||h!==p){var E=m.push("translate(",null,t,null,n);_.push({i:E-4,x:Vn(l,d)},{i:E-2,x:Vn(h,p)})}else(d||p)&&m.push("translate("+d+t+p+n)}function o(l,h,d,p){l!==h?(l-h>180?h+=360:h-l>180&&(l+=360),p.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Vn(l,h)})):h&&d.push(i(d)+"rotate("+h+r)}function u(l,h,d,p){l!==h?p.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Vn(l,h)}):h&&d.push(i(d)+"skewX("+h+r)}function c(l,h,d,p,m,_){if(l!==d||h!==p){var E=m.push(i(m)+"scale(",null,",",null,")");_.push({i:E-4,x:Vn(l,d)},{i:E-2,x:Vn(h,p)})}else(d!==1||p!==1)&&m.push(i(m)+"scale("+d+","+p+")")}return function(l,h){var d=[],p=[];return l=e(l),h=e(h),s(l.translateX,l.translateY,h.translateX,h.translateY,d,p),o(l.rotate,h.rotate,d,p),u(l.skewX,h.skewX,d,p),c(l.scaleX,l.scaleY,h.scaleX,h.scaleY,d,p),l=h=null,function(m){for(var _=-1,E=p.length,v;++_<E;)d[(v=p[_]).i]=v.x(m);return d.join("")}}}var lS=c_(aS,"px, ","px)","deg)"),cS=c_(uS,", ",")",")"),Qr=0,xi=0,Ri=0,h_=1e3,$o,Vi,qo=0,_r=0,Ra=0,ss=typeof performance=="object"&&performance.now?performance:Date,f_=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Rc(){return _r||(f_(hS),_r=ss.now()+Ra)}function hS(){_r=0}function jo(){this._call=this._time=this._next=null}jo.prototype=Sc.prototype={constructor:jo,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Rc():+n)+(t==null?0:+t),!this._next&&Vi!==this&&(Vi?Vi._next=this:$o=this,Vi=this),this._call=e,this._time=n,Yu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yu())}};function Sc(e,t,n){var r=new jo;return r.restart(e,t,n),r}function fS(){Rc(),++Qr;for(var e=$o,t;e;)(t=_r-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Qr}function Ed(){_r=(qo=ss.now())+Ra,Qr=xi=0;try{fS()}finally{Qr=0,pS(),_r=0}}function dS(){var e=ss.now(),t=e-qo;t>h_&&(Ra-=t,qo=e)}function pS(){for(var e,t=$o,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:$o=n);Vi=e,Yu(r)}function Yu(e){if(!Qr){xi&&(xi=clearTimeout(xi));var t=e-_r;t>24?(e<1/0&&(xi=setTimeout(Ed,e-ss.now()-Ra)),Ri&&(Ri=clearInterval(Ri))):(Ri||(qo=ss.now(),Ri=setInterval(dS,h_)),Qr=1,f_(Ed))}}function Td(e,t,n){var r=new jo;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var gS=Ec("start","end","cancel","interrupt"),mS=[],d_=0,Ad=1,Ju=2,uo=3,Id=4,Zu=5,lo=6;function Sa(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;_S(e,n,{name:t,index:r,group:i,on:gS,tween:mS,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:d_})}function bc(e,t){var n=$e(e,t);if(n.state>d_)throw new Error("too late; already scheduled");return n}function an(e,t){var n=$e(e,t);if(n.state>uo)throw new Error("too late; already running");return n}function $e(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _S(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Sc(s,0,n.time);function s(l){n.state=Ad,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var h,d,p,m;if(n.state!==Ad)return c();for(h in r)if(m=r[h],m.name===n.name){if(m.state===uo)return Td(o);m.state===Id?(m.state=lo,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[h]):+h<t&&(m.state=lo,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[h])}if(Td(function(){n.state===uo&&(n.state=Id,n.timer.restart(u,n.delay,n.time),u(l))}),n.state=Ju,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Ju){for(n.state=uo,i=new Array(p=n.tween.length),h=0,d=-1;h<p;++h)(m=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=m);i.length=d+1}}function u(l){for(var h=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Zu,1),d=-1,p=i.length;++d<p;)i[d].call(e,h);n.state===Zu&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=lo,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function yS(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>Ju&&r.state<Zu,r.state=lo,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function vS(e){return this.each(function(){yS(this,e)})}function wS(e,t){var n,r;return function(){var i=an(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,u=r.length;o<u;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function ES(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=an(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var u={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=u;break}c===l&&i.push(u)}s.tween=i}}function TS(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=$e(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?wS:ES)(n,e,t))}function Cc(e,t,n){var r=e._id;return e.each(function(){var i=an(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return $e(i,r).value[t]}}function p_(e,t){var n;return(typeof t=="number"?Vn:t instanceof is?vd:(n=is(t))?(t=n,vd):oS)(e,t)}function AS(e){return function(){this.removeAttribute(e)}}function IS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function RS(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function SS(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function bS(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function CS(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function PS(e,t){var n=Ia(e),r=n==="transform"?cS:p_;return this.attrTween(e,typeof t=="function"?(n.local?CS:bS)(n,r,Cc(this,"attr."+e,t)):t==null?(n.local?IS:AS)(n):(n.local?SS:RS)(n,r,t))}function xS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function VS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function NS(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&VS(e,s)),n}return i._value=t,i}function DS(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&xS(e,s)),n}return i._value=t,i}function kS(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Ia(e);return this.tween(n,(r.local?NS:DS)(r,t))}function OS(e,t){return function(){bc(this,e).delay=+t.apply(this,arguments)}}function MS(e,t){return t=+t,function(){bc(this,e).delay=t}}function LS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?OS:MS)(t,e)):$e(this.node(),t).delay}function FS(e,t){return function(){an(this,e).duration=+t.apply(this,arguments)}}function US(e,t){return t=+t,function(){an(this,e).duration=t}}function BS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?FS:US)(t,e)):$e(this.node(),t).duration}function $S(e,t){if(typeof t!="function")throw new Error;return function(){an(this,e).ease=t}}function qS(e){var t=this._id;return arguments.length?this.each($S(t,e)):$e(this.node(),t).ease}function jS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;an(this,e).ease=n}}function zS(e){if(typeof e!="function")throw new Error;return this.each(jS(this._id,e))}function HS(e){typeof e!="function"&&(e=Xm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new An(r,this._parents,this._name,this._id)}function GS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),u=0;u<s;++u)for(var c=t[u],l=n[u],h=c.length,d=o[u]=new Array(h),p,m=0;m<h;++m)(p=c[m]||l[m])&&(d[m]=p);for(;u<r;++u)o[u]=t[u];return new An(o,this._parents,this._name,this._id)}function WS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function KS(e,t,n){var r,i,s=WS(t)?bc:an;return function(){var o=s(this,e),u=o.on;u!==r&&(i=(r=u).copy()).on(t,n),o.on=i}}function QS(e,t){var n=this._id;return arguments.length<2?$e(this.node(),n).on.on(e):this.each(KS(n,e,t))}function XS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function YS(){return this.on("end.remove",XS(this._id))}function JS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Tc(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var u=r[o],c=u.length,l=s[o]=new Array(c),h,d,p=0;p<c;++p)(h=u[p])&&(d=e.call(h,h.__data__,p,u))&&("__data__"in h&&(d.__data__=h.__data__),l[p]=d,Sa(l[p],t,n,p,l,$e(h,n)));return new An(s,this._parents,t,n)}function ZS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Qm(e));for(var r=this._groups,i=r.length,s=[],o=[],u=0;u<i;++u)for(var c=r[u],l=c.length,h,d=0;d<l;++d)if(h=c[d]){for(var p=e.call(h,h.__data__,d,c),m,_=$e(h,n),E=0,v=p.length;E<v;++E)(m=p[E])&&Sa(m,t,n,E,p,_);s.push(p),o.push(h)}return new An(s,o,t,n)}var tb=vs.prototype.constructor;function eb(){return new tb(this._groups,this._parents)}function nb(e,t){var n,r,i;return function(){var s=Kr(this,e),o=(this.style.removeProperty(e),Kr(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function g_(e){return function(){this.style.removeProperty(e)}}function rb(e,t,n){var r,i=n+"",s;return function(){var o=Kr(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function ib(e,t,n){var r,i,s;return function(){var o=Kr(this,e),u=n(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(e),Kr(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u))}}function sb(e,t){var n,r,i,s="style."+t,o="end."+s,u;return function(){var c=an(this,e),l=c.on,h=c.value[s]==null?u||(u=g_(t)):void 0;(l!==n||i!==h)&&(r=(n=l).copy()).on(o,i=h),c.on=r}}function ob(e,t,n){var r=(e+="")=="transform"?lS:p_;return t==null?this.styleTween(e,nb(e,r)).on("end.style."+e,g_(e)):typeof t=="function"?this.styleTween(e,ib(e,r,Cc(this,"style."+e,t))).each(sb(this._id,e)):this.styleTween(e,rb(e,r,t),n).on("end.style."+e,null)}function ab(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function ub(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&ab(e,o,n)),r}return s._value=t,s}function lb(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,ub(e,t,n??""))}function cb(e){return function(){this.textContent=e}}function hb(e){return function(){var t=e(this);this.textContent=t??""}}function fb(e){return this.tween("text",typeof e=="function"?hb(Cc(this,"text",e)):cb(e==null?"":e+""))}function db(e){return function(t){this.textContent=e.call(this,t)}}function pb(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&db(i)),t}return r._value=e,r}function gb(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,pb(e))}function mb(){for(var e=this._name,t=this._id,n=m_(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)if(c=o[l]){var h=$e(c,t);Sa(c,e,n,l,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new An(r,this._parents,e,n)}function _b(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var u={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var l=an(this,r),h=l.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(c)),l.on=t}),i===0&&s()})}var yb=0;function An(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function m_(){return++yb}var hn=vs.prototype;An.prototype={constructor:An,select:JS,selectAll:ZS,selectChild:hn.selectChild,selectChildren:hn.selectChildren,filter:HS,merge:GS,selection:eb,transition:mb,call:hn.call,nodes:hn.nodes,node:hn.node,size:hn.size,empty:hn.empty,each:hn.each,on:QS,attr:PS,attrTween:kS,style:ob,styleTween:lb,text:fb,textTween:gb,remove:YS,tween:TS,delay:LS,duration:BS,ease:qS,easeVarying:zS,end:_b,[Symbol.iterator]:hn[Symbol.iterator]};function vb(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var wb={time:null,delay:0,duration:250,ease:vb};function Eb(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Tb(e){var t,n;e instanceof An?(t=e._id,e=e._name):(t=m_(),(n=wb).time=Rc(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&Sa(c,e,t,l,o,n||Eb(c,t));return new An(r,this._parents,e,t)}vs.prototype.interrupt=vS;vs.prototype.transition=Tb;function Ab(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,o=n.length,u,c=0,l=0;for(s=0;s<o;++s)u=n[s],c+=u.x,l+=u.y;for(c=(c/o-e)*r,l=(l/o-t)*r,s=0;s<o;++s)u=n[s],u.x-=c,u.y-=l}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function Ib(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return __(this.cover(t,n),t,n,e)}function __(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},u=e._x0,c=e._y0,l=e._x1,h=e._y1,d,p,m,_,E,v,P,b;if(!s)return e._root=o,e;for(;s.length;)if((E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p,i=s,!(s=s[P=v<<1|E]))return i[P]=o,e;if(m=+e._x.call(null,s.data),_=+e._y.call(null,s.data),t===m&&n===_)return o.next=s,i?i[P]=o:e._root=o,e;do i=i?i[P]=new Array(4):e._root=new Array(4),(E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p;while((P=v<<1|E)===(b=(_>=p)<<1|m>=d));return i[b]=s,i[P]=o,e}function Rb(e){var t,n,r=e.length,i,s,o=new Array(r),u=new Array(r),c=1/0,l=1/0,h=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,u[n]=s,i<c&&(c=i),i>h&&(h=i),s<l&&(l=s),s>d&&(d=s));if(c>h||l>d)return this;for(this.cover(c,l).cover(h,d),n=0;n<r;++n)__(this,o[n],u[n],e[n]);return this}function Sb(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n||1,u=this._root,c,l;n>e||e>=i||r>t||t>=s;)switch(l=(t<r)<<1|e<n,c=new Array(4),c[l]=u,u=c,o*=2,l){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function bb(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Cb(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ae(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Pb(e,t,n){var r,i=this._x0,s=this._y0,o,u,c,l,h=this._x1,d=this._y1,p=[],m=this._root,_,E;for(m&&p.push(new ae(m,i,s,h,d)),n==null?n=1/0:(i=e-n,s=t-n,h=e+n,d=t+n,n*=n);_=p.pop();)if(!(!(m=_.node)||(o=_.x0)>h||(u=_.y0)>d||(c=_.x1)<i||(l=_.y1)<s))if(m.length){var v=(o+c)/2,P=(u+l)/2;p.push(new ae(m[3],v,P,c,l),new ae(m[2],o,P,v,l),new ae(m[1],v,u,c,P),new ae(m[0],o,u,v,P)),(E=(t>=P)<<1|e>=v)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-E],p[p.length-1-E]=_)}else{var b=e-+this._x.call(null,m.data),N=t-+this._y.call(null,m.data),x=b*b+N*N;if(x<n){var M=Math.sqrt(n=x);i=e-M,s=t-M,h=e+M,d=t+M,r=m.data}}return r}function xb(e){if(isNaN(h=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,u=this._y0,c=this._x1,l=this._y1,h,d,p,m,_,E,v,P;if(!n)return this;if(n.length)for(;;){if((_=h>=(p=(o+c)/2))?o=p:c=p,(E=d>=(m=(u+l)/2))?u=m:l=m,t=n,!(n=n[v=E<<1|_]))return this;if(!n.length)break;(t[v+1&3]||t[v+2&3]||t[v+3&3])&&(r=t,P=v)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[v]=s:delete t[v],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[P]=n:this._root=n),this):(this._root=s,this)}function Vb(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Nb(){return this._root}function Db(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function kb(e){var t=[],n,r=this._root,i,s,o,u,c;for(r&&t.push(new ae(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,u=n.x1,c=n.y1)&&r.length){var l=(s+u)/2,h=(o+c)/2;(i=r[3])&&t.push(new ae(i,l,h,u,c)),(i=r[2])&&t.push(new ae(i,s,h,l,c)),(i=r[1])&&t.push(new ae(i,l,o,u,h)),(i=r[0])&&t.push(new ae(i,s,o,l,h))}return this}function Ob(e){var t=[],n=[],r;for(this._root&&t.push(new ae(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,u=r.y0,c=r.x1,l=r.y1,h=(o+c)/2,d=(u+l)/2;(s=i[0])&&t.push(new ae(s,o,u,h,d)),(s=i[1])&&t.push(new ae(s,h,u,c,d)),(s=i[2])&&t.push(new ae(s,o,d,h,l)),(s=i[3])&&t.push(new ae(s,h,d,c,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Mb(e){return e[0]}function Lb(e){return arguments.length?(this._x=e,this):this._x}function Fb(e){return e[1]}function Ub(e){return arguments.length?(this._y=e,this):this._y}function y_(e,t,n){var r=new Pc(t??Mb,n??Fb,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Pc(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function Rd(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ue=y_.prototype=Pc.prototype;ue.copy=function(){var e=new Pc(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Rd(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Rd(r));return e};ue.add=Ib;ue.addAll=Rb;ue.cover=Sb;ue.data=bb;ue.extent=Cb;ue.find=Pb;ue.remove=xb;ue.removeAll=Vb;ue.root=Nb;ue.size=Db;ue.visit=kb;ue.visitAfter=Ob;ue.x=Lb;ue.y=Ub;function pn(e){return function(){return e}}function Lr(e){return(e()-.5)*1e-6}function Bb(e){return e.index}function Sd(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function $b(e){var t=Bb,n=d,r,i=pn(30),s,o,u,c,l,h=1;e==null&&(e=[]);function d(v){return 1/Math.min(u[v.source.index],u[v.target.index])}function p(v){for(var P=0,b=e.length;P<h;++P)for(var N=0,x,M,U,I,w,T,S;N<b;++N)x=e[N],M=x.source,U=x.target,I=U.x+U.vx-M.x-M.vx||Lr(l),w=U.y+U.vy-M.y-M.vy||Lr(l),T=Math.sqrt(I*I+w*w),T=(T-s[N])/T*v*r[N],I*=T,w*=T,U.vx-=I*(S=c[N]),U.vy-=w*S,M.vx+=I*(S=1-S),M.vy+=w*S}function m(){if(o){var v,P=o.length,b=e.length,N=new Map(o.map((M,U)=>[t(M,U,o),M])),x;for(v=0,u=new Array(P);v<b;++v)x=e[v],x.index=v,typeof x.source!="object"&&(x.source=Sd(N,x.source)),typeof x.target!="object"&&(x.target=Sd(N,x.target)),u[x.source.index]=(u[x.source.index]||0)+1,u[x.target.index]=(u[x.target.index]||0)+1;for(v=0,c=new Array(b);v<b;++v)x=e[v],c[v]=u[x.source.index]/(u[x.source.index]+u[x.target.index]);r=new Array(b),_(),s=new Array(b),E()}}function _(){if(o)for(var v=0,P=e.length;v<P;++v)r[v]=+n(e[v],v,e)}function E(){if(o)for(var v=0,P=e.length;v<P;++v)s[v]=+i(e[v],v,e)}return p.initialize=function(v,P){o=v,l=P,m()},p.links=function(v){return arguments.length?(e=v,m(),p):e},p.id=function(v){return arguments.length?(t=v,p):t},p.iterations=function(v){return arguments.length?(h=+v,p):h},p.strength=function(v){return arguments.length?(n=typeof v=="function"?v:pn(+v),_(),p):n},p.distance=function(v){return arguments.length?(i=typeof v=="function"?v:pn(+v),E(),p):i},p}const qb=1664525,jb=1013904223,bd=4294967296;function zb(){let e=1;return()=>(e=(qb*e+jb)%bd)/bd}function Hb(e){return e.x}function Gb(e){return e.y}var Wb=10,Kb=Math.PI*(3-Math.sqrt(5));function Qb(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,u=new Map,c=Sc(d),l=Ec("tick","end"),h=zb();e==null&&(e=[]);function d(){p(),l.call("tick",t),n<r&&(c.stop(),l.call("end",t))}function p(E){var v,P=e.length,b;E===void 0&&(E=1);for(var N=0;N<E;++N)for(n+=(s-n)*i,u.forEach(function(x){x(n)}),v=0;v<P;++v)b=e[v],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function m(){for(var E=0,v=e.length,P;E<v;++E){if(P=e[E],P.index=E,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var b=Wb*Math.sqrt(.5+E),N=E*Kb;P.x=b*Math.cos(N),P.y=b*Math.sin(N)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function _(E){return E.initialize&&E.initialize(e,h),E}return m(),t={tick:p,restart:function(){return c.restart(d),t},stop:function(){return c.stop(),t},nodes:function(E){return arguments.length?(e=E,m(),u.forEach(_),t):e},alpha:function(E){return arguments.length?(n=+E,t):n},alphaMin:function(E){return arguments.length?(r=+E,t):r},alphaDecay:function(E){return arguments.length?(i=+E,t):+i},alphaTarget:function(E){return arguments.length?(s=+E,t):s},velocityDecay:function(E){return arguments.length?(o=1-E,t):1-o},randomSource:function(E){return arguments.length?(h=E,u.forEach(_),t):h},force:function(E,v){return arguments.length>1?(v==null?u.delete(E):u.set(E,_(v)),t):u.get(E)},find:function(E,v,P){var b=0,N=e.length,x,M,U,I,w;for(P==null?P=1/0:P*=P,b=0;b<N;++b)I=e[b],x=E-I.x,M=v-I.y,U=x*x+M*M,U<P&&(w=I,P=U);return w},on:function(E,v){return arguments.length>1?(l.on(E,v),t):l.on(E)}}}function Xb(){var e,t,n,r,i=pn(-30),s,o=1,u=1/0,c=.81;function l(m){var _,E=e.length,v=y_(e,Hb,Gb).visitAfter(d);for(r=m,_=0;_<E;++_)t=e[_],v.visit(p)}function h(){if(e){var m,_=e.length,E;for(s=new Array(_),m=0;m<_;++m)E=e[m],s[E.index]=+i(E,m,e)}}function d(m){var _=0,E,v,P=0,b,N,x;if(m.length){for(b=N=x=0;x<4;++x)(E=m[x])&&(v=Math.abs(E.value))&&(_+=E.value,P+=v,b+=v*E.x,N+=v*E.y);m.x=b/P,m.y=N/P}else{E=m,E.x=E.data.x,E.y=E.data.y;do _+=s[E.data.index];while(E=E.next)}m.value=_}function p(m,_,E,v){if(!m.value)return!0;var P=m.x-t.x,b=m.y-t.y,N=v-_,x=P*P+b*b;if(N*N/c<x)return x<u&&(P===0&&(P=Lr(n),x+=P*P),b===0&&(b=Lr(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)),t.vx+=P*m.value*r/x,t.vy+=b*m.value*r/x),!0;if(m.length||x>=u)return;(m.data!==t||m.next)&&(P===0&&(P=Lr(n),x+=P*P),b===0&&(b=Lr(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)));do m.data!==t&&(N=s[m.data.index]*r/x,t.vx+=P*N,t.vy+=b*N);while(m=m.next)}return l.initialize=function(m,_){e=m,n=_,h()},l.strength=function(m){return arguments.length?(i=typeof m=="function"?m:pn(+m),h(),l):i},l.distanceMin=function(m){return arguments.length?(o=m*m,l):Math.sqrt(o)},l.distanceMax=function(m){return arguments.length?(u=m*m,l):Math.sqrt(u)},l.theta=function(m){return arguments.length?(c=m*m,l):Math.sqrt(c)},l}function Yb(e,t,n){var r,i=pn(.1),s,o;typeof e!="function"&&(e=pn(+e)),t==null&&(t=0),n==null&&(n=0);function u(l){for(var h=0,d=r.length;h<d;++h){var p=r[h],m=p.x-t||1e-6,_=p.y-n||1e-6,E=Math.sqrt(m*m+_*_),v=(o[h]-E)*s[h]*l/E;p.vx+=m*v,p.vy+=_*v}}function c(){if(r){var l,h=r.length;for(s=new Array(h),o=new Array(h),l=0;l<h;++l)o[l]=+e(r[l],l,r),s[l]=isNaN(o[l])?0:+i(r[l],l,r)}}return u.initialize=function(l){r=l,c()},u.strength=function(l){return arguments.length?(i=typeof l=="function"?l:pn(+l),c(),u):i},u.radius=function(l){return arguments.length?(e=typeof l=="function"?l:pn(+l),c(),u):e},u.x=function(l){return arguments.length?(t=+l,u):t},u.y=function(l){return arguments.length?(n=+l,u):n},u}var pt=1e-6,st=Math.PI,Pe=st/2,Cd=st/4,De=st*2,fn=180/st,Te=st/180,wt=Math.abs,Jb=Math.atan,os=Math.atan2,Ct=Math.cos,Pt=Math.sin,Zb=Math.sign||function(e){return e>0?1:e<0?-1:0},Tr=Math.sqrt;function tC(e){return e>1?0:e<-1?st:Math.acos(e)}function as(e){return e>1?Pe:e<-1?-Pe:Math.asin(e)}function xe(){}function zo(e,t){e&&xd.hasOwnProperty(e.type)&&xd[e.type](e,t)}var Pd={Feature:function(e,t){zo(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)zo(n[r].geometry,t)}},xd={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){tl(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)tl(n[r],t,0)},Polygon:function(e,t){Vd(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Vd(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)zo(n[r],t)}};function tl(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function Vd(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)tl(e[n],t,1);t.polygonEnd()}function Mr(e,t){e&&Pd.hasOwnProperty(e.type)?Pd[e.type](e,t):zo(e,t)}function el(e){return[os(e[1],e[0]),as(e[2])]}function Xr(e){var t=e[0],n=e[1],r=Ct(n);return[r*Ct(t),r*Pt(t),Pt(n)]}function Ws(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ho(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function cu(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Ks(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function nl(e){var t=Tr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function rl(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function il(e,t){return wt(e)>st&&(e-=Math.round(e/De)*De),[e,t]}il.invert=il;function eC(e,t,n){return(e%=De)?t||n?rl(Dd(e),kd(t,n)):Dd(e):t||n?kd(t,n):il}function Nd(e){return function(t,n){return t+=e,wt(t)>st&&(t-=Math.round(t/De)*De),[t,n]}}function Dd(e){var t=Nd(e);return t.invert=Nd(-e),t}function kd(e,t){var n=Ct(e),r=Pt(e),i=Ct(t),s=Pt(t);function o(u,c){var l=Ct(c),h=Ct(u)*l,d=Pt(u)*l,p=Pt(c),m=p*n+h*r;return[os(d*i-m*s,h*n-p*r),as(m*i+d*s)]}return o.invert=function(u,c){var l=Ct(c),h=Ct(u)*l,d=Pt(u)*l,p=Pt(c),m=p*i-d*s;return[os(d*i+p*s,h*n+m*r),as(m*n-h*r)]},o}function nC(e,t,n,r,i,s){if(n){var o=Ct(t),u=Pt(t),c=r*n;i==null?(i=t+r*De,s=t-c/2):(i=Od(o,i),s=Od(o,s),(r>0?i<s:i>s)&&(i+=r*De));for(var l,h=i;r>0?h>s:h<s;h-=c)l=el([o,-u*Ct(h),-u*Pt(h)]),e.point(l[0],l[1])}}function Od(e,t){t=Xr(t),t[0]-=e,nl(t);var n=tC(-t[1]);return((-t[2]<0?-n:n)+De-pt)%De}function v_(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:xe,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function co(e,t){return wt(e[0]-t[0])<pt&&wt(e[1]-t[1])<pt}function Qs(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function w_(e,t,n,r,i){var s=[],o=[],u,c;if(e.forEach(function(_){if(!((E=_.length-1)<=0)){var E,v=_[0],P=_[E],b;if(co(v,P)){if(!v[2]&&!P[2]){for(i.lineStart(),u=0;u<E;++u)i.point((v=_[u])[0],v[1]);i.lineEnd();return}P[0]+=2*pt}s.push(b=new Qs(v,_,null,!0)),o.push(b.o=new Qs(v,null,b,!1)),s.push(b=new Qs(P,_,null,!1)),o.push(b.o=new Qs(P,null,b,!0))}}),!!s.length){for(o.sort(t),Md(s),Md(o),u=0,c=o.length;u<c;++u)o[u].e=n=!n;for(var l=s[0],h,d;;){for(var p=l,m=!0;p.v;)if((p=p.n)===l)return;h=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(m)for(u=0,c=h.length;u<c;++u)i.point((d=h[u])[0],d[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(m)for(h=p.p.z,u=h.length-1;u>=0;--u)i.point((d=h[u])[0],d[1]);else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,h=p.z,m=!m}while(!p.v);i.lineEnd()}}}function Md(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function hu(e){return wt(e[0])<=st?e[0]:Zb(e[0])*((wt(e[0])+st)%De-st)}function rC(e,t){var n=hu(t),r=t[1],i=Pt(r),s=[Pt(n),-Ct(n),0],o=0,u=0,c=new mr;i===1?r=Pe+pt:i===-1&&(r=-Pe-pt);for(var l=0,h=e.length;l<h;++l)if(p=(d=e[l]).length)for(var d,p,m=d[p-1],_=hu(m),E=m[1]/2+Cd,v=Pt(E),P=Ct(E),b=0;b<p;++b,_=x,v=U,P=I,m=N){var N=d[b],x=hu(N),M=N[1]/2+Cd,U=Pt(M),I=Ct(M),w=x-_,T=w>=0?1:-1,S=T*w,R=S>st,C=v*U;if(c.add(os(C*T*Pt(S),P*I+C*Ct(S))),o+=R?w+T*De:w,R^_>=n^x>=n){var A=Ho(Xr(m),Xr(N));nl(A);var Y=Ho(s,A);nl(Y);var F=(R^w>=0?-1:1)*as(Y[2]);(r>F||r===F&&(A[0]||A[1]))&&(u+=R^w>=0?1:-1)}}return(o<-pt||o<pt&&c<-1e-12)^u&1}function E_(e,t,n,r){return function(i){var s=t(i),o=v_(),u=t(o),c=!1,l,h,d,p={point:m,lineStart:E,lineEnd:v,polygonStart:function(){p.point=P,p.lineStart=b,p.lineEnd=N,h=[],l=[]},polygonEnd:function(){p.point=m,p.lineStart=E,p.lineEnd=v,h=Wm(h);var x=rC(l,r);h.length?(c||(i.polygonStart(),c=!0),w_(h,sC,x,n,i)):x&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),h=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function m(x,M){e(x,M)&&i.point(x,M)}function _(x,M){s.point(x,M)}function E(){p.point=_,s.lineStart()}function v(){p.point=m,s.lineEnd()}function P(x,M){d.push([x,M]),u.point(x,M)}function b(){u.lineStart(),d=[]}function N(){P(d[0][0],d[0][1]),u.lineEnd();var x=u.clean(),M=o.result(),U,I=M.length,w,T,S;if(d.pop(),l.push(d),d=null,!!I){if(x&1){if(T=M[0],(w=T.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),U=0;U<w;++U)i.point((S=T[U])[0],S[1]);i.lineEnd()}return}I>1&&x&2&&M.push(M.pop().concat(M.shift())),h.push(M.filter(iC))}}return p}}function iC(e){return e.length>1}function sC(e,t){return((e=e.x)[0]<0?e[1]-Pe-pt:Pe-e[1])-((t=t.x)[0]<0?t[1]-Pe-pt:Pe-t[1])}const Ld=E_(function(){return!0},oC,uC,[-st,-Pe]);function oC(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var u=s>0?st:-st,c=wt(s-t);wt(c-st)<pt?(e.point(t,n=(n+o)/2>0?Pe:-Pe),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&c>=st&&(wt(t-r)<pt&&(t-=r*pt),wt(s-u)<pt&&(s-=u*pt),n=aC(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=o),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function aC(e,t,n,r){var i,s,o=Pt(e-n);return wt(o)>pt?Jb((Pt(t)*(s=Ct(r))*Pt(n)-Pt(r)*(i=Ct(t))*Pt(e))/(i*s*o)):(t+r)/2}function uC(e,t,n,r){var i;if(e==null)i=n*Pe,r.point(-st,i),r.point(0,i),r.point(st,i),r.point(st,0),r.point(st,-i),r.point(0,-i),r.point(-st,-i),r.point(-st,0),r.point(-st,i);else if(wt(e[0]-t[0])>pt){var s=e[0]<t[0]?st:-st;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function lC(e){var t=Ct(e),n=2*Te,r=t>0,i=wt(t)>pt;function s(h,d,p,m){nC(m,e,n,p,h,d)}function o(h,d){return Ct(h)*Ct(d)>t}function u(h){var d,p,m,_,E;return{lineStart:function(){_=m=!1,E=1},point:function(v,P){var b=[v,P],N,x=o(v,P),M=r?x?0:l(v,P):x?l(v+(v<0?st:-st),P):0;if(!d&&(_=m=x)&&h.lineStart(),x!==m&&(N=c(d,b),(!N||co(d,N)||co(b,N))&&(b[2]=1)),x!==m)E=0,x?(h.lineStart(),N=c(b,d),h.point(N[0],N[1])):(N=c(d,b),h.point(N[0],N[1],2),h.lineEnd()),d=N;else if(i&&d&&r^x){var U;!(M&p)&&(U=c(b,d,!0))&&(E=0,r?(h.lineStart(),h.point(U[0][0],U[0][1]),h.point(U[1][0],U[1][1]),h.lineEnd()):(h.point(U[1][0],U[1][1]),h.lineEnd(),h.lineStart(),h.point(U[0][0],U[0][1],3)))}x&&(!d||!co(d,b))&&h.point(b[0],b[1]),d=b,m=x,p=M},lineEnd:function(){m&&h.lineEnd(),d=null},clean:function(){return E|(_&&m)<<1}}}function c(h,d,p){var m=Xr(h),_=Xr(d),E=[1,0,0],v=Ho(m,_),P=Ws(v,v),b=v[0],N=P-b*b;if(!N)return!p&&h;var x=t*P/N,M=-t*b/N,U=Ho(E,v),I=Ks(E,x),w=Ks(v,M);cu(I,w);var T=U,S=Ws(I,T),R=Ws(T,T),C=S*S-R*(Ws(I,I)-1);if(!(C<0)){var A=Tr(C),Y=Ks(T,(-S-A)/R);if(cu(Y,I),Y=el(Y),!p)return Y;var F=h[0],J=d[0],lt=h[1],gt=d[1],kt;J<F&&(kt=F,F=J,J=kt);var qe=J-F,_e=wt(qe-st)<pt,Lt=_e||qe<pt;if(!_e&&gt<lt&&(kt=lt,lt=gt,gt=kt),Lt?_e?lt+gt>0^Y[1]<(wt(Y[0]-F)<pt?lt:gt):lt<=Y[1]&&Y[1]<=gt:qe>st^(F<=Y[0]&&Y[0]<=J)){var ht=Ks(T,(-S+A)/R);return cu(ht,I),[Y,el(ht)]}}}function l(h,d){var p=r?e:st-e,m=0;return h<-p?m|=1:h>p&&(m|=2),d<-p?m|=4:d>p&&(m|=8),m}return E_(o,u,s,r?[0,-e]:[-st,e-st])}function cC(e,t,n,r,i,s){var o=e[0],u=e[1],c=t[0],l=t[1],h=0,d=1,p=c-o,m=l-u,_;if(_=n-o,!(!p&&_>0)){if(_/=p,p<0){if(_<h)return;_<d&&(d=_)}else if(p>0){if(_>d)return;_>h&&(h=_)}if(_=i-o,!(!p&&_<0)){if(_/=p,p<0){if(_>d)return;_>h&&(h=_)}else if(p>0){if(_<h)return;_<d&&(d=_)}if(_=r-u,!(!m&&_>0)){if(_/=m,m<0){if(_<h)return;_<d&&(d=_)}else if(m>0){if(_>d)return;_>h&&(h=_)}if(_=s-u,!(!m&&_<0)){if(_/=m,m<0){if(_>d)return;_>h&&(h=_)}else if(m>0){if(_<h)return;_<d&&(d=_)}return h>0&&(e[0]=o+h*p,e[1]=u+h*m),d<1&&(t[0]=o+d*p,t[1]=u+d*m),!0}}}}}var Ni=1e9,Xs=-Ni;function hC(e,t,n,r){function i(l,h){return e<=l&&l<=n&&t<=h&&h<=r}function s(l,h,d,p){var m=0,_=0;if(l==null||(m=o(l,d))!==(_=o(h,d))||c(l,h)<0^d>0)do p.point(m===0||m===3?e:n,m>1?r:t);while((m=(m+d+4)%4)!==_);else p.point(h[0],h[1])}function o(l,h){return wt(l[0]-e)<pt?h>0?0:3:wt(l[0]-n)<pt?h>0?2:1:wt(l[1]-t)<pt?h>0?1:0:h>0?3:2}function u(l,h){return c(l.x,h.x)}function c(l,h){var d=o(l,1),p=o(h,1);return d!==p?d-p:d===0?h[1]-l[1]:d===1?l[0]-h[0]:d===2?l[1]-h[1]:h[0]-l[0]}return function(l){var h=l,d=v_(),p,m,_,E,v,P,b,N,x,M,U,I={point:w,lineStart:C,lineEnd:A,polygonStart:S,polygonEnd:R};function w(F,J){i(F,J)&&h.point(F,J)}function T(){for(var F=0,J=0,lt=m.length;J<lt;++J)for(var gt=m[J],kt=1,qe=gt.length,_e=gt[0],Lt,ht,Rn=_e[0],le=_e[1];kt<qe;++kt)Lt=Rn,ht=le,_e=gt[kt],Rn=_e[0],le=_e[1],ht<=r?le>r&&(Rn-Lt)*(r-ht)>(le-ht)*(e-Lt)&&++F:le<=r&&(Rn-Lt)*(r-ht)<(le-ht)*(e-Lt)&&--F;return F}function S(){h=d,p=[],m=[],U=!0}function R(){var F=T(),J=U&&F,lt=(p=Wm(p)).length;(J||lt)&&(l.polygonStart(),J&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),lt&&w_(p,u,F,s,l),l.polygonEnd()),h=l,p=m=_=null}function C(){I.point=Y,m&&m.push(_=[]),M=!0,x=!1,b=N=NaN}function A(){p&&(Y(E,v),P&&x&&d.rejoin(),p.push(d.result())),I.point=w,x&&h.lineEnd()}function Y(F,J){var lt=i(F,J);if(m&&_.push([F,J]),M)E=F,v=J,P=lt,M=!1,lt&&(h.lineStart(),h.point(F,J));else if(lt&&x)h.point(F,J);else{var gt=[b=Math.max(Xs,Math.min(Ni,b)),N=Math.max(Xs,Math.min(Ni,N))],kt=[F=Math.max(Xs,Math.min(Ni,F)),J=Math.max(Xs,Math.min(Ni,J))];cC(gt,kt,e,t,n,r)?(x||(h.lineStart(),h.point(gt[0],gt[1])),h.point(kt[0],kt[1]),lt||h.lineEnd(),U=!1):lt&&(h.lineStart(),h.point(F,J),U=!1)}b=F,N=J,x=lt}return I}}const sl=e=>e;var fu=new mr,ol=new mr,T_,A_,al,ul,dn={point:xe,lineStart:xe,lineEnd:xe,polygonStart:function(){dn.lineStart=fC,dn.lineEnd=pC},polygonEnd:function(){dn.lineStart=dn.lineEnd=dn.point=xe,fu.add(wt(ol)),ol=new mr},result:function(){var e=fu/2;return fu=new mr,e}};function fC(){dn.point=dC}function dC(e,t){dn.point=I_,T_=al=e,A_=ul=t}function I_(e,t){ol.add(ul*e-al*t),al=e,ul=t}function pC(){I_(T_,A_)}var Yr=1/0,Go=Yr,us=-Yr,Wo=us,Ko={point:gC,lineStart:xe,lineEnd:xe,polygonStart:xe,polygonEnd:xe,result:function(){var e=[[Yr,Go],[us,Wo]];return us=Wo=-(Go=Yr=1/0),e}};function gC(e,t){e<Yr&&(Yr=e),e>us&&(us=e),t<Go&&(Go=t),t>Wo&&(Wo=t)}var ll=0,cl=0,Di=0,Qo=0,Xo=0,Fr=0,hl=0,fl=0,ki=0,R_,S_,Qe,Xe,Ce={point:yr,lineStart:Fd,lineEnd:Ud,polygonStart:function(){Ce.lineStart=yC,Ce.lineEnd=vC},polygonEnd:function(){Ce.point=yr,Ce.lineStart=Fd,Ce.lineEnd=Ud},result:function(){var e=ki?[hl/ki,fl/ki]:Fr?[Qo/Fr,Xo/Fr]:Di?[ll/Di,cl/Di]:[NaN,NaN];return ll=cl=Di=Qo=Xo=Fr=hl=fl=ki=0,e}};function yr(e,t){ll+=e,cl+=t,++Di}function Fd(){Ce.point=mC}function mC(e,t){Ce.point=_C,yr(Qe=e,Xe=t)}function _C(e,t){var n=e-Qe,r=t-Xe,i=Tr(n*n+r*r);Qo+=i*(Qe+e)/2,Xo+=i*(Xe+t)/2,Fr+=i,yr(Qe=e,Xe=t)}function Ud(){Ce.point=yr}function yC(){Ce.point=wC}function vC(){b_(R_,S_)}function wC(e,t){Ce.point=b_,yr(R_=Qe=e,S_=Xe=t)}function b_(e,t){var n=e-Qe,r=t-Xe,i=Tr(n*n+r*r);Qo+=i*(Qe+e)/2,Xo+=i*(Xe+t)/2,Fr+=i,i=Xe*e-Qe*t,hl+=i*(Qe+e),fl+=i*(Xe+t),ki+=i*3,yr(Qe=e,Xe=t)}function C_(e){this._context=e}C_.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,De);break}}},result:xe};var dl=new mr,du,P_,x_,Oi,Mi,ls={point:xe,lineStart:function(){ls.point=EC},lineEnd:function(){du&&V_(P_,x_),ls.point=xe},polygonStart:function(){du=!0},polygonEnd:function(){du=null},result:function(){var e=+dl;return dl=new mr,e}};function EC(e,t){ls.point=V_,P_=Oi=e,x_=Mi=t}function V_(e,t){Oi-=e,Mi-=t,dl.add(Tr(Oi*Oi+Mi*Mi)),Oi=e,Mi=t}let Bd,Yo,$d,qd;class jd{constructor(t){this._append=t==null?N_:TC(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==$d||this._append!==Yo){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,$d=r,Yo=this._append,qd=this._,this._=i}this._+=qd;break}}}result(){const t=this._;return this._="",t.length?t:null}}function N_(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function TC(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return N_;if(t!==Bd){const n=10**t;Bd=t,Yo=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return Yo}function AC(e,t){let n=3,r=4.5,i,s;function o(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Mr(u,i(s))),s.result()}return o.area=function(u){return Mr(u,i(dn)),dn.result()},o.measure=function(u){return Mr(u,i(ls)),ls.result()},o.bounds=function(u){return Mr(u,i(Ko)),Ko.result()},o.centroid=function(u){return Mr(u,i(Ce)),Ce.result()},o.projection=function(u){return arguments.length?(i=u==null?(e=null,sl):(e=u).stream,o):e},o.context=function(u){return arguments.length?(s=u==null?(t=null,new jd(n)):new C_(t=u),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),o):r},o.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const c=Math.floor(u);if(!(c>=0))throw new RangeError(`invalid digits: ${u}`);n=c}return t===null&&(s=new jd(n)),o},o.projection(e).digits(n).context(t)}function xc(e){return function(t){var n=new pl;for(var r in e)n[r]=e[r];return n.stream=t,n}}function pl(){}pl.prototype={constructor:pl,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Vc(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Mr(n,e.stream(Ko)),t(Ko.result()),r!=null&&e.clipExtent(r),e}function D_(e,t,n){return Vc(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([u,c])},n)}function IC(e,t,n){return D_(e,[[0,0],t],n)}function RC(e,t,n){return Vc(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([o,u])},n)}function SC(e,t,n){return Vc(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,u])},n)}var zd=16,bC=Ct(30*Te);function Hd(e,t){return+t?PC(e,t):CC(e)}function CC(e){return xc({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function PC(e,t){function n(r,i,s,o,u,c,l,h,d,p,m,_,E,v){var P=l-r,b=h-i,N=P*P+b*b;if(N>4*t&&E--){var x=o+p,M=u+m,U=c+_,I=Tr(x*x+M*M+U*U),w=as(U/=I),T=wt(wt(U)-1)<pt||wt(s-d)<pt?(s+d)/2:os(M,x),S=e(T,w),R=S[0],C=S[1],A=R-r,Y=C-i,F=b*A-P*Y;(F*F/N>t||wt((P*A+b*Y)/N-.5)>.3||o*p+u*m+c*_<bC)&&(n(r,i,s,o,u,c,R,C,T,x/=I,M/=I,U,E,v),v.point(R,C),n(R,C,T,x,M,U,l,h,d,p,m,_,E,v))}}return function(r){var i,s,o,u,c,l,h,d,p,m,_,E,v={point:P,lineStart:b,lineEnd:x,polygonStart:function(){r.polygonStart(),v.lineStart=M},polygonEnd:function(){r.polygonEnd(),v.lineStart=b}};function P(w,T){w=e(w,T),r.point(w[0],w[1])}function b(){d=NaN,v.point=N,r.lineStart()}function N(w,T){var S=Xr([w,T]),R=e(w,T);n(d,p,h,m,_,E,d=R[0],p=R[1],h=w,m=S[0],_=S[1],E=S[2],zd,r),r.point(d,p)}function x(){v.point=P,r.lineEnd()}function M(){b(),v.point=U,v.lineEnd=I}function U(w,T){N(i=w,T),s=d,o=p,u=m,c=_,l=E,v.point=N}function I(){n(d,p,h,m,_,E,s,o,i,u,c,l,zd,r),v.lineEnd=x,x()}return v}}var xC=xc({point:function(e,t){this.stream.point(e*Te,t*Te)}});function VC(e){return xc({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function NC(e,t,n,r,i){function s(o,u){return o*=r,u*=i,[t+e*o,n-e*u]}return s.invert=function(o,u){return[(o-t)/e*r,(n-u)/e*i]},s}function Gd(e,t,n,r,i,s){if(!s)return NC(e,t,n,r,i);var o=Ct(s),u=Pt(s),c=o*e,l=u*e,h=o/e,d=u/e,p=(u*n-o*t)/e,m=(u*t+o*n)/e;function _(E,v){return E*=r,v*=i,[c*E-l*v+t,n-l*E-c*v]}return _.invert=function(E,v){return[r*(h*E-d*v+p),i*(m-d*E-h*v)]},_}function DC(e){return kC(function(){return e})()}function kC(e){var t,n=150,r=480,i=250,s=0,o=0,u=0,c=0,l=0,h,d=0,p=1,m=1,_=null,E=Ld,v=null,P,b,N,x=sl,M=.5,U,I,w,T,S;function R(F){return w(F[0]*Te,F[1]*Te)}function C(F){return F=w.invert(F[0],F[1]),F&&[F[0]*fn,F[1]*fn]}R.stream=function(F){return T&&S===F?T:T=xC(VC(h)(E(U(x(S=F)))))},R.preclip=function(F){return arguments.length?(E=F,_=void 0,Y()):E},R.postclip=function(F){return arguments.length?(x=F,v=P=b=N=null,Y()):x},R.clipAngle=function(F){return arguments.length?(E=+F?lC(_=F*Te):(_=null,Ld),Y()):_*fn},R.clipExtent=function(F){return arguments.length?(x=F==null?(v=P=b=N=null,sl):hC(v=+F[0][0],P=+F[0][1],b=+F[1][0],N=+F[1][1]),Y()):v==null?null:[[v,P],[b,N]]},R.scale=function(F){return arguments.length?(n=+F,A()):n},R.translate=function(F){return arguments.length?(r=+F[0],i=+F[1],A()):[r,i]},R.center=function(F){return arguments.length?(s=F[0]%360*Te,o=F[1]%360*Te,A()):[s*fn,o*fn]},R.rotate=function(F){return arguments.length?(u=F[0]%360*Te,c=F[1]%360*Te,l=F.length>2?F[2]%360*Te:0,A()):[u*fn,c*fn,l*fn]},R.angle=function(F){return arguments.length?(d=F%360*Te,A()):d*fn},R.reflectX=function(F){return arguments.length?(p=F?-1:1,A()):p<0},R.reflectY=function(F){return arguments.length?(m=F?-1:1,A()):m<0},R.precision=function(F){return arguments.length?(U=Hd(I,M=F*F),Y()):Tr(M)},R.fitExtent=function(F,J){return D_(R,F,J)},R.fitSize=function(F,J){return IC(R,F,J)},R.fitWidth=function(F,J){return RC(R,F,J)},R.fitHeight=function(F,J){return SC(R,F,J)};function A(){var F=Gd(n,0,0,p,m,d).apply(null,t(s,o)),J=Gd(n,r-F[0],i-F[1],p,m,d);return h=eC(u,c,l),I=rl(t,J),w=rl(h,I),U=Hd(I,M),Y()}function Y(){return T=S=null,R}return function(){return t=e.apply(this,arguments),R.invert=t.invert&&C,A()}}function k_(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}k_.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(wt(i)>pt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function OC(){return DC(k_).scale(175.295)}function Li(e,t,n){this.k=e,this.x=t,this.y=n}Li.prototype={constructor:Li,scale:function(e){return e===1?this:new Li(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Li(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Li.prototype;function MC(e){return e}function LC(e){if(e==null)return MC;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(u,c){c||(t=n=0);var l=2,h=u.length,d=new Array(h);for(d[0]=(t+=u[0])*r+s,d[1]=(n+=u[1])*i+o;l<h;)d[l]=u[l],++l;return d}}function FC(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function Wd(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Kd(e,n)})}:Kd(e,t)}function Kd(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=UC(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function UC(e,t){var n=LC(e.transform),r=e.arcs;function i(h,d){d.length&&d.pop();for(var p=r[h<0?~h:h],m=0,_=p.length;m<_;++m)d.push(n(p[m],m));h<0&&FC(d,_)}function s(h){return n(h)}function o(h){for(var d=[],p=0,m=h.length;p<m;++p)i(h[p],d);return d.length<2&&d.push(d[0]),d}function u(h){for(var d=o(h);d.length<4;)d.push(d[0]);return d}function c(h){return h.map(u)}function l(h){var d=h.type,p;switch(d){case"GeometryCollection":return{type:d,geometries:h.geometries.map(l)};case"Point":p=s(h.coordinates);break;case"MultiPoint":p=h.coordinates.map(s);break;case"LineString":p=o(h.arcs);break;case"MultiLineString":p=h.arcs.map(o);break;case"Polygon":p=c(h.arcs);break;case"MultiPolygon":p=h.arcs.map(c);break;default:return null}return{type:d,coordinates:p}}return l(t)}var BC=Wn('<div class="loading-indicator svelte-74oupg">Loading...</div>'),$C=Wn('<img alt="Header image"/>'),qC=(e,t)=>{e.key==="Enter"&&t()},jC=ei('<path fill="#ADC2CE" stroke="#377293" stroke-width="0.5"></path>'),zC=(e,t,n,r)=>{nt(t,B(n).domain,!0),nt(r,B(n).city||B(n).country||"Unknown location",!0)},HC=(e,t,n)=>{nt(t,null),nt(n,"")},GC=ei('<g class="location-pin svelte-74oupg"><circle class="pin svelte-74oupg"></circle></g>'),WC=ei(" <!>",1),KC=ei('<svg width="200" height="125" viewBox="0 0 200 125" class="world-map svelte-74oupg"><!><!></svg>'),QC=Wn('<span style="color: #377293; font-weight: bold; font-size: 0.95rem;"> </span>'),XC=(e,t,n,r,i,s)=>{nt(t,n(B(r).link),!0);const o=B(i).find(u=>u.domain===B(t));nt(s,o?o.city||o.country||o.domain||"Unknown location":B(t)||"Unknown location",!0),console.log("Hovered Domain:",B(t))},YC=(e,t,n)=>{nt(t,null),nt(n,"")},JC=Wn('<div class="image-with-title svelte-74oupg"><a target="_blank" rel="noopener noreferrer"><img class="svelte-74oupg"/></a> <div class="image-title-box"><!></div></div>'),ZC=Wn('<div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;"><span style="color: #377293; font-weight: bold; font-size: 0.95rem;">Rollover for image locations</span> <!></div> <div class="image-container svelte-74oupg"></div>',1),tP=Wn('<div class="no-images-placeholder svelte-74oupg"><p>Your search results will appear here</p></div>'),eP=ei('<line stroke="#fff" stroke-opacity="0.6" stroke-width="2" class="svelte-74oupg"></line>'),nP=(e,t)=>console.log(B(t).id),rP=ei('<text fill="steelblue" text-anchor="middle" alignment-baseline="middle" filter="url(#dropshadow)" class="svelte-74oupg"> </text>'),iP=Wn('<li class="svelte-74oupg"> <span class="count svelte-74oupg"> </span></li>'),sP=Wn(`<main class="svelte-74oupg"><!> <div class="header svelte-74oupg"><div class="header-image-crossfade svelte-74oupg"></div> <div><div class="title svelte-74oupg">GREAT WAVE <span style="color: #F0BF91;">REMIX</span></div> <p class="subtitle svelte-74oupg">Discover Hokusai's "Great Wave off Kanagawa" in diverse and unexpected
        contexts worldwide. Search for any term to see how this iconic Japanese
        artwork has been reimagined in images spanning nations and cultures.</p></div></div> <div class="header-piping svelte-74oupg"></div> <h1 class="svelte-74oupg">HOKUSAI'S <em class="italic svelte-74oupg">GREAT WAVE</em> CAN BE <input type="text" placeholder="ANYTHING" class="svelte-74oupg"/> <div class="search-container svelte-74oupg"><div class="button-wrapper svelte-74oupg"><button class="svelte-74oupg">Search</button></div> <div class="call-to-action svelte-74oupg">No images yet â try a search!</div></div></h1> <div class="main-grid svelte-74oupg"><div class="left-column svelte-74oupg"><div class="map-container svelte-74oupg"><!></div> <!></div> <div class="right-column svelte-74oupg"><div class="word-cloud-container svelte-74oupg"><h3 class="svelte-74oupg">Trending topics</h3> <svg width="100%" height="400" viewBox="0 0 400 400" class="svelte-74oupg"><defs><filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.3"></feDropShadow></filter></defs><g style="transform: translate(0, -100px)"><!><!></g></svg> <div class="trending-panel svelte-74oupg"><ul class="svelte-74oupg"></ul></div></div></div></div> <h2 class="svelte-74oupg">Google Ngram Viewer shows a steady rise in mentions of "Great Wave off
    Kanagawa"</h2> <div class="bottom-panel svelte-74oupg"><div class="chart-container svelte-74oupg"><iframe name="ngram_chart" src="https://books.google.com/ngrams/interactive_chart?content=Great+Wave+off+Kanagawa&amp;year_start=1800&amp;year_end=2022&amp;corpus=en&amp;smoothing=3" width="900" height="400" marginwidth="50" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" class="svelte-74oupg"></iframe></div></div></main>`);function oP(e,t){op(t,!0);let n=Ot(0),r;const i=["/great-wave-everywhere/main-image.jpeg","/great-wave-everywhere/Hokusai-Great_Wave_off_Kanagawa-cat-end.jpg","/great-wave-everywhere/tomoko_nagao_hokusai-the_great_wave_of_kanagawa_with_mc_cupnoodle_kewpie_kikkoman_and_kitty_2012_digital_art_50_x_70_cm-_70_x_100_cm.jpe_3.jpg","/great-wave-everywhere/135e9cb8ff232a9c7e1f1be108eb670f.jpg","/great-wave-everywhere/2372ef58832305.5a0b25df284b7.jpg.webp","/great-wave-everywhere/image_BT0qjFvT31.png.jpeg"];yu(()=>{r=setInterval(()=>{nt(n,(B(n)+1)%i.length)},5e3)}),Tv(()=>{clearInterval(r)});function s(H){if(!H)return null;try{return H.replace(/^https?:\/\//,"").split("?")[0].replace(/\/$/,"")}catch{return null}}function o(H){if(!H)return null;try{const z=H.startsWith("http")?H:`https://${H}`;return new URL(z).hostname}catch{return H}}let u=Ot(null),c=Ot(We([])),l=Ot(""),h=Ot(We([])),d=Ot(We([])),p=Ot(We([])),m=Ot(!1),_=Ot(We([])),E=Ot(null),v=Ot("");async function P(){try{const H=await fetch("/great-wave-everywhere/ne_110m_admin_0_countries.json");if(!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const z=await H.json(),X=Object.keys(z.objects)[0];nt(E,Wd(z,z.objects[X]),!0)}catch{try{const z=await fetch("/ne_110m_admin_0_countries.json");if(z.ok){const X=await z.json(),ct=Object.keys(X.objects)[0];nt(E,Wd(X,X.objects[ct]),!0)}}catch{}}}yu(async()=>{nt(m,!0);try{try{nt(h,await Kf(),!0),nt(p,await Qf(5),!0),N(),x()}catch(H){console.warn("Firebase connection failed:",H),nt(h,[],!0),nt(p,[],!0)}await P()}finally{nt(m,!1)}});async function b(){if(B(l)){nt(m,!0);try{const H=await Rt.get(`https://great-wave-api-1muq.onrender.com/api/images?q=${B(l)}`);nt(c,H.data,!0);const z=B(c).map(ct=>ct.link).filter(Boolean);let X=[];if(z.length>0)try{X=(await Rt.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:z})).data,console.log("Geolocation API data:",X)}catch{}nt(_,X.filter(ct=>{if(ct==null)return!1;const Gt=Number(ct.lat),Wt=Number(ct.lng);return!(isNaN(Gt)||isNaN(Wt)||Gt===0&&Wt===0)}),!0);try{await P1(B(l)),nt(h,await Kf(),!0),nt(p,await Qf(5),!0),N(),x()}catch(ct){console.warn("Firebase update failed:",ct)}nt(l,"")}catch(H){console.error("Error fetching images",H)}finally{nt(m,!1)}}}function N(){nt(d,[],!0);for(let H=1;H<B(h).length;H++)B(d).push({source:B(h)[H-1].id,target:B(h)[H].id})}function x(){const H=Math.max(...B(h).map(z=>z.count));Qb(B(h)).force("link",$b(B(d)).id(z=>z.id).distance(25)).force("charge",Xb().strength(-100)).force("center",Ab(200,300)).force("gravity",Yb(z=>150*(1-z.count/H),200,300).strength(.5)).force("boundary",()=>{B(h).forEach(z=>{z.x=Math.max(20,Math.min(380,z.x||0)),z.y=Math.max(20,Math.min(580,z.y||0))})}).on("tick",()=>{nt(h,[...B(h)],!0)})}function M(H){return B(h).find(z=>z.id===H)}function U(H){const z=M(H.source),X=M(H.target);return{x1:(z==null?void 0:z.x)||0,y1:(z==null?void 0:z.y)||0,x2:(X==null?void 0:X.x)||0,y2:(X==null?void 0:X.y)||0}}var I=sP(),w=Et(I);{var T=H=>{var z=BC();Ft(H,z)};Pn(w,H=>{B(m)&&H(T)})}var S=qt(w,2),R=Et(S);rr(R,21,()=>i,nr,(H,z,X)=>{var ct=$C();let Gt;Me(Wt=>{se(ct,"src",B(z)),Gt=mv(ct,1,"svelte-74oupg",null,Gt,Wt)},[()=>({visible:B(n)===X,hidden:B(n)!==X})]),Ft(H,ct)});var C=qt(S,4),A=qt(Et(C),3);A.__keydown=[qC,b];var Y=qt(A,2),F=Et(Y),J=Et(F);J.__click=b;var lt=qt(C,2),gt=Et(lt),kt=Et(gt),qe=Et(kt);{var _e=H=>{var z=KC();const X=Ls(()=>OC().scale(40).translate([100,62.5])),ct=Ls(()=>AC().projection(B(X)));var Gt=Et(z);rr(Gt,17,()=>B(E).features,nr,(St,ne,ke)=>{var re=Ka();const Qt=Ls(()=>B(ct)(B(ne)));var un=Ai(re);{var vt=ye=>{var je=jC();Me(()=>se(je,"d",B(Qt))),Ft(ye,je)},At=ye=>{var je=sv();Me(ve=>xr(je,ve),[()=>{var ve;return console.log(`No path data for country ${ke}:`,(ve=B(ne).geometry)==null?void 0:ve.type)}]),Ft(ye,je)};Pn(un,ye=>{B(Qt)?ye(vt):ye(At,!1)})}Ft(St,re)});var Wt=qt(Gt);{var Kt=St=>{var ne=Ka(),ke=Ai(ne);rr(ke,17,()=>B(_),nr,(re,Qt)=>{var un=WC();const vt=Ls(()=>B(X)([B(Qt).lng,B(Qt).lat]));var At=Ai(un),ye=qt(At);{var je=ve=>{var Rr=GC();Rr.__mouseover=[zC,u,Qt,v],Rr.__mouseout=[HC,u,v];var ze=Et(Rr);Me(()=>{se(ze,"cx",B(vt)[0]),se(ze,"cy",B(vt)[1]),se(ze,"r",B(u)===B(Qt).domain?7:4),se(ze,"fill",B(u)===B(Qt).domain?"#ff4500":"#ff6b35")}),Ft(ve,Rr)};Pn(ye,ve=>{B(vt)&&ve(je)})}Me(ve=>xr(At,ve),[()=>console.log(B(Qt))]),Ft(re,un)}),Ft(St,ne)};Pn(Wt,St=>{B(_).length>0&&St(Kt)})}Ft(H,z)};Pn(qe,H=>{B(c).length>0&&B(E)&&H(_e)})}var Lt=qt(kt,2);{var ht=H=>{var z=ZC(),X=Ai(z),ct=qt(Et(X),2);{var Gt=Kt=>{var St=QC(),ne=Et(St);Me(()=>xr(ne,B(v))),Ft(Kt,St)};Pn(ct,Kt=>{B(v)&&Kt(Gt)})}var Wt=qt(X,2);rr(Wt,21,()=>B(c),nr,(Kt,St)=>{var ne=JC(),ke=Et(ne),re=Et(ke);re.__mouseover=[XC,u,o,St,_,v],re.__mouseout=[YC,u,v];var Qt=qt(ke,2),un=Et(Qt);dv(un,()=>`<textarea readonly rows='2'>${B(St).title}</textarea>`),Me((vt,At)=>{se(ke,"href",B(St).link),se(re,"src",B(St).link),kh(re,`border: ${vt??""};`),kh(Qt,`background: ${At??""};`)},[()=>B(u)===o(B(St).link)?"2px solid #ff6b35":"none",()=>B(u)===s(B(St).link)?"#ffe5d0":"#f9f9f9"]),Ft(Kt,ne)}),Ft(H,z)},Rn=H=>{var z=tP();Ft(H,z)};Pn(Lt,H=>{B(c).length>0?H(ht):H(Rn,!1)})}var le=qt(gt,2),ba=Et(le),Yn=qt(Et(ba),2),Ca=qt(Et(Yn)),Es=Et(Ca);rr(Es,17,()=>B(d),nr,(H,z)=>{var X=Ka(),ct=Ai(X);{var Gt=Wt=>{var Kt=eP();Me((St,ne,ke,re)=>{se(Kt,"x1",St),se(Kt,"y1",ne),se(Kt,"x2",ke),se(Kt,"y2",re)},[()=>U(B(z)).x1,()=>U(B(z)).y1,()=>U(B(z)).x2,()=>U(B(z)).y2]),Ft(Wt,Kt)};Pn(ct,Wt=>{M(B(z).source)&&M(B(z).target)&&Wt(Gt)})}Ft(H,X)});var Ar=qt(Es);rr(Ar,17,()=>B(h),nr,(H,z)=>{var X=rP();X.__mouseover=[nP,z];var ct=Et(X);Me(()=>{se(X,"x",B(z).x),se(X,"y",B(z).y),se(X,"font-size",`${10*B(z).count}px`),xr(ct,B(z).id)}),Ft(H,X)});var Ir=qt(Yn,2),ci=Et(Ir);rr(ci,21,()=>B(p),nr,(H,z)=>{var X=iP(),ct=Et(X),Gt=qt(ct),Wt=Et(Gt);Me(()=>{xr(ct,`${B(z).id??""} `),xr(Wt,`(${B(z).count??""})`)}),Ft(H,X)}),Ev(A,()=>B(l),H=>nt(l,H)),Ft(e,I),ap()}rv(["keydown","click","mouseover","mouseout"]);ov(oP,{target:document.getElementById("app")});
