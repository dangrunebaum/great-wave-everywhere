var ay=Object.defineProperty;var uy=(e,t,n)=>t in e?ay(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ka=(e,t,n)=>uy(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Sh=!1;var yl=Array.isArray,ly=Array.prototype.indexOf,vl=Array.from,cy=Object.defineProperty,$i=Object.getOwnPropertyDescriptor,hy=Object.getOwnPropertyDescriptors,fy=Object.prototype,dy=Array.prototype,Jd=Object.getPrototypeOf,bh=Object.isExtensible;function py(e){for(var t=0;t<e.length;t++)e[t]()}const Pe=2,Zd=4,na=8,wl=16,Tn=32,ei=64,El=128,Ae=256,go=512,xe=1024,mn=2048,Tr=4096,dn=8192,Tl=16384,tp=32768,Al=65536,Ch=1<<17,my=1<<18,ep=1<<19,_u=1<<20,Qa=Symbol("$state"),gy=Symbol(""),np=new class extends Error{constructor(){super(...arguments);Ka(this,"name","StaleReactionError");Ka(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function rp(e){return e===this.v}function _y(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ip(e){return!_y(e,this.v)}function yy(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function vy(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function wy(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Ey(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ty(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ay(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Iy(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Ry=!1;const Il=1,Rl=2,sp=4,Sy=8,by=16,op=1,Cy=2,ue=Symbol(),Py="http://www.w3.org/1999/xhtml";function ap(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let fe=null;function Ph(e){fe=e}function up(e,t=!1,n){var r=fe={p:fe,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};Fy(()=>{r.d=!0})}function lp(e){const t=fe;if(t!==null){const o=t.e;if(o!==null){var n=ft,r=at;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];$n(s.effect),en(s.reaction),yp(s.fn)}}finally{$n(n),en(r)}}fe=t.p,t.m=!0}return{}}function cp(){return!0}function He(e){if(typeof e!="object"||e===null||Qa in e)return e;const t=Jd(e);if(t!==fy&&t!==dy)return e;var n=new Map,r=yl(e),i=Ft(0),s=at,o=u=>{var c=at;en(s);var l=u();return en(c),l};return r&&n.set("length",Ft(e.length)),new Proxy(e,{defineProperty(u,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&Ty();var h=n.get(c);return h===void 0?h=o(()=>{var d=Ft(l.value);return n.set(c,d),d}):ut(h,l.value,!0),!0},deleteProperty(u,c){var l=n.get(c);if(l===void 0){if(c in u){const p=o(()=>Ft(ue));n.set(c,p),Xa(i)}}else{if(r&&typeof c=="string"){var h=n.get("length"),d=Number(c);Number.isInteger(d)&&d<h.v&&ut(h,d)}ut(l,ue),Xa(i)}return!0},get(u,c,l){var g;if(c===Qa)return e;var h=n.get(c),d=c in u;if(h===void 0&&(!d||(g=$i(u,c))!=null&&g.writable)&&(h=o(()=>{var _=He(d?u[c]:ue),E=Ft(_);return E}),n.set(c,h)),h!==void 0){var p=$(h);return p===ue?void 0:p}return Reflect.get(u,c,l)},getOwnPropertyDescriptor(u,c){var l=Reflect.getOwnPropertyDescriptor(u,c);if(l&&"value"in l){var h=n.get(c);h&&(l.value=$(h))}else if(l===void 0){var d=n.get(c),p=d==null?void 0:d.v;if(d!==void 0&&p!==ue)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return l},has(u,c){var p;if(c===Qa)return!0;var l=n.get(c),h=l!==void 0&&l.v!==ue||Reflect.has(u,c);if(l!==void 0||ft!==null&&(!h||(p=$i(u,c))!=null&&p.writable)){l===void 0&&(l=o(()=>{var g=h?He(u[c]):ue,_=Ft(g);return _}),n.set(c,l));var d=$(l);if(d===ue)return!1}return h},set(u,c,l,h){var N;var d=n.get(c),p=c in u;if(r&&c==="length")for(var g=l;g<d.v;g+=1){var _=n.get(g+"");_!==void 0?ut(_,ue):g in u&&(_=o(()=>Ft(ue)),n.set(g+"",_))}if(d===void 0)(!p||(N=$i(u,c))!=null&&N.writable)&&(d=o(()=>Ft(void 0)),ut(d,He(l)),n.set(c,d));else{p=d.v!==ue;var E=o(()=>He(l));ut(d,E)}var v=Reflect.getOwnPropertyDescriptor(u,c);if(v!=null&&v.set&&v.set.call(h,l),!p){if(r&&typeof c=="string"){var P=n.get("length"),b=Number(c);Number.isInteger(b)&&b>=P.v&&ut(P,b+1)}Xa(i)}return!0},ownKeys(u){$(i);var c=Reflect.ownKeys(u).filter(d=>{var p=n.get(d);return p===void 0||p.v!==ue});for(var[l,h]of n)h.v!==ue&&!(l in u)&&c.push(l);return c},setPrototypeOf(){Ay()}})}function Xa(e,t=1){ut(e,e.v+t)}function Sl(e){var t=Pe|mn,n=at!==null&&(at.f&Pe)!==0?at:null;return ft===null||n!==null&&(n.f&Ae)!==0?t|=Ae:ft.f|=ep,{ctx:fe,deps:null,effects:null,equals:rp,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??ft,ac:null}}function $s(e){const t=Sl(e);return Sp(t),t}function xy(e){const t=Sl(e);return t.equals=ip,t}function hp(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Bn(t[n])}}function Vy(e){for(var t=e.parent;t!==null;){if((t.f&Pe)===0)return t;t=t.parent}return null}function fp(e){var t,n=ft;$n(Vy(e));try{hp(e),t=xp(e)}finally{$n(n)}return t}function dp(e){var t=fp(e);if(e.equals(t)||(e.v=t,e.wv=Cp()),!ri){var n=(kn||(e.f&Ae)!==0)&&e.deps!==null?Tr:xe;nn(e,n)}}const Wi=new Map;function _o(e,t){var n={f:0,v:e,reactions:null,equals:rp,rv:0,wv:0};return n}function Ft(e,t){const n=_o(e);return Sp(n),n}function Ny(e,t=!1,n=!0){const r=_o(e);return t||(r.equals=ip),r}function ut(e,t,n=!1){at!==null&&(!Ge||(at.f&Ch)!==0)&&cp()&&(at.f&(Pe|wl|Ch))!==0&&!(Bt!=null&&Bt[1].includes(e)&&Bt[0]===at)&&Iy();let r=n?He(t):t;return yu(e,r)}function yu(e,t){if(!e.equals(t)){var n=e.v;ri?Wi.set(e,t):Wi.set(e,n),e.v=t,(e.f&Pe)!==0&&((e.f&mn)!==0&&fp(e),nn(e,(e.f&Ae)===0?xe:Tr)),e.wv=Cp(),pp(e,mn),ft!==null&&(ft.f&xe)!==0&&(ft.f&(Tn|ei))===0&&(Ie===null?Gy([e]):Ie.push(e))}return t}function pp(e,t){var n=e.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i],o=s.f;(o&mn)===0&&(nn(s,t),(o&(xe|Ae))!==0&&((o&Pe)!==0?pp(s,Tr):xl(s)))}}let Dy=!1;var xh,mp,gp,_p;function ky(){if(xh===void 0){xh=window,mp=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;gp=$i(t,"firstChild").get,_p=$i(t,"nextSibling").get,bh(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),bh(n)&&(n.__t=void 0)}}function ra(e=""){return document.createTextNode(e)}function Ee(e){return gp.call(e)}function ia(e){return _p.call(e)}function Tt(e,t){return Ee(e)}function Ri(e,t){{var n=Ee(e);return n instanceof Comment&&n.data===""?ia(n):n}}function Kt(e,t=1,n=!1){let r=e;for(;t--;)r=ia(r);return r}function Oy(e){e.textContent=""}function My(e){ft===null&&at===null&&wy(),at!==null&&(at.f&Ae)!==0&&ft===null&&vy(),ri&&yy()}function Ly(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ni(e,t,n,r=!0){var i=ft,s={ctx:fe,deps:null,nodes_start:null,nodes_end:null,f:e|mn,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Pl(s),s.f|=tp}catch(c){throw Bn(s),c}else t!==null&&xl(s);var o=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(ep|El))===0;if(!o&&r&&(i!==null&&Ly(s,i),at!==null&&(at.f&Pe)!==0)){var u=at;(u.effects??(u.effects=[])).push(s)}return s}function Fy(e){const t=ni(na,null,!1);return nn(t,xe),t.teardown=e,t}function Uy(e){My();var t=ft!==null&&(ft.f&Tn)!==0&&fe!==null&&!fe.m;if(t){var n=fe;(n.e??(n.e=[])).push({fn:e,effect:ft,reaction:at})}else{var r=yp(e);return r}}function By(e){const t=ni(ei,e,!0);return(n={})=>new Promise(r=>{n.outro?yo(t,()=>{Bn(t),r(void 0)}):(Bn(t),r(void 0))})}function yp(e){return ni(Zd,e,!1)}function $y(e){return ni(na,e,!0)}function ze(e,t=[],n=Sl){const r=t.map(n);return bl(()=>e(...r.map($)))}function bl(e,t=0){var n=ni(na|wl|t,e,!0);return n}function Ki(e,t=!0){return ni(na|Tn,e,!0,t)}function vp(e){var t=e.teardown;if(t!==null){const n=ri,r=at;Vh(!0),en(null);try{t.call(null)}finally{Vh(n),en(r)}}}function wp(e,t=!1){var i;var n=e.first;for(e.first=e.last=null;n!==null;){(i=n.ac)==null||i.abort(np);var r=n.next;(n.f&ei)!==0?n.parent=null:Bn(n,t),n=r}}function qy(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Tn)===0&&Bn(t),t=n}}function Bn(e,t=!0){var n=!1;(t||(e.f&my)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Ep(e.nodes_start,e.nodes_end),n=!0),wp(e,t&&!n),Ao(e,0),nn(e,Tl);var r=e.transitions;if(r!==null)for(const s of r)s.stop();vp(e);var i=e.parent;i!==null&&i.first!==null&&Tp(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Ep(e,t){for(;e!==null;){var n=e===t?null:ia(e);e.remove(),e=n}}function Tp(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function yo(e,t){var n=[];Cl(e,n,!0),Ap(n,()=>{Bn(e),t&&t()})}function Ap(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Cl(e,t,n){if((e.f&dn)===0){if(e.f^=dn,e.transitions!==null)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&Al)!==0||(r.f&Tn)!==0;Cl(r,t,s?n:!1),r=i}}}function vo(e){Ip(e,!0)}function Ip(e,t){if((e.f&dn)!==0){e.f^=dn;for(var n=e.first;n!==null;){var r=n.next,i=(n.f&Al)!==0||(n.f&Tn)!==0;Ip(n,i?t:!1),n=r}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let wo=[];function zy(){var e=wo;wo=[],py(e)}function jy(e){wo.length===0&&queueMicrotask(zy),wo.push(e)}function Hy(e){var t=ft;if((t.f&tp)===0){if((t.f&El)===0)throw e;t.fn(e)}else Rp(e,t)}function Rp(e,t){for(;t!==null;){if((t.f&El)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let vu=!1,Eo=null,hr=!1,ri=!1;function Vh(e){ri=e}let eo=[];let at=null,Ge=!1;function en(e){at=e}let ft=null;function $n(e){ft=e}let Bt=null;function Sp(e){at!==null&&at.f&_u&&(Bt===null?Bt=[at,[e]]:Bt[1].push(e))}let ne=null,ve=0,Ie=null;function Gy(e){Ie=e}let bp=1,To=0,kn=!1;function Cp(){return++bp}function sa(e){var d;var t=e.f;if((t&mn)!==0)return!0;if((t&Tr)!==0){var n=e.deps,r=(t&Ae)!==0;if(n!==null){var i,s,o=(t&go)!==0,u=r&&ft!==null&&!kn,c=n.length;if(o||u){var l=e,h=l.parent;for(i=0;i<c;i++)s=n[i],(o||!((d=s==null?void 0:s.reactions)!=null&&d.includes(l)))&&(s.reactions??(s.reactions=[])).push(l);o&&(l.f^=go),u&&h!==null&&(h.f&Ae)===0&&(l.f^=Ae)}for(i=0;i<c;i++)if(s=n[i],sa(s)&&dp(s),s.wv>e.wv)return!0}(!r||ft!==null&&!kn)&&nn(e,xe)}return!1}function Pp(e,t,n=!0){var r=e.reactions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];Bt!=null&&Bt[1].includes(e)&&Bt[0]===at||((s.f&Pe)!==0?Pp(s,t,!1):t===s&&(n?nn(s,mn):(s.f&xe)!==0&&nn(s,Tr),xl(s)))}}function xp(e){var g;var t=ne,n=ve,r=Ie,i=at,s=kn,o=Bt,u=fe,c=Ge,l=e.f;ne=null,ve=0,Ie=null,kn=(l&Ae)!==0&&(Ge||!hr||at===null),at=(l&(Tn|ei))===0?e:null,Bt=null,Ph(e.ctx),Ge=!1,To++,e.f|=_u,e.ac!==null&&(e.ac.abort(np),e.ac=null);try{var h=(0,e.fn)(),d=e.deps;if(ne!==null){var p;if(Ao(e,ve),d!==null&&ve>0)for(d.length=ve+ne.length,p=0;p<ne.length;p++)d[ve+p]=ne[p];else e.deps=d=ne;if(!kn||(l&Pe)!==0&&e.reactions!==null)for(p=ve;p<d.length;p++)((g=d[p]).reactions??(g.reactions=[])).push(e)}else d!==null&&ve<d.length&&(Ao(e,ve),d.length=ve);if(cp()&&Ie!==null&&!Ge&&d!==null&&(e.f&(Pe|Tr|mn))===0)for(p=0;p<Ie.length;p++)Pp(Ie[p],e);return i!==null&&i!==e&&(To++,Ie!==null&&(r===null?r=Ie:r.push(...Ie))),h}catch(_){Hy(_)}finally{ne=t,ve=n,Ie=r,at=i,kn=s,Bt=o,Ph(u),Ge=c,e.f^=_u}}function Wy(e,t){let n=t.reactions;if(n!==null){var r=ly.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&Pe)!==0&&(ne===null||!ne.includes(t))&&(nn(t,Tr),(t.f&(Ae|go))===0&&(t.f^=go),hp(t),Ao(t,0))}function Ao(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Wy(e,n[r])}function Pl(e){var t=e.f;if((t&Tl)===0){nn(e,xe);var n=ft,r=hr;ft=e,hr=!0;try{(t&wl)!==0?qy(e):wp(e),vp(e);var i=xp(e);e.teardown=typeof i=="function"?i:null,e.wv=bp;var s;Sh&&Ry&&(e.f&mn)!==0&&e.deps}finally{hr=r,ft=n}}}function Ky(){try{Ey()}catch(e){if(Eo!==null)Rp(e,Eo);else throw e}}function Qy(){var e=hr;try{var t=0;for(hr=!0;eo.length>0;){t++>1e3&&Ky();var n=eo,r=n.length;eo=[];for(var i=0;i<r;i++){var s=Yy(n[i]);Xy(s)}Wi.clear()}}finally{vu=!1,hr=e,Eo=null}}function Xy(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(Tl|dn))===0&&sa(r)&&(Pl(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Tp(r):r.fn=null))}}function xl(e){vu||(vu=!0,queueMicrotask(Qy));for(var t=Eo=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(ei|Tn))!==0){if((n&xe)===0)return;t.f^=xe}}eo.push(t)}function Yy(e){for(var t=[],n=e;n!==null;){var r=n.f,i=(r&(Tn|ei))!==0,s=i&&(r&xe)!==0;if(!s&&(r&dn)===0){(r&Zd)!==0?t.push(n):i?n.f^=xe:sa(n)&&Pl(n);var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return t}function $(e){var t=e.f,n=(t&Pe)!==0;if(at!==null&&!Ge){if(!(Bt!=null&&Bt[1].includes(e))||Bt[0]!==at){var r=at.deps;e.rv<To&&(e.rv=To,ne===null&&r!==null&&r[ve]===e?ve++:ne===null?ne=[e]:(!kn||!ne.includes(e))&&ne.push(e))}}else if(n&&e.deps===null&&e.effects===null){var i=e,s=i.parent;s!==null&&(s.f&Ae)===0&&(i.f^=Ae)}return n&&(i=e,sa(i)&&dp(i)),ri&&Wi.has(e)?Wi.get(e):e.v}function Vl(e){var t=Ge;try{return Ge=!0,e()}finally{Ge=t}}const Jy=-7169;function nn(e,t){e.f=e.f&Jy|t}const Zy=["touchstart","touchmove"];function tv(e){return Zy.includes(e)}let Nh=!1;function ev(){Nh||(Nh=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function nv(e){var t=at,n=ft;en(null),$n(null);try{return e()}finally{en(t),$n(n)}}function rv(e,t,n,r=n){e.addEventListener(t,()=>nv(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),ev()}const Vp=new Set,wu=new Set;function iv(e){for(var t=0;t<e.length;t++)Vp.add(e[t]);for(var n of wu)n(e)}function qs(e){var b;var t=this,n=t.ownerDocument,r=e.type,i=((b=e.composedPath)==null?void 0:b.call(e))||[],s=i[0]||e.target,o=0,u=e.__root;if(u){var c=i.indexOf(u);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var l=i.indexOf(t);if(l===-1)return;c<=l&&(o=c)}if(s=i[o]||e.target,s!==t){cy(e,"currentTarget",{configurable:!0,get(){return s||n}});var h=at,d=ft;en(null),$n(null);try{for(var p,g=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+r];if(E!=null&&(!s.disabled||e.target===s))if(yl(E)){var[v,...P]=E;v.apply(s,[e,...P])}else E.call(s,e)}catch(N){p?g.push(N):p=N}if(e.cancelBubble||_===t||_===null)break;s=_}if(p){for(let N of g)queueMicrotask(()=>{throw N});throw p}}finally{e.__root=t,delete e.currentTarget,en(h),$n(d)}}}function Nl(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function mr(e,t){var n=ft;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function An(e,t){var n=(t&op)!==0,r=(t&Cy)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=Nl(s?e:"<!>"+e),n||(i=Ee(i)));var o=r||mp?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=Ee(o),c=o.lastChild;mr(u,c)}else mr(o,o);return o}}function sv(e,t,n="svg"){var r=!e.startsWith("<!>"),i=(t&op)!==0,s=`<${n}>${r?e:"<!>"+e}</${n}>`,o;return()=>{if(!o){var u=Nl(s),c=Ee(u);if(i)for(o=document.createDocumentFragment();Ee(c);)o.appendChild(Ee(c));else o=Ee(c)}var l=o.cloneNode(!0);if(i){var h=Ee(l),d=l.lastChild;mr(h,d)}else mr(l,l);return l}}function ds(e,t){return sv(e,t,"svg")}function Dh(e=""){{var t=ra(e+"");return mr(t,t),t}}function Ya(){var e=document.createDocumentFragment(),t=document.createComment(""),n=ra();return e.append(t,n),mr(t,n),e}function kt(e,t){e!==null&&e.before(t)}function Si(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function ov(e,t){return av(e,t)}const kr=new Map;function av(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:o=!0}){ky();var u=new Set,c=d=>{for(var p=0;p<d.length;p++){var g=d[p];if(!u.has(g)){u.add(g);var _=tv(g);t.addEventListener(g,qs,{passive:_});var E=kr.get(g);E===void 0?(document.addEventListener(g,qs,{passive:_}),kr.set(g,1)):kr.set(g,E+1)}}};c(vl(Vp)),wu.add(c);var l=void 0,h=By(()=>{var d=n??t.appendChild(ra());return Ki(()=>{if(s){up({});var p=fe;p.c=s}i&&(r.$$events=i),l=e(d,r)||{},s&&lp()}),()=>{var _;for(var p of u){t.removeEventListener(p,qs);var g=kr.get(p);--g===0?(document.removeEventListener(p,qs),kr.delete(p)):kr.set(p,g)}wu.delete(c),d!==n&&((_=d.parentNode)==null||_.removeChild(d))}});return uv.set(l,h),l}let uv=new WeakMap;function Vn(e,t,[n,r]=[0,0]){var i=e,s=null,o=null,u=ue,c=n>0?Al:0,l=!1;const h=(p,g=!0)=>{l=!0,d(g,p)},d=(p,g)=>{u!==(u=p)&&(u?(s?vo(s):g&&(s=Ki(()=>g(i))),o&&yo(o,()=>{o=null})):(o?vo(o):g&&(o=Ki(()=>g(i,[n+1,r]))),s&&yo(s,()=>{s=null})))};bl(()=>{l=!1,t(h),l||d(null,null)},c)}function sr(e,t){return t}function lv(e,t,n,r){for(var i=[],s=t.length,o=0;o<s;o++)Cl(t[o].e,i,!0);var u=s>0&&i.length===0&&n!==null;if(u){var c=n.parentNode;Oy(c),c.append(n),r.clear(),Nn(e,t[0].prev,t[s-1].next)}Ap(i,()=>{for(var l=0;l<s;l++){var h=t[l];u||(r.delete(h.k),Nn(e,h.prev,h.next)),Bn(h.e,!u)}})}function or(e,t,n,r,i,s=null){var o=e,u={flags:t,items:new Map,first:null},c=(t&sp)!==0;if(c){var l=e;o=l.appendChild(ra())}var h=null,d=!1,p=xy(()=>{var g=n();return yl(g)?g:g==null?[]:vl(g)});bl(()=>{var g=$(p),_=g.length;d&&_===0||(d=_===0,cv(g,u,o,i,t,r,n),s!==null&&(_===0?h?vo(h):h=Ki(()=>s(o)):h!==null&&yo(h,()=>{h=null})),$(p))})}function cv(e,t,n,r,i,s,o){var X,F,Y,lt;var u=(i&Sy)!==0,c=(i&(Il|Rl))!==0,l=e.length,h=t.items,d=t.first,p=d,g,_=null,E,v=[],P=[],b,N,x,M;if(u)for(M=0;M<l;M+=1)b=e[M],N=s(b,M),x=h.get(N),x!==void 0&&((X=x.a)==null||X.measure(),(E??(E=new Set)).add(x));for(M=0;M<l;M+=1){if(b=e[M],N=s(b,M),x=h.get(N),x===void 0){var U=p?p.e.nodes_start:n;_=fv(U,t,_,_===null?t.first:_.next,b,N,M,r,i,o),h.set(N,_),v=[],P=[],p=_.next;continue}if(c&&hv(x,b,M,i),(x.e.f&dn)!==0&&(vo(x.e),u&&((F=x.a)==null||F.unfix(),(E??(E=new Set)).delete(x))),x!==p){if(g!==void 0&&g.has(x)){if(v.length<P.length){var I=P[0],w;_=I.prev;var T=v[0],S=v[v.length-1];for(w=0;w<v.length;w+=1)kh(v[w],I,n);for(w=0;w<P.length;w+=1)g.delete(P[w]);Nn(t,T.prev,S.next),Nn(t,_,T),Nn(t,S,I),p=I,_=S,M-=1,v=[],P=[]}else g.delete(x),kh(x,p,n),Nn(t,x.prev,x.next),Nn(t,x,_===null?t.first:_.next),Nn(t,_,x),_=x;continue}for(v=[],P=[];p!==null&&p.k!==N;)(p.e.f&dn)===0&&(g??(g=new Set)).add(p),P.push(p),p=p.next;if(p===null)continue;x=p}v.push(x),_=x,p=x.next}if(p!==null||g!==void 0){for(var R=g===void 0?[]:vl(g);p!==null;)(p.e.f&dn)===0&&R.push(p),p=p.next;var C=R.length;if(C>0){var A=(i&sp)!==0&&l===0?n:null;if(u){for(M=0;M<C;M+=1)(Y=R[M].a)==null||Y.measure();for(M=0;M<C;M+=1)(lt=R[M].a)==null||lt.fix()}lv(t,R,A,h)}}u&&jy(()=>{var mt;if(E!==void 0)for(x of E)(mt=x.a)==null||mt.apply()}),ft.first=t.first&&t.first.e,ft.last=_&&_.e}function hv(e,t,n,r){(r&Il)!==0&&yu(e.v,t),(r&Rl)!==0?yu(e.i,n):e.i=n}function fv(e,t,n,r,i,s,o,u,c,l){var h=(c&Il)!==0,d=(c&by)===0,p=h?d?Ny(i,!1,!1):_o(i):i,g=(c&Rl)===0?o:_o(o),_={i:g,v:p,k:s,a:null,e:null,prev:n,next:r};try{return _.e=Ki(()=>u(e,p,g,l),Dy),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function kh(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var o=ia(s);i.before(s),s=o}}function Nn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function dv(e,t,n=!1,r=!1,i=!1){var s=e,o="";ze(()=>{var u=ft;if(o!==(o=t()??"")&&(u.nodes_start!==null&&(Ep(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),o!=="")){var c=o+"";n?c=`<svg>${c}</svg>`:r&&(c=`<math>${c}</math>`);var l=Nl(c);if((n||r)&&(l=Ee(l)),mr(Ee(l),l.lastChild),n||r)for(;Ee(l);)s.before(Ee(l));else s.before(l)}})}const Oh=[...` 	
\r\fÂ \v\uFEFF`];function pv(e,t,n){var r=""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,o=0;(o=r.indexOf(i,o))>=0;){var u=o+s;(o===0||Oh.includes(r[o-1]))&&(u===r.length||Oh.includes(r[u]))?r=(o===0?"":r.substring(0,o))+r.substring(u+1):o=u}}return r===""?null:r}function mv(e,t){return e==null?null:String(e)}function gv(e,t,n,r,i,s){var o=e.__className;if(o!==n||o===void 0){var u=pv(n,r,s);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(s&&i!==s)for(var c in s){var l=!!s[c];(i==null||l!==!!i[c])&&e.classList.toggle(c,l)}return s}function Mh(e,t,n,r){var i=e.__style;if(i!==t){var s=mv(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return r}const _v=Symbol("is custom element"),yv=Symbol("is html");function ee(e,t,n,r){var i=vv(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[gy]=n),n==null?e.removeAttribute(t):typeof n!="string"&&wv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function vv(e){return e.__attributes??(e.__attributes={[_v]:e.nodeName.includes("-"),[yv]:e.namespaceURI===Py})}var Lh=new Map;function wv(e){var t=Lh.get(e.nodeName);if(t)return t;Lh.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=hy(r);for(var s in n)n[s].set&&t.push(s);r=Jd(r)}return t}function Ev(e,t,n=t){rv(e,"input",r=>{var i=r?e.defaultValue:e.value;if(i=Ja(e)?Za(i):i,n(i),i!==(i=t())){var s=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(o,e.value.length))}}),Vl(t)==null&&e.value&&n(Ja(e)?Za(e.value):e.value),$y(()=>{var r=t();Ja(e)&&r===Za(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Ja(e){var t=e.type;return t==="number"||t==="range"}function Za(e){return e===""?null:+e}function Eu(e){fe===null&&ap(),Uy(()=>{const t=Vl(e);if(typeof t=="function")return t})}function Tv(e){fe===null&&ap(),Eu(()=>()=>Vl(e))}const Av="5";var Yd;typeof window<"u"&&((Yd=window.__svelte??(window.__svelte={})).v??(Yd.v=new Set)).add(Av);const Iv=()=>{};var Fh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},Rv=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],o=e[n++],u=e[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},Dp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,u=o?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,h=s>>2,d=(s&3)<<4|u>>4;let p=(u&15)<<2|l>>6,g=l&63;c||(g=64,o||(p=64)),r.push(n[h],n[d],n[p],n[g])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Np(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Rv(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],u=i<e.length?n[e.charAt(i)]:0;++i;const l=i<e.length?n[e.charAt(i)]:64;++i;const d=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||u==null||l==null||d==null)throw new Sv;const p=s<<2|u>>4;if(r.push(p),l!==64){const g=u<<4&240|l>>2;if(r.push(g),d!==64){const _=l<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Sv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bv=function(e){const t=Np(e);return Dp.encodeByteArray(t,!0)},Io=function(e){return bv(e).replace(/\./g,"")},Cv=function(e){try{return Dp.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv=()=>Pv().__FIREBASE_DEFAULTS__,Vv=()=>{if(typeof process>"u"||typeof Fh>"u")return;const e=Fh.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Nv=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Cv(e[1]);return t&&JSON.parse(t)},Dl=()=>{try{return Iv()||xv()||Vv()||Nv()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Dv=e=>{var t,n;return(n=(t=Dl())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},kv=e=>{const t=Dv(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},kp=()=>{var e;return(e=Dl())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Mv(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Io(JSON.stringify(n)),Io(JSON.stringify(o)),""].join(".")}const qi={};function Fv(){const e={prod:[],emulator:[]};for(const t of Object.keys(qi))qi[t]?e.emulator.push(t):e.prod.push(t);return e}function Uv(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let Uh=!1;function Bv(e,t){if(typeof window>"u"||typeof document>"u"||!kl(window.location.host)||qi[e]===t||qi[e]||Uh)return;qi[e]=t;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=Fv().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function u(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function l(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Uh=!0,o()},p}function h(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=Uv(r),g=n("text"),_=document.getElementById(g)||document.createElement("span"),E=n("learnmore"),v=document.getElementById(E)||document.createElement("a"),P=n("preprendIcon"),b=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;u(N),h(v,E);const x=l();c(b,P),N.append(b,_,v,x),document.body.appendChild(N)}s?(_.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qv(){var e;const t=(e=Dl())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zv(){return!qv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jv(){try{return typeof indexedDB=="object"}catch{return!1}}function Hv(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="FirebaseError";class ii extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Gv,Object.setPrototypeOf(this,ii.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Op.prototype.create)}}class Op{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?Wv(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new ii(i,u,r)}}function Wv(e,t){return e.replace(Kv,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const Kv=/\{\$([^}]+)}/g;function Ro(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],o=t[i];if(Bh(s)&&Bh(o)){if(!Ro(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Bh(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(e){return e&&e._delegate?e._delegate:e}class Qi{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new Ov;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Yv(t))try{this.getOrInitializeService({instanceIdentifier:ar})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=ar){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ar){return this.instances.has(t)}getOptions(t=ar){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Xv(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=ar){return this.component?this.component.multipleInstances?t:ar:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Xv(e){return e===ar?void 0:e}function Yv(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Qv(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(it||(it={}));const Zv={debug:it.DEBUG,verbose:it.VERBOSE,info:it.INFO,warn:it.WARN,error:it.ERROR,silent:it.SILENT},t0=it.INFO,e0={[it.DEBUG]:"log",[it.VERBOSE]:"log",[it.INFO]:"info",[it.WARN]:"warn",[it.ERROR]:"error"},n0=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=e0[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Mp{constructor(t){this.name=t,this._logLevel=t0,this._logHandler=n0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in it))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Zv[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,it.DEBUG,...t),this._logHandler(this,it.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,it.VERBOSE,...t),this._logHandler(this,it.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,it.INFO,...t),this._logHandler(this,it.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,it.WARN,...t),this._logHandler(this,it.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,it.ERROR,...t),this._logHandler(this,it.ERROR,...t)}}const r0=(e,t)=>t.some(n=>e instanceof n);let $h,qh;function i0(){return $h||($h=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s0(){return qh||(qh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lp=new WeakMap,Tu=new WeakMap,Fp=new WeakMap,tu=new WeakMap,Ol=new WeakMap;function o0(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(Mn(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Lp.set(n,e)}).catch(()=>{}),Ol.set(t,e),t}function a0(e){if(Tu.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});Tu.set(e,t)}let Au={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Tu.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Fp.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function u0(e){Au=e(Au)}function l0(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(eu(this),t,...n);return Fp.set(r,t.sort?t.sort():[t]),Mn(r)}:s0().includes(e)?function(...t){return e.apply(eu(this),t),Mn(Lp.get(this))}:function(...t){return Mn(e.apply(eu(this),t))}}function c0(e){return typeof e=="function"?l0(e):(e instanceof IDBTransaction&&a0(e),r0(e,i0())?new Proxy(e,Au):e)}function Mn(e){if(e instanceof IDBRequest)return o0(e);if(tu.has(e))return tu.get(e);const t=c0(e);return t!==e&&(tu.set(e,t),Ol.set(t,e)),t}const eu=e=>Ol.get(e);function h0(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),u=Mn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Mn(o.result),c.oldVersion,c.newVersion,Mn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),u}const f0=["get","getKey","getAll","getAllKeys","count"],d0=["put","add","delete","clear"],nu=new Map;function zh(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(nu.get(t))return nu.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=d0.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||f0.includes(n)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(u.shift())),(await Promise.all([l[n](...u),i&&c.done]))[0]};return nu.set(t,s),s}u0(e=>({...e,get:(t,n,r)=>zh(t,n)||e.get(t,n,r),has:(t,n)=>!!zh(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(m0(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function m0(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Iu="@firebase/app",jh="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n=new Mp("@firebase/app"),g0="@firebase/app-compat",_0="@firebase/analytics-compat",y0="@firebase/analytics",v0="@firebase/app-check-compat",w0="@firebase/app-check",E0="@firebase/auth",T0="@firebase/auth-compat",A0="@firebase/database",I0="@firebase/data-connect",R0="@firebase/database-compat",S0="@firebase/functions",b0="@firebase/functions-compat",C0="@firebase/installations",P0="@firebase/installations-compat",x0="@firebase/messaging",V0="@firebase/messaging-compat",N0="@firebase/performance",D0="@firebase/performance-compat",k0="@firebase/remote-config",O0="@firebase/remote-config-compat",M0="@firebase/storage",L0="@firebase/storage-compat",F0="@firebase/firestore",U0="@firebase/ai",B0="@firebase/firestore-compat",$0="firebase",q0="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru="[DEFAULT]",z0={[Iu]:"fire-core",[g0]:"fire-core-compat",[y0]:"fire-analytics",[_0]:"fire-analytics-compat",[w0]:"fire-app-check",[v0]:"fire-app-check-compat",[E0]:"fire-auth",[T0]:"fire-auth-compat",[A0]:"fire-rtdb",[I0]:"fire-data-connect",[R0]:"fire-rtdb-compat",[S0]:"fire-fn",[b0]:"fire-fn-compat",[C0]:"fire-iid",[P0]:"fire-iid-compat",[x0]:"fire-fcm",[V0]:"fire-fcm-compat",[N0]:"fire-perf",[D0]:"fire-perf-compat",[k0]:"fire-rc",[O0]:"fire-rc-compat",[M0]:"fire-gcs",[L0]:"fire-gcs-compat",[F0]:"fire-fst",[B0]:"fire-fst-compat",[U0]:"fire-vertex","fire-js":"fire-js",[$0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So=new Map,j0=new Map,Su=new Map;function Hh(e,t){try{e.container.addComponent(t)}catch(n){_n.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function bo(e){const t=e.name;if(Su.has(t))return _n.debug(`There were multiple attempts to register component ${t}.`),!1;Su.set(t,e);for(const n of So.values())Hh(n,e);for(const n of j0.values())Hh(n,e);return!0}function H0(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function G0(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ln=new Op("app","Firebase",W0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ln.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=q0;function Up(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Ru,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw Ln.create("bad-app-name",{appName:String(i)});if(n||(n=kp()),!n)throw Ln.create("no-options");const s=So.get(i);if(s){if(Ro(n,s.options)&&Ro(r,s.config))return s;throw Ln.create("duplicate-app",{appName:i})}const o=new Jv(i);for(const c of Su.values())o.addComponent(c);const u=new K0(n,r,o);return So.set(i,u),u}function X0(e=Ru){const t=So.get(e);if(!t&&e===Ru&&kp())return Up();if(!t)throw Ln.create("no-app",{appName:e});return t}function qr(e,t,n){var r;let i=(r=z0[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${t}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),_n.warn(u.join(" "));return}bo(new Qi(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="firebase-heartbeat-database",J0=1,Xi="firebase-heartbeat-store";let ru=null;function Bp(){return ru||(ru=h0(Y0,J0,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Xi)}catch(n){console.warn(n)}}}}).catch(e=>{throw Ln.create("idb-open",{originalErrorMessage:e.message})})),ru}async function Z0(e){try{const n=(await Bp()).transaction(Xi),r=await n.objectStore(Xi).get($p(e));return await n.done,r}catch(t){if(t instanceof ii)_n.warn(t.message);else{const n=Ln.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});_n.warn(n.message)}}}async function Gh(e,t){try{const r=(await Bp()).transaction(Xi,"readwrite");await r.objectStore(Xi).put(t,$p(e)),await r.done}catch(n){if(n instanceof ii)_n.warn(n.message);else{const r=Ln.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});_n.warn(r.message)}}}function $p(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=1024,ew=30;class nw{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new iw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Wh();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>ew){const o=sw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){_n.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Wh(),{heartbeatsToSend:r,unsentEntries:i}=rw(this._heartbeatsCache.heartbeats),s=Io(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return _n.warn(n),""}}}function Wh(){return new Date().toISOString().substring(0,10)}function rw(e,t=tw){const n=[];let r=e.slice();for(const i of e){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Kh(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Kh(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class iw{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jv()?Hv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Z0(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Gh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Gh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Kh(e){return Io(JSON.stringify({version:2,heartbeats:e})).length}function sw(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(e){bo(new Qi("platform-logger",t=>new p0(t),"PRIVATE")),bo(new Qi("heartbeat",t=>new nw(t),"PRIVATE")),qr(Iu,jh,e),qr(Iu,jh,"esm2017"),qr("fire-js","")}ow("");var aw="firebase",uw="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qr(aw,uw,"app");var Qh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fn,qp;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,w){function T(){}T.prototype=w.prototype,I.D=w.prototype,I.prototype=new T,I.prototype.constructor=I,I.C=function(S,R,C){for(var A=Array(arguments.length-2),X=2;X<arguments.length;X++)A[X-2]=arguments[X];return w.prototype[R].apply(S,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,w,T){T||(T=0);var S=Array(16);if(typeof w=="string")for(var R=0;16>R;++R)S[R]=w.charCodeAt(T++)|w.charCodeAt(T++)<<8|w.charCodeAt(T++)<<16|w.charCodeAt(T++)<<24;else for(R=0;16>R;++R)S[R]=w[T++]|w[T++]<<8|w[T++]<<16|w[T++]<<24;w=I.g[0],T=I.g[1],R=I.g[2];var C=I.g[3],A=w+(C^T&(R^C))+S[0]+3614090360&4294967295;w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[1]+3905402710&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[2]+606105819&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[3]+3250441966&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[4]+4118548399&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[5]+1200080426&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[6]+2821735955&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[7]+4249261313&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[8]+1770035416&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[9]+2336552879&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[10]+4294925233&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[11]+2304563134&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[12]+1804603682&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[13]+4254626195&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[14]+2792965006&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[15]+1236535329&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(R^C&(T^R))+S[1]+4129170786&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[6]+3225465664&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[11]+643717713&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[0]+3921069994&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[5]+3593408605&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[10]+38016083&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[15]+3634488961&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[4]+3889429448&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[9]+568446438&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[14]+3275163606&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[3]+4107603335&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[8]+1163531501&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[13]+2850285829&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[2]+4243563512&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[7]+1735328473&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[12]+2368359562&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(T^R^C)+S[5]+4294588738&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[8]+2272392833&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[11]+1839030562&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[14]+4259657740&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[1]+2763975236&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[4]+1272893353&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[7]+4139469664&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[10]+3200236656&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[13]+681279174&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[0]+3936430074&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[3]+3572445317&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[6]+76029189&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[9]+3654602809&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[12]+3873151461&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[15]+530742520&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[2]+3299628645&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(R^(T|~C))+S[0]+4096336452&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[7]+1126891415&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[14]+2878612391&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[5]+4237533241&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[12]+1700485571&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[3]+2399980690&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[10]+4293915773&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[1]+2240044497&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[8]+1873313359&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[15]+4264355552&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[6]+2734768916&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[13]+1309151649&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[4]+4149444226&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[11]+3174756917&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[2]+718787259&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[9]+3951481745&4294967295,I.g[0]=I.g[0]+w&4294967295,I.g[1]=I.g[1]+(R+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+C&4294967295}r.prototype.u=function(I,w){w===void 0&&(w=I.length);for(var T=w-this.blockSize,S=this.B,R=this.h,C=0;C<w;){if(R==0)for(;C<=T;)i(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<w;)if(S[R++]=I.charCodeAt(C++),R==this.blockSize){i(this,S),R=0;break}}else for(;C<w;)if(S[R++]=I[C++],R==this.blockSize){i(this,S),R=0;break}}this.h=R,this.o+=w},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var w=1;w<I.length-8;++w)I[w]=0;var T=8*this.o;for(w=I.length-8;w<I.length;++w)I[w]=T&255,T/=256;for(this.u(I),I=Array(16),w=T=0;4>w;++w)for(var S=0;32>S;S+=8)I[T++]=this.g[w]>>>S&255;return I};function s(I,w){var T=u;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=w(I)}function o(I,w){this.h=w;for(var T=[],S=!0,R=I.length-1;0<=R;R--){var C=I[R]|0;S&&C==w||(T[R]=C,S=!1)}this.g=T}var u={};function c(I){return-128<=I&&128>I?s(I,function(w){return new o([w|0],0>w?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return v(l(-I));for(var w=[],T=1,S=0;I>=T;S++)w[S]=I/T|0,T*=4294967296;return new o(w,0)}function h(I,w){if(I.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(I.charAt(0)=="-")return v(h(I.substring(1),w));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=l(Math.pow(w,8)),S=d,R=0;R<I.length;R+=8){var C=Math.min(8,I.length-R),A=parseInt(I.substring(R,R+C),w);8>C?(C=l(Math.pow(w,C)),S=S.j(C).add(l(A))):(S=S.j(T),S=S.add(l(A)))}return S}var d=c(0),p=c(1),g=c(16777216);e=o.prototype,e.m=function(){if(E(this))return-v(this).m();for(var I=0,w=1,T=0;T<this.g.length;T++){var S=this.i(T);I+=(0<=S?S:4294967296+S)*w,w*=4294967296}return I},e.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(E(this))return"-"+v(this).toString(I);for(var w=l(Math.pow(I,6)),T=this,S="";;){var R=x(T,w).g;T=P(T,R.j(w));var C=((0<T.g.length?T.g[0]:T.h)>>>0).toString(I);if(T=R,_(T))return C+S;for(;6>C.length;)C="0"+C;S=C+S}},e.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var w=0;w<I.g.length;w++)if(I.g[w]!=0)return!1;return!0}function E(I){return I.h==-1}e.l=function(I){return I=P(this,I),E(I)?-1:_(I)?0:1};function v(I){for(var w=I.g.length,T=[],S=0;S<w;S++)T[S]=~I.g[S];return new o(T,~I.h).add(p)}e.abs=function(){return E(this)?v(this):this},e.add=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0,R=0;R<=w;R++){var C=S+(this.i(R)&65535)+(I.i(R)&65535),A=(C>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);S=A>>>16,C&=65535,A&=65535,T[R]=A<<16|C}return new o(T,T[T.length-1]&-2147483648?-1:0)};function P(I,w){return I.add(v(w))}e.j=function(I){if(_(this)||_(I))return d;if(E(this))return E(I)?v(this).j(v(I)):v(v(this).j(I));if(E(I))return v(this.j(v(I)));if(0>this.l(g)&&0>I.l(g))return l(this.m()*I.m());for(var w=this.g.length+I.g.length,T=[],S=0;S<2*w;S++)T[S]=0;for(S=0;S<this.g.length;S++)for(var R=0;R<I.g.length;R++){var C=this.i(S)>>>16,A=this.i(S)&65535,X=I.i(R)>>>16,F=I.i(R)&65535;T[2*S+2*R]+=A*F,b(T,2*S+2*R),T[2*S+2*R+1]+=C*F,b(T,2*S+2*R+1),T[2*S+2*R+1]+=A*X,b(T,2*S+2*R+1),T[2*S+2*R+2]+=C*X,b(T,2*S+2*R+2)}for(S=0;S<w;S++)T[S]=T[2*S+1]<<16|T[2*S];for(S=w;S<2*w;S++)T[S]=0;return new o(T,0)};function b(I,w){for(;(I[w]&65535)!=I[w];)I[w+1]+=I[w]>>>16,I[w]&=65535,w++}function N(I,w){this.g=I,this.h=w}function x(I,w){if(_(w))throw Error("division by zero");if(_(I))return new N(d,d);if(E(I))return w=x(v(I),w),new N(v(w.g),v(w.h));if(E(w))return w=x(I,v(w)),new N(v(w.g),w.h);if(30<I.g.length){if(E(I)||E(w))throw Error("slowDivide_ only works with positive integers.");for(var T=p,S=w;0>=S.l(I);)T=M(T),S=M(S);var R=U(T,1),C=U(S,1);for(S=U(S,2),T=U(T,2);!_(S);){var A=C.add(S);0>=A.l(I)&&(R=R.add(T),C=A),S=U(S,1),T=U(T,1)}return w=P(I,R.j(w)),new N(R,w)}for(R=d;0<=I.l(w);){for(T=Math.max(1,Math.floor(I.m()/w.m())),S=Math.ceil(Math.log(T)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),C=l(T),A=C.j(w);E(A)||0<A.l(I);)T-=S,C=l(T),A=C.j(w);_(C)&&(C=p),R=R.add(C),I=P(I,A)}return new N(R,I)}e.A=function(I){return x(this,I).h},e.and=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)&I.i(S);return new o(T,this.h&I.h)},e.or=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)|I.i(S);return new o(T,this.h|I.h)},e.xor=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)^I.i(S);return new o(T,this.h^I.h)};function M(I){for(var w=I.g.length+1,T=[],S=0;S<w;S++)T[S]=I.i(S)<<1|I.i(S-1)>>>31;return new o(T,I.h)}function U(I,w){var T=w>>5;w%=32;for(var S=I.g.length-T,R=[],C=0;C<S;C++)R[C]=0<w?I.i(C+T)>>>w|I.i(C+T+1)<<32-w:I.i(C+T);return new o(R,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qp=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=h,Fn=o}).apply(typeof Qh<"u"?Qh:typeof self<"u"?self:typeof window<"u"?window:{});var zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zp,Pi,jp,no,bu,Hp,Gp,Wp;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,m){return a==Array.prototype||a==Object.prototype||(a[f]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof zs=="object"&&zs];for(var f=0;f<a.length;++f){var m=a[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function i(a,f){if(f)t:{var m=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var V=a[y];if(!(V in m))break t;m=m[V]}a=a[a.length-1],y=m[a],f=f(y),f!=y&&f!=null&&t(m,a,{configurable:!0,writable:!0,value:f})}}function s(a,f){a instanceof String&&(a+="");var m=0,y=!1,V={next:function(){if(!y&&m<a.length){var k=m++;return{value:f(k,a[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(a){return a||function(){return s(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function l(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,m){return a.call.apply(a.bind,arguments)}function d(a,f,m){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,y),a.apply(f,V)}}return function(){return a.apply(f,arguments)}}function p(a,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function g(a,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function _(a,f){function m(){}m.prototype=f.prototype,a.aa=f.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(y,V,k){for(var B=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)B[dt-2]=arguments[dt];return f.prototype[V].apply(y,B)}}function E(a){const f=a.length;if(0<f){const m=Array(f);for(let y=0;y<f;y++)m[y]=a[y];return m}return[]}function v(a,f){for(let m=1;m<arguments.length;m++){const y=arguments[m];if(c(y)){const V=a.length||0,k=y.length||0;a.length=V+k;for(let B=0;B<k;B++)a[V+B]=y[B]}else a.push(y)}}class P{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function b(a){return/^[\s\xa0]*$/.test(a)}function N(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function x(a){return x[" "](a),a}x[" "]=function(){};var M=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function U(a,f,m){for(const y in a)f.call(m,a[y],y,a)}function I(a,f){for(const m in a)f.call(void 0,a[m],m,a)}function w(a){const f={};for(const m in a)f[m]=a[m];return f}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(a,f){let m,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(m in y)a[m]=y[m];for(let k=0;k<T.length;k++)m=T[k],Object.prototype.hasOwnProperty.call(y,m)&&(a[m]=y[m])}}function R(a){var f=1;a=a.split(":");const m=[];for(;0<f&&a.length;)m.push(a.shift()),f--;return a.length&&m.push(a.join(":")),m}function C(a){u.setTimeout(()=>{throw a},0)}function A(){var a=Mt;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class X{constructor(){this.h=this.g=null}add(f,m){const y=F.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var F=new P(()=>new Y,a=>a.reset());class Y{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let lt,mt=!1,Mt=new X,Fe=()=>{const a=u.Promise.resolve(void 0);lt=()=>{a.then(me)}};var me=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(m){C(m)}var f=F;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}mt=!1};function Lt(){this.s=this.s,this.C=this.C}Lt.prototype.s=!1,Lt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Lt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ht(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}ht.prototype.h=function(){this.defaultPrevented=!0};var In=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};u.addEventListener("test",m,f),u.removeEventListener("test",m,f)}catch{}return a}();function se(a,f){if(ht.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(M){t:{try{x(f.nodeName);var V=!0;break t}catch{}V=!1}V||(f=null)}}else m=="mouseover"?f=a.fromElement:m=="mouseout"&&(f=a.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Va[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&se.aa.h.call(this)}}_(se,ht);var Va={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Jn="closure_listenable_"+(1e6*Math.random()|0),Na=0;function Rs(a,f,m,y,V){this.listener=a,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=V,this.key=++Na,this.da=this.fa=!1}function Sr(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function br(a){this.src=a,this.g={},this.h=0}br.prototype.add=function(a,f,m,y,V){var k=a.toString();a=this.g[k],a||(a=this.g[k]=[],this.h++);var B=H(a,f,y,V);return-1<B?(f=a[B],m||(f.fa=!1)):(f=new Rs(f,this.src,k,!!y,V),f.fa=m,a.push(f)),f};function fi(a,f){var m=f.type;if(m in a.g){var y=a.g[m],V=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=V)&&Array.prototype.splice.call(y,V,1),k&&(Sr(f),a.g[m].length==0&&(delete a.g[m],a.h--))}}function H(a,f,m,y){for(var V=0;V<a.length;++V){var k=a[V];if(!k.da&&k.listener==f&&k.capture==!!m&&k.ha==y)return V}return-1}var z="closure_lm_"+(1e6*Math.random()|0),J={};function nt(a,f,m,y,V){if(Array.isArray(f)){for(var k=0;k<f.length;k++)nt(a,f[k],m,y,V);return null}return m=Be(m),a&&a[Jn]?a.K(f,m,l(y)?!!y.capture:!1,V):$t(a,f,m,!1,y,V)}function $t(a,f,m,y,V,k){if(!f)throw Error("Invalid event type");var B=l(V)?!!V.capture:!!V,dt=on(a);if(dt||(a[z]=dt=new br(a)),m=dt.add(f,m,y,B,k),m.proxy)return m;if(y=Dt(),m.proxy=y,y.src=a,y.listener=m,a.addEventListener)In||(V=B),V===void 0&&(V=!1),a.addEventListener(f.toString(),y,V);else if(a.attachEvent)a.attachEvent(Rn(f.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Dt(){function a(m){return f.call(a.src,a.listener,m)}const f=Zn;return a}function Zt(a,f,m,y,V){if(Array.isArray(f))for(var k=0;k<f.length;k++)Zt(a,f[k],m,y,V);else y=l(y)?!!y.capture:!!y,m=Be(m),a&&a[Jn]?(a=a.i,f=String(f).toString(),f in a.g&&(k=a.g[f],m=H(k,m,y,V),-1<m&&(Sr(k[m]),Array.prototype.splice.call(k,m,1),k.length==0&&(delete a.g[f],a.h--)))):a&&(a=on(a))&&(f=a.g[f.toString()],a=-1,f&&(a=H(f,m,y,V)),(m=-1<a?f[a]:null)&&Ue(m))}function Ue(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[Jn])fi(f.i,a);else{var m=a.type,y=a.proxy;f.removeEventListener?f.removeEventListener(m,y,a.capture):f.detachEvent?f.detachEvent(Rn(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=on(f))?(fi(m,a),m.h==0&&(m.src=null,f[z]=null)):Sr(a)}}}function Rn(a){return a in J?J[a]:J[a]="on"+a}function Zn(a,f){if(a.da)a=!0;else{f=new se(f,this);var m=a.listener,y=a.ha||a.src;a.fa&&Ue(a),a=m.call(y,f)}return a}function on(a){return a=a[z],a instanceof br?a:null}var ge="__closure_events_fn_"+(1e9*Math.random()>>>0);function Be(a){return typeof a=="function"?a:(a[ge]||(a[ge]=function(f){return a.handleEvent(f)}),a[ge])}function Ct(){Lt.call(this),this.i=new br(this),this.M=this,this.F=null}_(Ct,Lt),Ct.prototype[Jn]=!0,Ct.prototype.removeEventListener=function(a,f,m,y){Zt(this,a,f,m,y)};function Pt(a,f){var m,y=a.F;if(y)for(m=[];y;y=y.F)m.push(y);if(a=a.M,y=f.type||f,typeof f=="string")f=new ht(f,a);else if(f instanceof ht)f.target=f.target||a;else{var V=f;f=new ht(y,a),S(f,V)}if(V=!0,m)for(var k=m.length-1;0<=k;k--){var B=f.g=m[k];V=oe(B,y,!0,f)&&V}if(B=f.g=a,V=oe(B,y,!0,f)&&V,V=oe(B,y,!1,f)&&V,m)for(k=0;k<m.length;k++)B=f.g=m[k],V=oe(B,y,!1,f)&&V}Ct.prototype.N=function(){if(Ct.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var m=a.g[f],y=0;y<m.length;y++)Sr(m[y]);delete a.g[f],a.h--}}this.F=null},Ct.prototype.K=function(a,f,m,y){return this.i.add(String(a),f,!1,m,y)},Ct.prototype.L=function(a,f,m,y){return this.i.add(String(a),f,!0,m,y)};function oe(a,f,m,y){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var V=!0,k=0;k<f.length;++k){var B=f[k];if(B&&!B.da&&B.capture==m){var dt=B.listener,qt=B.ha||B.src;B.fa&&fi(a.i,B),V=dt.call(qt,y)!==!1&&V}}return V&&!y.defaultPrevented}function tr(a,f,m){if(typeof a=="function")m&&(a=p(a,m));else if(a&&typeof a.handleEvent=="function")a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:u.setTimeout(a,f||0)}function Sn(a){a.g=tr(()=>{a.g=null,a.i&&(a.i=!1,Sn(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class Cr extends Lt{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Sn(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ae(a){Lt.call(this),this.h=a,this.g={}}_(ae,Lt);var $e=[];function _e(a){U(a.g,function(f,m){this.g.hasOwnProperty(m)&&Ue(f)},a),a.g={}}ae.prototype.N=function(){ae.aa.N.call(this),_e(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bn=u.JSON.stringify,Pr=u.JSON.parse,L_=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function Da(){}Da.prototype.h=null;function Oc(a){return a.h||(a.h=a.i())}function Mc(){}var di={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ka(){ht.call(this,"d")}_(ka,ht);function Oa(){ht.call(this,"c")}_(Oa,ht);var er={},Lc=null;function Ss(){return Lc=Lc||new Ct}er.La="serverreachability";function Fc(a){ht.call(this,er.La,a)}_(Fc,ht);function pi(a){const f=Ss();Pt(f,new Fc(f))}er.STAT_EVENT="statevent";function Uc(a,f){ht.call(this,er.STAT_EVENT,a),this.stat=f}_(Uc,ht);function te(a){const f=Ss();Pt(f,new Uc(f,a))}er.Ma="timingevent";function Bc(a,f){ht.call(this,er.Ma,a),this.size=f}_(Bc,ht);function mi(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},f)}function gi(){this.g=!0}gi.prototype.xa=function(){this.g=!1};function F_(a,f,m,y,V,k){a.info(function(){if(a.g)if(k)for(var B="",dt=k.split("&"),qt=0;qt<dt.length;qt++){var ot=dt[qt].split("=");if(1<ot.length){var Gt=ot[0];ot=ot[1];var Wt=Gt.split("_");B=2<=Wt.length&&Wt[1]=="type"?B+(Gt+"="+ot+"&"):B+(Gt+"=redacted&")}}else B=null;else B=k;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+f+`
`+m+`
`+B})}function U_(a,f,m,y,V,k,B){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+f+`
`+m+`
`+k+" "+B})}function xr(a,f,m,y){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+$_(a,m)+(y?" "+y:"")})}function B_(a,f){a.info(function(){return"TIMEOUT: "+f})}gi.prototype.info=function(){};function $_(a,f){if(!a.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var y=m[a];if(!(2>y.length)){var V=y[1];if(Array.isArray(V)&&!(1>V.length)){var k=V[0];if(k!="noop"&&k!="stop"&&k!="close")for(var B=1;B<V.length;B++)V[B]=""}}}}return bn(m)}catch{return f}}var bs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$c={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ma;function Cs(){}_(Cs,Da),Cs.prototype.g=function(){return new XMLHttpRequest},Cs.prototype.i=function(){return{}},Ma=new Cs;function Cn(a,f,m,y){this.j=a,this.i=f,this.l=m,this.R=y||1,this.U=new ae(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qc}function qc(){this.i=null,this.g="",this.h=!1}var zc={},La={};function Fa(a,f,m){a.L=1,a.v=Ns(an(f)),a.m=m,a.P=!0,jc(a,null)}function jc(a,f){a.F=Date.now(),Ps(a),a.A=an(a.v);var m=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),ih(m.i,"t",y),a.C=0,m=a.j.J,a.h=new qc,a.g=Th(a.j,m?f:null,!a.m),0<a.O&&(a.M=new Cr(p(a.Y,a,a.g),a.O)),f=a.U,m=a.g,y=a.ca;var V="readystatechange";Array.isArray(V)||(V&&($e[0]=V.toString()),V=$e);for(var k=0;k<V.length;k++){var B=nt(m,V[k],y||f.handleEvent,!1,f.h||f);if(!B)break;f.g[B.key]=B}f=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),pi(),F_(a.i,a.u,a.A,a.l,a.R,a.m)}Cn.prototype.ca=function(a){a=a.target;const f=this.M;f&&un(a)==3?f.j():this.Y(a)},Cn.prototype.Y=function(a){try{if(a==this.g)t:{const Wt=un(this.g);var f=this.g.Ba();const Dr=this.g.Z();if(!(3>Wt)&&(Wt!=3||this.g&&(this.h.h||this.g.oa()||hh(this.g)))){this.J||Wt!=4||f==7||(f==8||0>=Dr?pi(3):pi(2)),Ua(this);var m=this.g.Z();this.X=m;e:if(Hc(this)){var y=hh(this.g);a="";var V=y.length,k=un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){nr(this),_i(this);var B="";break e}this.h.i=new u.TextDecoder}for(f=0;f<V;f++)this.h.h=!0,a+=this.h.i.decode(y[f],{stream:!(k&&f==V-1)});y.length=0,this.h.g+=a,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,U_(this.i,this.u,this.A,this.l,this.R,Wt,m),this.o){if(this.T&&!this.K){e:{if(this.g){var dt,qt=this.g;if((dt=qt.g?qt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(dt)){var ot=dt;break e}}ot=null}if(m=ot)xr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ba(this,m);else{this.o=!1,this.s=3,te(12),nr(this),_i(this);break t}}if(this.P){m=!0;let Ne;for(;!this.J&&this.C<B.length;)if(Ne=q_(this,B),Ne==La){Wt==4&&(this.s=4,te(14),m=!1),xr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ne==zc){this.s=4,te(15),xr(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else xr(this.i,this.l,Ne,null),Ba(this,Ne);if(Hc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Wt!=4||B.length!=0||this.h.h||(this.s=1,te(16),m=!1),this.o=this.o&&m,!m)xr(this.i,this.l,B,"[Invalid Chunked Response]"),nr(this),_i(this);else if(0<B.length&&!this.W){this.W=!0;var Gt=this.j;Gt.g==this&&Gt.ba&&!Gt.M&&(Gt.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Ga(Gt),Gt.M=!0,te(11))}}else xr(this.i,this.l,B,null),Ba(this,B);Wt==4&&nr(this),this.o&&!this.J&&(Wt==4?yh(this.j,this):(this.o=!1,Ps(this)))}else sy(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,te(12)):(this.s=0,te(13)),nr(this),_i(this)}}}catch{}finally{}};function Hc(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function q_(a,f){var m=a.C,y=f.indexOf(`
`,m);return y==-1?La:(m=Number(f.substring(m,y)),isNaN(m)?zc:(y+=1,y+m>f.length?La:(f=f.slice(y,y+m),a.C=y+m,f)))}Cn.prototype.cancel=function(){this.J=!0,nr(this)};function Ps(a){a.S=Date.now()+a.I,Gc(a,a.I)}function Gc(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=mi(p(a.ba,a),f)}function Ua(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Cn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(B_(this.i,this.A),this.L!=2&&(pi(),te(17)),nr(this),this.s=2,_i(this)):Gc(this,this.S-a)};function _i(a){a.j.G==0||a.J||yh(a.j,a)}function nr(a){Ua(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,_e(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function Ba(a,f){try{var m=a.j;if(m.G!=0&&(m.g==a||$a(m.h,a))){if(!a.K&&$a(m.h,a)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)Fs(m),Ms(m);else break t;Ha(m),te(18)}}else m.za=V[1],0<m.za-m.T&&37500>V[2]&&m.F&&m.v==0&&!m.C&&(m.C=mi(p(m.Za,m),6e3));if(1>=Qc(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else ir(m,11)}else if((a.K||m.g==a)&&Fs(m),!b(f))for(V=m.Da.g.parse(f),f=0;f<V.length;f++){let ot=V[f];if(m.T=ot[0],ot=ot[1],m.G==2)if(ot[0]=="c"){m.K=ot[1],m.ia=ot[2];const Gt=ot[3];Gt!=null&&(m.la=Gt,m.j.info("VER="+m.la));const Wt=ot[4];Wt!=null&&(m.Aa=Wt,m.j.info("SVER="+m.Aa));const Dr=ot[5];Dr!=null&&typeof Dr=="number"&&0<Dr&&(y=1.5*Dr,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;const Ne=a.g;if(Ne){const Bs=Ne.g?Ne.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bs){var k=y.h;k.g||Bs.indexOf("spdy")==-1&&Bs.indexOf("quic")==-1&&Bs.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(qa(k,k.h),k.h=null))}if(y.D){const Wa=Ne.g?Ne.g.getResponseHeader("X-HTTP-Session-Id"):null;Wa&&(y.ya=Wa,_t(y.I,y.D,Wa))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var B=a;if(y.qa=Eh(y,y.J?y.ia:null,y.W),B.K){Xc(y.h,B);var dt=B,qt=y.L;qt&&(dt.I=qt),dt.B&&(Ua(dt),Ps(dt)),y.g=B}else gh(y);0<m.i.length&&Ls(m)}else ot[0]!="stop"&&ot[0]!="close"||ir(m,7);else m.G==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?ir(m,7):ja(m):ot[0]!="noop"&&m.l&&m.l.ta(ot),m.v=0)}}pi(4)}catch{}}var z_=class{constructor(a,f){this.g=a,this.map=f}};function Wc(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kc(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Qc(a){return a.h?1:a.g?a.g.size:0}function $a(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function qa(a,f){a.g?a.g.add(f):a.h=f}function Xc(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}Wc.prototype.cancel=function(){if(this.i=Yc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Yc(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const m of a.g.values())f=f.concat(m.D);return f}return E(a.i)}function j_(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var f=[],m=a.length,y=0;y<m;y++)f.push(a[y]);return f}f=[],m=0;for(y in a)f[m++]=a[y];return f}function H_(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var f=[];a=a.length;for(var m=0;m<a;m++)f.push(m);return f}f=[],m=0;for(const y in a)f[m++]=y;return f}}}function Jc(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var m=H_(a),y=j_(a),V=y.length,k=0;k<V;k++)f.call(void 0,y[k],m&&m[k],a)}var Zc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function G_(a,f){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var y=a[m].indexOf("="),V=null;if(0<=y){var k=a[m].substring(0,y);V=a[m].substring(y+1)}else k=a[m];f(k,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function rr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof rr){this.h=a.h,xs(this,a.j),this.o=a.o,this.g=a.g,Vs(this,a.s),this.l=a.l;var f=a.i,m=new wi;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),th(this,m),this.m=a.m}else a&&(f=String(a).match(Zc))?(this.h=!1,xs(this,f[1]||"",!0),this.o=yi(f[2]||""),this.g=yi(f[3]||"",!0),Vs(this,f[4]),this.l=yi(f[5]||"",!0),th(this,f[6]||"",!0),this.m=yi(f[7]||"")):(this.h=!1,this.i=new wi(null,this.h))}rr.prototype.toString=function(){var a=[],f=this.j;f&&a.push(vi(f,eh,!0),":");var m=this.g;return(m||f=="file")&&(a.push("//"),(f=this.o)&&a.push(vi(f,eh,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(vi(m,m.charAt(0)=="/"?Q_:K_,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",vi(m,Y_)),a.join("")};function an(a){return new rr(a)}function xs(a,f,m){a.j=m?yi(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function Vs(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function th(a,f,m){f instanceof wi?(a.i=f,J_(a.i,a.h)):(m||(f=vi(f,X_)),a.i=new wi(f,a.h))}function _t(a,f,m){a.i.set(f,m)}function Ns(a){return _t(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function yi(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function vi(a,f,m){return typeof a=="string"?(a=encodeURI(a).replace(f,W_),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function W_(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var eh=/[#\/\?@]/g,K_=/[#\?:]/g,Q_=/[#\?]/g,X_=/[#\?@]/g,Y_=/#/g;function wi(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function Pn(a){a.g||(a.g=new Map,a.h=0,a.i&&G_(a.i,function(f,m){a.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}e=wi.prototype,e.add=function(a,f){Pn(this),this.i=null,a=Vr(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(f),this.h+=1,this};function nh(a,f){Pn(a),f=Vr(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function rh(a,f){return Pn(a),f=Vr(a,f),a.g.has(f)}e.forEach=function(a,f){Pn(this),this.g.forEach(function(m,y){m.forEach(function(V){a.call(f,V,y,this)},this)},this)},e.na=function(){Pn(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){const V=a[y];for(let k=0;k<V.length;k++)m.push(f[y])}return m},e.V=function(a){Pn(this);let f=[];if(typeof a=="string")rh(this,a)&&(f=f.concat(this.g.get(Vr(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)f=f.concat(a[m])}return f},e.set=function(a,f){return Pn(this),this.i=null,a=Vr(this,a),rh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},e.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function ih(a,f,m){nh(a,f),0<m.length&&(a.i=null,a.g.set(Vr(a,f),E(m)),a.h+=m.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];const k=encodeURIComponent(String(y)),B=this.V(y);for(y=0;y<B.length;y++){var V=k;B[y]!==""&&(V+="="+encodeURIComponent(String(B[y]))),a.push(V)}}return this.i=a.join("&")};function Vr(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function J_(a,f){f&&!a.j&&(Pn(a),a.i=null,a.g.forEach(function(m,y){var V=y.toLowerCase();y!=V&&(nh(this,y),ih(this,V,m))},a)),a.j=f}function Z_(a,f){const m=new gi;if(u.Image){const y=new Image;y.onload=g(xn,m,"TestLoadImage: loaded",!0,f,y),y.onerror=g(xn,m,"TestLoadImage: error",!1,f,y),y.onabort=g(xn,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=g(xn,m,"TestLoadImage: timeout",!1,f,y),u.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else f(!1)}function ty(a,f){const m=new gi,y=new AbortController,V=setTimeout(()=>{y.abort(),xn(m,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:y.signal}).then(k=>{clearTimeout(V),k.ok?xn(m,"TestPingServer: ok",!0,f):xn(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),xn(m,"TestPingServer: error",!1,f)})}function xn(a,f,m,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(m)}catch{}}function ey(){this.g=new L_}function ny(a,f,m){const y=m||"";try{Jc(a,function(V,k){let B=V;l(V)&&(B=bn(V)),f.push(y+k+"="+encodeURIComponent(B))})}catch(V){throw f.push(y+"type="+encodeURIComponent("_badmap")),V}}function Ds(a){this.l=a.Ub||null,this.j=a.eb||!1}_(Ds,Da),Ds.prototype.g=function(){return new ks(this.l,this.j)},Ds.prototype.i=function(a){return function(){return a}}({});function ks(a,f){Ct.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(ks,Ct),e=ks.prototype,e.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,Ti(this)},e.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||u).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ei(this)),this.readyState=0},e.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ti(this)),this.g&&(this.readyState=3,Ti(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;sh(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function sh(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}e.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?Ei(this):Ti(this),this.readyState==3&&sh(this)}},e.Ra=function(a){this.g&&(this.response=this.responseText=a,Ei(this))},e.Qa=function(a){this.g&&(this.response=a,Ei(this))},e.ga=function(){this.g&&Ei(this)};function Ei(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ti(a)}e.setRequestHeader=function(a,f){this.u.append(a,f)},e.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=f.next();return a.join(`\r
`)};function Ti(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ks.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function oh(a){let f="";return U(a,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function za(a,f,m){t:{for(y in m){var y=!1;break t}y=!0}y||(m=oh(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):_t(a,f,m))}function Et(a){Ct.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Et,Ct);var ry=/^https?$/i,iy=["POST","PUT"];e=Et.prototype,e.Ha=function(a){this.J=a},e.ea=function(a,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ma.g(),this.v=this.o?Oc(this.o):Oc(Ma),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(k){ah(this,k);return}if(a=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)m.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const k of y.keys())m.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(k=>k.toLowerCase()=="content-type"),V=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(iy,f,void 0))||y||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,B]of m)this.g.setRequestHeader(k,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ch(this),this.u=!0,this.g.send(a),this.u=!1}catch(k){ah(this,k)}};function ah(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,uh(a),Os(a)}function uh(a){a.A||(a.A=!0,Pt(a,"complete"),Pt(a,"error"))}e.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Pt(this,"complete"),Pt(this,"abort"),Os(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Os(this,!0)),Et.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?lh(this):this.bb())},e.bb=function(){lh(this)};function lh(a){if(a.h&&typeof o<"u"&&(!a.v[1]||un(a)!=4||a.Z()!=2)){if(a.u&&un(a)==4)tr(a.Ea,0,a);else if(Pt(a,"readystatechange"),un(a)==4){a.h=!1;try{const B=a.Z();t:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var m;if(!(m=f)){var y;if(y=B===0){var V=String(a.D).match(Zc)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),y=!ry.test(V?V.toLowerCase():"")}m=y}if(m)Pt(a,"complete"),Pt(a,"success");else{a.m=6;try{var k=2<un(a)?a.g.statusText:""}catch{k=""}a.l=k+" ["+a.Z()+"]",uh(a)}}finally{Os(a)}}}}function Os(a,f){if(a.g){ch(a);const m=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||Pt(a,"ready");try{m.onreadystatechange=y}catch{}}}function ch(a){a.I&&(u.clearTimeout(a.I),a.I=null)}e.isActive=function(){return!!this.g};function un(a){return a.g?a.g.readyState:0}e.Z=function(){try{return 2<un(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),Pr(f)}};function hh(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function sy(a){const f={};a=(a.g&&2<=un(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(b(a[y]))continue;var m=R(a[y]);const V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const k=f[V]||[];f[V]=k,k.push(m)}I(f,function(y){return y.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ai(a,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||f}function fh(a){this.Aa=0,this.i=[],this.j=new gi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ai("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ai("baseRetryDelayMs",5e3,a),this.cb=Ai("retryDelaySeedMs",1e4,a),this.Wa=Ai("forwardChannelMaxRetries",2,a),this.wa=Ai("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Wc(a&&a.concurrentRequestLimit),this.Da=new ey,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=fh.prototype,e.la=8,e.G=1,e.connect=function(a,f,m,y){te(0),this.W=a,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=Eh(this,null,this.W),Ls(this)};function ja(a){if(dh(a),a.G==3){var f=a.U++,m=an(a.I);if(_t(m,"SID",a.K),_t(m,"RID",f),_t(m,"TYPE","terminate"),Ii(a,m),f=new Cn(a,a.j,f),f.L=2,f.v=Ns(an(m)),m=!1,u.navigator&&u.navigator.sendBeacon)try{m=u.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&u.Image&&(new Image().src=f.v,m=!0),m||(f.g=Th(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Ps(f)}wh(a)}function Ms(a){a.g&&(Ga(a),a.g.cancel(),a.g=null)}function dh(a){Ms(a),a.u&&(u.clearTimeout(a.u),a.u=null),Fs(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Ls(a){if(!Kc(a.h)&&!a.s){a.s=!0;var f=a.Ga;lt||Fe(),mt||(lt(),mt=!0),Mt.add(f,a),a.B=0}}function oy(a,f){return Qc(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=mi(p(a.Ga,a,f),vh(a,a.B)),a.B++,!0)}e.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new Cn(this,this.j,a);let k=this.o;if(this.S&&(k?(k=w(k),S(k,this.S)):k=this.S),this.m!==null||this.O||(V.H=k,k=null),this.P)t:{for(var f=0,m=0;m<this.i.length;m++){e:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break e}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break t}if(f===4096||m===this.i.length-1){f=m+1;break t}}f=1e3}else f=1e3;f=mh(this,V,f),m=an(this.I),_t(m,"RID",a),_t(m,"CVER",22),this.D&&_t(m,"X-HTTP-Session-Id",this.D),Ii(this,m),k&&(this.O?f="headers="+encodeURIComponent(String(oh(k)))+"&"+f:this.m&&za(m,this.m,k)),qa(this.h,V),this.Ua&&_t(m,"TYPE","init"),this.P?(_t(m,"$req",f),_t(m,"SID","null"),V.T=!0,Fa(V,m,null)):Fa(V,m,f),this.G=2}}else this.G==3&&(a?ph(this,a):this.i.length==0||Kc(this.h)||ph(this))};function ph(a,f){var m;f?m=f.l:m=a.U++;const y=an(a.I);_t(y,"SID",a.K),_t(y,"RID",m),_t(y,"AID",a.T),Ii(a,y),a.m&&a.o&&za(y,a.m,a.o),m=new Cn(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),f&&(a.i=f.D.concat(a.i)),f=mh(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),qa(a.h,m),Fa(m,y,f)}function Ii(a,f){a.H&&U(a.H,function(m,y){_t(f,y,m)}),a.l&&Jc({},function(m,y){_t(f,y,m)})}function mh(a,f,m){m=Math.min(a.i.length,m);var y=a.l?p(a.l.Na,a.l,a):null;t:{var V=a.i;let k=-1;for(;;){const B=["count="+m];k==-1?0<m?(k=V[0].g,B.push("ofs="+k)):k=0:B.push("ofs="+k);let dt=!0;for(let qt=0;qt<m;qt++){let ot=V[qt].g;const Gt=V[qt].map;if(ot-=k,0>ot)k=Math.max(0,V[qt].g-100),dt=!1;else try{ny(Gt,B,"req"+ot+"_")}catch{y&&y(Gt)}}if(dt){y=B.join("&");break t}}}return a=a.i.splice(0,m),f.D=a,y}function gh(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;lt||Fe(),mt||(lt(),mt=!0),Mt.add(f,a),a.v=0}}function Ha(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=mi(p(a.Fa,a),vh(a,a.v)),a.v++,!0)}e.Fa=function(){if(this.u=null,_h(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=mi(p(this.ab,this),a)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,te(10),Ms(this),_h(this))};function Ga(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function _h(a){a.g=new Cn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=an(a.qa);_t(f,"RID","rpc"),_t(f,"SID",a.K),_t(f,"AID",a.T),_t(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&_t(f,"TO",a.ja),_t(f,"TYPE","xmlhttp"),Ii(a,f),a.m&&a.o&&za(f,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=Ns(an(f)),m.m=null,m.P=!0,jc(m,a)}e.Za=function(){this.C!=null&&(this.C=null,Ms(this),Ha(this),te(19))};function Fs(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function yh(a,f){var m=null;if(a.g==f){Fs(a),Ga(a),a.g=null;var y=2}else if($a(a.h,f))m=f.D,Xc(a.h,f),y=1;else return;if(a.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var V=a.B;y=Ss(),Pt(y,new Bc(y,m)),Ls(a)}else gh(a);else if(V=f.s,V==3||V==0&&0<f.X||!(y==1&&oy(a,f)||y==2&&Ha(a)))switch(m&&0<m.length&&(f=a.h,f.i=f.i.concat(m)),V){case 1:ir(a,5);break;case 4:ir(a,10);break;case 3:ir(a,6);break;default:ir(a,2)}}}function vh(a,f){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*f}function ir(a,f){if(a.j.info("Error code "+f),f==2){var m=p(a.fb,a),y=a.Xa;const V=!y;y=new rr(y||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||xs(y,"https"),Ns(y),V?Z_(y.toString(),m):ty(y.toString(),m)}else te(2);a.G=0,a.l&&a.l.sa(f),wh(a),dh(a)}e.fb=function(a){a?(this.j.info("Successfully pinged google.com"),te(2)):(this.j.info("Failed to ping google.com"),te(1))};function wh(a){if(a.G=0,a.ka=[],a.l){const f=Yc(a.h);(f.length!=0||a.i.length!=0)&&(v(a.ka,f),v(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function Eh(a,f,m){var y=m instanceof rr?an(m):new rr(m);if(y.g!="")f&&(y.g=f+"."+y.g),Vs(y,y.s);else{var V=u.location;y=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;var k=new rr(null);y&&xs(k,y),f&&(k.g=f),V&&Vs(k,V),m&&(k.l=m),y=k}return m=a.D,f=a.ya,m&&f&&_t(y,m,f),_t(y,"VER",a.la),Ii(a,y),y}function Th(a,f,m){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new Et(new Ds({eb:m})):new Et(a.pa),f.Ha(a.J),f}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ah(){}e=Ah.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Us(){}Us.prototype.g=function(a,f){return new ye(a,f)};function ye(a,f){Ct.call(this),this.g=new fh(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!b(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!b(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Nr(this)}_(ye,Ct),ye.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ye.prototype.close=function(){ja(this.g)},ye.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=bn(a),a=m);f.i.push(new z_(f.Ya++,a)),f.G==3&&Ls(f)},ye.prototype.N=function(){this.g.l=null,delete this.j,ja(this.g),delete this.g,ye.aa.N.call(this)};function Ih(a){ka.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){t:{for(const m in f){a=m;break t}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}_(Ih,ka);function Rh(){Oa.call(this),this.status=1}_(Rh,Oa);function Nr(a){this.g=a}_(Nr,Ah),Nr.prototype.ua=function(){Pt(this.g,"a")},Nr.prototype.ta=function(a){Pt(this.g,new Ih(a))},Nr.prototype.sa=function(a){Pt(this.g,new Rh)},Nr.prototype.ra=function(){Pt(this.g,"b")},Us.prototype.createWebChannel=Us.prototype.g,ye.prototype.send=ye.prototype.o,ye.prototype.open=ye.prototype.m,ye.prototype.close=ye.prototype.close,Wp=function(){return new Us},Gp=function(){return Ss()},Hp=er,bu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},bs.NO_ERROR=0,bs.TIMEOUT=8,bs.HTTP_ERROR=6,no=bs,$c.COMPLETE="complete",jp=$c,Mc.EventType=di,di.OPEN="a",di.CLOSE="b",di.ERROR="c",di.MESSAGE="d",Ct.prototype.listen=Ct.prototype.K,Pi=Mc,Et.prototype.listenOnce=Et.prototype.L,Et.prototype.getLastError=Et.prototype.Ka,Et.prototype.getLastErrorCode=Et.prototype.Ba,Et.prototype.getStatus=Et.prototype.Z,Et.prototype.getResponseJson=Et.prototype.Oa,Et.prototype.getResponseText=Et.prototype.oa,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Ha,zp=Et}).apply(typeof zs<"u"?zs:typeof self<"u"?self:typeof window<"u"?window:{});const Xh="@firebase/firestore",Yh="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let si="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr=new Mp("@firebase/firestore");function Or(){return gr.logLevel}function j(e,...t){if(gr.logLevel<=it.DEBUG){const n=t.map(Ml);gr.debug(`Firestore (${si}): ${e}`,...n)}}function yn(e,...t){if(gr.logLevel<=it.ERROR){const n=t.map(Ml);gr.error(`Firestore (${si}): ${e}`,...n)}}function qn(e,...t){if(gr.logLevel<=it.WARN){const n=t.map(Ml);gr.warn(`Firestore (${si}): ${e}`,...n)}}function Ml(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,Kp(e,r,n)}function Kp(e,t,n){let r=`FIRESTORE (${si}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw yn(r),new Error(r)}function ct(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||Kp(t,i,r)}function Q(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends ii{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class lw{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}}class cw{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class hw{constructor(t){this.t=t,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ct(this.o===void 0,42304);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new pn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pn,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;t.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pn)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ct(typeof r.accessToken=="string",31837,{l:r}),new Qp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ct(t===null||typeof t=="string",2055,{h:t}),new Xt(t)}}class fw{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class dw{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new fw(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Jh{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pw{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,G0(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ct(this.o===void 0,3512);const r=s=>{s.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Jh(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ct(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Jh(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=mw(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%62))}return r}}function tt(e,t){return e<t?-1:e>t?1:0}function Cu(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return tt(r,i);{const s=Xp(),o=gw(s.encode(Zh(e,n)),s.encode(Zh(t,n)));return o!==0?o:tt(r,i)}}n+=r>65535?2:1}return tt(e.length,t.length)}function Zh(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function gw(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return tt(e[n],t[n]);return tt(e.length,t.length)}function Gr(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf="__name__";class je{constructor(t,n,r){n===void 0?n=0:n>t.length&&W(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&W(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return je.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof je?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const s=je.compareSegments(t.get(i),n.get(i));if(s!==0)return s}return tt(t.length,n.length)}static compareSegments(t,n){const r=je.isNumericId(t),i=je.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?je.extractNumericId(t).compare(je.extractNumericId(n)):Cu(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Fn.fromString(t.substring(4,t.length-2))}}class gt extends je{construct(t,n,r){return new gt(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new q(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new gt(n)}static emptyPath(){return new gt([])}}const _w=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jt extends je{construct(t,n,r){return new jt(t,n,r)}static isValidIdentifier(t){return _w.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tf}static keyField(){return new jt([tf])}static fromServerFormat(t){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new q(O.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new q(O.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new jt(n)}static emptyPath(){return new jt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(t){this.path=t}static fromPath(t){return new G(gt.fromString(t))}static fromName(t){return new G(gt.fromString(t).popFirst(5))}static empty(){return new G(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&gt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return gt.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new G(new gt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(e,t,n){if(!n)throw new q(O.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function yw(e,t,n,r){if(t===!0&&r===!0)throw new q(O.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function ef(e){if(!G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function nf(e){if(G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Jp(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function oa(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":W(12329,{type:typeof e})}function vn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new q(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=oa(e);throw new q(O.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function vw(e,t){if(t<=0)throw new q(O.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(e,t){const n={typeString:e};return t&&(n.value=t),n}function ps(e,t){if(!Jp(e))throw new q(O.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new q(O.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf=-62135596800,sf=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(t){return yt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*sf);return new yt(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<rf)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sf}_compareTo(t){return this.seconds===t.seconds?tt(this.nanoseconds,t.nanoseconds):tt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(ps(t,yt._jsonSchema))return new yt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-rf;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:Nt("string",yt._jsonSchemaVersion),seconds:Nt("number"),nanoseconds:Nt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{static fromTimestamp(t){return new K(t)}static min(){return new K(new yt(0,0))}static max(){return new K(new yt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=-1;function ww(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new yt(n+1,0):new yt(n,r));return new zn(i,G.empty(),t)}function Ew(e){return new zn(e.readTime,e.key,Yi)}class zn{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new zn(K.min(),G.empty(),Yi)}static max(){return new zn(K.max(),G.empty(),Yi)}}function Tw(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=G.comparator(e.documentKey,t.documentKey),n!==0?n:tt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Iw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oi(e){if(e.code!==O.FAILED_PRECONDITION||e.message!==Aw)throw e;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&W(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):L.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):L.reject(n)}static resolve(t){return new L((n,r)=>{n(t)})}static reject(t){return new L((n,r)=>{r(t)})}static waitFor(t){return new L((n,r)=>{let i=0,s=0,o=!1;t.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(t){let n=L.resolve(!1);for(const r of t)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new L((r,i)=>{const s=t.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const l=c;n(t[l]).next(h=>{o[l]=h,++u,u===s&&r(o)},h=>i(h))}})}static doWhile(t,n){return new L((r,i)=>{const s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}}function Rw(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ai(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}aa.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=-1;function ua(e){return e==null}function Co(e){return e===0&&1/e==-1/0}function Sw(e){return typeof e=="number"&&Number.isInteger(e)&&!Co(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="";function bw(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=of(t)),t=Cw(e.get(n),t);return of(t)}function Cw(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const s=e.charAt(i);switch(s){case"\0":n+="";break;case Zp:n+="";break;default:n+=s}}return n}function of(e){return e+Zp+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Qn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function tm(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(t,n){this.comparator=t,this.root=n||zt.EMPTY}insert(t,n){return new wt(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,zt.BLACK,null,null))}remove(t){return new wt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,zt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new js(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new js(this.root,t,this.comparator,!1)}getReverseIterator(){return new js(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new js(this.root,t,this.comparator,!0)}}class js{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class zt{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??zt.RED,this.left=i??zt.EMPTY,this.right=s??zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new zt(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return zt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return zt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw W(43730,{key:this.key,value:this.value});if(this.right.isRed())throw W(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw W(27949);return t+(this.isRed()?0:1)}}zt.EMPTY=null,zt.RED=!0,zt.BLACK=!1;zt.EMPTY=new class{constructor(){this.size=0}get key(){throw W(57766)}get value(){throw W(16141)}get color(){throw W(16727)}get left(){throw W(29726)}get right(){throw W(36894)}copy(t,n,r,i,s){return this}insert(t,n,r){return new zt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(t){this.comparator=t,this.data=new wt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new uf(this.data.getIterator())}getIteratorFrom(t){return new uf(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Ot)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Ot(this.comparator);return n.data=t,n}}class uf{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(t){this.fields=t,t.sort(jt.comparator)}static empty(){return new Te([])}unionWith(t){let n=new Ot(jt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Te(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Gr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new em("Invalid base64 string: "+s):s}}(t);return new Ht(n)}static fromUint8Array(t){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new Ht(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return tt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ht.EMPTY_BYTE_STRING=new Ht("");const Pw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jn(e){if(ct(!!e,39018),typeof e=="string"){let t=0;const n=Pw.exec(e);if(ct(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:It(e.seconds),nanos:It(e.nanos)}}function It(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Hn(e){return typeof e=="string"?Ht.fromBase64String(e):Ht.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm="server_timestamp",rm="__type__",im="__previous_value__",sm="__local_write_time__";function Ul(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[rm])===null||n===void 0?void 0:n.stringValue)===nm}function la(e){const t=e.mapValue.fields[im];return Ul(t)?la(t):t}function Ji(e){const t=jn(e.mapValue.fields[sm].timestampValue);return new yt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(t,n,r,i,s,o,u,c,l,h){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=h}}const Po="(default)";class Zi{constructor(t,n){this.projectId=t,this.database=n||Po}static empty(){return new Zi("","")}get isDefaultDatabase(){return this.database===Po}isEqual(t){return t instanceof Zi&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="__type__",Vw="__max__",Hs={mapValue:{}},am="__vector__",xo="value";function Gn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ul(e)?4:Dw(e)?9007199254740991:Nw(e)?10:11:W(28295,{value:e})}function rn(e,t){if(e===t)return!0;const n=Gn(e);if(n!==Gn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ji(e).isEqual(Ji(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=jn(i.timestampValue),u=jn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return Hn(i.bytesValue).isEqual(Hn(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return It(i.geoPointValue.latitude)===It(s.geoPointValue.latitude)&&It(i.geoPointValue.longitude)===It(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return It(i.integerValue)===It(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=It(i.doubleValue),u=It(s.doubleValue);return o===u?Co(o)===Co(u):isNaN(o)&&isNaN(u)}return!1}(e,t);case 9:return Gr(e.arrayValue.values||[],t.arrayValue.values||[],rn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(af(o)!==af(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!rn(o[c],u[c])))return!1;return!0}(e,t);default:return W(52216,{left:e})}}function ts(e,t){return(e.values||[]).find(n=>rn(n,t))!==void 0}function Wr(e,t){if(e===t)return 0;const n=Gn(e),r=Gn(t);if(n!==r)return tt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tt(e.booleanValue,t.booleanValue);case 2:return function(s,o){const u=It(s.integerValue||s.doubleValue),c=It(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(e,t);case 3:return lf(e.timestampValue,t.timestampValue);case 4:return lf(Ji(e),Ji(t));case 5:return Cu(e.stringValue,t.stringValue);case 6:return function(s,o){const u=Hn(s),c=Hn(o);return u.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let l=0;l<u.length&&l<c.length;l++){const h=tt(u[l],c[l]);if(h!==0)return h}return tt(u.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const u=tt(It(s.latitude),It(o.latitude));return u!==0?u:tt(It(s.longitude),It(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return cf(e.arrayValue,t.arrayValue);case 10:return function(s,o){var u,c,l,h;const d=s.fields||{},p=o.fields||{},g=(u=d[xo])===null||u===void 0?void 0:u.arrayValue,_=(c=p[xo])===null||c===void 0?void 0:c.arrayValue,E=tt(((l=g==null?void 0:g.values)===null||l===void 0?void 0:l.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:cf(g,_)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===Hs.mapValue&&o===Hs.mapValue)return 0;if(s===Hs.mapValue)return 1;if(o===Hs.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),l=o.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const p=Cu(c[d],h[d]);if(p!==0)return p;const g=Wr(u[c[d]],l[h[d]]);if(g!==0)return g}return tt(c.length,h.length)}(e.mapValue,t.mapValue);default:throw W(23264,{le:n})}}function lf(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return tt(e,t);const n=jn(e),r=jn(t),i=tt(n.seconds,r.seconds);return i!==0?i:tt(n.nanos,r.nanos)}function cf(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Wr(n[i],r[i]);if(s)return s}return tt(n.length,r.length)}function Kr(e){return Pu(e)}function Pu(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=jn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Hn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return G.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Pu(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Pu(n.fields[o])}`;return i+"}"}(e.mapValue):W(61005,{value:e})}function ro(e){switch(Gn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=la(e);return t?16+ro(t):16;case 5:return 2*e.stringValue.length;case 6:return Hn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+ro(s),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return Qn(r.fields,(s,o)=>{i+=s.length+ro(o)}),i}(e.mapValue);default:throw W(13486,{value:e})}}function hf(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function xu(e){return!!e&&"integerValue"in e}function Bl(e){return!!e&&"arrayValue"in e}function ff(e){return!!e&&"nullValue"in e}function df(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function io(e){return!!e&&"mapValue"in e}function Nw(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[om])===null||n===void 0?void 0:n.stringValue)===am}function zi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Qn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=zi(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=zi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Dw(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Vw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(t){this.value=t}static empty(){return new ce({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!io(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=zi(n)}setAll(t){let n=jt.emptyPath(),r={},i=[];t.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=zi(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){const n=this.field(t.popLast());io(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return rn(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];io(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){Qn(n,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new ce(zi(this.value))}}function um(e){const t=[];return Qn(e.fields,(n,r)=>{const i=new jt([n]);if(io(r)){const s=um(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new Te(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(t,n,r,i,s,o,u){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(t){return new Yt(t,0,K.min(),K.min(),K.min(),ce.empty(),0)}static newFoundDocument(t,n,r,i){return new Yt(t,1,n,K.min(),r,i,0)}static newNoDocument(t,n){return new Yt(t,2,n,K.min(),K.min(),ce.empty(),0)}static newUnknownDocument(t,n){return new Yt(t,3,n,K.min(),K.min(),ce.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ce.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ce.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Yt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(t,n){this.position=t,this.inclusive=n}}function pf(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=Wr(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function mf(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!rn(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(t,n="asc"){this.field=t,this.dir=n}}function kw(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{}class Vt extends lm{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new Mw(t,n,r):n==="array-contains"?new Uw(t,r):n==="in"?new Bw(t,r):n==="not-in"?new $w(t,r):n==="array-contains-any"?new qw(t,r):new Vt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new Lw(t,r):new Fw(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Wr(n,this.value)):n!==null&&Gn(this.value)===Gn(n)&&this.matchesComparison(Wr(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ke extends lm{constructor(t,n){super(),this.filters=t,this.op=n,this.he=null}static create(t,n){return new ke(t,n)}matches(t){return cm(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function cm(e){return e.op==="and"}function hm(e){return Ow(e)&&cm(e)}function Ow(e){for(const t of e.filters)if(t instanceof ke)return!1;return!0}function Vu(e){if(e instanceof Vt)return e.field.canonicalString()+e.op.toString()+Kr(e.value);if(hm(e))return e.filters.map(t=>Vu(t)).join(",");{const t=e.filters.map(n=>Vu(n)).join(",");return`${e.op}(${t})`}}function fm(e,t){return e instanceof Vt?function(r,i){return i instanceof Vt&&r.op===i.op&&r.field.isEqual(i.field)&&rn(r.value,i.value)}(e,t):e instanceof ke?function(r,i){return i instanceof ke&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&fm(o,i.filters[u]),!0):!1}(e,t):void W(19439)}function dm(e){return e instanceof Vt?function(n){return`${n.field.canonicalString()} ${n.op} ${Kr(n.value)}`}(e):e instanceof ke?function(n){return n.op.toString()+" {"+n.getFilters().map(dm).join(" ,")+"}"}(e):"Filter"}class Mw extends Vt{constructor(t,n,r){super(t,n,r),this.key=G.fromName(r.referenceValue)}matches(t){const n=G.comparator(t.key,this.key);return this.matchesComparison(n)}}class Lw extends Vt{constructor(t,n){super(t,"in",n),this.keys=pm("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class Fw extends Vt{constructor(t,n){super(t,"not-in",n),this.keys=pm("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function pm(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class Uw extends Vt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return Bl(n)&&ts(n.arrayValue,this.value)}}class Bw extends Vt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&ts(this.value.arrayValue,n)}}class $w extends Vt{constructor(t,n){super(t,"not-in",n)}matches(t){if(ts(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ts(this.value.arrayValue,n)}}class qw extends Vt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!Bl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ts(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(t,n=null,r=[],i=[],s=null,o=null,u=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.Pe=null}}function gf(e,t=null,n=[],r=[],i=null,s=null,o=null){return new zw(e,t,n,r,i,s,o)}function $l(e){const t=Q(e);if(t.Pe===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>Vu(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ua(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Kr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Kr(r)).join(",")),t.Pe=n}return t.Pe}function ql(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!kw(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!fm(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!mf(e.startAt,t.startAt)&&mf(e.endAt,t.endAt)}function Nu(e){return G.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(t,n=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function jw(e,t,n,r,i,s,o,u){return new ui(e,t,n,r,i,s,o,u)}function zl(e){return new ui(e)}function _f(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function mm(e){return e.collectionGroup!==null}function ji(e){const t=Q(e);if(t.Te===null){t.Te=[];const n=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Ot(jt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(u=u.add(l.field))})}),u})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Te.push(new es(s,r))}),n.has(jt.keyField().canonicalString())||t.Te.push(new es(jt.keyField(),r))}return t.Te}function Qe(e){const t=Q(e);return t.Ie||(t.Ie=Hw(t,ji(e))),t.Ie}function Hw(e,t){if(e.limitType==="F")return gf(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new es(i.field,s)});const n=e.endAt?new Vo(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Vo(e.startAt.position,e.startAt.inclusive):null;return gf(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Du(e,t){const n=e.filters.concat([t]);return new ui(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function No(e,t,n){return new ui(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ca(e,t){return ql(Qe(e),Qe(t))&&e.limitType===t.limitType}function gm(e){return`${$l(Qe(e))}|lt:${e.limitType}`}function Mr(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>dm(i)).join(", ")}]`),ua(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Kr(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Kr(i)).join(",")),`Target(${r})`}(Qe(e))}; limitType=${e.limitType})`}function ha(e,t){return t.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(const s of ji(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,u,c){const l=pf(o,u,c);return o.inclusive?l<=0:l<0}(r.startAt,ji(r),i)||r.endAt&&!function(o,u,c){const l=pf(o,u,c);return o.inclusive?l>=0:l>0}(r.endAt,ji(r),i))}(e,t)}function Gw(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function _m(e){return(t,n)=>{let r=!1;for(const i of ji(e)){const s=Ww(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Ww(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(s,o,u){const c=o.data.field(s),l=u.data.field(s);return c!==null&&l!==null?Wr(c,l):W(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return W(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Qn(this.inner,(n,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return tm(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=new wt(G.comparator);function wn(){return Kw}const ym=new wt(G.comparator);function xi(...e){let t=ym;for(const n of e)t=t.insert(n.key,n);return t}function vm(e){let t=ym;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function ur(){return Hi()}function wm(){return Hi()}function Hi(){return new Ar(e=>e.toString(),(e,t)=>e.isEqual(t))}const Qw=new wt(G.comparator),Xw=new Ot(G.comparator);function et(...e){let t=Xw;for(const n of e)t=t.add(n);return t}const Yw=new Ot(tt);function Jw(){return Yw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Co(t)?"-0":t}}function Em(e){return{integerValue:""+e}}function Zw(e,t){return Sw(t)?Em(t):jl(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this._=void 0}}function tE(e,t,n){return e instanceof Do?function(i,s){const o={fields:{[rm]:{stringValue:nm},[sm]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ul(s)&&(s=la(s)),s&&(o.fields[im]=s),{mapValue:o}}(n,t):e instanceof ns?Am(e,t):e instanceof rs?Im(e,t):function(i,s){const o=Tm(i,s),u=yf(o)+yf(i.Ee);return xu(o)&&xu(i.Ee)?Em(u):jl(i.serializer,u)}(e,t)}function eE(e,t,n){return e instanceof ns?Am(e,t):e instanceof rs?Im(e,t):n}function Tm(e,t){return e instanceof ko?function(r){return xu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}class Do extends fa{}class ns extends fa{constructor(t){super(),this.elements=t}}function Am(e,t){const n=Rm(t);for(const r of e.elements)n.some(i=>rn(i,r))||n.push(r);return{arrayValue:{values:n}}}class rs extends fa{constructor(t){super(),this.elements=t}}function Im(e,t){let n=Rm(t);for(const r of e.elements)n=n.filter(i=>!rn(i,r));return{arrayValue:{values:n}}}class ko extends fa{constructor(t,n){super(),this.serializer=t,this.Ee=n}}function yf(e){return It(e.integerValue||e.doubleValue)}function Rm(e){return Bl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function nE(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof ns&&i instanceof ns||r instanceof rs&&i instanceof rs?Gr(r.elements,i.elements,rn):r instanceof ko&&i instanceof ko?rn(r.Ee,i.Ee):r instanceof Do&&i instanceof Do}(e.transform,t.transform)}class rE{constructor(t,n){this.version=t,this.transformResults=n}}class Xe{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Xe}static exists(t){return new Xe(void 0,t)}static updateTime(t){return new Xe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function so(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class da{}function Sm(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Cm(e.key,Xe.none()):new ms(e.key,e.data,Xe.none());{const n=e.data,r=ce.empty();let i=new Ot(jt.comparator);for(let s of t.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Xn(e.key,r,new Te(i.toArray()),Xe.none())}}function iE(e,t,n){e instanceof ms?function(i,s,o){const u=i.value.clone(),c=wf(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,n):e instanceof Xn?function(i,s,o){if(!so(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=wf(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(bm(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Gi(e,t,n,r){return e instanceof ms?function(s,o,u,c){if(!so(s.precondition,o))return u;const l=s.value.clone(),h=Ef(s.fieldTransforms,c,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(e,t,n,r):e instanceof Xn?function(s,o,u,c){if(!so(s.precondition,o))return u;const l=Ef(s.fieldTransforms,c,o),h=o.data;return h.setAll(bm(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,r):function(s,o,u){return so(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(e,t,n)}function sE(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),s=Tm(r.transform,i||null);s!=null&&(n===null&&(n=ce.empty()),n.set(r.field,s))}return n||null}function vf(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Gr(r,i,(s,o)=>nE(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ms extends da{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xn extends da{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function bm(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function wf(e,t,n){const r=new Map;ct(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,u=t.data.field(s.field);r.set(s.field,eE(o,u,n[i]))}return r}function Ef(e,t,n){const r=new Map;for(const i of e){const s=i.transform,o=n.data.field(i.field);r.set(i.field,tE(s,o,t))}return r}class Cm extends da{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oE extends da{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&iE(s,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Gi(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Gi(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=wm();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const c=Sm(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),et())}isEqual(t){return this.batchId===t.batchId&&Gr(this.mutations,t.mutations,(n,r)=>vf(n,r))&&Gr(this.baseMutations,t.baseMutations,(n,r)=>vf(n,r))}}class Hl{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){ct(t.mutations.length===r.length,58842,{Ve:t.mutations.length,me:r.length});let i=function(){return Qw}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Hl(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt,rt;function cE(e){switch(e){case O.OK:return W(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return W(15467,{code:e})}}function Pm(e){if(e===void 0)return yn("GRPC error has no .code"),O.UNKNOWN;switch(e){case xt.OK:return O.OK;case xt.CANCELLED:return O.CANCELLED;case xt.UNKNOWN:return O.UNKNOWN;case xt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case xt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case xt.INTERNAL:return O.INTERNAL;case xt.UNAVAILABLE:return O.UNAVAILABLE;case xt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case xt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case xt.NOT_FOUND:return O.NOT_FOUND;case xt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case xt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case xt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case xt.ABORTED:return O.ABORTED;case xt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case xt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case xt.DATA_LOSS:return O.DATA_LOSS;default:return W(39323,{code:e})}}(rt=xt||(xt={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE=new Fn([4294967295,4294967295],0);function Tf(e){const t=Xp().encode(e),n=new qp;return n.update(t),new Uint8Array(n.digest())}function Af(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Fn([n,r],0),new Fn([i,s],0)]}class Gl{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Vi(`Invalid padding: ${n}`);if(r<0)throw new Vi(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Vi(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Vi(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*t.length-n,this.ge=Fn.fromNumber(this.fe)}pe(t,n,r){let i=t.add(n.multiply(Fn.fromNumber(r)));return i.compare(hE)===1&&(i=new Fn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const n=Tf(t),[r,i]=Af(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(t,n,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new Gl(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(t){if(this.fe===0)return;const n=Tf(t),[r,i]=Af(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Vi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const i=new Map;return i.set(t,gs.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new pa(K.min(),i,new wt(tt),wn(),et())}}class gs{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new gs(r,n,et(),et(),et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(t,n,r,i){this.Se=t,this.removedTargetIds=n,this.key=r,this.be=i}}class xm{constructor(t,n){this.targetId=t,this.De=n}}class Vm{constructor(t,n,r=Ht.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}}class If{constructor(){this.ve=0,this.Ce=Rf(),this.Fe=Ht.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=et(),n=et(),r=et();return this.Ce.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:W(38017,{changeType:s})}}),new gs(this.Fe,this.Me,t,n,r)}ke(){this.xe=!1,this.Ce=Rf()}qe(t,n){this.xe=!0,this.Ce=this.Ce.insert(t,n)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,ct(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class fE{constructor(t){this.We=t,this.Ge=new Map,this.ze=wn(),this.je=Gs(),this.Je=Gs(),this.He=new wt(tt)}Ye(t){for(const n of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(n,t.be):this.Xe(n,t.key,t.be);for(const n of t.removedTargetIds)this.Xe(n,t.key,t.be)}et(t){this.forEachTarget(t,n=>{const r=this.tt(n);switch(t.state){case 0:this.nt(n)&&r.Be(t.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(t.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(t.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(t.resumeToken));break;default:W(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(t){const n=t.targetId,r=t.De.count,i=this.st(n);if(i){const s=i.target;if(Nu(s))if(r===0){const o=new G(s.path);this.Xe(n,o,Yt.newNoDocument(o,K.min()))}else ct(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const u=this._t(t),c=u?this.ut(u,t,o):1;if(c!==0){this.rt(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,l)}}}}}_t(t){const n=t.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=Hn(r).toUint8Array()}catch(c){if(c instanceof em)return qn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new Gl(o,i,s)}catch(c){return qn(c instanceof Vi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.fe===0?null:u}ut(t,n,r){return n.De.count===r-this.ht(t,n.targetId)?0:2}ht(t,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(u)||(this.Xe(n,s,null),i++)}),i}Pt(t){const n=new Map;this.Ge.forEach((s,o)=>{const u=this.st(o);if(u){if(s.current&&Nu(u.target)){const c=new G(u.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,Yt.newNoDocument(c,t))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=et();this.Je.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const l=this.st(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(t));const i=new pa(t,n,this.He,this.ze,r);return this.ze=wn(),this.je=Gs(),this.Je=Gs(),this.He=new wt(tt),i}Ze(t,n){if(!this.nt(t))return;const r=this.It(t,n.key)?2:0;this.tt(t).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(t)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(t))}Xe(t,n,r){if(!this.nt(t))return;const i=this.tt(t);this.It(t,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(t)),this.Je=this.Je.insert(n,this.dt(n).add(t)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(t){this.Ge.delete(t)}ot(t){const n=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let n=this.Ge.get(t);return n||(n=new If,this.Ge.set(t,n)),n}dt(t){let n=this.Je.get(t);return n||(n=new Ot(tt),this.Je=this.Je.insert(t,n)),n}Tt(t){let n=this.je.get(t);return n||(n=new Ot(tt),this.je=this.je.insert(t,n)),n}nt(t){const n=this.st(t)!==null;return n||j("WatchChangeAggregator","Detected inactive target",t),n}st(t){const n=this.Ge.get(t);return n&&n.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new If),this.We.getRemoteKeysForTarget(t).forEach(n=>{this.Xe(t,n,null)})}It(t,n){return this.We.getRemoteKeysForTarget(t).has(n)}}function Gs(){return new wt(G.comparator)}function Rf(){return new wt(G.comparator)}const dE={asc:"ASCENDING",desc:"DESCENDING"},pE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mE={and:"AND",or:"OR"};class gE{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function ku(e,t){return e.useProto3Json||ua(t)?t:{value:t}}function Oo(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Nm(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function _E(e,t){return Oo(e,t.toTimestamp())}function Ye(e){return ct(!!e,49232),K.fromTimestamp(function(n){const r=jn(n);return new yt(r.seconds,r.nanos)}(e))}function Wl(e,t){return Ou(e,t).canonicalString()}function Ou(e,t){const n=function(i){return new gt(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Dm(e){const t=gt.fromString(e);return ct(Fm(t),10190,{key:t.toString()}),t}function Mu(e,t){return Wl(e.databaseId,t.path)}function iu(e,t){const n=Dm(t);if(n.get(1)!==e.databaseId.projectId)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new G(Om(n))}function km(e,t){return Wl(e.databaseId,t)}function yE(e){const t=Dm(e);return t.length===4?gt.emptyPath():Om(t)}function Lu(e){return new gt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Om(e){return ct(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Sf(e,t,n){return{name:Mu(e,t),fields:n.value.mapValue.fields}}function vE(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:W(39313,{state:l})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(l,h){return l.useProto3Json?(ct(h===void 0||typeof h=="string",58123),Ht.fromBase64String(h||"")):(ct(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Ht.fromUint8Array(h||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(l){const h=l.code===void 0?O.UNKNOWN:Pm(l.code);return new q(h,l.message||"")}(o);n=new Vm(r,i,s,u||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=iu(e,r.document.name),s=Ye(r.document.updateTime),o=r.document.createTime?Ye(r.document.createTime):K.min(),u=new ce({mapValue:{fields:r.document.fields}}),c=Yt.newFoundDocument(i,s,o,u),l=r.targetIds||[],h=r.removedTargetIds||[];n=new oo(l,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=iu(e,r.document),s=r.readTime?Ye(r.readTime):K.min(),o=Yt.newNoDocument(i,s),u=r.removedTargetIds||[];n=new oo([],u,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=iu(e,r.document),s=r.removedTargetIds||[];n=new oo([],s,i,null)}else{if(!("filter"in t))return W(11601,{At:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new lE(i,s),u=r.targetId;n=new xm(u,o)}}return n}function wE(e,t){let n;if(t instanceof ms)n={update:Sf(e,t.key,t.value)};else if(t instanceof Cm)n={delete:Mu(e,t.key)};else if(t instanceof Xn)n={update:Sf(e,t.key,t.data),updateMask:PE(t.fieldMask)};else{if(!(t instanceof oE))return W(16599,{Rt:t.type});n={verify:Mu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Do)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ns)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof rs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof ko)return{fieldPath:o.field.canonicalString(),increment:u.Ee};throw W(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_E(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W(27497)}(e,t.precondition)),n}function EE(e,t){return e&&e.length>0?(ct(t!==void 0,14353),e.map(n=>function(i,s){let o=i.updateTime?Ye(i.updateTime):Ye(s);return o.isEqual(K.min())&&(o=Ye(s)),new rE(o,i.transformResults||[])}(n,t))):[]}function TE(e,t){return{documents:[km(e,t.path)]}}function AE(e,t){const n={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=km(e,i);const s=function(l){if(l.length!==0)return Lm(ke.create(l,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(l){if(l.length!==0)return l.map(h=>function(p){return{field:Lr(p.field),direction:SE(p.dir)}}(h))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const u=ku(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{Vt:n,parent:i}}function IE(e){let t=yE(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ct(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let s=[];n.where&&(s=function(d){const p=Mm(d);return p instanceof ke&&hm(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(_){return new es(Fr(_.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(p))}(n.orderBy));let u=null;n.limit&&(u=function(d){let p;return p=typeof d=="object"?d.value:d,ua(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(d){const p=!!d.before,g=d.values||[];return new Vo(g,p)}(n.startAt));let l=null;return n.endAt&&(l=function(d){const p=!d.before,g=d.values||[];return new Vo(g,p)}(n.endAt)),jw(t,i,o,s,u,"F",c,l)}function RE(e,t){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W(28987,{purpose:i})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Mm(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Fr(n.unaryFilter.field);return Vt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Fr(n.unaryFilter.field);return Vt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Fr(n.unaryFilter.field);return Vt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fr(n.unaryFilter.field);return Vt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return W(61313);default:return W(60726)}}(e):e.fieldFilter!==void 0?function(n){return Vt.create(Fr(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return W(58110);default:return W(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return ke.create(n.compositeFilter.filters.map(r=>Mm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W(1026)}}(n.compositeFilter.op))}(e):W(30097,{filter:e})}function SE(e){return dE[e]}function bE(e){return pE[e]}function CE(e){return mE[e]}function Lr(e){return{fieldPath:e.canonicalString()}}function Fr(e){return jt.fromServerFormat(e.fieldPath)}function Lm(e){return e instanceof Vt?function(n){if(n.op==="=="){if(df(n.value))return{unaryFilter:{field:Lr(n.field),op:"IS_NAN"}};if(ff(n.value))return{unaryFilter:{field:Lr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(df(n.value))return{unaryFilter:{field:Lr(n.field),op:"IS_NOT_NAN"}};if(ff(n.value))return{unaryFilter:{field:Lr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lr(n.field),op:bE(n.op),value:n.value}}}(e):e instanceof ke?function(n){const r=n.getFilters().map(i=>Lm(i));return r.length===1?r[0]:{compositeFilter:{op:CE(n.op),filters:r}}}(e):W(54877,{filter:e})}function PE(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Fm(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(t,n,r,i,s=K.min(),o=K.min(),u=Ht.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(t){return new On(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new On(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new On(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new On(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(t){this.gt=t}}function VE(e){const t=IE({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?No(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this.Dn=new DE}addToCollectionParentIndex(t,n){return this.Dn.add(n),L.resolve()}getCollectionParents(t,n){return L.resolve(this.Dn.getEntries(n))}addFieldIndex(t,n){return L.resolve()}deleteFieldIndex(t,n){return L.resolve()}deleteAllFieldIndexes(t){return L.resolve()}createTargetIndexes(t,n){return L.resolve()}getDocumentsMatchingTarget(t,n){return L.resolve(null)}getIndexType(t,n){return L.resolve(0)}getFieldIndexes(t,n){return L.resolve([])}getNextCollectionGroupToUpdate(t){return L.resolve(null)}getMinOffset(t,n){return L.resolve(zn.min())}getMinOffsetFromCollectionGroup(t,n){return L.resolve(zn.min())}updateCollectionGroup(t,n,r){return L.resolve()}updateIndexEntries(t,n){return L.resolve()}}class DE{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new Ot(gt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new Ot(gt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Um=41943040;class le{static withCacheSize(t){return new le(t,le.DEFAULT_COLLECTION_PERCENTILE,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */le.DEFAULT_COLLECTION_PERCENTILE=10,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,le.DEFAULT=new le(Um,le.DEFAULT_COLLECTION_PERCENTILE,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),le.DISABLED=new le(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Qr(0)}static ur(){return new Qr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="LruGarbageCollector",kE=1048576;function Pf([e,t],[n,r]){const i=tt(e,n);return i===0?tt(t,r):i}class OE{constructor(t){this.Tr=t,this.buffer=new Ot(Pf),this.Ir=0}dr(){return++this.Ir}Er(t){const n=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Pf(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ME{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){j(Cf,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ai(n)?j(Cf,"Ignoring IndexedDB error during garbage collection: ",n):await oi(n)}await this.Rr(3e5)})}}class LE{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.mr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return L.resolve(aa.ue);const r=new OE(n);return this.Vr.forEachTarget(t,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(t,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.Vr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(bf)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bf):this.pr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,n){let r,i,s,o,u,c,l;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(r=d,u=Date.now(),this.removeTargets(t,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(t,r))).next(d=>(l=Date.now(),Or()<=it.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function FE(e,t){return new LE(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this.changes=new Ar(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Yt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&Gi(r.mutation,i,Te.empty(),yt.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,et()).next(()=>r))}getLocalViewOfDocuments(t,n,r=et()){const i=ur();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let o=xi();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=ur();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,et()))}populateOverlays(t,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(t,n,r,i){let s=wn();const o=Hi(),u=function(){return Hi()}();return n.forEach((c,l)=>{const h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof Xn)?s=s.insert(l.key,l):h!==void 0?(o.set(l.key,h.mutation.getFieldMask()),Gi(h.mutation,l,h.mutation.getFieldMask(),yt.now())):o.set(l.key,Te.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((l,h)=>o.set(l,h)),n.forEach((l,h)=>{var d;return u.set(l,new BE(h,(d=o.get(l))!==null&&d!==void 0?d:null))}),u))}recalculateAndSaveOverlays(t,n){const r=Hi();let i=new wt((o,u)=>o-u),s=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let h=r.get(c)||Te.empty();h=u.applyToLocalView(l,h),r.set(c,h);const d=(i.get(u.batchId)||et()).add(c);i=i.insert(u.batchId,d)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),l=c.key,h=c.value,d=wm();h.forEach(p=>{if(!s.has(p)){const g=Sm(n.get(p),r.get(p));g!==null&&d.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,d))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):mm(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):L.resolve(ur());let u=Yi,c=s;return o.next(l=>L.forEach(l,(h,d)=>(u<d.largestBatchId&&(u=d.largestBatchId),s.get(h)?L.resolve():this.remoteDocumentCache.getEntry(t,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(t,l,s)).next(()=>this.computeViews(t,c,l,et())).next(h=>({batchId:u,changes:vm(h)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new G(n)).next(r=>{let i=xi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const s=n.collectionGroup;let o=xi();return this.indexManager.getCollectionParents(t,s).next(u=>L.forEach(u,c=>{const l=function(d,p){return new ui(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,r,i).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(o=>{s.forEach((c,l)=>{const h=l.getKey();o.get(h)===null&&(o=o.insert(h,Yt.newInvalidDocument(h)))});let u=xi();return o.forEach((c,l)=>{const h=s.get(c);h!==void 0&&Gi(h.mutation,l,Te.empty(),yt.now()),ha(n,l)&&(u=u.insert(c,l))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,n){return L.resolve(this.Br.get(n))}saveBundleMetadata(t,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ye(i.createTime)}}(n)),L.resolve()}getNamedQuery(t,n){return L.resolve(this.Lr.get(n))}saveNamedQuery(t,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:VE(i.bundledQuery),readTime:Ye(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.overlays=new wt(G.comparator),this.kr=new Map}getOverlay(t,n){return L.resolve(this.overlays.get(n))}getOverlays(t,n){const r=ur();return L.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.wt(t,n,s)}),L.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),L.resolve()}getOverlaysForCollection(t,n,r){const i=ur(),s=n.length+1,o=new G(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new wt((l,h)=>l-h);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let h=s.get(l.largestBatchId);h===null&&(h=ur(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const u=ur(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>u.set(l,h)),!(u.size()>=i)););return L.resolve(u)}wt(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new uE(n,r));let s=this.kr.get(n);s===void 0&&(s=et(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.sessionToken=Ht.EMPTY_BYTE_STRING}getSessionToken(t){return L.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(){this.qr=new Ot(Ut.Qr),this.$r=new Ot(Ut.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,n){const r=new Ut(t,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Wr(new Ut(t,n))}Gr(t,n){t.forEach(r=>this.removeReference(r,n))}zr(t){const n=new G(new gt([])),r=new Ut(n,t),i=new Ut(n,t+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const n=new G(new gt([])),r=new Ut(n,t),i=new Ut(n,t+1);let s=et();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new Ut(t,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class Ut{constructor(t,n){this.key=t,this.Hr=n}static Qr(t,n){return G.comparator(t.key,n.key)||tt(t.Hr,n.Hr)}static Ur(t,n){return tt(t.Hr,n.Hr)||G.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Ot(Ut.Qr)}checkEmpty(t){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new aE(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.Yr=this.Yr.add(new Ut(u.key,s)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return L.resolve(o)}lookupMutationBatch(t,n){return L.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?Fl:this.er-1)}getAllMutationBatches(t){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new Ut(n,0),i=new Ut(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const u=this.Zr(o.Hr);s.push(u)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Ot(tt);return n.forEach(i=>{const s=new Ut(i,0),o=new Ut(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],u=>{r=r.add(u.Hr)})}),L.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new Ut(new G(s),0);let u=new Ot(tt);return this.Yr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(u=u.add(c.Hr)),!0)},o),L.resolve(this.ei(u))}ei(t){const n=[];return t.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){ct(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return L.forEach(n.mutations,i=>{const s=new Ut(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Yr=r})}rr(t){}containsKey(t,n){const r=new Ut(n,0),i=this.Yr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,L.resolve()}ti(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(t){this.ni=t,this.docs=function(){return new wt(G.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():Yt.newInvalidDocument(n))}getEntries(t,n){let r=wn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Yt.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=wn();const o=n.path,u=new G(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:l,value:{document:h}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Tw(Ew(h),r)<=0||(i.has(h.key)||ha(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(t,n,r,i){W(9500)}ri(t,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new WE(this)}getSize(t){return L.resolve(this.size)}}class WE extends UE{constructor(t){super(),this.Or=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(t,i)):this.Or.removeEntry(r)}),L.waitFor(n)}getFromCache(t,n){return this.Or.getEntry(t,n)}getAllFromCache(t,n){return this.Or.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(t){this.persistence=t,this.ii=new Ar(n=>$l(n),ql),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.si=0,this.oi=new Kl,this.targetCount=0,this._i=Qr.ar()}forEachTarget(t,n){return this.ii.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(t){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return L.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),L.resolve()}hr(t){this.ii.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this._i=new Qr(n),this.highestTargetId=n),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,n){return this.hr(n),this.targetCount+=1,L.resolve()}updateTargetData(t,n){return this.hr(n),L.resolve()}removeTargetData(t,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(t,n,r){let i=0;const s=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(t){return L.resolve(this.targetCount)}getTargetData(t,n){const r=this.ii.get(n)||null;return L.resolve(r)}addMatchingKeys(t,n,r){return this.oi.Kr(n,r),L.resolve()}removeMatchingKeys(t,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.oi.zr(n),L.resolve()}getMatchingKeysForTargetId(t,n){const r=this.oi.Jr(n);return L.resolve(r)}containsKey(t,n){return L.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(t,n){this.ai={},this.overlays={},this.ui=new aa(0),this.ci=!1,this.ci=!0,this.li=new jE,this.referenceDelegate=t(this),this.hi=new KE(this),this.indexManager=new NE,this.remoteDocumentCache=function(i){return new GE(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new xE(n),this.Ti=new qE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new zE,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ai[t.toKey()];return r||(r=new HE(n,this.referenceDelegate),this.ai[t.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,n,r){j("MemoryPersistence","Starting transaction:",t);const i=new QE(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(t,n){return L.or(Object.values(this.ai).map(r=>()=>r.containsKey(t,n)))}}class QE extends Iw{constructor(t){super(),this.currentSequenceNumber=t}}class Ql{constructor(t){this.persistence=t,this.Ai=new Kl,this.Ri=null}static Vi(t){return new Ql(t)}get mi(){if(this.Ri)return this.Ri;throw W(60996)}addReference(t,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),L.resolve()}removeReference(t,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(t,n){return this.mi.add(n.toString()),L.resolve()}removeTarget(t,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ii(){this.Ri=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.mi,r=>{const i=G.fromPath(r);return this.fi(t,i).next(s=>{s||n.removeEntry(i,K.min())})}).next(()=>(this.Ri=null,n.apply(t)))}updateLimboDocument(t,n){return this.fi(t,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(t){return 0}fi(t,n){return L.or([()=>L.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class Mo{constructor(t,n){this.persistence=t,this.gi=new Ar(r=>bw(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=FE(this,n)}static Vi(t,n){return new Mo(t,n)}Ii(){}di(t){return L.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}mr(t){const n=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}yr(t){let n=0;return this.gr(t,r=>{n++}).next(()=>n)}gr(t,n){return L.forEach(this.gi,(r,i)=>this.Sr(t,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(t,o=>this.Sr(t,o,n).next(u=>{u||(r++,s.removeEntry(o,K.min()))})).next(()=>s.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}removeReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}updateLimboDocument(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}Pi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=ro(t.data.value)),n}Sr(t,n,r){return L.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.gi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.Is=r,this.ds=i}static Es(t,n){let r=et(),i=et();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Xl(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return zv()?8:Rw($v())>0?6:4}()}initialize(t,n){this.gs=t,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(t,n,r,i){const s={result:null};return this.ps(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(t,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new XE;return this.ws(t,n,o).next(u=>{if(s.result=u,this.Rs)return this.Ss(t,n,o,u.size)})}).next(()=>s.result)}Ss(t,n,r,i){return r.documentReadCount<this.Vs?(Or()<=it.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",Mr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),L.resolve()):(Or()<=it.DEBUG&&j("QueryEngine","Query:",Mr(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Or()<=it.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",Mr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Qe(n))):L.resolve())}ps(t,n){if(_f(n))return L.resolve(null);let r=Qe(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=No(n,null,"F"),r=Qe(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const o=et(...s);return this.gs.getDocuments(t,o).next(u=>this.indexManager.getMinOffset(t,r).next(c=>{const l=this.bs(n,u);return this.Ds(n,l,o,c.readTime)?this.ps(t,No(n,null,"F")):this.vs(t,l,n,c)}))})))}ys(t,n,r,i){return _f(n)||i.isEqual(K.min())?L.resolve(null):this.gs.getDocuments(t,r).next(s=>{const o=this.bs(n,s);return this.Ds(n,o,r,i)?L.resolve(null):(Or()<=it.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mr(n)),this.vs(t,o,n,ww(i,Yi)).next(u=>u))})}bs(t,n){let r=new Ot(_m(t));return n.forEach((i,s)=>{ha(t,s)&&(r=r.add(s))}),r}Ds(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(t,n,r){return Or()<=it.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Mr(n)),this.gs.getDocumentsMatchingQuery(t,n,zn.min(),r)}vs(t,n,r,i){return this.gs.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl="LocalStore",JE=3e8;class ZE{constructor(t,n,r,i){this.persistence=t,this.Cs=n,this.serializer=i,this.Fs=new wt(tt),this.Ms=new Ar(s=>$l(s),ql),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(r)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new $E(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Fs))}}function tT(e,t,n,r){return new ZE(e,t,n,r)}async function $m(e,t){const n=Q(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=et();for(const l of i){o.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}for(const l of s){u.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Bs:l,removedBatchIds:o,addedBatchIds:u}))})})}function eT(e,t){const n=Q(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,c,l,h){const d=l.batch,p=d.keys();let g=L.resolve();return p.forEach(_=>{g=g.next(()=>h.getEntry(c,_)).next(E=>{const v=l.docVersions.get(_);ct(v!==null,48541),E.version.compareTo(v)<0&&(d.applyToRemoteDocument(E,l),E.isValidDocument()&&(E.setReadTime(l.commitVersion),h.addEntry(E)))})}),g.next(()=>u.mutationQueue.removeMutationBatch(c,d))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=et();for(let l=0;l<u.mutationResults.length;++l)u.mutationResults[l].transformResults.length>0&&(c=c.add(u.batch.mutations[l].key));return c}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function qm(e){const t=Q(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.hi.getLastRemoteSnapshotVersion(n))}function nT(e,t){const n=Q(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const u=[];t.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;u.push(n.hi.removeMatchingKeys(s,h.removedDocuments,d).next(()=>n.hi.addMatchingKeys(s,h.addedDocuments,d)));let g=p.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?g=g.withResumeToken(Ht.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(d,g),function(E,v,P){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=JE?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(p,g,h)&&u.push(n.hi.updateTargetData(s,g))});let c=wn(),l=et();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),u.push(rT(s,o,t.documentUpdates).next(h=>{c=h.Ls,l=h.ks})),!r.isEqual(K.min())){const h=n.hi.getLastRemoteSnapshotVersion(s).next(d=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(h)}return L.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.Fs=i,s))}function rT(e,t,n){let r=et(),i=et();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let o=wn();return n.forEach((u,c)=>{const l=s.get(u);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(K.min())?(t.removeEntry(u,c.readTime),o=o.insert(u,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(u,c)):j(Yl,"Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function iT(e,t){const n=Q(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=Fl),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function sT(e,t){const n=Q(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,t).next(s=>s?(i=s,L.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new On(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(t,r.targetId)),r})}async function Fu(e,t,n){const r=Q(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ai(o))throw o;j(Yl,`Failed to update sequence numbers for target ${t}: ${o}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function xf(e,t,n){const r=Q(e);let i=K.min(),s=et();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,h){const d=Q(c),p=d.Ms.get(h);return p!==void 0?L.resolve(d.Fs.get(p)):d.hi.getTargetData(l,h)}(r,o,Qe(t)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,t,n?i:K.min(),n?s:et())).next(u=>(oT(r,Gw(t),u),{documents:u,qs:s})))}function oT(e,t,n){let r=e.xs.get(t)||K.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.xs.set(t,r)}class Vf{constructor(){this.activeTargetIds=Jw()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class aT{constructor(){this.Fo=new Vf,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,n,r){this.Mo[t]=n}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new Vf,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="ConnectivityMonitor";class Df{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){j(Nf,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){j(Nf,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ws=null;function Uu(){return Ws===null?Ws=function(){return 268435456+Math.round(2147483648*Math.random())}():Ws++,"0x"+Ws.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su="RestConnection",lT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cT{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Po?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,n,r,i,s){const o=Uu(),u=this.Go(t,n.toUriEncodedString());j(su,`Sending RPC '${t}' ${o}:`,u,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);const{host:l}=new URL(u),h=kl(l);return this.jo(t,u,c,r,h).then(d=>(j(su,`Received RPC '${t}' ${o}: `,d),d),d=>{throw qn(su,`RPC '${t}' ${o} failed with error: `,d,"url: ",u,"request:",r),d})}Jo(t,n,r,i,s,o){return this.Wo(t,n,r,i,s)}zo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+si}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}Go(t,n){const r=lT[t];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="WebChannelConnection";class fT extends cT{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,n,r,i,s){const o=Uu();return new Promise((u,c)=>{const l=new zp;l.setWithCredentials(!0),l.listenOnce(jp.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case no.NO_ERROR:const d=l.getResponseJson();j(Qt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),u(d);break;case no.TIMEOUT:j(Qt,`RPC '${t}' ${o} timed out`),c(new q(O.DEADLINE_EXCEEDED,"Request time out"));break;case no.HTTP_ERROR:const p=l.getStatus();if(j(Qt,`RPC '${t}' ${o} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const E=function(P){const b=P.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(b)>=0?b:O.UNKNOWN}(_.status);c(new q(E,_.message))}else c(new q(O.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new q(O.UNAVAILABLE,"Connection failed."));break;default:W(9055,{c_:t,streamId:o,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{j(Qt,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);j(Qt,`RPC '${t}' ${o} sending request:`,i),l.send(n,"POST",h,r,15)})}P_(t,n,r){const i=Uu(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Wp(),u=Gp(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=s.join("");j(Qt,`Creating RPC '${t}' stream ${i}: ${h}`,c);const d=o.createWebChannel(h,c);this.T_(d);let p=!1,g=!1;const _=new hT({Ho:v=>{g?j(Qt,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(p||(j(Qt,`Opening RPC '${t}' stream ${i} transport.`),d.open(),p=!0),j(Qt,`RPC '${t}' stream ${i} sending:`,v),d.send(v))},Yo:()=>d.close()}),E=(v,P,b)=>{v.listen(P,N=>{try{b(N)}catch(x){setTimeout(()=>{throw x},0)}})};return E(d,Pi.EventType.OPEN,()=>{g||(j(Qt,`RPC '${t}' stream ${i} transport opened.`),_.s_())}),E(d,Pi.EventType.CLOSE,()=>{g||(g=!0,j(Qt,`RPC '${t}' stream ${i} transport closed`),_.__(),this.I_(d))}),E(d,Pi.EventType.ERROR,v=>{g||(g=!0,qn(Qt,`RPC '${t}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),_.__(new q(O.UNAVAILABLE,"The operation could not be completed")))}),E(d,Pi.EventType.MESSAGE,v=>{var P;if(!g){const b=v.data[0];ct(!!b,16349);const N=b,x=(N==null?void 0:N.error)||((P=N[0])===null||P===void 0?void 0:P.error);if(x){j(Qt,`RPC '${t}' stream ${i} received error:`,x);const M=x.status;let U=function(T){const S=xt[T];if(S!==void 0)return Pm(S)}(M),I=x.message;U===void 0&&(U=O.INTERNAL,I="Unknown error status: "+M+" with message "+x.message),g=!0,_.__(new q(U,I)),d.close()}else j(Qt,`RPC '${t}' stream ${i} received:`,b),_.a_(b)}}),E(u,Hp.STAT_EVENT,v=>{v.stat===bu.PROXY?j(Qt,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===bu.NOPROXY&&j(Qt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.o_()},0),_}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(n=>n===t)}}function ou(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(e){return new gE(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(t,n,r=1e3,i=1.5,s=6e4){this.Fi=t,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&j("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf="PersistentStream";class jm{constructor(t,n,r,i,s,o,u,c){this.Fi=t,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new zm(t,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():n&&n.code===O.RESOURCE_EXHAUSTED?(yn(n.toString()),yn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(n)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{t(()=>{const i=new q(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(t,n){const r=this.K_(this.b_);this.stream=this.z_(t,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return j(kf,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return n=>{this.Fi.enqueueAndForget(()=>this.b_===t?n():(j(kf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dT extends jm{constructor(t,n,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(t,n){return this.connection.P_("Listen",t,n)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const n=vE(this.serializer,t),r=function(s){if(!("targetChange"in s))return K.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?K.min():o.readTime?Ye(o.readTime):K.min()}(t);return this.listener.J_(n,r)}H_(t){const n={};n.database=Lu(this.serializer),n.addTarget=function(s,o){let u;const c=o.target;if(u=Nu(c)?{documents:TE(s,c)}:{query:AE(s,c).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=Nm(s,o.resumeToken);const l=ku(s,o.expectedCount);l!==null&&(u.expectedCount=l)}else if(o.snapshotVersion.compareTo(K.min())>0){u.readTime=Oo(s,o.snapshotVersion.toTimestamp());const l=ku(s,o.expectedCount);l!==null&&(u.expectedCount=l)}return u}(this.serializer,t);const r=RE(this.serializer,t);r&&(n.labels=r),this.k_(n)}Y_(t){const n={};n.database=Lu(this.serializer),n.removeTarget=t,this.k_(n)}}class pT extends jm{constructor(t,n,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,n){return this.connection.P_("Write",t,n)}j_(t){return ct(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ct(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){ct(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const n=EE(t.writeResults,t.commitTime),r=Ye(t.commitTime);return this.listener.ta(r,n)}na(){const t={};t.database=Lu(this.serializer),this.k_(t)}X_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>wE(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{}class gT extends mT{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,Ou(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(O.UNKNOWN,s.toString())})}Jo(t,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(t,Ou(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(O.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class _T{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(yn(n),this._a=!1):j("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r="RemoteStore";class yT{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Ir(this)&&(j(_r,"Restarting streams for network reachability change."),await async function(c){const l=Q(c);l.Ia.add(4),await _s(l),l.Aa.set("Unknown"),l.Ia.delete(4),await ga(l)}(this))})}),this.Aa=new _T(r,i)}}async function ga(e){if(Ir(e))for(const t of e.da)await t(!0)}async function _s(e){for(const t of e.da)await t(!1)}function Hm(e,t){const n=Q(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),ec(n)?tc(n):li(n).x_()&&Zl(n,t))}function Jl(e,t){const n=Q(e),r=li(n);n.Ta.delete(t),r.x_()&&Gm(n,t),n.Ta.size===0&&(r.x_()?r.B_():Ir(n)&&n.Aa.set("Unknown"))}function Zl(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(K.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}li(e).H_(t)}function Gm(e,t){e.Ra.$e(t),li(e).Y_(t)}function tc(e){e.Ra=new fE({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),li(e).start(),e.Aa.aa()}function ec(e){return Ir(e)&&!li(e).M_()&&e.Ta.size>0}function Ir(e){return Q(e).Ia.size===0}function Wm(e){e.Ra=void 0}async function vT(e){e.Aa.set("Online")}async function wT(e){e.Ta.forEach((t,n)=>{Zl(e,t)})}async function ET(e,t){Wm(e),ec(e)?(e.Aa.la(t),tc(e)):e.Aa.set("Unknown")}async function TT(e,t,n){if(e.Aa.set("Online"),t instanceof Vm&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.Ta.delete(u),i.Ra.removeTarget(u))}(e,t)}catch(r){j(_r,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Lo(e,r)}else if(t instanceof oo?e.Ra.Ye(t):t instanceof xm?e.Ra.it(t):e.Ra.et(t),!n.isEqual(K.min()))try{const r=await qm(e.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Ra.Pt(o);return u.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.Ta.get(l);h&&s.Ta.set(l,h.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,l)=>{const h=s.Ta.get(c);if(!h)return;s.Ta.set(c,h.withResumeToken(Ht.EMPTY_BYTE_STRING,h.snapshotVersion)),Gm(s,c);const d=new On(h.target,c,l,h.sequenceNumber);Zl(s,d)}),s.remoteSyncer.applyRemoteEvent(u)}(e,n)}catch(r){j(_r,"Failed to raise snapshot:",r),await Lo(e,r)}}async function Lo(e,t,n){if(!ai(t))throw t;e.Ia.add(1),await _s(e),e.Aa.set("Offline"),n||(n=()=>qm(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{j(_r,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await ga(e)})}function Km(e,t){return t().catch(n=>Lo(e,n,t))}async function _a(e){const t=Q(e),n=Wn(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Fl;for(;AT(t);)try{const i=await iT(t.localStore,r);if(i===null){t.Pa.length===0&&n.B_();break}r=i.batchId,IT(t,i)}catch(i){await Lo(t,i)}Qm(t)&&Xm(t)}function AT(e){return Ir(e)&&e.Pa.length<10}function IT(e,t){e.Pa.push(t);const n=Wn(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function Qm(e){return Ir(e)&&!Wn(e).M_()&&e.Pa.length>0}function Xm(e){Wn(e).start()}async function RT(e){Wn(e).na()}async function ST(e){const t=Wn(e);for(const n of e.Pa)t.X_(n.mutations)}async function bT(e,t,n){const r=e.Pa.shift(),i=Hl.from(r,t,n);await Km(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await _a(e)}async function CT(e,t){t&&Wn(e).Z_&&await async function(r,i){if(function(o){return cE(o)&&o!==O.ABORTED}(i.code)){const s=r.Pa.shift();Wn(r).N_(),await Km(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await _a(r)}}(e,t),Qm(e)&&Xm(e)}async function Of(e,t){const n=Q(e);n.asyncQueue.verifyOperationInProgress(),j(_r,"RemoteStore received new credentials");const r=Ir(n);n.Ia.add(3),await _s(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await ga(n)}async function PT(e,t){const n=Q(e);t?(n.Ia.delete(2),await ga(n)):t||(n.Ia.add(2),await _s(n),n.Aa.set("Unknown"))}function li(e){return e.Va||(e.Va=function(n,r,i){const s=Q(n);return s.ia(),new dT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:vT.bind(null,e),e_:wT.bind(null,e),n_:ET.bind(null,e),J_:TT.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),ec(e)?tc(e):e.Aa.set("Unknown")):(await e.Va.stop(),Wm(e))})),e.Va}function Wn(e){return e.ma||(e.ma=function(n,r,i){const s=Q(n);return s.ia(),new pT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:RT.bind(null,e),n_:CT.bind(null,e),ea:ST.bind(null,e),ta:bT.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await _a(e)):(await e.ma.stop(),e.Pa.length>0&&(j(_r,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new pn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){const o=Date.now()+r,u=new nc(t,n,o,i,s);return u.start(r),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(O.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rc(e,t){if(yn("AsyncQueue",`${t}: ${e}`),ai(e))return new q(O.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{static emptySet(t){return new zr(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=xi(),this.sortedSet=new wt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof zr)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new zr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(){this.fa=new wt(G.comparator)}track(t){const n=t.doc.key,r=this.fa.get(n);r?t.type!==0&&r.type===3?this.fa=this.fa.insert(n,t):t.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.fa=this.fa.remove(n):t.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):W(63341,{At:t,ga:r}):this.fa=this.fa.insert(n,t)}pa(){const t=[];return this.fa.inorderTraversal((n,r)=>{t.push(r)}),t}}class Xr{constructor(t,n,r,i,s,o,u,c,l){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new Xr(t,n,zr.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ca(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class VT{constructor(){this.queries=Lf(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=Q(n),s=i.queries;i.queries=Lf(),s.forEach((o,u)=>{for(const c of u.wa)c.onError(r)})})(this,new q(O.ABORTED,"Firestore shutting down"))}}function Lf(){return new Ar(e=>gm(e),ca)}async function Ym(e,t){const n=Q(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new xT,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=rc(o,`Initialization of query '${Mr(t.query)}' failed`);return void t.onError(u)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&ic(n)}async function Jm(e,t){const n=Q(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const o=s.wa.indexOf(t);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function NT(e,t){const n=Q(e);let r=!1;for(const i of t){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.wa)u.Ca(i)&&(r=!0);o.ya=i}}r&&ic(n)}function DT(e,t,n){const r=Q(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function ic(e){e.Da.forEach(t=>{t.next()})}var Bu,Ff;(Ff=Bu||(Bu={})).Fa="default",Ff.Cache="cache";class Zm{constructor(t,n,r){this.query=t,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new Xr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),n=!0):this.Ba(t,this.onlineState)&&(this.La(t),n=!0),this.Oa=t,n}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),n=!0),n}Ba(t,n){if(!t.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(t){t=Xr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==Bu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(t){this.key=t}}class eg{constructor(t){this.key=t}}class kT{constructor(t,n){this.query=t,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=et(),this.mutatedKeys=et(),this.Xa=_m(t),this.eu=new zr(this.Xa)}get tu(){return this.Ha}nu(t,n){const r=n?n.ru:new Mf,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const p=i.get(h),g=ha(this.query,d)?d:null,_=!!p&&this.mutatedKeys.has(p.key),E=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;p&&g?p.data.isEqual(g.data)?_!==E&&(r.track({type:3,doc:g}),v=!0):this.iu(p,g)||(r.track({type:2,doc:g}),v=!0,(c&&this.Xa(g,c)>0||l&&this.Xa(g,l)<0)&&(u=!0)):!p&&g?(r.track({type:0,doc:g}),v=!0):p&&!g&&(r.track({type:1,doc:p}),v=!0,(c||l)&&(u=!0)),v&&(g?(o=o.add(g),s=E?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:u,mutatedKeys:s}}iu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const o=t.ru.pa();o.sort((h,d)=>function(g,_){const E=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W(20277,{At:v})}};return E(g)-E(_)}(h.type,d.type)||this.Xa(h.doc,d.doc)),this.su(r),i=i!=null&&i;const u=n&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,l=c!==this.Ya;return this.Ya=c,o.length!==0||l?{snapshot:new Xr(this.query,t.eu,s,o,t.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Mf,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=et(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return t.forEach(r=>{this.Za.has(r)||n.push(new eg(r))}),this.Za.forEach(r=>{t.has(r)||n.push(new tg(r))}),n}uu(t){this.Ha=t.qs,this.Za=et();const n=this.nu(t.documents);return this.applyChanges(n,!0)}cu(){return Xr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const sc="SyncEngine";class OT{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class MT{constructor(t){this.key=t,this.lu=!1}}class LT{constructor(t,n,r,i,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Ar(u=>gm(u),ca),this.Tu=new Map,this.Iu=new Set,this.du=new wt(G.comparator),this.Eu=new Map,this.Au=new Kl,this.Ru={},this.Vu=new Map,this.mu=Qr.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function FT(e,t,n=!0){const r=ag(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await ng(r,t,n,!0),i}async function UT(e,t){const n=ag(e);await ng(n,t,!0,!1)}async function ng(e,t,n,r){const i=await sT(e.localStore,Qe(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await BT(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&n&&Hm(e.remoteStore,i),u}async function BT(e,t,n,r,i){e.gu=(d,p,g)=>async function(E,v,P,b){let N=v.view.nu(P);N.Ds&&(N=await xf(E.localStore,v.query,!1).then(({documents:I})=>v.view.nu(I,N)));const x=b&&b.targetChanges.get(v.targetId),M=b&&b.targetMismatches.get(v.targetId)!=null,U=v.view.applyChanges(N,E.isPrimaryClient,x,M);return Bf(E,v.targetId,U._u),U.snapshot}(e,d,p,g);const s=await xf(e.localStore,t,!0),o=new kT(t,s.qs),u=o.nu(s.documents),c=gs.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),l=o.applyChanges(u,e.isPrimaryClient,c);Bf(e,n,l._u);const h=new OT(t,n,o);return e.Pu.set(t,h),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),l.snapshot}async function $T(e,t,n){const r=Q(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!ca(o,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Fu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Jl(r.remoteStore,i.targetId),$u(r,i.targetId)}).catch(oi)):($u(r,i.targetId),await Fu(r.localStore,i.targetId,!0))}async function qT(e,t){const n=Q(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Jl(n.remoteStore,r.targetId))}async function zT(e,t,n){const r=XT(e);try{const i=await function(o,u){const c=Q(o),l=yt.now(),h=u.reduce((g,_)=>g.add(_.key),et());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=wn(),E=et();return c.Os.getEntries(g,h).next(v=>{_=v,_.forEach((P,b)=>{b.isValidDocument()||(E=E.add(P))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,_)).next(v=>{d=v;const P=[];for(const b of u){const N=sE(b,d.get(b.key).overlayedDocument);N!=null&&P.push(new Xn(b.key,N,um(N.value.mapValue),Xe.exists(!0)))}return c.mutationQueue.addMutationBatch(g,l,P,u)}).next(v=>{p=v;const P=v.applyToLocalDocumentSet(d,E);return c.documentOverlayCache.saveOverlays(g,v.batchId,P)})}).then(()=>({batchId:p.batchId,changes:vm(d)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let l=o.Ru[o.currentUser.toKey()];l||(l=new wt(tt)),l=l.insert(u,c),o.Ru[o.currentUser.toKey()]=l}(r,i.batchId,n),await ys(r,i.changes),await _a(r.remoteStore)}catch(i){const s=rc(i,"Failed to persist write");n.reject(s)}}async function rg(e,t){const n=Q(e);try{const r=await nT(n.localStore,t);t.targetChanges.forEach((i,s)=>{const o=n.Eu.get(s);o&&(ct(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?ct(o.lu,14607):i.removedDocuments.size>0&&(ct(o.lu,42227),o.lu=!1))}),await ys(n,r,t)}catch(r){await oi(r)}}function Uf(e,t,n){const r=Q(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,o)=>{const u=o.view.va(t);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=Q(o);c.onlineState=u;let l=!1;c.queries.forEach((h,d)=>{for(const p of d.wa)p.va(u)&&(l=!0)}),l&&ic(c)}(r.eventManager,t),i.length&&r.hu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function jT(e,t,n){const r=Q(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let o=new wt(G.comparator);o=o.insert(s,Yt.newNoDocument(s,K.min()));const u=et().add(s),c=new pa(K.min(),new Map,new wt(tt),o,u);await rg(r,c),r.du=r.du.remove(s),r.Eu.delete(t),oc(r)}else await Fu(r.localStore,t,!1).then(()=>$u(r,t,n)).catch(oi)}async function HT(e,t){const n=Q(e),r=t.batch.batchId;try{const i=await eT(n.localStore,t);sg(n,r,null),ig(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ys(n,i)}catch(i){await oi(i)}}async function GT(e,t,n){const r=Q(e);try{const i=await function(o,u){const c=Q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,u).next(d=>(ct(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,t);sg(r,t,n),ig(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await ys(r,i)}catch(i){await oi(i)}}function ig(e,t){(e.Vu.get(t)||[]).forEach(n=>{n.resolve()}),e.Vu.delete(t)}function sg(e,t,n){const r=Q(e);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function $u(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(r=>{e.Au.containsKey(r)||og(e,r)})}function og(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(Jl(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),oc(e))}function Bf(e,t,n){for(const r of n)r instanceof tg?(e.Au.addReference(r.key,t),WT(e,r)):r instanceof eg?(j(sc,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||og(e,r.key)):W(19791,{yu:r})}function WT(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(j(sc,"New document in limbo: "+n),e.Iu.add(r),oc(e))}function oc(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new G(gt.fromString(t)),r=e.mu.next();e.Eu.set(r,new MT(n)),e.du=e.du.insert(n,r),Hm(e.remoteStore,new On(Qe(zl(n.path)),r,"TargetPurposeLimboResolution",aa.ue))}}async function ys(e,t,n){const r=Q(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,c)=>{o.push(r.gu(c,t,n).then(l=>{var h;if((l||n)&&r.isPrimaryClient){const d=l?!l.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);const d=Xl.Es(c.targetId,l);s.push(d)}}))}),await Promise.all(o),r.hu.J_(i),await async function(c,l){const h=Q(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>L.forEach(l,p=>L.forEach(p.Is,g=>h.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>L.forEach(p.ds,g=>h.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!ai(d))throw d;j(Yl,"Failed to update sequence numbers: "+d)}for(const d of l){const p=d.targetId;if(!d.fromCache){const g=h.Fs.get(p),_=g.snapshotVersion,E=g.withLastLimboFreeSnapshotVersion(_);h.Fs=h.Fs.insert(p,E)}}}(r.localStore,s))}async function KT(e,t){const n=Q(e);if(!n.currentUser.isEqual(t)){j(sc,"User change. New user:",t.toKey());const r=await $m(n.localStore,t);n.currentUser=t,function(s,o){s.Vu.forEach(u=>{u.forEach(c=>{c.reject(new q(O.CANCELLED,o))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await ys(n,r.Bs)}}function QT(e,t){const n=Q(e),r=n.Eu.get(t);if(r&&r.lu)return et().add(r.key);{let i=et();const s=n.Tu.get(t);if(!s)return i;for(const o of s){const u=n.Pu.get(o);i=i.unionWith(u.view.tu)}return i}}function ag(e){const t=Q(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=rg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=QT.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=jT.bind(null,t),t.hu.J_=NT.bind(null,t.eventManager),t.hu.pu=DT.bind(null,t.eventManager),t}function XT(e){const t=Q(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=HT.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=GT.bind(null,t),t}class Fo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ma(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,n){return null}Fu(t,n){return null}vu(t){return tT(this.persistence,new YE,t.initialUser,this.serializer)}Du(t){return new Bm(Ql.Vi,this.serializer)}bu(t){return new aT}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fo.provider={build:()=>new Fo};class YT extends Fo{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,n){ct(this.persistence.referenceDelegate instanceof Mo,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ME(r,t.asyncQueue,n)}Du(t){const n=this.cacheSizeBytes!==void 0?le.withCacheSize(this.cacheSizeBytes):le.DEFAULT;return new Bm(r=>Mo.Vi(r,n),this.serializer)}}class qu{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Uf(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=KT.bind(null,this.syncEngine),await PT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new VT}()}createDatastore(t){const n=ma(t.databaseInfo.databaseId),r=function(s){return new fT(s)}(t.databaseInfo);return function(s,o,u,c){return new gT(s,o,u,c)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,o,u){return new yT(r,i,s,o,u)}(this.localStore,this.datastore,t.asyncQueue,n=>Uf(this.syncEngine,n,0),function(){return Df.C()?new Df:new uT}())}createSyncEngine(t,n){return function(i,s,o,u,c,l,h){const d=new LT(i,s,o,u,c,l);return h&&(d.fu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const s=Q(i);j(_r,"RemoteStore shutting down."),s.Ia.add(5),await _s(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}qu.provider={build:()=>new qu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):yn("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="FirestoreClient";class JT{constructor(t,n,r,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=Ll.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{j(Kn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(j(Kn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new pn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=rc(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function au(e,t){e.asyncQueue.verifyOperationInProgress(),j(Kn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await $m(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>{qn("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{j("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{qn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),e._offlineComponents=t}async function $f(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ZT(e);j(Kn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>Of(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>Of(t.remoteStore,i)),e._onlineComponents=t}async function ZT(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){j(Kn,"Using user provided OfflineComponentProvider");try{await au(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===O.FAILED_PRECONDITION||i.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;qn("Error using user provided cache. Falling back to memory cache: "+n),await au(e,new Fo)}}else j(Kn,"Using default OfflineComponentProvider"),await au(e,new YT(void 0));return e._offlineComponents}async function lg(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(j(Kn,"Using user provided OnlineComponentProvider"),await $f(e,e._uninitializedComponentsProvider._online)):(j(Kn,"Using default OnlineComponentProvider"),await $f(e,new qu))),e._onlineComponents}function t1(e){return lg(e).then(t=>t.syncEngine)}async function cg(e){const t=await lg(e),n=t.eventManager;return n.onListen=FT.bind(null,t.syncEngine),n.onUnlisten=$T.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=UT.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=qT.bind(null,t.syncEngine),n}function e1(e,t,n={}){const r=new pn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new ug({next:p=>{h.Ou(),o.enqueueAndForget(()=>Jm(s,d));const g=p.docs.has(u);!g&&p.fromCache?l.reject(new q(O.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new Zm(zl(u.path),h,{includeMetadataChanges:!0,ka:!0});return Ym(s,d)}(await cg(e),e.asyncQueue,t,n,r)),r.promise}function n1(e,t,n={}){const r=new pn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new ug({next:p=>{h.Ou(),o.enqueueAndForget(()=>Jm(s,d)),p.fromCache&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new Zm(u,h,{includeMetadataChanges:!0,ka:!0});return Ym(s,d)}(await cg(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg="firestore.googleapis.com",zf=!0;class jf{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new q(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fg,this.ssl=zf}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:zf;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Um;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<kE)throw new q(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}yw("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hg((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ya{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new q(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jf(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lw;switch(r.type){case"firstParty":return new dw(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=qf.get(n);r&&(j("ComponentProvider","Removing Datastore"),qf.delete(n),r.terminate())}(this),Promise.resolve()}}function r1(e,t,n,r={}){var i;e=vn(e,ya);const s=kl(t),o=e._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),c=`${t}:${n}`;s&&(Mv(`https://${c}`),Bv("Firestore",!0)),o.host!==fg&&o.host!==c&&qn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!Ro(l,u)&&(e._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Xt.MOCK_USER;else{h=Lv(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new q(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Xt(p)}e._authCredentials=new cw(new Qp(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Yn(this.firestore,t,this._query)}}class bt{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Un(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new bt(this.firestore,t,this._key)}toJSON(){return{type:bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(ps(n,bt._jsonSchema))return new bt(t,r||null,new G(gt.fromString(n.referencePath)))}}bt._jsonSchemaVersion="firestore/documentReference/1.0",bt._jsonSchema={type:Nt("string",bt._jsonSchemaVersion),referencePath:Nt("string")};class Un extends Yn{constructor(t,n,r){super(t,n,zl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new bt(this.firestore,null,new G(t))}withConverter(t){return new Un(this.firestore,t,this._path)}}function dg(e,t,...n){if(e=gn(e),Yp("collection","path",t),e instanceof ya){const r=gt.fromString(t,...n);return nf(r),new Un(e,null,r)}{if(!(e instanceof bt||e instanceof Un))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(gt.fromString(t,...n));return nf(r),new Un(e.firestore,null,r)}}function i1(e,t,...n){if(e=gn(e),arguments.length===1&&(t=Ll.newId()),Yp("doc","path",t),e instanceof ya){const r=gt.fromString(t,...n);return ef(r),new bt(e,null,new G(r))}{if(!(e instanceof bt||e instanceof Un))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(gt.fromString(t,...n));return ef(r),new bt(e.firestore,e instanceof Un?e.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="AsyncQueue";class Gf{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new zm(this,"async_queue_retry"),this.oc=()=>{const r=ou();r&&j(Hf,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=t;const n=ou();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const n=ou();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new pn;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!ai(t))throw t;j(Hf,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const n=this._c.then(()=>(this.nc=!0,t().catch(r=>{throw this.tc=r,this.nc=!1,yn("INTERNAL UNHANDLED ERROR: ",Wf(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(t,n,r){this.ac(),this.sc.indexOf(t)>-1&&(n=0);const i=nc.createAndSchedule(this,t,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&W(47125,{hc:Wf(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const n of this.ec)if(n.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const n=this.ec.indexOf(t);this.ec.splice(n,1)}}function Wf(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class vs extends ya{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new Gf,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Gf(t),this._firestoreClient=void 0,await t}}}function s1(e,t){const n=typeof e=="object"?e:X0(),r=typeof e=="string"?e:Po,i=H0(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=kv("firestore");s&&r1(i,...s)}return i}function ac(e){if(e._terminated)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||o1(e),e._firestoreClient}function o1(e){var t,n,r;const i=e._freezeSettings(),s=function(u,c,l,h){return new xw(u,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,hg(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new JT(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Re(Ht.fromBase64String(t))}catch(n){throw new q(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Re(Ht.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Re._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(ps(t,Re._jsonSchema))return Re.fromBase64String(t.bytes)}}Re._jsonSchemaVersion="firestore/bytes/1.0",Re._jsonSchema={type:Nt("string",Re._jsonSchemaVersion),bytes:Nt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new q(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new q(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new q(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return tt(this._lat,t._lat)||tt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Je._jsonSchemaVersion}}static fromJSON(t){if(ps(t,Je._jsonSchema))return new Je(t.latitude,t.longitude)}}Je._jsonSchemaVersion="firestore/geoPoint/1.0",Je._jsonSchema={type:Nt("string",Je._jsonSchemaVersion),latitude:Nt("number"),longitude:Nt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Ze._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(ps(t,Ze._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new Ze(t.vectorValues);throw new q(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ze._jsonSchemaVersion="firestore/vectorValue/1.0",Ze._jsonSchema={type:Nt("string",Ze._jsonSchemaVersion),vectorValues:Nt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=/^__.*__$/;class u1{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Xn(t,this.data,this.fieldMask,n,this.fieldTransforms):new ms(t,this.data,n,this.fieldTransforms)}}class pg{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Xn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function mg(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W(40011,{Ec:e})}}class lc{constructor(t,n,r,i,s,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new lc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.fc(t),i}gc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return Uo(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(mg(this.Ec)&&a1.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class l1{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||ma(t)}Dc(t,n,r,i=!1){return new lc({Ec:t,methodName:n,bc:r,path:jt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cc(e){const t=e._freezeSettings(),n=ma(e._databaseId);return new l1(e._databaseId,!!t.ignoreUndefinedProperties,n)}function c1(e,t,n,r,i,s={}){const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);hc("Data must be an object, but it was:",o,r);const u=gg(r,o);let c,l;if(s.merge)c=new Te(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=zu(t,d,n);if(!o.contains(p))throw new q(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);yg(h,p)||h.push(p)}c=new Te(h),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new u1(new ce(u),c,l)}class wa extends uc{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof wa}}function h1(e,t,n,r){const i=e.Dc(1,t,n);hc("Data must be an object, but it was:",i,r);const s=[],o=ce.empty();Qn(r,(c,l)=>{const h=fc(t,c,n);l=gn(l);const d=i.gc(h);if(l instanceof wa)s.push(h);else{const p=ws(l,d);p!=null&&(s.push(h),o.set(h,p))}});const u=new Te(s);return new pg(o,u,i.fieldTransforms)}function f1(e,t,n,r,i,s){const o=e.Dc(1,t,n),u=[zu(t,r,n)],c=[i];if(s.length%2!=0)throw new q(O.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)u.push(zu(t,s[p])),c.push(s[p+1]);const l=[],h=ce.empty();for(let p=u.length-1;p>=0;--p)if(!yg(l,u[p])){const g=u[p];let _=c[p];_=gn(_);const E=o.gc(g);if(_ instanceof wa)l.push(g);else{const v=ws(_,E);v!=null&&(l.push(g),h.set(g,v))}}const d=new Te(l);return new pg(h,d,o.fieldTransforms)}function d1(e,t,n,r=!1){return ws(n,e.Dc(r?4:3,t))}function ws(e,t){if(_g(e=gn(e)))return hc("Unsupported field value:",t,e),gg(e,t);if(e instanceof uc)return function(r,i){if(!mg(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=ws(u,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=gn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Zw(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=yt.fromDate(r);return{timestampValue:Oo(i.serializer,s)}}if(r instanceof yt){const s=new yt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Oo(i.serializer,s)}}if(r instanceof Je)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Re)return{bytesValue:Nm(i.serializer,r._byteString)};if(r instanceof bt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Wl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ze)return function(o,u){return{mapValue:{fields:{[om]:{stringValue:am},[xo]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw u.wc("VectorValues must only contain numeric values.");return jl(u.serializer,l)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${oa(r)}`)}(e,t)}function gg(e,t){const n={};return tm(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Qn(e,(r,i)=>{const s=ws(i,t.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function _g(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof yt||e instanceof Je||e instanceof Re||e instanceof bt||e instanceof uc||e instanceof Ze)}function hc(e,t,n){if(!_g(n)||!Jp(n)){const r=oa(n);throw r==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function zu(e,t,n){if((t=gn(t))instanceof va)return t._internalPath;if(typeof t=="string")return fc(e,t);throw Uo("Field path arguments must be of type string or ",e,!1,void 0,n)}const p1=new RegExp("[~\\*/\\[\\]]");function fc(e,t,n){if(t.search(p1)>=0)throw Uo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new va(...t.split("."))._internalPath}catch{throw Uo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Uo(e,t,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${t}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new q(O.INVALID_ARGUMENT,u+e+c)}function yg(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new m1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(dc("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class m1 extends vg{data(){return super.data()}}function dc(e,t){return typeof t=="string"?fc(e,t):t instanceof va?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g1(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new q(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pc{}class mc extends pc{}function _1(e,t,...n){let r=[];t instanceof pc&&r.push(t),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof _c).length,u=s.filter(c=>c instanceof gc).length;if(o>1||o>0&&u>0)throw new q(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class gc extends mc{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new gc(t,n,r)}_apply(t){const n=this._parse(t);return wg(t._query,n),new Yn(t.firestore,t.converter,Du(t._query,n))}_parse(t){const n=cc(t.firestore);return function(s,o,u,c,l,h,d){let p;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Qf(d,h);const _=[];for(const E of d)_.push(Kf(c,s,E));p={arrayValue:{values:_}}}else p=Kf(c,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Qf(d,h),p=d1(u,o,d,h==="in"||h==="not-in");return Vt.create(l,h,p)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class _c extends pc{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new _c(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ke.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)wg(o,c),o=Du(o,c)}(t._query,n),new Yn(t.firestore,t.converter,Du(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class yc extends mc{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new yc(t,n)}_apply(t){const n=function(i,s,o){if(i.startAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new es(s,o)}(t._query,this._field,this._direction);return new Yn(t.firestore,t.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ui(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function y1(e,t="asc"){const n=t,r=dc("orderBy",e);return yc._create(r,n)}class vc extends mc{constructor(t,n,r){super(),this.type=t,this._limit=n,this._limitType=r}static _create(t,n,r){return new vc(t,n,r)}_apply(t){return new Yn(t.firestore,t.converter,No(t._query,this._limit,this._limitType))}}function v1(e){return vw("limit",e),vc._create("limit",e,"F")}function Kf(e,t,n){if(typeof(n=gn(n))=="string"){if(n==="")throw new q(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mm(t)&&n.indexOf("/")!==-1)throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(gt.fromString(n));if(!G.isDocumentKey(r))throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hf(e,new G(r))}if(n instanceof bt)return hf(e,n._key);throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${oa(n)}.`)}function Qf(e,t){if(!Array.isArray(e)||e.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function wg(e,t){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class w1{convertValue(t,n="none"){switch(Gn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return It(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Hn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw W(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Qn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(t){var n,r,i;const s=(i=(r=(n=t.fields)===null||n===void 0?void 0:n[xo].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>It(o.doubleValue));return new Ze(s)}convertGeoPoint(t){return new Je(It(t.latitude),It(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=la(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ji(t));default:return null}}convertTimestamp(t){const n=jn(t);return new yt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=gt.fromString(t);ct(Fm(r),9688,{name:t});const i=new Zi(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||yn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class Ni{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class fr extends vg{constructor(t,n,r,i,s,o){super(t,n,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new ao(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(dc("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=fr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}fr._jsonSchemaVersion="firestore/documentSnapshot/1.0",fr._jsonSchema={type:Nt("string",fr._jsonSchemaVersion),bundleSource:Nt("string","DocumentSnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class ao extends fr{data(t={}){return super.data(t)}}class jr{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ni(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new ao(this._firestore,this._userDataWriter,r.key,r,new Ni(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new ao(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ni(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new ao(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ni(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return u.type!==0&&(l=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),h=o.indexOf(u.doc.key)),{type:T1(u.type),doc:c,oldIndex:l,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=jr._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Ll.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function T1(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(e){e=vn(e,bt);const t=vn(e.firestore,vs);return e1(ac(t),e._key).then(n=>S1(t,e,n))}jr._jsonSchemaVersion="firestore/querySnapshot/1.0",jr._jsonSchema={type:Nt("string",jr._jsonSchemaVersion),bundleSource:Nt("string","QuerySnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class Eg extends w1{constructor(t){super(),this.firestore=t}convertBytes(t){return new Re(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new bt(this.firestore,null,n)}}function Tg(e){e=vn(e,Yn);const t=vn(e.firestore,vs),n=ac(t),r=new Eg(t);return g1(e._query),n1(n,e._query).then(i=>new jr(t,r,e,i))}function I1(e,t,n){e=vn(e,bt);const r=vn(e.firestore,vs),i=E1(e.converter,t);return Ag(r,[c1(cc(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,Xe.none())])}function R1(e,t,n,...r){e=vn(e,bt);const i=vn(e.firestore,vs),s=cc(i);let o;return o=typeof(t=gn(t))=="string"||t instanceof va?f1(s,"updateDoc",e._key,t,n,r):h1(s,"updateDoc",e._key,t),Ag(i,[o.toMutation(e._key,Xe.exists(!0))])}function Ag(e,t){return function(r,i){const s=new pn;return r.asyncQueue.enqueueAndForget(async()=>zT(await t1(r),i,s)),s.promise}(ac(e),t)}function S1(e,t,n){const r=n.docs.get(t._key),i=new Eg(e);return new fr(e,i,t._key,r,new Ni(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){si=i})(Q0),bo(new Qi("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new vs(new hw(r.getProvider("auth-internal")),new pw(o,r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new q(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zi(l.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),qr(Xh,Yh,t),qr(Xh,Yh,"esm2017")})();const b1={apiKey:"AIzaSyAZsdXZU6WbM33SaKP5PoYm7G0V2ABYUSU",authDomain:"great-wave-everywhere.firebaseapp.com",projectId:"great-wave-everywhere",storageBucket:"great-wave-everywhere.firebasestorage.app",messagingSenderId:"636756607685",appId:"1:636756607685:web:2199075bc12821f89466ac",measurementId:"G-XRVYGKFWJ8"},C1=Up(b1),wc=s1(C1);async function P1(e){const t=i1(wc,"words",e.toLowerCase()),n=await A1(t);n.exists()?await R1(t,{count:n.data().count+1}):await I1(t,{count:1})}async function Xf(){return(await Tg(dg(wc,"words"))).docs.map(t=>({id:t.id,count:t.data().count}))}async function Yf(e=5){const t=_1(dg(wc,"words"),y1("count","desc"),v1(e));return(await Tg(t)).docs.map(r=>({id:r.id,count:r.data().count}))}function Ig(e,t){return function(){return e.apply(t,arguments)}}const{toString:x1}=Object.prototype,{getPrototypeOf:Ec}=Object,{iterator:Ea,toStringTag:Rg}=Symbol,Ta=(e=>t=>{const n=x1.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Me=e=>(e=e.toLowerCase(),t=>Ta(t)===e),Aa=e=>t=>typeof t===e,{isArray:ci}=Array,is=Aa("undefined");function V1(e){return e!==null&&!is(e)&&e.constructor!==null&&!is(e.constructor)&&de(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Sg=Me("ArrayBuffer");function N1(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Sg(e.buffer),t}const D1=Aa("string"),de=Aa("function"),bg=Aa("number"),Ia=e=>e!==null&&typeof e=="object",k1=e=>e===!0||e===!1,uo=e=>{if(Ta(e)!=="object")return!1;const t=Ec(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Rg in e)&&!(Ea in e)},O1=Me("Date"),M1=Me("File"),L1=Me("Blob"),F1=Me("FileList"),U1=e=>Ia(e)&&de(e.pipe),B1=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||de(e.append)&&((t=Ta(e))==="formdata"||t==="object"&&de(e.toString)&&e.toString()==="[object FormData]"))},$1=Me("URLSearchParams"),[q1,z1,j1,H1]=["ReadableStream","Request","Response","Headers"].map(Me),G1=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Es(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),ci(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],t.call(null,e[u],u,e)}}function Cg(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const lr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Pg=e=>!is(e)&&e!==lr;function ju(){const{caseless:e}=Pg(this)&&this||{},t={},n=(r,i)=>{const s=e&&Cg(t,i)||i;uo(t[s])&&uo(r)?t[s]=ju(t[s],r):uo(r)?t[s]=ju({},r):ci(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Es(arguments[r],n);return t}const W1=(e,t,n,{allOwnKeys:r}={})=>(Es(t,(i,s)=>{n&&de(i)?e[s]=Ig(i,n):e[s]=i},{allOwnKeys:r}),e),K1=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Q1=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},X1=(e,t,n,r)=>{let i,s,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&Ec(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Y1=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},J1=e=>{if(!e)return null;if(ci(e))return e;let t=e.length;if(!bg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Z1=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ec(Uint8Array)),tA=(e,t)=>{const r=(e&&e[Ea]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},eA=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},nA=Me("HTMLFormElement"),rA=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Jf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),iA=Me("RegExp"),xg=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Es(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},sA=e=>{xg(e,(t,n)=>{if(de(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(de(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},oA=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return ci(e)?r(e):r(String(e).split(t)),n},aA=()=>{},uA=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function lA(e){return!!(e&&de(e.append)&&e[Rg]==="FormData"&&e[Ea])}const cA=e=>{const t=new Array(10),n=(r,i)=>{if(Ia(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=ci(r)?[]:{};return Es(r,(o,u)=>{const c=n(o,i+1);!is(c)&&(s[u]=c)}),t[i]=void 0,s}}return r};return n(e,0)},hA=Me("AsyncFunction"),fA=e=>e&&(Ia(e)||de(e))&&de(e.then)&&de(e.catch),Vg=((e,t)=>e?setImmediate:t?((n,r)=>(lr.addEventListener("message",({source:i,data:s})=>{i===lr&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),lr.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",de(lr.postMessage)),dA=typeof queueMicrotask<"u"?queueMicrotask.bind(lr):typeof process<"u"&&process.nextTick||Vg,pA=e=>e!=null&&de(e[Ea]),D={isArray:ci,isArrayBuffer:Sg,isBuffer:V1,isFormData:B1,isArrayBufferView:N1,isString:D1,isNumber:bg,isBoolean:k1,isObject:Ia,isPlainObject:uo,isReadableStream:q1,isRequest:z1,isResponse:j1,isHeaders:H1,isUndefined:is,isDate:O1,isFile:M1,isBlob:L1,isRegExp:iA,isFunction:de,isStream:U1,isURLSearchParams:$1,isTypedArray:Z1,isFileList:F1,forEach:Es,merge:ju,extend:W1,trim:G1,stripBOM:K1,inherits:Q1,toFlatObject:X1,kindOf:Ta,kindOfTest:Me,endsWith:Y1,toArray:J1,forEachEntry:tA,matchAll:eA,isHTMLForm:nA,hasOwnProperty:Jf,hasOwnProp:Jf,reduceDescriptors:xg,freezeMethods:sA,toObjectSet:oA,toCamelCase:rA,noop:aA,toFiniteNumber:uA,findKey:Cg,global:lr,isContextDefined:Pg,isSpecCompliantForm:lA,toJSONObject:cA,isAsyncFn:hA,isThenable:fA,setImmediate:Vg,asap:dA,isIterable:pA};function Z(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}D.inherits(Z,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const Ng=Z.prototype,Dg={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Dg[e]={value:e}});Object.defineProperties(Z,Dg);Object.defineProperty(Ng,"isAxiosError",{value:!0});Z.from=(e,t,n,r,i,s)=>{const o=Object.create(Ng);return D.toFlatObject(e,o,function(c){return c!==Error.prototype},u=>u!=="isAxiosError"),Z.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const mA=null;function Hu(e){return D.isPlainObject(e)||D.isArray(e)}function kg(e){return D.endsWith(e,"[]")?e.slice(0,-2):e}function Zf(e,t,n){return e?e.concat(t).map(function(i,s){return i=kg(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function gA(e){return D.isArray(e)&&!e.some(Hu)}const _A=D.toFlatObject(D,{},null,function(t){return/^is[A-Z]/.test(t)});function Ra(e,t,n){if(!D.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=D.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,v){return!D.isUndefined(v[E])});const r=n.metaTokens,i=n.visitor||h,s=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(i))throw new TypeError("visitor must be a function");function l(_){if(_===null)return"";if(D.isDate(_))return _.toISOString();if(D.isBoolean(_))return _.toString();if(!c&&D.isBlob(_))throw new Z("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(_)||D.isTypedArray(_)?c&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,E,v){let P=_;if(_&&!v&&typeof _=="object"){if(D.endsWith(E,"{}"))E=r?E:E.slice(0,-2),_=JSON.stringify(_);else if(D.isArray(_)&&gA(_)||(D.isFileList(_)||D.endsWith(E,"[]"))&&(P=D.toArray(_)))return E=kg(E),P.forEach(function(N,x){!(D.isUndefined(N)||N===null)&&t.append(o===!0?Zf([E],x,s):o===null?E:E+"[]",l(N))}),!1}return Hu(_)?!0:(t.append(Zf(v,E,s),l(_)),!1)}const d=[],p=Object.assign(_A,{defaultVisitor:h,convertValue:l,isVisitable:Hu});function g(_,E){if(!D.isUndefined(_)){if(d.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));d.push(_),D.forEach(_,function(P,b){(!(D.isUndefined(P)||P===null)&&i.call(t,P,D.isString(b)?b.trim():b,E,p))===!0&&g(P,E?E.concat(b):[b])}),d.pop()}}if(!D.isObject(e))throw new TypeError("data must be an object");return g(e),t}function td(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Tc(e,t){this._pairs=[],e&&Ra(e,this,t)}const Og=Tc.prototype;Og.append=function(t,n){this._pairs.push([t,n])};Og.toString=function(t){const n=t?function(r){return t.call(this,r,td)}:td;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function yA(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Mg(e,t,n){if(!t)return e;const r=n&&n.encode||yA;D.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=D.isURLSearchParams(t)?t.toString():new Tc(t,n).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class ed{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){D.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Lg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vA=typeof URLSearchParams<"u"?URLSearchParams:Tc,wA=typeof FormData<"u"?FormData:null,EA=typeof Blob<"u"?Blob:null,TA={isBrowser:!0,classes:{URLSearchParams:vA,FormData:wA,Blob:EA},protocols:["http","https","file","blob","url","data"]},Ac=typeof window<"u"&&typeof document<"u",Gu=typeof navigator=="object"&&navigator||void 0,AA=Ac&&(!Gu||["ReactNative","NativeScript","NS"].indexOf(Gu.product)<0),IA=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",RA=Ac&&window.location.href||"http://localhost",SA=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ac,hasStandardBrowserEnv:AA,hasStandardBrowserWebWorkerEnv:IA,navigator:Gu,origin:RA},Symbol.toStringTag,{value:"Module"})),Jt={...SA,...TA};function bA(e,t){return Ra(e,new Jt.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Jt.isNode&&D.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function CA(e){return D.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function PA(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function Fg(e){function t(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),c=s>=n.length;return o=!o&&D.isArray(i)?i.length:o,c?(D.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!D.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],s)&&D.isArray(i[o])&&(i[o]=PA(i[o])),!u)}if(D.isFormData(e)&&D.isFunction(e.entries)){const n={};return D.forEachEntry(e,(r,i)=>{t(CA(r),i,n,0)}),n}return null}function xA(e,t,n){if(D.isString(e))try{return(t||JSON.parse)(e),D.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Ts={transitional:Lg,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=D.isObject(t);if(s&&D.isHTMLForm(t)&&(t=new FormData(t)),D.isFormData(t))return i?JSON.stringify(Fg(t)):t;if(D.isArrayBuffer(t)||D.isBuffer(t)||D.isStream(t)||D.isFile(t)||D.isBlob(t)||D.isReadableStream(t))return t;if(D.isArrayBufferView(t))return t.buffer;if(D.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return bA(t,this.formSerializer).toString();if((u=D.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Ra(u?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),xA(t)):t}],transformResponse:[function(t){const n=this.transitional||Ts.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(D.isResponse(t)||D.isReadableStream(t))return t;if(t&&D.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Z.from(u,Z.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Jt.classes.FormData,Blob:Jt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],e=>{Ts.headers[e]={}});const VA=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NA=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&VA[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},nd=Symbol("internals");function bi(e){return e&&String(e).trim().toLowerCase()}function lo(e){return e===!1||e==null?e:D.isArray(e)?e.map(lo):String(e)}function DA(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const kA=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function uu(e,t,n,r,i){if(D.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!D.isString(t)){if(D.isString(r))return t.indexOf(r)!==-1;if(D.isRegExp(r))return r.test(t)}}function OA(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function MA(e,t){const n=D.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,o){return this[r].call(this,t,i,s,o)},configurable:!0})})}let pe=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,c,l){const h=bi(c);if(!h)throw new Error("header name must be a non-empty string");const d=D.findKey(i,h);(!d||i[d]===void 0||l===!0||l===void 0&&i[d]!==!1)&&(i[d||c]=lo(u))}const o=(u,c)=>D.forEach(u,(l,h)=>s(l,h,c));if(D.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(D.isString(t)&&(t=t.trim())&&!kA(t))o(NA(t),n);else if(D.isObject(t)&&D.isIterable(t)){let u={},c,l;for(const h of t){if(!D.isArray(h))throw TypeError("Object iterator must return a key-value pair");u[l=h[0]]=(c=u[l])?D.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(u,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=bi(t),t){const r=D.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return DA(i);if(D.isFunction(n))return n.call(this,i,r);if(D.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=bi(t),t){const r=D.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||uu(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(o){if(o=bi(o),o){const u=D.findKey(r,o);u&&(!n||uu(r,r[u],u,n))&&(delete r[u],i=!0)}}return D.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||uu(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return D.forEach(this,(i,s)=>{const o=D.findKey(r,s);if(o){n[o]=lo(i),delete n[s];return}const u=t?OA(s):String(s).trim();u!==s&&delete n[s],n[u]=lo(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return D.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&D.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[nd]=this[nd]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=bi(o);r[u]||(MA(i,o),r[u]=!0)}return D.isArray(t)?t.forEach(s):s(t),this}};pe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(pe.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});D.freezeMethods(pe);function lu(e,t){const n=this||Ts,r=t||n,i=pe.from(r.headers);let s=r.data;return D.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function Ug(e){return!!(e&&e.__CANCEL__)}function hi(e,t,n){Z.call(this,e??"canceled",Z.ERR_CANCELED,t,n),this.name="CanceledError"}D.inherits(hi,Z,{__CANCEL__:!0});function Bg(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Z("Request failed with status code "+n.status,[Z.ERR_BAD_REQUEST,Z.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function LA(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function FA(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),h=r[s];o||(o=l),n[i]=c,r[i]=l;let d=s,p=0;for(;d!==i;)p+=n[d++],d=d%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),l-o<t)return;const g=h&&l-h;return g?Math.round(p*1e3/g):void 0}}function UA(e,t){let n=0,r=1e3/t,i,s;const o=(l,h=Date.now())=>{n=h,i=null,s&&(clearTimeout(s),s=null),e.apply(null,l)};return[(...l)=>{const h=Date.now(),d=h-n;d>=r?o(l,h):(i=l,s||(s=setTimeout(()=>{s=null,o(i)},r-d)))},()=>i&&o(i)]}const Bo=(e,t,n=3)=>{let r=0;const i=FA(50,250);return UA(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,c=o-r,l=i(c),h=o<=u;r=o;const d={loaded:o,total:u,progress:u?o/u:void 0,bytes:c,rate:l||void 0,estimated:l&&u&&h?(u-o)/l:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(d)},n)},rd=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},id=e=>(...t)=>D.asap(()=>e(...t)),BA=Jt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Jt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Jt.origin),Jt.navigator&&/(msie|trident)/i.test(Jt.navigator.userAgent)):()=>!0,$A=Jt.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];D.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),D.isString(r)&&o.push("path="+r),D.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function qA(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function zA(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function $g(e,t,n){let r=!qA(t);return e&&(r||n==!1)?zA(e,t):t}const sd=e=>e instanceof pe?{...e}:e;function yr(e,t){t=t||{};const n={};function r(l,h,d,p){return D.isPlainObject(l)&&D.isPlainObject(h)?D.merge.call({caseless:p},l,h):D.isPlainObject(h)?D.merge({},h):D.isArray(h)?h.slice():h}function i(l,h,d,p){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l,d,p)}else return r(l,h,d,p)}function s(l,h){if(!D.isUndefined(h))return r(void 0,h)}function o(l,h){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l)}else return r(void 0,h)}function u(l,h,d){if(d in t)return r(l,h);if(d in e)return r(void 0,l)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(l,h,d)=>i(sd(l),sd(h),d,!0)};return D.forEach(Object.keys(Object.assign({},e,t)),function(h){const d=c[h]||i,p=d(e[h],t[h],h);D.isUndefined(p)&&d!==u||(n[h]=p)}),n}const qg=e=>{const t=yr({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=t;t.headers=o=pe.from(o),t.url=Mg($g(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let c;if(D.isFormData(n)){if(Jt.hasStandardBrowserEnv||Jt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[l,...h]=c?c.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([l||"multipart/form-data",...h].join("; "))}}if(Jt.hasStandardBrowserEnv&&(r&&D.isFunction(r)&&(r=r(t)),r||r!==!1&&BA(t.url))){const l=i&&s&&$A.read(s);l&&o.set(i,l)}return t},jA=typeof XMLHttpRequest<"u",HA=jA&&function(e){return new Promise(function(n,r){const i=qg(e);let s=i.data;const o=pe.from(i.headers).normalize();let{responseType:u,onUploadProgress:c,onDownloadProgress:l}=i,h,d,p,g,_;function E(){g&&g(),_&&_(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(i.method.toUpperCase(),i.url,!0),v.timeout=i.timeout;function P(){if(!v)return;const N=pe.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),M={data:!u||u==="text"||u==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:N,config:e,request:v};Bg(function(I){n(I),E()},function(I){r(I),E()},M),v=null}"onloadend"in v?v.onloadend=P:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(P)},v.onabort=function(){v&&(r(new Z("Request aborted",Z.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new Z("Network Error",Z.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let x=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const M=i.transitional||Lg;i.timeoutErrorMessage&&(x=i.timeoutErrorMessage),r(new Z(x,M.clarifyTimeoutError?Z.ETIMEDOUT:Z.ECONNABORTED,e,v)),v=null},s===void 0&&o.setContentType(null),"setRequestHeader"in v&&D.forEach(o.toJSON(),function(x,M){v.setRequestHeader(M,x)}),D.isUndefined(i.withCredentials)||(v.withCredentials=!!i.withCredentials),u&&u!=="json"&&(v.responseType=i.responseType),l&&([p,_]=Bo(l,!0),v.addEventListener("progress",p)),c&&v.upload&&([d,g]=Bo(c),v.upload.addEventListener("progress",d),v.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(h=N=>{v&&(r(!N||N.type?new hi(null,e,v):N),v.abort(),v=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const b=LA(i.url);if(b&&Jt.protocols.indexOf(b)===-1){r(new Z("Unsupported protocol "+b+":",Z.ERR_BAD_REQUEST,e));return}v.send(s||null)})},GA=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(l){if(!i){i=!0,u();const h=l instanceof Error?l:this.reason;r.abort(h instanceof Z?h:new hi(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new Z(`timeout ${t} of ms exceeded`,Z.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(s):l.removeEventListener("abort",s)}),e=null)};e.forEach(l=>l.addEventListener("abort",s));const{signal:c}=r;return c.unsubscribe=()=>D.asap(u),c}},WA=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},KA=async function*(e,t){for await(const n of QA(e))yield*WA(n,t)},QA=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},od=(e,t,n,r)=>{const i=KA(e,t);let s=0,o,u=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:l,value:h}=await i.next();if(l){u(),c.close();return}let d=h.byteLength;if(n){let p=s+=d;n(p)}c.enqueue(new Uint8Array(h))}catch(l){throw u(l),l}},cancel(c){return u(c),i.return()}},{highWaterMark:2})},Sa=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",zg=Sa&&typeof ReadableStream=="function",XA=Sa&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),jg=(e,...t)=>{try{return!!e(...t)}catch{return!1}},YA=zg&&jg(()=>{let e=!1;const t=new Request(Jt.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),ad=64*1024,Wu=zg&&jg(()=>D.isReadableStream(new Response("").body)),$o={stream:Wu&&(e=>e.body)};Sa&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!$o[t]&&($o[t]=D.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Z(`Response type '${t}' is not supported`,Z.ERR_NOT_SUPPORT,r)})})})(new Response);const JA=async e=>{if(e==null)return 0;if(D.isBlob(e))return e.size;if(D.isSpecCompliantForm(e))return(await new Request(Jt.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(D.isArrayBufferView(e)||D.isArrayBuffer(e))return e.byteLength;if(D.isURLSearchParams(e)&&(e=e+""),D.isString(e))return(await XA(e)).byteLength},ZA=async(e,t)=>{const n=D.toFiniteNumber(e.getContentLength());return n??JA(t)},tI=Sa&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:c,responseType:l,headers:h,withCredentials:d="same-origin",fetchOptions:p}=qg(e);l=l?(l+"").toLowerCase():"text";let g=GA([i,s&&s.toAbortSignal()],o),_;const E=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&YA&&n!=="get"&&n!=="head"&&(v=await ZA(h,r))!==0){let M=new Request(t,{method:"POST",body:r,duplex:"half"}),U;if(D.isFormData(r)&&(U=M.headers.get("content-type"))&&h.setContentType(U),M.body){const[I,w]=rd(v,Bo(id(c)));r=od(M.body,ad,I,w)}}D.isString(d)||(d=d?"include":"omit");const P="credentials"in Request.prototype;_=new Request(t,{...p,signal:g,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:P?d:void 0});let b=await fetch(_,p);const N=Wu&&(l==="stream"||l==="response");if(Wu&&(u||N&&E)){const M={};["status","statusText","headers"].forEach(T=>{M[T]=b[T]});const U=D.toFiniteNumber(b.headers.get("content-length")),[I,w]=u&&rd(U,Bo(id(u),!0))||[];b=new Response(od(b.body,ad,I,()=>{w&&w(),E&&E()}),M)}l=l||"text";let x=await $o[D.findKey($o,l)||"text"](b,e);return!N&&E&&E(),await new Promise((M,U)=>{Bg(M,U,{data:x,headers:pe.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:_})})}catch(P){throw E&&E(),P&&P.name==="TypeError"&&/Load failed|fetch/i.test(P.message)?Object.assign(new Z("Network Error",Z.ERR_NETWORK,e,_),{cause:P.cause||P}):Z.from(P,P&&P.code,e,_)}}),Ku={http:mA,xhr:HA,fetch:tI};D.forEach(Ku,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ud=e=>`- ${e}`,eI=e=>D.isFunction(e)||e===null||e===!1,Hg={getAdapter:e=>{e=D.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let o;if(r=n,!eI(n)&&(r=Ku[(o=String(n)).toLowerCase()],r===void 0))throw new Z(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,c])=>`adapter ${u} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(ud).join(`
`):" "+ud(s[0]):"as no adapter specified";throw new Z("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Ku};function cu(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new hi(null,e)}function ld(e){return cu(e),e.headers=pe.from(e.headers),e.data=lu.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Hg.getAdapter(e.adapter||Ts.adapter)(e).then(function(r){return cu(e),r.data=lu.call(e,e.transformResponse,r),r.headers=pe.from(r.headers),r},function(r){return Ug(r)||(cu(e),r&&r.response&&(r.response.data=lu.call(e,e.transformResponse,r.response),r.response.headers=pe.from(r.response.headers))),Promise.reject(r)})}const Gg="1.10.0",ba={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ba[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const cd={};ba.transitional=function(t,n,r){function i(s,o){return"[Axios v"+Gg+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(t===!1)throw new Z(i(o," has been removed"+(n?" in "+n:"")),Z.ERR_DEPRECATED);return n&&!cd[o]&&(cd[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,u):!0}};ba.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function nI(e,t,n){if(typeof e!="object")throw new Z("options must be an object",Z.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const u=e[s],c=u===void 0||o(u,s,e);if(c!==!0)throw new Z("option "+s+" must be "+c,Z.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Z("Unknown option "+s,Z.ERR_BAD_OPTION)}}const co={assertOptions:nI,validators:ba},qe=co.validators;let dr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ed,response:new ed}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=yr(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&co.assertOptions(r,{silentJSONParsing:qe.transitional(qe.boolean),forcedJSONParsing:qe.transitional(qe.boolean),clarifyTimeoutError:qe.transitional(qe.boolean)},!1),i!=null&&(D.isFunction(i)?n.paramsSerializer={serialize:i}:co.assertOptions(i,{encode:qe.function,serialize:qe.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),co.assertOptions(n,{baseUrl:qe.spelling("baseURL"),withXsrfToken:qe.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&D.merge(s.common,s[n.method]);s&&D.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),n.headers=pe.concat(o,s);const u=[];let c=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(n)===!1||(c=c&&E.synchronous,u.unshift(E.fulfilled,E.rejected))});const l=[];this.interceptors.response.forEach(function(E){l.push(E.fulfilled,E.rejected)});let h,d=0,p;if(!c){const _=[ld.bind(this),void 0];for(_.unshift.apply(_,u),_.push.apply(_,l),p=_.length,h=Promise.resolve(n);d<p;)h=h.then(_[d++],_[d++]);return h}p=u.length;let g=n;for(d=0;d<p;){const _=u[d++],E=u[d++];try{g=_(g)}catch(v){E.call(this,v);break}}try{h=ld.call(this,g)}catch(_){return Promise.reject(_)}for(d=0,p=l.length;d<p;)h=h.then(l[d++],l[d++]);return h}getUri(t){t=yr(this.defaults,t);const n=$g(t.baseURL,t.url,t.allowAbsoluteUrls);return Mg(n,t.params,t.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(t){dr.prototype[t]=function(n,r){return this.request(yr(r||{},{method:t,url:n,data:(r||{}).data}))}});D.forEach(["post","put","patch"],function(t){function n(r){return function(s,o,u){return this.request(yr(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}dr.prototype[t]=n(),dr.prototype[t+"Form"]=n(!0)});let rI=class Wg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},t(function(s,o,u){r.reason||(r.reason=new hi(s,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Wg(function(i){t=i}),cancel:t}}};function iI(e){return function(n){return e.apply(null,n)}}function sI(e){return D.isObject(e)&&e.isAxiosError===!0}const Qu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Qu).forEach(([e,t])=>{Qu[t]=e});function Kg(e){const t=new dr(e),n=Ig(dr.prototype.request,t);return D.extend(n,dr.prototype,t,{allOwnKeys:!0}),D.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return Kg(yr(e,i))},n}const At=Kg(Ts);At.Axios=dr;At.CanceledError=hi;At.CancelToken=rI;At.isCancel=Ug;At.VERSION=Gg;At.toFormData=Ra;At.AxiosError=Z;At.Cancel=At.CanceledError;At.all=function(t){return Promise.all(t)};At.spread=iI;At.isAxiosError=sI;At.mergeConfig=yr;At.AxiosHeaders=pe;At.formToJSON=e=>Fg(D.isHTMLForm(e)?new FormData(e):e);At.getAdapter=Hg.getAdapter;At.HttpStatusCode=Qu;At.default=At;const{Axios:fP,AxiosError:dP,CanceledError:pP,isCancel:mP,CancelToken:gP,VERSION:_P,all:yP,Cancel:vP,isAxiosError:wP,spread:EP,toFormData:TP,AxiosHeaders:AP,HttpStatusCode:IP,formToJSON:RP,getAdapter:SP,mergeConfig:bP}=At;class vr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,u=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);u&&(n[r++]=u),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function*oI(e){for(const t of e)yield*t}function Qg(e){return Array.from(oI(e))}var aI={value:()=>{}};function Ic(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ho(n)}function ho(e){this._=e}function uI(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ho.prototype=Ic.prototype={constructor:ho,on:function(e,t){var n=this._,r=uI(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=lI(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=hd(n[i],e.name,t);else if(t==null)for(i in n)n[i]=hd(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ho(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function lI(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function hd(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=aI,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Xu="http://www.w3.org/1999/xhtml";const fd={svg:"http://www.w3.org/2000/svg",xhtml:Xu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ca(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),fd.hasOwnProperty(t)?{space:fd[t],local:e}:e}function cI(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Xu&&t.documentElement.namespaceURI===Xu?t.createElement(e):t.createElementNS(n,e)}}function hI(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Xg(e){var t=Ca(e);return(t.local?hI:cI)(t)}function fI(){}function Rc(e){return e==null?fI:function(){return this.querySelector(e)}}function dI(e){typeof e!="function"&&(e=Rc(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=new Array(o),c,l,h=0;h<o;++h)(c=s[h])&&(l=e.call(c,c.__data__,h,s))&&("__data__"in c&&(l.__data__=c.__data__),u[h]=l);return new Oe(r,this._parents)}function pI(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function mI(){return[]}function Yg(e){return e==null?mI:function(){return this.querySelectorAll(e)}}function gI(e){return function(){return pI(e.apply(this,arguments))}}function _I(e){typeof e=="function"?e=gI(e):e=Yg(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new Oe(r,i)}function Jg(e){return function(){return this.matches(e)}}function Zg(e){return function(t){return t.matches(e)}}var yI=Array.prototype.find;function vI(e){return function(){return yI.call(this.children,e)}}function wI(){return this.firstElementChild}function EI(e){return this.select(e==null?wI:vI(typeof e=="function"?e:Zg(e)))}var TI=Array.prototype.filter;function AI(){return Array.from(this.children)}function II(e){return function(){return TI.call(this.children,e)}}function RI(e){return this.selectAll(e==null?AI:II(typeof e=="function"?e:Zg(e)))}function SI(e){typeof e!="function"&&(e=Jg(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new Oe(r,this._parents)}function t_(e){return new Array(e.length)}function bI(){return new Oe(this._enter||this._groups.map(t_),this._parents)}function qo(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}qo.prototype={constructor:qo,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function CI(e){return function(){return e}}function PI(e,t,n,r,i,s){for(var o=0,u,c=t.length,l=s.length;o<l;++o)(u=t[o])?(u.__data__=s[o],r[o]=u):n[o]=new qo(e,s[o]);for(;o<c;++o)(u=t[o])&&(i[o]=u)}function xI(e,t,n,r,i,s,o){var u,c,l=new Map,h=t.length,d=s.length,p=new Array(h),g;for(u=0;u<h;++u)(c=t[u])&&(p[u]=g=o.call(c,c.__data__,u,t)+"",l.has(g)?i[u]=c:l.set(g,c));for(u=0;u<d;++u)g=o.call(e,s[u],u,s)+"",(c=l.get(g))?(r[u]=c,c.__data__=s[u],l.delete(g)):n[u]=new qo(e,s[u]);for(u=0;u<h;++u)(c=t[u])&&l.get(p[u])===c&&(i[u]=c)}function VI(e){return e.__data__}function NI(e,t){if(!arguments.length)return Array.from(this,VI);var n=t?xI:PI,r=this._parents,i=this._groups;typeof e!="function"&&(e=CI(e));for(var s=i.length,o=new Array(s),u=new Array(s),c=new Array(s),l=0;l<s;++l){var h=r[l],d=i[l],p=d.length,g=DI(e.call(h,h&&h.__data__,l,r)),_=g.length,E=u[l]=new Array(_),v=o[l]=new Array(_),P=c[l]=new Array(p);n(h,d,E,v,P,g,t);for(var b=0,N=0,x,M;b<_;++b)if(x=E[b]){for(b>=N&&(N=b+1);!(M=v[N])&&++N<_;);x._next=M||null}}return o=new Oe(o,r),o._enter=u,o._exit=c,o}function DI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kI(){return new Oe(this._exit||this._groups.map(t_),this._parents)}function OI(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function MI(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),u=new Array(i),c=0;c<o;++c)for(var l=n[c],h=r[c],d=l.length,p=u[c]=new Array(d),g,_=0;_<d;++_)(g=l[_]||h[_])&&(p[_]=g);for(;c<i;++c)u[c]=n[c];return new Oe(u,this._parents)}function LI(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function FI(e){e||(e=UI);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],u=o.length,c=i[s]=new Array(u),l,h=0;h<u;++h)(l=o[h])&&(c[h]=l);c.sort(t)}return new Oe(i,this._parents).order()}function UI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function BI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $I(){return Array.from(this)}function qI(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function zI(){let e=0;for(const t of this)++e;return e}function jI(){return!this.node()}function HI(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,u;s<o;++s)(u=i[s])&&e.call(u,u.__data__,s,i);return this}function GI(e){return function(){this.removeAttribute(e)}}function WI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function KI(e,t){return function(){this.setAttribute(e,t)}}function QI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function XI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function YI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function JI(e,t){var n=Ca(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?WI:GI:typeof t=="function"?n.local?YI:XI:n.local?QI:KI)(n,t))}function e_(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ZI(e){return function(){this.style.removeProperty(e)}}function tR(e,t,n){return function(){this.style.setProperty(e,t,n)}}function eR(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function nR(e,t,n){return arguments.length>1?this.each((t==null?ZI:typeof t=="function"?eR:tR)(e,t,n??"")):Yr(this.node(),e)}function Yr(e,t){return e.style.getPropertyValue(t)||e_(e).getComputedStyle(e,null).getPropertyValue(t)}function rR(e){return function(){delete this[e]}}function iR(e,t){return function(){this[e]=t}}function sR(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function oR(e,t){return arguments.length>1?this.each((t==null?rR:typeof t=="function"?sR:iR)(e,t)):this.node()[e]}function n_(e){return e.trim().split(/^|\s+/)}function Sc(e){return e.classList||new r_(e)}function r_(e){this._node=e,this._names=n_(e.getAttribute("class")||"")}r_.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function i_(e,t){for(var n=Sc(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function s_(e,t){for(var n=Sc(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function aR(e){return function(){i_(this,e)}}function uR(e){return function(){s_(this,e)}}function lR(e,t){return function(){(t.apply(this,arguments)?i_:s_)(this,e)}}function cR(e,t){var n=n_(e+"");if(arguments.length<2){for(var r=Sc(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?lR:t?aR:uR)(n,t))}function hR(){this.textContent=""}function fR(e){return function(){this.textContent=e}}function dR(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function pR(e){return arguments.length?this.each(e==null?hR:(typeof e=="function"?dR:fR)(e)):this.node().textContent}function mR(){this.innerHTML=""}function gR(e){return function(){this.innerHTML=e}}function _R(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function yR(e){return arguments.length?this.each(e==null?mR:(typeof e=="function"?_R:gR)(e)):this.node().innerHTML}function vR(){this.nextSibling&&this.parentNode.appendChild(this)}function wR(){return this.each(vR)}function ER(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function TR(){return this.each(ER)}function AR(e){var t=typeof e=="function"?e:Xg(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function IR(){return null}function RR(e,t){var n=typeof e=="function"?e:Xg(e),r=t==null?IR:typeof t=="function"?t:Rc(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function SR(){var e=this.parentNode;e&&e.removeChild(this)}function bR(){return this.each(SR)}function CR(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function PR(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xR(e){return this.select(e?PR:CR)}function VR(e){return arguments.length?this.property("__data__",e):this.node().__data__}function NR(e){return function(t){e.call(this,t,this.__data__)}}function DR(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function kR(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function OR(e,t,n){return function(){var r=this.__on,i,s=NR(t);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function MR(e,t,n){var r=DR(e+""),i,s=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,l=u.length,h;c<l;++c)for(i=0,h=u[c];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(u=t?OR:kR,i=0;i<s;++i)this.each(u(r[i],t,n));return this}function o_(e,t,n){var r=e_(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function LR(e,t){return function(){return o_(this,e,t)}}function FR(e,t){return function(){return o_(this,e,t.apply(this,arguments))}}function UR(e,t){return this.each((typeof t=="function"?FR:LR)(e,t))}function*BR(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var $R=[null];function Oe(e,t){this._groups=e,this._parents=t}function As(){return new Oe([[document.documentElement]],$R)}function qR(){return this}Oe.prototype=As.prototype={constructor:Oe,select:dI,selectAll:_I,selectChild:EI,selectChildren:RI,filter:SI,data:NI,enter:bI,exit:kI,join:OI,merge:MI,selection:qR,order:LI,sort:FI,call:BI,nodes:$I,node:qI,size:zI,empty:jI,each:HI,attr:JI,style:nR,property:oR,classed:cR,text:pR,html:yR,raise:wR,lower:TR,append:AR,insert:RR,remove:bR,clone:xR,datum:VR,on:MR,dispatch:UR,[Symbol.iterator]:BR};function bc(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function a_(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Is(){}var ss=.7,zo=1/ss,Hr="\\s*([+-]?\\d+)\\s*",os="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zR=/^#([0-9a-f]{3,8})$/,jR=new RegExp(`^rgb\\(${Hr},${Hr},${Hr}\\)$`),HR=new RegExp(`^rgb\\(${tn},${tn},${tn}\\)$`),GR=new RegExp(`^rgba\\(${Hr},${Hr},${Hr},${os}\\)$`),WR=new RegExp(`^rgba\\(${tn},${tn},${tn},${os}\\)$`),KR=new RegExp(`^hsl\\(${os},${tn},${tn}\\)$`),QR=new RegExp(`^hsla\\(${os},${tn},${tn},${os}\\)$`),dd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};bc(Is,as,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:pd,formatHex:pd,formatHex8:XR,formatHsl:YR,formatRgb:md,toString:md});function pd(){return this.rgb().formatHex()}function XR(){return this.rgb().formatHex8()}function YR(){return u_(this).formatHsl()}function md(){return this.rgb().formatRgb()}function as(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=zR.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?gd(t):n===3?new he(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ks(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ks(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=jR.exec(e))?new he(t[1],t[2],t[3],1):(t=HR.exec(e))?new he(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=GR.exec(e))?Ks(t[1],t[2],t[3],t[4]):(t=WR.exec(e))?Ks(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=KR.exec(e))?vd(t[1],t[2]/100,t[3]/100,1):(t=QR.exec(e))?vd(t[1],t[2]/100,t[3]/100,t[4]):dd.hasOwnProperty(e)?gd(dd[e]):e==="transparent"?new he(NaN,NaN,NaN,0):null}function gd(e){return new he(e>>16&255,e>>8&255,e&255,1)}function Ks(e,t,n,r){return r<=0&&(e=t=n=NaN),new he(e,t,n,r)}function JR(e){return e instanceof Is||(e=as(e)),e?(e=e.rgb(),new he(e.r,e.g,e.b,e.opacity)):new he}function Yu(e,t,n,r){return arguments.length===1?JR(e):new he(e,t,n,r??1)}function he(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}bc(he,Yu,a_(Is,{brighter(e){return e=e==null?zo:Math.pow(zo,e),new he(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ss:Math.pow(ss,e),new he(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new he(pr(this.r),pr(this.g),pr(this.b),jo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_d,formatHex:_d,formatHex8:ZR,formatRgb:yd,toString:yd}));function _d(){return`#${cr(this.r)}${cr(this.g)}${cr(this.b)}`}function ZR(){return`#${cr(this.r)}${cr(this.g)}${cr(this.b)}${cr((isNaN(this.opacity)?1:this.opacity)*255)}`}function yd(){const e=jo(this.opacity);return`${e===1?"rgb(":"rgba("}${pr(this.r)}, ${pr(this.g)}, ${pr(this.b)}${e===1?")":`, ${e})`}`}function jo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function cr(e){return e=pr(e),(e<16?"0":"")+e.toString(16)}function vd(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new De(e,t,n,r)}function u_(e){if(e instanceof De)return new De(e.h,e.s,e.l,e.opacity);if(e instanceof Is||(e=as(e)),!e)return new De;if(e instanceof De)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,u=s-i,c=(s+i)/2;return u?(t===s?o=(n-r)/u+(n<r)*6:n===s?o=(r-t)/u+2:o=(t-n)/u+4,u/=c<.5?s+i:2-s-i,o*=60):u=c>0&&c<1?0:o,new De(o,u,c,e.opacity)}function tS(e,t,n,r){return arguments.length===1?u_(e):new De(e,t,n,r??1)}function De(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}bc(De,tS,a_(Is,{brighter(e){return e=e==null?zo:Math.pow(zo,e),new De(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ss:Math.pow(ss,e),new De(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new he(hu(e>=240?e-240:e+120,i,r),hu(e,i,r),hu(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new De(wd(this.h),Qs(this.s),Qs(this.l),jo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=jo(this.opacity);return`${e===1?"hsl(":"hsla("}${wd(this.h)}, ${Qs(this.s)*100}%, ${Qs(this.l)*100}%${e===1?")":`, ${e})`}`}}));function wd(e){return e=(e||0)%360,e<0?e+360:e}function Qs(e){return Math.max(0,Math.min(1,e||0))}function hu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const l_=e=>()=>e;function eS(e,t){return function(n){return e+n*t}}function nS(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function rS(e){return(e=+e)==1?c_:function(t,n){return n-t?nS(t,n,e):l_(isNaN(t)?n:t)}}function c_(e,t){var n=t-e;return n?eS(e,n):l_(isNaN(e)?t:e)}const Ed=function e(t){var n=rS(t);function r(i,s){var o=n((i=Yu(i)).r,(s=Yu(s)).r),u=n(i.g,s.g),c=n(i.b,s.b),l=c_(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=u(h),i.b=c(h),i.opacity=l(h),i+""}}return r.gamma=e,r}(1);function Dn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Ju=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fu=new RegExp(Ju.source,"g");function iS(e){return function(){return e}}function sS(e){return function(t){return e(t)+""}}function oS(e,t){var n=Ju.lastIndex=fu.lastIndex=0,r,i,s,o=-1,u=[],c=[];for(e=e+"",t=t+"";(r=Ju.exec(e))&&(i=fu.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),u[o]?u[o]+=s:u[++o]=s),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,c.push({i:o,x:Dn(r,i)})),n=fu.lastIndex;return n<t.length&&(s=t.slice(n),u[o]?u[o]+=s:u[++o]=s),u.length<2?c[0]?sS(c[0].x):iS(t):(t=c.length,function(l){for(var h=0,d;h<t;++h)u[(d=c[h]).i]=d.x(l);return u.join("")})}var Td=180/Math.PI,Zu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function h_(e,t,n,r,i,s){var o,u,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,c/=u),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Td,skewX:Math.atan(c)*Td,scaleX:o,scaleY:u}}var Xs;function aS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Zu:h_(t.a,t.b,t.c,t.d,t.e,t.f)}function uS(e){return e==null||(Xs||(Xs=document.createElementNS("http://www.w3.org/2000/svg","g")),Xs.setAttribute("transform",e),!(e=Xs.transform.baseVal.consolidate()))?Zu:(e=e.matrix,h_(e.a,e.b,e.c,e.d,e.e,e.f))}function f_(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,h,d,p,g,_){if(l!==d||h!==p){var E=g.push("translate(",null,t,null,n);_.push({i:E-4,x:Dn(l,d)},{i:E-2,x:Dn(h,p)})}else(d||p)&&g.push("translate("+d+t+p+n)}function o(l,h,d,p){l!==h?(l-h>180?h+=360:h-l>180&&(l+=360),p.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Dn(l,h)})):h&&d.push(i(d)+"rotate("+h+r)}function u(l,h,d,p){l!==h?p.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Dn(l,h)}):h&&d.push(i(d)+"skewX("+h+r)}function c(l,h,d,p,g,_){if(l!==d||h!==p){var E=g.push(i(g)+"scale(",null,",",null,")");_.push({i:E-4,x:Dn(l,d)},{i:E-2,x:Dn(h,p)})}else(d!==1||p!==1)&&g.push(i(g)+"scale("+d+","+p+")")}return function(l,h){var d=[],p=[];return l=e(l),h=e(h),s(l.translateX,l.translateY,h.translateX,h.translateY,d,p),o(l.rotate,h.rotate,d,p),u(l.skewX,h.skewX,d,p),c(l.scaleX,l.scaleY,h.scaleX,h.scaleY,d,p),l=h=null,function(g){for(var _=-1,E=p.length,v;++_<E;)d[(v=p[_]).i]=v.x(g);return d.join("")}}}var lS=f_(aS,"px, ","px)","deg)"),cS=f_(uS,", ",")",")"),Jr=0,Di=0,Ci=0,d_=1e3,Ho,ki,Go=0,wr=0,Pa=0,us=typeof performance=="object"&&performance.now?performance:Date,p_=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Cc(){return wr||(p_(hS),wr=us.now()+Pa)}function hS(){wr=0}function Wo(){this._call=this._time=this._next=null}Wo.prototype=Pc.prototype={constructor:Wo,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Cc():+n)+(t==null?0:+t),!this._next&&ki!==this&&(ki?ki._next=this:Ho=this,ki=this),this._call=e,this._time=n,tl()},stop:function(){this._call&&(this._call=null,this._time=1/0,tl())}};function Pc(e,t,n){var r=new Wo;return r.restart(e,t,n),r}function fS(){Cc(),++Jr;for(var e=Ho,t;e;)(t=wr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Jr}function Ad(){wr=(Go=us.now())+Pa,Jr=Di=0;try{fS()}finally{Jr=0,pS(),wr=0}}function dS(){var e=us.now(),t=e-Go;t>d_&&(Pa-=t,Go=e)}function pS(){for(var e,t=Ho,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Ho=n);ki=e,tl(r)}function tl(e){if(!Jr){Di&&(Di=clearTimeout(Di));var t=e-wr;t>24?(e<1/0&&(Di=setTimeout(Ad,e-us.now()-Pa)),Ci&&(Ci=clearInterval(Ci))):(Ci||(Go=us.now(),Ci=setInterval(dS,d_)),Jr=1,p_(Ad))}}function Id(e,t,n){var r=new Wo;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var mS=Ic("start","end","cancel","interrupt"),gS=[],m_=0,Rd=1,el=2,fo=3,Sd=4,nl=5,po=6;function xa(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;_S(e,n,{name:t,index:r,group:i,on:mS,tween:gS,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:m_})}function xc(e,t){var n=Le(e,t);if(n.state>m_)throw new Error("too late; already scheduled");return n}function sn(e,t){var n=Le(e,t);if(n.state>fo)throw new Error("too late; already running");return n}function Le(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _S(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Pc(s,0,n.time);function s(l){n.state=Rd,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var h,d,p,g;if(n.state!==Rd)return c();for(h in r)if(g=r[h],g.name===n.name){if(g.state===fo)return Id(o);g.state===Sd?(g.state=po,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[h]):+h<t&&(g.state=po,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[h])}if(Id(function(){n.state===fo&&(n.state=Sd,n.timer.restart(u,n.delay,n.time),u(l))}),n.state=el,n.on.call("start",e,e.__data__,n.index,n.group),n.state===el){for(n.state=fo,i=new Array(p=n.tween.length),h=0,d=-1;h<p;++h)(g=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=g);i.length=d+1}}function u(l){for(var h=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=nl,1),d=-1,p=i.length;++d<p;)i[d].call(e,h);n.state===nl&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=po,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function yS(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>el&&r.state<nl,r.state=po,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function vS(e){return this.each(function(){yS(this,e)})}function wS(e,t){var n,r;return function(){var i=sn(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,u=r.length;o<u;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function ES(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=sn(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var u={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=u;break}c===l&&i.push(u)}s.tween=i}}function TS(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Le(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?wS:ES)(n,e,t))}function Vc(e,t,n){var r=e._id;return e.each(function(){var i=sn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Le(i,r).value[t]}}function g_(e,t){var n;return(typeof t=="number"?Dn:t instanceof as?Ed:(n=as(t))?(t=n,Ed):oS)(e,t)}function AS(e){return function(){this.removeAttribute(e)}}function IS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function RS(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function SS(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function bS(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function CS(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function PS(e,t){var n=Ca(e),r=n==="transform"?cS:g_;return this.attrTween(e,typeof t=="function"?(n.local?CS:bS)(n,r,Vc(this,"attr."+e,t)):t==null?(n.local?IS:AS)(n):(n.local?SS:RS)(n,r,t))}function xS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function VS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function NS(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&VS(e,s)),n}return i._value=t,i}function DS(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&xS(e,s)),n}return i._value=t,i}function kS(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Ca(e);return this.tween(n,(r.local?NS:DS)(r,t))}function OS(e,t){return function(){xc(this,e).delay=+t.apply(this,arguments)}}function MS(e,t){return t=+t,function(){xc(this,e).delay=t}}function LS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?OS:MS)(t,e)):Le(this.node(),t).delay}function FS(e,t){return function(){sn(this,e).duration=+t.apply(this,arguments)}}function US(e,t){return t=+t,function(){sn(this,e).duration=t}}function BS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?FS:US)(t,e)):Le(this.node(),t).duration}function $S(e,t){if(typeof t!="function")throw new Error;return function(){sn(this,e).ease=t}}function qS(e){var t=this._id;return arguments.length?this.each($S(t,e)):Le(this.node(),t).ease}function zS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;sn(this,e).ease=n}}function jS(e){if(typeof e!="function")throw new Error;return this.each(zS(this._id,e))}function HS(e){typeof e!="function"&&(e=Jg(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new En(r,this._parents,this._name,this._id)}function GS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),u=0;u<s;++u)for(var c=t[u],l=n[u],h=c.length,d=o[u]=new Array(h),p,g=0;g<h;++g)(p=c[g]||l[g])&&(d[g]=p);for(;u<r;++u)o[u]=t[u];return new En(o,this._parents,this._name,this._id)}function WS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function KS(e,t,n){var r,i,s=WS(t)?xc:sn;return function(){var o=s(this,e),u=o.on;u!==r&&(i=(r=u).copy()).on(t,n),o.on=i}}function QS(e,t){var n=this._id;return arguments.length<2?Le(this.node(),n).on.on(e):this.each(KS(n,e,t))}function XS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function YS(){return this.on("end.remove",XS(this._id))}function JS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Rc(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var u=r[o],c=u.length,l=s[o]=new Array(c),h,d,p=0;p<c;++p)(h=u[p])&&(d=e.call(h,h.__data__,p,u))&&("__data__"in h&&(d.__data__=h.__data__),l[p]=d,xa(l[p],t,n,p,l,Le(h,n)));return new En(s,this._parents,t,n)}function ZS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Yg(e));for(var r=this._groups,i=r.length,s=[],o=[],u=0;u<i;++u)for(var c=r[u],l=c.length,h,d=0;d<l;++d)if(h=c[d]){for(var p=e.call(h,h.__data__,d,c),g,_=Le(h,n),E=0,v=p.length;E<v;++E)(g=p[E])&&xa(g,t,n,E,p,_);s.push(p),o.push(h)}return new En(s,o,t,n)}var tb=As.prototype.constructor;function eb(){return new tb(this._groups,this._parents)}function nb(e,t){var n,r,i;return function(){var s=Yr(this,e),o=(this.style.removeProperty(e),Yr(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function __(e){return function(){this.style.removeProperty(e)}}function rb(e,t,n){var r,i=n+"",s;return function(){var o=Yr(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function ib(e,t,n){var r,i,s;return function(){var o=Yr(this,e),u=n(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(e),Yr(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u))}}function sb(e,t){var n,r,i,s="style."+t,o="end."+s,u;return function(){var c=sn(this,e),l=c.on,h=c.value[s]==null?u||(u=__(t)):void 0;(l!==n||i!==h)&&(r=(n=l).copy()).on(o,i=h),c.on=r}}function ob(e,t,n){var r=(e+="")=="transform"?lS:g_;return t==null?this.styleTween(e,nb(e,r)).on("end.style."+e,__(e)):typeof t=="function"?this.styleTween(e,ib(e,r,Vc(this,"style."+e,t))).each(sb(this._id,e)):this.styleTween(e,rb(e,r,t),n).on("end.style."+e,null)}function ab(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function ub(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&ab(e,o,n)),r}return s._value=t,s}function lb(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,ub(e,t,n??""))}function cb(e){return function(){this.textContent=e}}function hb(e){return function(){var t=e(this);this.textContent=t??""}}function fb(e){return this.tween("text",typeof e=="function"?hb(Vc(this,"text",e)):cb(e==null?"":e+""))}function db(e){return function(t){this.textContent=e.call(this,t)}}function pb(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&db(i)),t}return r._value=e,r}function mb(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,pb(e))}function gb(){for(var e=this._name,t=this._id,n=y_(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)if(c=o[l]){var h=Le(c,t);xa(c,e,n,l,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new En(r,this._parents,e,n)}function _b(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var u={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var l=sn(this,r),h=l.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(c)),l.on=t}),i===0&&s()})}var yb=0;function En(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function y_(){return++yb}var ln=As.prototype;En.prototype={constructor:En,select:JS,selectAll:ZS,selectChild:ln.selectChild,selectChildren:ln.selectChildren,filter:HS,merge:GS,selection:eb,transition:gb,call:ln.call,nodes:ln.nodes,node:ln.node,size:ln.size,empty:ln.empty,each:ln.each,on:QS,attr:PS,attrTween:kS,style:ob,styleTween:lb,text:fb,textTween:mb,remove:YS,tween:TS,delay:LS,duration:BS,ease:qS,easeVarying:jS,end:_b,[Symbol.iterator]:ln[Symbol.iterator]};function vb(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var wb={time:null,delay:0,duration:250,ease:vb};function Eb(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Tb(e){var t,n;e instanceof En?(t=e._id,e=e._name):(t=y_(),(n=wb).time=Cc(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&xa(c,e,t,l,o,n||Eb(c,t));return new En(r,this._parents,e,t)}As.prototype.interrupt=vS;As.prototype.transition=Tb;function Ab(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,o=n.length,u,c=0,l=0;for(s=0;s<o;++s)u=n[s],c+=u.x,l+=u.y;for(c=(c/o-e)*r,l=(l/o-t)*r,s=0;s<o;++s)u=n[s],u.x-=c,u.y-=l}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function Ib(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return v_(this.cover(t,n),t,n,e)}function v_(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},u=e._x0,c=e._y0,l=e._x1,h=e._y1,d,p,g,_,E,v,P,b;if(!s)return e._root=o,e;for(;s.length;)if((E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p,i=s,!(s=s[P=v<<1|E]))return i[P]=o,e;if(g=+e._x.call(null,s.data),_=+e._y.call(null,s.data),t===g&&n===_)return o.next=s,i?i[P]=o:e._root=o,e;do i=i?i[P]=new Array(4):e._root=new Array(4),(E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p;while((P=v<<1|E)===(b=(_>=p)<<1|g>=d));return i[b]=s,i[P]=o,e}function Rb(e){var t,n,r=e.length,i,s,o=new Array(r),u=new Array(r),c=1/0,l=1/0,h=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,u[n]=s,i<c&&(c=i),i>h&&(h=i),s<l&&(l=s),s>d&&(d=s));if(c>h||l>d)return this;for(this.cover(c,l).cover(h,d),n=0;n<r;++n)v_(this,o[n],u[n],e[n]);return this}function Sb(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n||1,u=this._root,c,l;n>e||e>=i||r>t||t>=s;)switch(l=(t<r)<<1|e<n,c=new Array(4),c[l]=u,u=c,o*=2,l){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function bb(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Cb(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function re(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Pb(e,t,n){var r,i=this._x0,s=this._y0,o,u,c,l,h=this._x1,d=this._y1,p=[],g=this._root,_,E;for(g&&p.push(new re(g,i,s,h,d)),n==null?n=1/0:(i=e-n,s=t-n,h=e+n,d=t+n,n*=n);_=p.pop();)if(!(!(g=_.node)||(o=_.x0)>h||(u=_.y0)>d||(c=_.x1)<i||(l=_.y1)<s))if(g.length){var v=(o+c)/2,P=(u+l)/2;p.push(new re(g[3],v,P,c,l),new re(g[2],o,P,v,l),new re(g[1],v,u,c,P),new re(g[0],o,u,v,P)),(E=(t>=P)<<1|e>=v)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-E],p[p.length-1-E]=_)}else{var b=e-+this._x.call(null,g.data),N=t-+this._y.call(null,g.data),x=b*b+N*N;if(x<n){var M=Math.sqrt(n=x);i=e-M,s=t-M,h=e+M,d=t+M,r=g.data}}return r}function xb(e){if(isNaN(h=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,u=this._y0,c=this._x1,l=this._y1,h,d,p,g,_,E,v,P;if(!n)return this;if(n.length)for(;;){if((_=h>=(p=(o+c)/2))?o=p:c=p,(E=d>=(g=(u+l)/2))?u=g:l=g,t=n,!(n=n[v=E<<1|_]))return this;if(!n.length)break;(t[v+1&3]||t[v+2&3]||t[v+3&3])&&(r=t,P=v)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[v]=s:delete t[v],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[P]=n:this._root=n),this):(this._root=s,this)}function Vb(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Nb(){return this._root}function Db(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function kb(e){var t=[],n,r=this._root,i,s,o,u,c;for(r&&t.push(new re(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,u=n.x1,c=n.y1)&&r.length){var l=(s+u)/2,h=(o+c)/2;(i=r[3])&&t.push(new re(i,l,h,u,c)),(i=r[2])&&t.push(new re(i,s,h,l,c)),(i=r[1])&&t.push(new re(i,l,o,u,h)),(i=r[0])&&t.push(new re(i,s,o,l,h))}return this}function Ob(e){var t=[],n=[],r;for(this._root&&t.push(new re(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,u=r.y0,c=r.x1,l=r.y1,h=(o+c)/2,d=(u+l)/2;(s=i[0])&&t.push(new re(s,o,u,h,d)),(s=i[1])&&t.push(new re(s,h,u,c,d)),(s=i[2])&&t.push(new re(s,o,d,h,l)),(s=i[3])&&t.push(new re(s,h,d,c,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Mb(e){return e[0]}function Lb(e){return arguments.length?(this._x=e,this):this._x}function Fb(e){return e[1]}function Ub(e){return arguments.length?(this._y=e,this):this._y}function w_(e,t,n){var r=new Nc(t??Mb,n??Fb,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Nc(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function bd(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ie=w_.prototype=Nc.prototype;ie.copy=function(){var e=new Nc(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=bd(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=bd(r));return e};ie.add=Ib;ie.addAll=Rb;ie.cover=Sb;ie.data=bb;ie.extent=Cb;ie.find=Pb;ie.remove=xb;ie.removeAll=Vb;ie.root=Nb;ie.size=Db;ie.visit=kb;ie.visitAfter=Ob;ie.x=Lb;ie.y=Ub;function fn(e){return function(){return e}}function Br(e){return(e()-.5)*1e-6}function Bb(e){return e.index}function Cd(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function $b(e){var t=Bb,n=d,r,i=fn(30),s,o,u,c,l,h=1;e==null&&(e=[]);function d(v){return 1/Math.min(u[v.source.index],u[v.target.index])}function p(v){for(var P=0,b=e.length;P<h;++P)for(var N=0,x,M,U,I,w,T,S;N<b;++N)x=e[N],M=x.source,U=x.target,I=U.x+U.vx-M.x-M.vx||Br(l),w=U.y+U.vy-M.y-M.vy||Br(l),T=Math.sqrt(I*I+w*w),T=(T-s[N])/T*v*r[N],I*=T,w*=T,U.vx-=I*(S=c[N]),U.vy-=w*S,M.vx+=I*(S=1-S),M.vy+=w*S}function g(){if(o){var v,P=o.length,b=e.length,N=new Map(o.map((M,U)=>[t(M,U,o),M])),x;for(v=0,u=new Array(P);v<b;++v)x=e[v],x.index=v,typeof x.source!="object"&&(x.source=Cd(N,x.source)),typeof x.target!="object"&&(x.target=Cd(N,x.target)),u[x.source.index]=(u[x.source.index]||0)+1,u[x.target.index]=(u[x.target.index]||0)+1;for(v=0,c=new Array(b);v<b;++v)x=e[v],c[v]=u[x.source.index]/(u[x.source.index]+u[x.target.index]);r=new Array(b),_(),s=new Array(b),E()}}function _(){if(o)for(var v=0,P=e.length;v<P;++v)r[v]=+n(e[v],v,e)}function E(){if(o)for(var v=0,P=e.length;v<P;++v)s[v]=+i(e[v],v,e)}return p.initialize=function(v,P){o=v,l=P,g()},p.links=function(v){return arguments.length?(e=v,g(),p):e},p.id=function(v){return arguments.length?(t=v,p):t},p.iterations=function(v){return arguments.length?(h=+v,p):h},p.strength=function(v){return arguments.length?(n=typeof v=="function"?v:fn(+v),_(),p):n},p.distance=function(v){return arguments.length?(i=typeof v=="function"?v:fn(+v),E(),p):i},p}const qb=1664525,zb=1013904223,Pd=4294967296;function jb(){let e=1;return()=>(e=(qb*e+zb)%Pd)/Pd}function Hb(e){return e.x}function Gb(e){return e.y}var Wb=10,Kb=Math.PI*(3-Math.sqrt(5));function Qb(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,u=new Map,c=Pc(d),l=Ic("tick","end"),h=jb();e==null&&(e=[]);function d(){p(),l.call("tick",t),n<r&&(c.stop(),l.call("end",t))}function p(E){var v,P=e.length,b;E===void 0&&(E=1);for(var N=0;N<E;++N)for(n+=(s-n)*i,u.forEach(function(x){x(n)}),v=0;v<P;++v)b=e[v],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function g(){for(var E=0,v=e.length,P;E<v;++E){if(P=e[E],P.index=E,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var b=Wb*Math.sqrt(.5+E),N=E*Kb;P.x=b*Math.cos(N),P.y=b*Math.sin(N)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function _(E){return E.initialize&&E.initialize(e,h),E}return g(),t={tick:p,restart:function(){return c.restart(d),t},stop:function(){return c.stop(),t},nodes:function(E){return arguments.length?(e=E,g(),u.forEach(_),t):e},alpha:function(E){return arguments.length?(n=+E,t):n},alphaMin:function(E){return arguments.length?(r=+E,t):r},alphaDecay:function(E){return arguments.length?(i=+E,t):+i},alphaTarget:function(E){return arguments.length?(s=+E,t):s},velocityDecay:function(E){return arguments.length?(o=1-E,t):1-o},randomSource:function(E){return arguments.length?(h=E,u.forEach(_),t):h},force:function(E,v){return arguments.length>1?(v==null?u.delete(E):u.set(E,_(v)),t):u.get(E)},find:function(E,v,P){var b=0,N=e.length,x,M,U,I,w;for(P==null?P=1/0:P*=P,b=0;b<N;++b)I=e[b],x=E-I.x,M=v-I.y,U=x*x+M*M,U<P&&(w=I,P=U);return w},on:function(E,v){return arguments.length>1?(l.on(E,v),t):l.on(E)}}}function Xb(){var e,t,n,r,i=fn(-30),s,o=1,u=1/0,c=.81;function l(g){var _,E=e.length,v=w_(e,Hb,Gb).visitAfter(d);for(r=g,_=0;_<E;++_)t=e[_],v.visit(p)}function h(){if(e){var g,_=e.length,E;for(s=new Array(_),g=0;g<_;++g)E=e[g],s[E.index]=+i(E,g,e)}}function d(g){var _=0,E,v,P=0,b,N,x;if(g.length){for(b=N=x=0;x<4;++x)(E=g[x])&&(v=Math.abs(E.value))&&(_+=E.value,P+=v,b+=v*E.x,N+=v*E.y);g.x=b/P,g.y=N/P}else{E=g,E.x=E.data.x,E.y=E.data.y;do _+=s[E.data.index];while(E=E.next)}g.value=_}function p(g,_,E,v){if(!g.value)return!0;var P=g.x-t.x,b=g.y-t.y,N=v-_,x=P*P+b*b;if(N*N/c<x)return x<u&&(P===0&&(P=Br(n),x+=P*P),b===0&&(b=Br(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)),t.vx+=P*g.value*r/x,t.vy+=b*g.value*r/x),!0;if(g.length||x>=u)return;(g.data!==t||g.next)&&(P===0&&(P=Br(n),x+=P*P),b===0&&(b=Br(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)));do g.data!==t&&(N=s[g.data.index]*r/x,t.vx+=P*N,t.vy+=b*N);while(g=g.next)}return l.initialize=function(g,_){e=g,n=_,h()},l.strength=function(g){return arguments.length?(i=typeof g=="function"?g:fn(+g),h(),l):i},l.distanceMin=function(g){return arguments.length?(o=g*g,l):Math.sqrt(o)},l.distanceMax=function(g){return arguments.length?(u=g*g,l):Math.sqrt(u)},l.theta=function(g){return arguments.length?(c=g*g,l):Math.sqrt(c)},l}function Yb(e,t,n){var r,i=fn(.1),s,o;typeof e!="function"&&(e=fn(+e)),t==null&&(t=0),n==null&&(n=0);function u(l){for(var h=0,d=r.length;h<d;++h){var p=r[h],g=p.x-t||1e-6,_=p.y-n||1e-6,E=Math.sqrt(g*g+_*_),v=(o[h]-E)*s[h]*l/E;p.vx+=g*v,p.vy+=_*v}}function c(){if(r){var l,h=r.length;for(s=new Array(h),o=new Array(h),l=0;l<h;++l)o[l]=+e(r[l],l,r),s[l]=isNaN(o[l])?0:+i(r[l],l,r)}}return u.initialize=function(l){r=l,c()},u.strength=function(l){return arguments.length?(i=typeof l=="function"?l:fn(+l),c(),u):i},u.radius=function(l){return arguments.length?(e=typeof l=="function"?l:fn(+l),c(),u):e},u.x=function(l){return arguments.length?(t=+l,u):t},u.y=function(l){return arguments.length?(n=+l,u):n},u}var pt=1e-6,st=Math.PI,be=st/2,xd=st/4,Ve=st*2,cn=180/st,we=st/180,vt=Math.abs,Jb=Math.atan,ls=Math.atan2,Rt=Math.cos,St=Math.sin,Zb=Math.sign||function(e){return e>0?1:e<0?-1:0},Rr=Math.sqrt;function tC(e){return e>1?0:e<-1?st:Math.acos(e)}function cs(e){return e>1?be:e<-1?-be:Math.asin(e)}function Ce(){}function Ko(e,t){e&&Nd.hasOwnProperty(e.type)&&Nd[e.type](e,t)}var Vd={Feature:function(e,t){Ko(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Ko(n[r].geometry,t)}},Nd={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){rl(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)rl(n[r],t,0)},Polygon:function(e,t){Dd(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Dd(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Ko(n[r],t)}};function rl(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function Dd(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)rl(e[n],t,1);t.polygonEnd()}function Ur(e,t){e&&Vd.hasOwnProperty(e.type)?Vd[e.type](e,t):Ko(e,t)}function il(e){return[ls(e[1],e[0]),cs(e[2])]}function Zr(e){var t=e[0],n=e[1],r=Rt(n);return[r*Rt(t),r*St(t),St(n)]}function Ys(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Qo(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function du(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Js(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function sl(e){var t=Rr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function ol(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function al(e,t){return vt(e)>st&&(e-=Math.round(e/Ve)*Ve),[e,t]}al.invert=al;function eC(e,t,n){return(e%=Ve)?t||n?ol(Od(e),Md(t,n)):Od(e):t||n?Md(t,n):al}function kd(e){return function(t,n){return t+=e,vt(t)>st&&(t-=Math.round(t/Ve)*Ve),[t,n]}}function Od(e){var t=kd(e);return t.invert=kd(-e),t}function Md(e,t){var n=Rt(e),r=St(e),i=Rt(t),s=St(t);function o(u,c){var l=Rt(c),h=Rt(u)*l,d=St(u)*l,p=St(c),g=p*n+h*r;return[ls(d*i-g*s,h*n-p*r),cs(g*i+d*s)]}return o.invert=function(u,c){var l=Rt(c),h=Rt(u)*l,d=St(u)*l,p=St(c),g=p*i-d*s;return[ls(d*i+p*s,h*n+g*r),cs(g*n-h*r)]},o}function nC(e,t,n,r,i,s){if(n){var o=Rt(t),u=St(t),c=r*n;i==null?(i=t+r*Ve,s=t-c/2):(i=Ld(o,i),s=Ld(o,s),(r>0?i<s:i>s)&&(i+=r*Ve));for(var l,h=i;r>0?h>s:h<s;h-=c)l=il([o,-u*Rt(h),-u*St(h)]),e.point(l[0],l[1])}}function Ld(e,t){t=Zr(t),t[0]-=e,sl(t);var n=tC(-t[1]);return((-t[2]<0?-n:n)+Ve-pt)%Ve}function E_(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Ce,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function mo(e,t){return vt(e[0]-t[0])<pt&&vt(e[1]-t[1])<pt}function Zs(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function T_(e,t,n,r,i){var s=[],o=[],u,c;if(e.forEach(function(_){if(!((E=_.length-1)<=0)){var E,v=_[0],P=_[E],b;if(mo(v,P)){if(!v[2]&&!P[2]){for(i.lineStart(),u=0;u<E;++u)i.point((v=_[u])[0],v[1]);i.lineEnd();return}P[0]+=2*pt}s.push(b=new Zs(v,_,null,!0)),o.push(b.o=new Zs(v,null,b,!1)),s.push(b=new Zs(P,_,null,!1)),o.push(b.o=new Zs(P,null,b,!0))}}),!!s.length){for(o.sort(t),Fd(s),Fd(o),u=0,c=o.length;u<c;++u)o[u].e=n=!n;for(var l=s[0],h,d;;){for(var p=l,g=!0;p.v;)if((p=p.n)===l)return;h=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(u=0,c=h.length;u<c;++u)i.point((d=h[u])[0],d[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(g)for(h=p.p.z,u=h.length-1;u>=0;--u)i.point((d=h[u])[0],d[1]);else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,h=p.z,g=!g}while(!p.v);i.lineEnd()}}}function Fd(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function pu(e){return vt(e[0])<=st?e[0]:Zb(e[0])*((vt(e[0])+st)%Ve-st)}function rC(e,t){var n=pu(t),r=t[1],i=St(r),s=[St(n),-Rt(n),0],o=0,u=0,c=new vr;i===1?r=be+pt:i===-1&&(r=-be-pt);for(var l=0,h=e.length;l<h;++l)if(p=(d=e[l]).length)for(var d,p,g=d[p-1],_=pu(g),E=g[1]/2+xd,v=St(E),P=Rt(E),b=0;b<p;++b,_=x,v=U,P=I,g=N){var N=d[b],x=pu(N),M=N[1]/2+xd,U=St(M),I=Rt(M),w=x-_,T=w>=0?1:-1,S=T*w,R=S>st,C=v*U;if(c.add(ls(C*T*St(S),P*I+C*Rt(S))),o+=R?w+T*Ve:w,R^_>=n^x>=n){var A=Qo(Zr(g),Zr(N));sl(A);var X=Qo(s,A);sl(X);var F=(R^w>=0?-1:1)*cs(X[2]);(r>F||r===F&&(A[0]||A[1]))&&(u+=R^w>=0?1:-1)}}return(o<-pt||o<pt&&c<-1e-12)^u&1}function A_(e,t,n,r){return function(i){var s=t(i),o=E_(),u=t(o),c=!1,l,h,d,p={point:g,lineStart:E,lineEnd:v,polygonStart:function(){p.point=P,p.lineStart=b,p.lineEnd=N,h=[],l=[]},polygonEnd:function(){p.point=g,p.lineStart=E,p.lineEnd=v,h=Qg(h);var x=rC(l,r);h.length?(c||(i.polygonStart(),c=!0),T_(h,sC,x,n,i)):x&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),h=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function g(x,M){e(x,M)&&i.point(x,M)}function _(x,M){s.point(x,M)}function E(){p.point=_,s.lineStart()}function v(){p.point=g,s.lineEnd()}function P(x,M){d.push([x,M]),u.point(x,M)}function b(){u.lineStart(),d=[]}function N(){P(d[0][0],d[0][1]),u.lineEnd();var x=u.clean(),M=o.result(),U,I=M.length,w,T,S;if(d.pop(),l.push(d),d=null,!!I){if(x&1){if(T=M[0],(w=T.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),U=0;U<w;++U)i.point((S=T[U])[0],S[1]);i.lineEnd()}return}I>1&&x&2&&M.push(M.pop().concat(M.shift())),h.push(M.filter(iC))}}return p}}function iC(e){return e.length>1}function sC(e,t){return((e=e.x)[0]<0?e[1]-be-pt:be-e[1])-((t=t.x)[0]<0?t[1]-be-pt:be-t[1])}const Ud=A_(function(){return!0},oC,uC,[-st,-be]);function oC(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var u=s>0?st:-st,c=vt(s-t);vt(c-st)<pt?(e.point(t,n=(n+o)/2>0?be:-be),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&c>=st&&(vt(t-r)<pt&&(t-=r*pt),vt(s-u)<pt&&(s-=u*pt),n=aC(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=o),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function aC(e,t,n,r){var i,s,o=St(e-n);return vt(o)>pt?Jb((St(t)*(s=Rt(r))*St(n)-St(r)*(i=Rt(t))*St(e))/(i*s*o)):(t+r)/2}function uC(e,t,n,r){var i;if(e==null)i=n*be,r.point(-st,i),r.point(0,i),r.point(st,i),r.point(st,0),r.point(st,-i),r.point(0,-i),r.point(-st,-i),r.point(-st,0),r.point(-st,i);else if(vt(e[0]-t[0])>pt){var s=e[0]<t[0]?st:-st;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function lC(e){var t=Rt(e),n=2*we,r=t>0,i=vt(t)>pt;function s(h,d,p,g){nC(g,e,n,p,h,d)}function o(h,d){return Rt(h)*Rt(d)>t}function u(h){var d,p,g,_,E;return{lineStart:function(){_=g=!1,E=1},point:function(v,P){var b=[v,P],N,x=o(v,P),M=r?x?0:l(v,P):x?l(v+(v<0?st:-st),P):0;if(!d&&(_=g=x)&&h.lineStart(),x!==g&&(N=c(d,b),(!N||mo(d,N)||mo(b,N))&&(b[2]=1)),x!==g)E=0,x?(h.lineStart(),N=c(b,d),h.point(N[0],N[1])):(N=c(d,b),h.point(N[0],N[1],2),h.lineEnd()),d=N;else if(i&&d&&r^x){var U;!(M&p)&&(U=c(b,d,!0))&&(E=0,r?(h.lineStart(),h.point(U[0][0],U[0][1]),h.point(U[1][0],U[1][1]),h.lineEnd()):(h.point(U[1][0],U[1][1]),h.lineEnd(),h.lineStart(),h.point(U[0][0],U[0][1],3)))}x&&(!d||!mo(d,b))&&h.point(b[0],b[1]),d=b,g=x,p=M},lineEnd:function(){g&&h.lineEnd(),d=null},clean:function(){return E|(_&&g)<<1}}}function c(h,d,p){var g=Zr(h),_=Zr(d),E=[1,0,0],v=Qo(g,_),P=Ys(v,v),b=v[0],N=P-b*b;if(!N)return!p&&h;var x=t*P/N,M=-t*b/N,U=Qo(E,v),I=Js(E,x),w=Js(v,M);du(I,w);var T=U,S=Ys(I,T),R=Ys(T,T),C=S*S-R*(Ys(I,I)-1);if(!(C<0)){var A=Rr(C),X=Js(T,(-S-A)/R);if(du(X,I),X=il(X),!p)return X;var F=h[0],Y=d[0],lt=h[1],mt=d[1],Mt;Y<F&&(Mt=F,F=Y,Y=Mt);var Fe=Y-F,me=vt(Fe-st)<pt,Lt=me||Fe<pt;if(!me&&mt<lt&&(Mt=lt,lt=mt,mt=Mt),Lt?me?lt+mt>0^X[1]<(vt(X[0]-F)<pt?lt:mt):lt<=X[1]&&X[1]<=mt:Fe>st^(F<=X[0]&&X[0]<=Y)){var ht=Js(T,(-S+A)/R);return du(ht,I),[X,il(ht)]}}}function l(h,d){var p=r?e:st-e,g=0;return h<-p?g|=1:h>p&&(g|=2),d<-p?g|=4:d>p&&(g|=8),g}return A_(o,u,s,r?[0,-e]:[-st,e-st])}function cC(e,t,n,r,i,s){var o=e[0],u=e[1],c=t[0],l=t[1],h=0,d=1,p=c-o,g=l-u,_;if(_=n-o,!(!p&&_>0)){if(_/=p,p<0){if(_<h)return;_<d&&(d=_)}else if(p>0){if(_>d)return;_>h&&(h=_)}if(_=i-o,!(!p&&_<0)){if(_/=p,p<0){if(_>d)return;_>h&&(h=_)}else if(p>0){if(_<h)return;_<d&&(d=_)}if(_=r-u,!(!g&&_>0)){if(_/=g,g<0){if(_<h)return;_<d&&(d=_)}else if(g>0){if(_>d)return;_>h&&(h=_)}if(_=s-u,!(!g&&_<0)){if(_/=g,g<0){if(_>d)return;_>h&&(h=_)}else if(g>0){if(_<h)return;_<d&&(d=_)}return h>0&&(e[0]=o+h*p,e[1]=u+h*g),d<1&&(t[0]=o+d*p,t[1]=u+d*g),!0}}}}}var Oi=1e9,to=-Oi;function hC(e,t,n,r){function i(l,h){return e<=l&&l<=n&&t<=h&&h<=r}function s(l,h,d,p){var g=0,_=0;if(l==null||(g=o(l,d))!==(_=o(h,d))||c(l,h)<0^d>0)do p.point(g===0||g===3?e:n,g>1?r:t);while((g=(g+d+4)%4)!==_);else p.point(h[0],h[1])}function o(l,h){return vt(l[0]-e)<pt?h>0?0:3:vt(l[0]-n)<pt?h>0?2:1:vt(l[1]-t)<pt?h>0?1:0:h>0?3:2}function u(l,h){return c(l.x,h.x)}function c(l,h){var d=o(l,1),p=o(h,1);return d!==p?d-p:d===0?h[1]-l[1]:d===1?l[0]-h[0]:d===2?l[1]-h[1]:h[0]-l[0]}return function(l){var h=l,d=E_(),p,g,_,E,v,P,b,N,x,M,U,I={point:w,lineStart:C,lineEnd:A,polygonStart:S,polygonEnd:R};function w(F,Y){i(F,Y)&&h.point(F,Y)}function T(){for(var F=0,Y=0,lt=g.length;Y<lt;++Y)for(var mt=g[Y],Mt=1,Fe=mt.length,me=mt[0],Lt,ht,In=me[0],se=me[1];Mt<Fe;++Mt)Lt=In,ht=se,me=mt[Mt],In=me[0],se=me[1],ht<=r?se>r&&(In-Lt)*(r-ht)>(se-ht)*(e-Lt)&&++F:se<=r&&(In-Lt)*(r-ht)<(se-ht)*(e-Lt)&&--F;return F}function S(){h=d,p=[],g=[],U=!0}function R(){var F=T(),Y=U&&F,lt=(p=Qg(p)).length;(Y||lt)&&(l.polygonStart(),Y&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),lt&&T_(p,u,F,s,l),l.polygonEnd()),h=l,p=g=_=null}function C(){I.point=X,g&&g.push(_=[]),M=!0,x=!1,b=N=NaN}function A(){p&&(X(E,v),P&&x&&d.rejoin(),p.push(d.result())),I.point=w,x&&h.lineEnd()}function X(F,Y){var lt=i(F,Y);if(g&&_.push([F,Y]),M)E=F,v=Y,P=lt,M=!1,lt&&(h.lineStart(),h.point(F,Y));else if(lt&&x)h.point(F,Y);else{var mt=[b=Math.max(to,Math.min(Oi,b)),N=Math.max(to,Math.min(Oi,N))],Mt=[F=Math.max(to,Math.min(Oi,F)),Y=Math.max(to,Math.min(Oi,Y))];cC(mt,Mt,e,t,n,r)?(x||(h.lineStart(),h.point(mt[0],mt[1])),h.point(Mt[0],Mt[1]),lt||h.lineEnd(),U=!1):lt&&(h.lineStart(),h.point(F,Y),U=!1)}b=F,N=Y,x=lt}return I}}const ul=e=>e;var mu=new vr,ll=new vr,I_,R_,cl,hl,hn={point:Ce,lineStart:Ce,lineEnd:Ce,polygonStart:function(){hn.lineStart=fC,hn.lineEnd=pC},polygonEnd:function(){hn.lineStart=hn.lineEnd=hn.point=Ce,mu.add(vt(ll)),ll=new vr},result:function(){var e=mu/2;return mu=new vr,e}};function fC(){hn.point=dC}function dC(e,t){hn.point=S_,I_=cl=e,R_=hl=t}function S_(e,t){ll.add(hl*e-cl*t),cl=e,hl=t}function pC(){S_(I_,R_)}var ti=1/0,Xo=ti,hs=-ti,Yo=hs,Jo={point:mC,lineStart:Ce,lineEnd:Ce,polygonStart:Ce,polygonEnd:Ce,result:function(){var e=[[ti,Xo],[hs,Yo]];return hs=Yo=-(Xo=ti=1/0),e}};function mC(e,t){e<ti&&(ti=e),e>hs&&(hs=e),t<Xo&&(Xo=t),t>Yo&&(Yo=t)}var fl=0,dl=0,Mi=0,Zo=0,ta=0,$r=0,pl=0,ml=0,Li=0,b_,C_,We,Ke,Se={point:Er,lineStart:Bd,lineEnd:$d,polygonStart:function(){Se.lineStart=yC,Se.lineEnd=vC},polygonEnd:function(){Se.point=Er,Se.lineStart=Bd,Se.lineEnd=$d},result:function(){var e=Li?[pl/Li,ml/Li]:$r?[Zo/$r,ta/$r]:Mi?[fl/Mi,dl/Mi]:[NaN,NaN];return fl=dl=Mi=Zo=ta=$r=pl=ml=Li=0,e}};function Er(e,t){fl+=e,dl+=t,++Mi}function Bd(){Se.point=gC}function gC(e,t){Se.point=_C,Er(We=e,Ke=t)}function _C(e,t){var n=e-We,r=t-Ke,i=Rr(n*n+r*r);Zo+=i*(We+e)/2,ta+=i*(Ke+t)/2,$r+=i,Er(We=e,Ke=t)}function $d(){Se.point=Er}function yC(){Se.point=wC}function vC(){P_(b_,C_)}function wC(e,t){Se.point=P_,Er(b_=We=e,C_=Ke=t)}function P_(e,t){var n=e-We,r=t-Ke,i=Rr(n*n+r*r);Zo+=i*(We+e)/2,ta+=i*(Ke+t)/2,$r+=i,i=Ke*e-We*t,pl+=i*(We+e),ml+=i*(Ke+t),Li+=i*3,Er(We=e,Ke=t)}function x_(e){this._context=e}x_.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ve);break}}},result:Ce};var gl=new vr,gu,V_,N_,Fi,Ui,fs={point:Ce,lineStart:function(){fs.point=EC},lineEnd:function(){gu&&D_(V_,N_),fs.point=Ce},polygonStart:function(){gu=!0},polygonEnd:function(){gu=null},result:function(){var e=+gl;return gl=new vr,e}};function EC(e,t){fs.point=D_,V_=Fi=e,N_=Ui=t}function D_(e,t){Fi-=e,Ui-=t,gl.add(Rr(Fi*Fi+Ui*Ui)),Fi=e,Ui=t}let qd,ea,zd,jd;class Hd{constructor(t){this._append=t==null?k_:TC(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==zd||this._append!==ea){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,zd=r,ea=this._append,jd=this._,this._=i}this._+=jd;break}}}result(){const t=this._;return this._="",t.length?t:null}}function k_(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function TC(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return k_;if(t!==qd){const n=10**t;qd=t,ea=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return ea}function AC(e,t){let n=3,r=4.5,i,s;function o(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Ur(u,i(s))),s.result()}return o.area=function(u){return Ur(u,i(hn)),hn.result()},o.measure=function(u){return Ur(u,i(fs)),fs.result()},o.bounds=function(u){return Ur(u,i(Jo)),Jo.result()},o.centroid=function(u){return Ur(u,i(Se)),Se.result()},o.projection=function(u){return arguments.length?(i=u==null?(e=null,ul):(e=u).stream,o):e},o.context=function(u){return arguments.length?(s=u==null?(t=null,new Hd(n)):new x_(t=u),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),o):r},o.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const c=Math.floor(u);if(!(c>=0))throw new RangeError(`invalid digits: ${u}`);n=c}return t===null&&(s=new Hd(n)),o},o.projection(e).digits(n).context(t)}function Dc(e){return function(t){var n=new _l;for(var r in e)n[r]=e[r];return n.stream=t,n}}function _l(){}_l.prototype={constructor:_l,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function kc(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Ur(n,e.stream(Jo)),t(Jo.result()),r!=null&&e.clipExtent(r),e}function O_(e,t,n){return kc(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([u,c])},n)}function IC(e,t,n){return O_(e,[[0,0],t],n)}function RC(e,t,n){return kc(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([o,u])},n)}function SC(e,t,n){return kc(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,u])},n)}var Gd=16,bC=Rt(30*we);function Wd(e,t){return+t?PC(e,t):CC(e)}function CC(e){return Dc({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function PC(e,t){function n(r,i,s,o,u,c,l,h,d,p,g,_,E,v){var P=l-r,b=h-i,N=P*P+b*b;if(N>4*t&&E--){var x=o+p,M=u+g,U=c+_,I=Rr(x*x+M*M+U*U),w=cs(U/=I),T=vt(vt(U)-1)<pt||vt(s-d)<pt?(s+d)/2:ls(M,x),S=e(T,w),R=S[0],C=S[1],A=R-r,X=C-i,F=b*A-P*X;(F*F/N>t||vt((P*A+b*X)/N-.5)>.3||o*p+u*g+c*_<bC)&&(n(r,i,s,o,u,c,R,C,T,x/=I,M/=I,U,E,v),v.point(R,C),n(R,C,T,x,M,U,l,h,d,p,g,_,E,v))}}return function(r){var i,s,o,u,c,l,h,d,p,g,_,E,v={point:P,lineStart:b,lineEnd:x,polygonStart:function(){r.polygonStart(),v.lineStart=M},polygonEnd:function(){r.polygonEnd(),v.lineStart=b}};function P(w,T){w=e(w,T),r.point(w[0],w[1])}function b(){d=NaN,v.point=N,r.lineStart()}function N(w,T){var S=Zr([w,T]),R=e(w,T);n(d,p,h,g,_,E,d=R[0],p=R[1],h=w,g=S[0],_=S[1],E=S[2],Gd,r),r.point(d,p)}function x(){v.point=P,r.lineEnd()}function M(){b(),v.point=U,v.lineEnd=I}function U(w,T){N(i=w,T),s=d,o=p,u=g,c=_,l=E,v.point=N}function I(){n(d,p,h,g,_,E,s,o,i,u,c,l,Gd,r),v.lineEnd=x,x()}return v}}var xC=Dc({point:function(e,t){this.stream.point(e*we,t*we)}});function VC(e){return Dc({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function NC(e,t,n,r,i){function s(o,u){return o*=r,u*=i,[t+e*o,n-e*u]}return s.invert=function(o,u){return[(o-t)/e*r,(n-u)/e*i]},s}function Kd(e,t,n,r,i,s){if(!s)return NC(e,t,n,r,i);var o=Rt(s),u=St(s),c=o*e,l=u*e,h=o/e,d=u/e,p=(u*n-o*t)/e,g=(u*t+o*n)/e;function _(E,v){return E*=r,v*=i,[c*E-l*v+t,n-l*E-c*v]}return _.invert=function(E,v){return[r*(h*E-d*v+p),i*(g-d*E-h*v)]},_}function DC(e){return kC(function(){return e})()}function kC(e){var t,n=150,r=480,i=250,s=0,o=0,u=0,c=0,l=0,h,d=0,p=1,g=1,_=null,E=Ud,v=null,P,b,N,x=ul,M=.5,U,I,w,T,S;function R(F){return w(F[0]*we,F[1]*we)}function C(F){return F=w.invert(F[0],F[1]),F&&[F[0]*cn,F[1]*cn]}R.stream=function(F){return T&&S===F?T:T=xC(VC(h)(E(U(x(S=F)))))},R.preclip=function(F){return arguments.length?(E=F,_=void 0,X()):E},R.postclip=function(F){return arguments.length?(x=F,v=P=b=N=null,X()):x},R.clipAngle=function(F){return arguments.length?(E=+F?lC(_=F*we):(_=null,Ud),X()):_*cn},R.clipExtent=function(F){return arguments.length?(x=F==null?(v=P=b=N=null,ul):hC(v=+F[0][0],P=+F[0][1],b=+F[1][0],N=+F[1][1]),X()):v==null?null:[[v,P],[b,N]]},R.scale=function(F){return arguments.length?(n=+F,A()):n},R.translate=function(F){return arguments.length?(r=+F[0],i=+F[1],A()):[r,i]},R.center=function(F){return arguments.length?(s=F[0]%360*we,o=F[1]%360*we,A()):[s*cn,o*cn]},R.rotate=function(F){return arguments.length?(u=F[0]%360*we,c=F[1]%360*we,l=F.length>2?F[2]%360*we:0,A()):[u*cn,c*cn,l*cn]},R.angle=function(F){return arguments.length?(d=F%360*we,A()):d*cn},R.reflectX=function(F){return arguments.length?(p=F?-1:1,A()):p<0},R.reflectY=function(F){return arguments.length?(g=F?-1:1,A()):g<0},R.precision=function(F){return arguments.length?(U=Wd(I,M=F*F),X()):Rr(M)},R.fitExtent=function(F,Y){return O_(R,F,Y)},R.fitSize=function(F,Y){return IC(R,F,Y)},R.fitWidth=function(F,Y){return RC(R,F,Y)},R.fitHeight=function(F,Y){return SC(R,F,Y)};function A(){var F=Kd(n,0,0,p,g,d).apply(null,t(s,o)),Y=Kd(n,r-F[0],i-F[1],p,g,d);return h=eC(u,c,l),I=ol(t,Y),w=ol(h,I),U=Wd(I,M),X()}function X(){return T=S=null,R}return function(){return t=e.apply(this,arguments),R.invert=t.invert&&C,A()}}function M_(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}M_.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(vt(i)>pt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function OC(){return DC(M_).scale(175.295)}function Bi(e,t,n){this.k=e,this.x=t,this.y=n}Bi.prototype={constructor:Bi,scale:function(e){return e===1?this:new Bi(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Bi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Bi.prototype;function MC(e){return e}function LC(e){if(e==null)return MC;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(u,c){c||(t=n=0);var l=2,h=u.length,d=new Array(h);for(d[0]=(t+=u[0])*r+s,d[1]=(n+=u[1])*i+o;l<h;)d[l]=u[l],++l;return d}}function FC(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function Qd(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Xd(e,n)})}:Xd(e,t)}function Xd(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=UC(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function UC(e,t){var n=LC(e.transform),r=e.arcs;function i(h,d){d.length&&d.pop();for(var p=r[h<0?~h:h],g=0,_=p.length;g<_;++g)d.push(n(p[g],g));h<0&&FC(d,_)}function s(h){return n(h)}function o(h){for(var d=[],p=0,g=h.length;p<g;++p)i(h[p],d);return d.length<2&&d.push(d[0]),d}function u(h){for(var d=o(h);d.length<4;)d.push(d[0]);return d}function c(h){return h.map(u)}function l(h){var d=h.type,p;switch(d){case"GeometryCollection":return{type:d,geometries:h.geometries.map(l)};case"Point":p=s(h.coordinates);break;case"MultiPoint":p=h.coordinates.map(s);break;case"LineString":p=o(h.arcs);break;case"MultiLineString":p=h.arcs.map(o);break;case"Polygon":p=c(h.arcs);break;case"MultiPolygon":p=h.arcs.map(c);break;default:return null}return{type:d,coordinates:p}}return l(t)}var BC=An('<div class="loading-indicator svelte-orzfhr">Loading...</div>'),$C=An('<img alt="Header image"/>'),qC=(e,t)=>{e.key==="Enter"&&t()},zC=ds('<path fill="#ADC2CE" stroke="#377293" stroke-width="0.5"></path>'),jC=(e,t,n)=>{ut(t,$(n).domain,!0),console.log("Pin Domain:",$(t))},HC=(e,t)=>ut(t,null),GC=ds('<g class="location-pin svelte-orzfhr"><circle class="pin svelte-orzfhr"></circle></g>'),WC=ds(" <!>",1),KC=An('<svg width="200" height="125" viewBox="0 0 200 125" class="world-map svelte-orzfhr"><!><!></svg> <p class="map-caption svelte-orzfhr"><!></p>',1),QC=An("<p>Loading world map...</p>"),XC=(e,t,n,r)=>{ut(t,n($(r).link),!0),console.log("Hovered Domain:",$(t))},YC=(e,t)=>ut(t,null),JC=An('<div class="image-with-title svelte-orzfhr"><a target="_blank" rel="noopener noreferrer"><img class="svelte-orzfhr"/></a> <div class="image-title-box"><!></div></div>'),ZC=An('<div class="image-container svelte-orzfhr"></div>'),tP=An('<div class="no-images-placeholder svelte-orzfhr"><p>Your search results will appear here</p></div>'),eP=ds('<line stroke="#fff" stroke-opacity="0.6" stroke-width="2" class="svelte-orzfhr"></line>'),nP=(e,t)=>console.log($(t).id),rP=ds('<text fill="steelblue" text-anchor="middle" alignment-baseline="middle" filter="url(#dropshadow)" class="svelte-orzfhr"> </text>'),iP=An('<li class="svelte-orzfhr"> <span class="count svelte-orzfhr"> </span></li>'),sP=An(`<main class="svelte-orzfhr"><!> <div class="header svelte-orzfhr"><div class="header-image-crossfade svelte-orzfhr"></div> <div><div class="title svelte-orzfhr">GREAT WAVE <span style="color: #F0BF91;">REMIX</span></div> <p class="subtitle svelte-orzfhr">Discover Hokusai's "Great Wave off Kanagawa" in diverse and unexpected
        contexts worldwide. Search for any term to see how this iconic Japanese artwork
        appears in images across various topics and countries.</p></div></div> <div class="header-piping svelte-orzfhr"></div> <h1 class="svelte-orzfhr">HOKUSAI'S <em class="italic svelte-orzfhr">GREAT WAVE</em> CAN BE <input type="text" placeholder="ANYTHING" class="svelte-orzfhr"/> <div class="search-container svelte-orzfhr"><div class="button-wrapper svelte-orzfhr"><button class="svelte-orzfhr">Search</button></div> <div class="call-to-action svelte-orzfhr">No images yet â try a search!</div></div></h1> <div class="main-grid svelte-orzfhr"><div class="left-column svelte-orzfhr"><div class="map-container svelte-orzfhr"><!></div> <!></div> <div class="right-column svelte-orzfhr"><div class="word-cloud-container svelte-orzfhr"><h3 class="svelte-orzfhr">Trending topics</h3> <svg width="100%" height="400" viewBox="0 0 400 400" class="svelte-orzfhr"><defs><filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.3"></feDropShadow></filter></defs><g style="transform: translate(0, -100px)"><!><!></g></svg> <div class="trending-panel svelte-orzfhr"><ul class="svelte-orzfhr"></ul></div></div></div></div> <h2 class="svelte-orzfhr">Google Ngram Viewer shows a steady rise in mentions of "Great Wave off
    Kanagawa"</h2> <div class="bottom-panel svelte-orzfhr"><div class="chart-container svelte-orzfhr"><iframe name="ngram_chart" src="https://books.google.com/ngrams/interactive_chart?content=Great+Wave+off+Kanagawa&amp;year_start=1800&amp;year_end=2022&amp;corpus=en&amp;smoothing=3" width="900" height="400" marginwidth="50" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" class="svelte-orzfhr"></iframe></div></div></main>`);function oP(e,t){up(t,!0);let n=Ft(0),r;const i=["/great-wave-everywhere/main-image.jpeg","/great-wave-everywhere/tomoko_nagao_hokusai-the_great_wave_of_kanagawa_with_mc_cupnoodle_kewpie_kikkoman_and_kitty_2012_digital_art_50_x_70_cm-_70_x_100_cm.jpe_3.jpg","/great-wave-everywhere/135e9cb8ff232a9c7e1f1be108eb670f.jpg","/great-wave-everywhere/2372ef58832305.5a0b25df284b7.jpg.webp","/great-wave-everywhere/image_BT0qjFvT31.png.jpeg"];Eu(()=>{r=setInterval(()=>{ut(n,($(n)+1)%i.length)},5e3)}),Tv(()=>{clearInterval(r)});function s(H){if(!H)return null;try{return H.replace(/^https?:\/\//,"").split("?")[0].replace(/\/$/,"")}catch{return null}}function o(H){if(!H)return null;try{const z=H.startsWith("http")?H:`https://${H}`;return new URL(z).hostname}catch{return H}}let u=Ft(null),c=Ft(He([])),l=Ft(""),h=Ft(He([])),d=Ft(He([])),p=Ft(He([])),g=Ft(!1),_=Ft(He([])),E=Ft(null);async function v(){try{const H=await fetch("/great-wave-everywhere/ne_110m_admin_0_countries.json");if(!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const z=await H.json(),J=Object.keys(z.objects)[0];ut(E,Qd(z,z.objects[J]),!0)}catch{try{const z=await fetch("/ne_110m_admin_0_countries.json");if(z.ok){const J=await z.json(),nt=Object.keys(J.objects)[0];ut(E,Qd(J,J.objects[nt]),!0)}}catch{}}}Eu(async()=>{ut(g,!0);try{try{ut(h,await Xf(),!0),ut(p,await Yf(5),!0),b(),N()}catch(H){console.warn("Firebase connection failed:",H),ut(h,[],!0),ut(p,[],!0)}await v()}finally{ut(g,!1)}});async function P(){if($(l)){ut(g,!0);try{const H=await At.get(`https://great-wave-api-1muq.onrender.com/api/images?q=${$(l)}`);ut(c,H.data,!0);const z=$(c).map(nt=>nt.link).filter(Boolean);let J=[];if(z.length>0)try{J=(await At.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:z})).data,console.log("Geolocation API data:",J)}catch{}ut(_,J.filter(nt=>{if(nt==null)return!1;const $t=Number(nt.lat),Dt=Number(nt.lng);return!(isNaN($t)||isNaN(Dt)||$t===0&&Dt===0)}),!0);try{await P1($(l)),ut(h,await Xf(),!0),ut(p,await Yf(5),!0),b(),N()}catch(nt){console.warn("Firebase update failed:",nt)}ut(l,"")}catch(H){console.error("Error fetching images",H)}finally{ut(g,!1)}}}function b(){ut(d,[],!0);for(let H=1;H<$(h).length;H++)$(d).push({source:$(h)[H-1].id,target:$(h)[H].id})}function N(){const H=Math.max(...$(h).map(z=>z.count));Qb($(h)).force("link",$b($(d)).id(z=>z.id).distance(25)).force("charge",Xb().strength(-100)).force("center",Ab(200,300)).force("gravity",Yb(z=>150*(1-z.count/H),200,300).strength(.5)).force("boundary",()=>{$(h).forEach(z=>{z.x=Math.max(20,Math.min(380,z.x||0)),z.y=Math.max(20,Math.min(580,z.y||0))})}).on("tick",()=>{ut(h,[...$(h)],!0)})}function x(H){return $(h).find(z=>z.id===H)}function M(H){const z=x(H.source),J=x(H.target);return{x1:(z==null?void 0:z.x)||0,y1:(z==null?void 0:z.y)||0,x2:(J==null?void 0:J.x)||0,y2:(J==null?void 0:J.y)||0}}var U=sP(),I=Tt(U);{var w=H=>{var z=BC();kt(H,z)};Vn(I,H=>{$(g)&&H(w)})}var T=Kt(I,2),S=Tt(T);or(S,21,()=>i,sr,(H,z,J)=>{var nt=$C();let $t;ze(Dt=>{ee(nt,"src",$(z)),$t=gv(nt,1,"svelte-orzfhr",null,$t,Dt)},[()=>({visible:$(n)===J,hidden:$(n)!==J})]),kt(H,nt)});var R=Kt(T,4),C=Kt(Tt(R),3);C.__keydown=[qC,P];var A=Kt(C,2),X=Tt(A),F=Tt(X);F.__click=P;var Y=Kt(R,2),lt=Tt(Y),mt=Tt(lt),Mt=Tt(mt);{var Fe=H=>{var z=KC();const J=$s(()=>OC().scale(40).translate([100,62.5])),nt=$s(()=>AC().projection($(J)));var $t=Ri(z),Dt=Tt($t);or(Dt,17,()=>$(E).features,sr,(ge,Be,Ct)=>{var Pt=Ya();const oe=$s(()=>$(nt)($(Be)));var tr=Ri(Pt);{var Sn=ae=>{var $e=zC();ze(()=>ee($e,"d",$(oe))),kt(ae,$e)},Cr=ae=>{var $e=Dh();ze(_e=>Si($e,_e),[()=>{var _e;return console.log(`No path data for country ${Ct}:`,(_e=$(Be).geometry)==null?void 0:_e.type)}]),kt(ae,$e)};Vn(tr,ae=>{$(oe)?ae(Sn):ae(Cr,!1)})}kt(ge,Pt)});var Zt=Kt(Dt);{var Ue=ge=>{var Be=Ya(),Ct=Ri(Be);or(Ct,17,()=>$(_),sr,(Pt,oe)=>{var tr=WC();const Sn=$s(()=>$(J)([$(oe).lng,$(oe).lat]));var Cr=Ri(tr),ae=Kt(Cr);{var $e=_e=>{var bn=GC();bn.__mouseover=[jC,u,oe],bn.__mouseout=[HC,u];var Pr=Tt(bn);ze(()=>{ee(Pr,"cx",$(Sn)[0]),ee(Pr,"cy",$(Sn)[1]),ee(Pr,"r",$(u)===$(oe).domain?7:4),ee(Pr,"fill",$(u)===$(oe).domain?"#ff4500":"#ff6b35")}),kt(_e,bn)};Vn(ae,_e=>{$(Sn)&&_e($e)})}ze(_e=>Si(Cr,_e),[()=>console.log($(oe))]),kt(Pt,tr)}),kt(ge,Be)};Vn(Zt,ge=>{$(_).length>0&&ge(Ue)})}var Rn=Kt($t,2),Zn=Tt(Rn);{var on=ge=>{var Be=Dh("Rollover to see server locations");kt(ge,Be)};Vn(Zn,ge=>{$(_).length>0&&ge(on)})}kt(H,z)},me=H=>{var z=QC();kt(H,z)};Vn(Mt,H=>{$(E)?H(Fe):H(me,!1)})}var Lt=Kt(mt,2);{var ht=H=>{var z=ZC();or(z,21,()=>$(c),sr,(J,nt)=>{var $t=JC(),Dt=Tt($t),Zt=Tt(Dt);Zt.__mouseover=[XC,u,o,nt],Zt.__mouseout=[YC,u];var Ue=Kt(Dt,2),Rn=Tt(Ue);dv(Rn,()=>`<textarea readonly rows='2'>${$(nt).title}</textarea>`),ze((Zn,on)=>{ee(Dt,"href",$(nt).link),ee(Zt,"src",$(nt).link),Mh(Zt,`border: ${Zn??""};`),Mh(Ue,`background: ${on??""};`)},[()=>$(u)===o($(nt).link)?"2px solid #ff6b35":"none",()=>$(u)===s($(nt).link)?"#ffe5d0":"#f9f9f9"]),kt(J,$t)}),kt(H,z)},In=H=>{var z=tP();kt(H,z)};Vn(Lt,H=>{$(c).length>0?H(ht):H(In,!1)})}var se=Kt(lt,2),Va=Tt(se),Jn=Kt(Tt(Va),2),Na=Kt(Tt(Jn)),Rs=Tt(Na);or(Rs,17,()=>$(d),sr,(H,z)=>{var J=Ya(),nt=Ri(J);{var $t=Dt=>{var Zt=eP();ze((Ue,Rn,Zn,on)=>{ee(Zt,"x1",Ue),ee(Zt,"y1",Rn),ee(Zt,"x2",Zn),ee(Zt,"y2",on)},[()=>M($(z)).x1,()=>M($(z)).y1,()=>M($(z)).x2,()=>M($(z)).y2]),kt(Dt,Zt)};Vn(nt,Dt=>{x($(z).source)&&x($(z).target)&&Dt($t)})}kt(H,J)});var Sr=Kt(Rs);or(Sr,17,()=>$(h),sr,(H,z)=>{var J=rP();J.__mouseover=[nP,z];var nt=Tt(J);ze(()=>{ee(J,"x",$(z).x),ee(J,"y",$(z).y),ee(J,"font-size",`${10*$(z).count}px`),Si(nt,$(z).id)}),kt(H,J)});var br=Kt(Jn,2),fi=Tt(br);or(fi,21,()=>$(p),sr,(H,z)=>{var J=iP(),nt=Tt(J),$t=Kt(nt),Dt=Tt($t);ze(()=>{Si(nt,`${$(z).id??""} `),Si(Dt,`(${$(z).count??""})`)}),kt(H,J)}),Ev(C,()=>$(l),H=>ut(l,H)),kt(e,U),lp()}iv(["keydown","click","mouseover","mouseout"]);ov(oP,{target:document.getElementById("app")});
