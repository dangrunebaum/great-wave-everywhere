var gg=Object.defineProperty;var _g=(e,t,n)=>t in e?gg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $o=(e,t,n)=>_g(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const cc=!1;var Ka=Array.isArray,yg=Array.prototype.indexOf,Qa=Array.from,vg=Object.defineProperty,qr=Object.getOwnPropertyDescriptor,mf=Object.getOwnPropertyDescriptors,wg=Object.prototype,Eg=Array.prototype,Xa=Object.getPrototypeOf,hc=Object.isExtensible;function Tg(e){return e()}function aa(e){for(var t=0;t<e.length;t++)e[t]()}const ee=2,gf=4,$s=8,Ja=16,qe=32,rr=64,Ya=128,Yt=256,hs=512,ne=1024,ke=2048,Vn=4096,Ne=8192,Za=16384,_f=32768,tu=65536,fc=1<<17,Ag=1<<18,yf=1<<19,ua=1<<20,$r=Symbol("$state"),Ig=Symbol(""),vf=new class extends Error{constructor(){super(...arguments);$o(this,"name","StaleReactionError");$o(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function wf(e){return e===this.v}function bg(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ef(e){return!bg(e,this.v)}function Rg(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Sg(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Cg(e){throw new Error("https://svelte.dev/e/effect_orphan")}function xg(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Pg(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Vg(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ng(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let hi=!1,Dg=!1;function kg(){hi=!0}const eu=1,nu=2,Tf=4,Og=8,Mg=16,Fg=2,jt=Symbol(),Lg="http://www.w3.org/1999/xhtml";function Ug(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ft=null;function dc(e){ft=e}function Af(e,t=!1,n){var r=ft={p:ft,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};hi&&!t&&(ft.l={s:null,u:null,r1:[],r2:Qr(!1)}),kf(()=>{r.d=!0})}function If(e){const t=ft;if(t!==null){const a=t.e;if(a!==null){var n=rt,r=et;t.e=null;try{for(var i=0;i<a.length;i++){var s=a[i];nn(s.effect),Ee(s.reaction),Of(s.fn)}}finally{nn(n),Ee(r)}}ft=t.p,t.m=!0}return{}}function fi(){return!hi||ft!==null&&ft.l===null}function Vr(e){if(typeof e!="object"||e===null||$r in e)return e;const t=Xa(e);if(t!==wg&&t!==Eg)return e;var n=new Map,r=Ka(e),i=Ge(0),s=et,a=u=>{var l=et;Ee(s);var c=u();return Ee(l),c};return r&&n.set("length",Ge(e.length)),new Proxy(e,{defineProperty(u,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Pg();var f=n.get(l);return f===void 0?f=a(()=>{var p=Ge(c.value);return n.set(l,p),p}):dt(f,c.value,!0),!0},deleteProperty(u,l){var c=n.get(l);if(c===void 0){if(l in u){const m=a(()=>Ge(jt));n.set(l,m),jo(i)}}else{if(r&&typeof l=="string"){var f=n.get("length"),p=Number(l);Number.isInteger(p)&&p<f.v&&dt(f,p)}dt(c,jt),jo(i)}return!0},get(u,l,c){var _;if(l===$r)return e;var f=n.get(l),p=l in u;if(f===void 0&&(!p||(_=qr(u,l))!=null&&_.writable)&&(f=a(()=>{var v=Vr(p?u[l]:jt),A=Ge(v);return A}),n.set(l,f)),f!==void 0){var m=z(f);return m===jt?void 0:m}return Reflect.get(u,l,c)},getOwnPropertyDescriptor(u,l){var c=Reflect.getOwnPropertyDescriptor(u,l);if(c&&"value"in c){var f=n.get(l);f&&(c.value=z(f))}else if(c===void 0){var p=n.get(l),m=p==null?void 0:p.v;if(p!==void 0&&m!==jt)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return c},has(u,l){var m;if(l===$r)return!0;var c=n.get(l),f=c!==void 0&&c.v!==jt||Reflect.has(u,l);if(c!==void 0||rt!==null&&(!f||(m=qr(u,l))!=null&&m.writable)){c===void 0&&(c=a(()=>{var _=f?Vr(u[l]):jt,v=Ge(_);return v}),n.set(l,c));var p=z(c);if(p===jt)return!1}return f},set(u,l,c,f){var M;var p=n.get(l),m=l in u;if(r&&l==="length")for(var _=c;_<p.v;_+=1){var v=n.get(_+"");v!==void 0?dt(v,jt):_ in u&&(v=a(()=>Ge(jt)),n.set(_+"",v))}if(p===void 0)(!m||(M=qr(u,l))!=null&&M.writable)&&(p=a(()=>Ge(void 0)),dt(p,Vr(c)),n.set(l,p));else{m=p.v!==jt;var A=a(()=>Vr(c));dt(p,A)}var w=Reflect.getOwnPropertyDescriptor(u,l);if(w!=null&&w.set&&w.set.call(f,c),!m){if(r&&typeof l=="string"){var x=n.get("length"),N=Number(l);Number.isInteger(N)&&N>=x.v&&dt(x,N+1)}jo(i)}return!0},ownKeys(u){z(i);var l=Reflect.ownKeys(u).filter(p=>{var m=n.get(p);return m===void 0||m.v!==jt});for(var[c,f]of n)f.v!==jt&&!(c in u)&&l.push(c);return l},setPrototypeOf(){Vg()}})}function jo(e,t=1){dt(e,e.v+t)}function ru(e){var t=ee|ke,n=et!==null&&(et.f&ee)!==0?et:null;return rt===null||n!==null&&(n.f&Yt)!==0?t|=Yt:rt.f|=yf,{ctx:ft,deps:null,effects:null,equals:wf,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??rt,ac:null}}function bf(e){const t=ru(e);return t.equals=Ef,t}function Rf(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)en(t[n])}}function Bg(e){for(var t=e.parent;t!==null;){if((t.f&ee)===0)return t;t=t.parent}return null}function Sf(e){var t,n=rt;nn(Bg(e));try{Rf(e),t=Kf(e)}finally{nn(n)}return t}function Cf(e){var t=Sf(e);if(e.equals(t)||(e.v=t,e.wv=Gf()),!sr){var n=(Qe||(e.f&Yt)!==0)&&e.deps!==null?Vn:ne;Te(e,n)}}const Kr=new Map;function Qr(e,t){var n={f:0,v:e,reactions:null,equals:wf,rv:0,wv:0};return n}function Ge(e,t){const n=Qr(e);return Jg(n),n}function yn(e,t=!1,n=!0){var i;const r=Qr(e);return t||(r.equals=Ef),hi&&n&&ft!==null&&ft.l!==null&&((i=ft.l).s??(i.s=[])).push(r),r}function dt(e,t,n=!1){et!==null&&(!pe||(et.f&fc)!==0)&&fi()&&(et.f&(ee|Ja|fc))!==0&&!(At!=null&&At[1].includes(e)&&At[0]===et)&&Ng();let r=n?Vr(t):t;return la(e,r)}function la(e,t){if(!e.equals(t)){var n=e.v;sr?Kr.set(e,t):Kr.set(e,n),e.v=t,(e.f&ee)!==0&&((e.f&ke)!==0&&Sf(e),Te(e,(e.f&Yt)===0?ne:Vn)),e.wv=Gf(),xf(e,ke),fi()&&rt!==null&&(rt.f&ne)!==0&&(rt.f&(qe|rr))===0&&(Zt===null?Yg([e]):Zt.push(e))}return t}function xf(e,t){var n=e.reactions;if(n!==null)for(var r=fi(),i=n.length,s=0;s<i;s++){var a=n[s],u=a.f;(u&ke)===0&&(!r&&a===rt||(Te(a,t),(u&(ne|Yt))!==0&&((u&ee)!==0?xf(a,Vn):uu(a))))}}let qg=!1;var pc,Pf,Vf,Nf;function $g(){if(pc===void 0){pc=window,Pf=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Vf=qr(t,"firstChild").get,Nf=qr(t,"nextSibling").get,hc(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),hc(n)&&(n.__t=void 0)}}function iu(e=""){return document.createTextNode(e)}function Pe(e){return Vf.call(e)}function js(e){return Nf.call(e)}function Vt(e,t){return Pe(e)}function jg(e,t){{var n=Pe(e);return n instanceof Comment&&n.data===""?js(n):n}}function ie(e,t=1,n=!1){let r=e;for(;t--;)r=js(r);return r}function zg(e){e.textContent=""}function Df(e){rt===null&&et===null&&Cg(),et!==null&&(et.f&Yt)!==0&&rt===null&&Sg(),sr&&Rg()}function Hg(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ir(e,t,n,r=!0){var i=rt,s={ctx:ft,deps:null,nodes_start:null,nodes_end:null,f:e|ke,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{au(s),s.f|=_f}catch(l){throw en(s),l}else t!==null&&uu(s);var a=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(yf|Ya))===0;if(!a&&r&&(i!==null&&Hg(s,i),et!==null&&(et.f&ee)!==0)){var u=et;(u.effects??(u.effects=[])).push(s)}return s}function kf(e){const t=ir($s,null,!1);return Te(t,ne),t.teardown=e,t}function ca(e){Df();var t=rt!==null&&(rt.f&qe)!==0&&ft!==null&&!ft.m;if(t){var n=ft;(n.e??(n.e=[])).push({fn:e,effect:rt,reaction:et})}else{var r=Of(e);return r}}function Gg(e){return Df(),Mf(e)}function Wg(e){const t=ir(rr,e,!0);return(n={})=>new Promise(r=>{n.outro?fs(t,()=>{en(t),r(void 0)}):(en(t),r(void 0))})}function Of(e){return ir(gf,e,!1)}function Mf(e){return ir($s,e,!0)}function Nr(e,t=[],n=ru){const r=t.map(n);return su(()=>e(...r.map(z)))}function su(e,t=0){var n=ir($s|Ja|t,e,!0);return n}function Xr(e,t=!0){return ir($s|qe,e,!0,t)}function Ff(e){var t=e.teardown;if(t!==null){const n=sr,r=et;mc(!0),Ee(null);try{t.call(null)}finally{mc(n),Ee(r)}}}function Lf(e,t=!1){var i;var n=e.first;for(e.first=e.last=null;n!==null;){(i=n.ac)==null||i.abort(vf);var r=n.next;(n.f&rr)!==0?n.parent=null:en(n,t),n=r}}function Kg(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&qe)===0&&en(t),t=n}}function en(e,t=!0){var n=!1;(t||(e.f&Ag)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Uf(e.nodes_start,e.nodes_end),n=!0),Lf(e,t&&!n),_s(e,0),Te(e,Za);var r=e.transitions;if(r!==null)for(const s of r)s.stop();Ff(e);var i=e.parent;i!==null&&i.first!==null&&Bf(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Uf(e,t){for(;e!==null;){var n=e===t?null:js(e);e.remove(),e=n}}function Bf(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function fs(e,t){var n=[];ou(e,n,!0),qf(n,()=>{en(e),t&&t()})}function qf(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function ou(e,t,n){if((e.f&Ne)===0){if(e.f^=Ne,e.transitions!==null)for(const a of e.transitions)(a.is_global||n)&&t.push(a);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&tu)!==0||(r.f&qe)!==0;ou(r,t,s?n:!1),r=i}}}function ds(e){$f(e,!0)}function $f(e,t){if((e.f&Ne)!==0){e.f^=Ne;for(var n=e.first;n!==null;){var r=n.next,i=(n.f&tu)!==0||(n.f&qe)!==0;$f(n,i?t:!1),n=r}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let ps=[];function Qg(){var e=ps;ps=[],aa(e)}function jf(e){ps.length===0&&queueMicrotask(Qg),ps.push(e)}function Xg(e){var t=rt;if((t.f&_f)===0){if((t.f&Ya)===0)throw e;t.fn(e)}else zf(e,t)}function zf(e,t){for(;t!==null;){if((t.f&Ya)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let ha=!1,ms=null,An=!1,sr=!1;function mc(e){sr=e}let Yi=[];let et=null,pe=!1;function Ee(e){et=e}let rt=null;function nn(e){rt=e}let At=null;function Jg(e){et!==null&&et.f&ua&&(At===null?At=[et,[e]]:At[1].push(e))}let Lt=null,Xt=0,Zt=null;function Yg(e){Zt=e}let Hf=1,gs=0,Qe=!1;function Gf(){return++Hf}function zs(e){var p;var t=e.f;if((t&ke)!==0)return!0;if((t&Vn)!==0){var n=e.deps,r=(t&Yt)!==0;if(n!==null){var i,s,a=(t&hs)!==0,u=r&&rt!==null&&!Qe,l=n.length;if(a||u){var c=e,f=c.parent;for(i=0;i<l;i++)s=n[i],(a||!((p=s==null?void 0:s.reactions)!=null&&p.includes(c)))&&(s.reactions??(s.reactions=[])).push(c);a&&(c.f^=hs),u&&f!==null&&(f.f&Yt)===0&&(c.f^=Yt)}for(i=0;i<l;i++)if(s=n[i],zs(s)&&Cf(s),s.wv>e.wv)return!0}(!r||rt!==null&&!Qe)&&Te(e,ne)}return!1}function Wf(e,t,n=!0){var r=e.reactions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];At!=null&&At[1].includes(e)&&At[0]===et||((s.f&ee)!==0?Wf(s,t,!1):t===s&&(n?Te(s,ke):(s.f&ne)!==0&&Te(s,Vn),uu(s)))}}function Kf(e){var _;var t=Lt,n=Xt,r=Zt,i=et,s=Qe,a=At,u=ft,l=pe,c=e.f;Lt=null,Xt=0,Zt=null,Qe=(c&Yt)!==0&&(pe||!An||et===null),et=(c&(qe|rr))===0?e:null,At=null,dc(e.ctx),pe=!1,gs++,e.f|=ua,e.ac!==null&&(e.ac.abort(vf),e.ac=null);try{var f=(0,e.fn)(),p=e.deps;if(Lt!==null){var m;if(_s(e,Xt),p!==null&&Xt>0)for(p.length=Xt+Lt.length,m=0;m<Lt.length;m++)p[Xt+m]=Lt[m];else e.deps=p=Lt;if(!Qe||(c&ee)!==0&&e.reactions!==null)for(m=Xt;m<p.length;m++)((_=p[m]).reactions??(_.reactions=[])).push(e)}else p!==null&&Xt<p.length&&(_s(e,Xt),p.length=Xt);if(fi()&&Zt!==null&&!pe&&p!==null&&(e.f&(ee|Vn|ke))===0)for(m=0;m<Zt.length;m++)Wf(Zt[m],e);return i!==null&&i!==e&&(gs++,Zt!==null&&(r===null?r=Zt:r.push(...Zt))),f}catch(v){Xg(v)}finally{Lt=t,Xt=n,Zt=r,et=i,Qe=s,At=a,dc(u),pe=l,e.f^=ua}}function Zg(e,t){let n=t.reactions;if(n!==null){var r=yg.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&ee)!==0&&(Lt===null||!Lt.includes(t))&&(Te(t,Vn),(t.f&(Yt|hs))===0&&(t.f^=hs),Rf(t),_s(t,0))}function _s(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Zg(e,n[r])}function au(e){var t=e.f;if((t&Za)===0){Te(e,ne);var n=rt,r=An;rt=e,An=!0;try{(t&Ja)!==0?Kg(e):Lf(e),Ff(e);var i=Kf(e);e.teardown=typeof i=="function"?i:null,e.wv=Hf;var s;cc&&Dg&&(e.f&ke)!==0&&e.deps}finally{An=r,rt=n}}}function t_(){try{xg()}catch(e){if(ms!==null)zf(e,ms);else throw e}}function e_(){var e=An;try{var t=0;for(An=!0;Yi.length>0;){t++>1e3&&t_();var n=Yi,r=n.length;Yi=[];for(var i=0;i<r;i++){var s=r_(n[i]);n_(s)}Kr.clear()}}finally{ha=!1,An=e,ms=null}}function n_(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(Za|Ne))===0&&zs(r)&&(au(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Bf(r):r.fn=null))}}function uu(e){ha||(ha=!0,queueMicrotask(e_));for(var t=ms=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(rr|qe))!==0){if((n&ne)===0)return;t.f^=ne}}Yi.push(t)}function r_(e){for(var t=[],n=e;n!==null;){var r=n.f,i=(r&(qe|rr))!==0,s=i&&(r&ne)!==0;if(!s&&(r&Ne)===0){(r&gf)!==0?t.push(n):i?n.f^=ne:zs(n)&&au(n);var a=n.first;if(a!==null){n=a;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return t}function z(e){var t=e.f,n=(t&ee)!==0;if(et!==null&&!pe){if(!(At!=null&&At[1].includes(e))||At[0]!==et){var r=et.deps;e.rv<gs&&(e.rv=gs,Lt===null&&r!==null&&r[Xt]===e?Xt++:Lt===null?Lt=[e]:(!Qe||!Lt.includes(e))&&Lt.push(e))}}else if(n&&e.deps===null&&e.effects===null){var i=e,s=i.parent;s!==null&&(s.f&Yt)===0&&(i.f^=Yt)}return n&&(i=e,zs(i)&&Cf(i)),sr&&Kr.has(e)?Kr.get(e):e.v}function lu(e){var t=pe;try{return pe=!0,e()}finally{pe=t}}const i_=-7169;function Te(e,t){e.f=e.f&i_|t}function s_(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if($r in e)fa(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&$r in n&&fa(n)}}}function fa(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{fa(e[r],t)}catch{}const n=Xa(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=mf(n);for(let i in r){const s=r[i].get;if(s)try{s.call(e)}catch{}}}}}const o_=["touchstart","touchmove"];function a_(e){return o_.includes(e)}let gc=!1;function u_(){gc||(gc=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function Qf(e){var t=et,n=rt;Ee(null),nn(null);try{return e()}finally{Ee(t),nn(n)}}function l_(e,t,n,r=n){e.addEventListener(t,()=>Qf(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),u_()}const c_=new Set,_c=new Set;function h_(e,t,n,r={}){function i(s){if(r.capture||Dr.call(t,s),!s.cancelBubble)return Qf(()=>n==null?void 0:n.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?jf(()=>{t.addEventListener(e,i,r)}):t.addEventListener(e,i,r),i}function yc(e,t,n,r,i){var s={capture:r,passive:i},a=h_(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&kf(()=>{t.removeEventListener(e,a,s)})}function Dr(e){var N;var t=this,n=t.ownerDocument,r=e.type,i=((N=e.composedPath)==null?void 0:N.call(e))||[],s=i[0]||e.target,a=0,u=e.__root;if(u){var l=i.indexOf(u);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=i.indexOf(t);if(c===-1)return;l<=c&&(a=l)}if(s=i[a]||e.target,s!==t){vg(e,"currentTarget",{configurable:!0,get(){return s||n}});var f=et,p=rt;Ee(null),nn(null);try{for(var m,_=[];s!==null;){var v=s.assignedSlot||s.parentNode||s.host||null;try{var A=s["__"+r];if(A!=null&&(!s.disabled||e.target===s))if(Ka(A)){var[w,...x]=A;w.apply(s,[e,...x])}else A.call(s,e)}catch(M){m?_.push(M):m=M}if(e.cancelBubble||v===t||v===null)break;s=v}if(m){for(let M of _)queueMicrotask(()=>{throw M});throw m}}finally{e.__root=t,delete e.currentTarget,Ee(f),nn(p)}}}function cu(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Hs(e,t){var n=rt;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function or(e,t){var n=(t&Fg)!==0,r,i=!e.startsWith("<!>");return()=>{r===void 0&&(r=cu(i?e:"<!>"+e),r=Pe(r));var s=n||Pf?document.importNode(r,!0):r.cloneNode(!0);return Hs(s,s),s}}function f_(e,t,n="svg"){var r=!e.startsWith("<!>"),i=`<${n}>${r?e:"<!>"+e}</${n}>`,s;return()=>{if(!s){var a=cu(i),u=Pe(a);s=Pe(u)}var l=s.cloneNode(!0);return Hs(l,l),l}}function Xf(e,t){return f_(e,t,"svg")}function d_(){var e=document.createDocumentFragment(),t=document.createComment(""),n=iu();return e.append(t,n),Hs(t,n),e}function Ce(e,t){e!==null&&e.before(t)}function zo(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function p_(e,t){return m_(e,t)}const Bn=new Map;function m_(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:a=!0}){$g();var u=new Set,l=p=>{for(var m=0;m<p.length;m++){var _=p[m];if(!u.has(_)){u.add(_);var v=a_(_);t.addEventListener(_,Dr,{passive:v});var A=Bn.get(_);A===void 0?(document.addEventListener(_,Dr,{passive:v}),Bn.set(_,1)):Bn.set(_,A+1)}}};l(Qa(c_)),_c.add(l);var c=void 0,f=Wg(()=>{var p=n??t.appendChild(iu());return Xr(()=>{if(s){Af({});var m=ft;m.c=s}i&&(r.$$events=i),c=e(p,r)||{},s&&If()}),()=>{var v;for(var m of u){t.removeEventListener(m,Dr);var _=Bn.get(m);--_===0?(document.removeEventListener(m,Dr),Bn.delete(m)):Bn.set(m,_)}_c.delete(l),p!==n&&((v=p.parentNode)==null||v.removeChild(p))}});return g_.set(c,f),c}let g_=new WeakMap;function Ho(e,t,[n,r]=[0,0]){var i=e,s=null,a=null,u=jt,l=n>0?tu:0,c=!1;const f=(m,_=!0)=>{c=!0,p(_,m)},p=(m,_)=>{u!==(u=m)&&(u?(s?ds(s):_&&(s=Xr(()=>_(i))),a&&fs(a,()=>{a=null})):(a?ds(a):_&&(a=Xr(()=>_(i,[n+1,r]))),s&&fs(s,()=>{s=null})))};su(()=>{c=!1,t(f),c||p(null,null)},l)}function $i(e,t){return t}function __(e,t,n,r){for(var i=[],s=t.length,a=0;a<s;a++)ou(t[a].e,i,!0);var u=s>0&&i.length===0&&n!==null;if(u){var l=n.parentNode;zg(l),l.append(n),r.clear(),We(e,t[0].prev,t[s-1].next)}qf(i,()=>{for(var c=0;c<s;c++){var f=t[c];u||(r.delete(f.k),We(e,f.prev,f.next)),en(f.e,!u)}})}function ji(e,t,n,r,i,s=null){var a=e,u={flags:t,items:new Map,first:null},l=(t&Tf)!==0;if(l){var c=e;a=c.appendChild(iu())}var f=null,p=!1,m=bf(()=>{var _=n();return Ka(_)?_:_==null?[]:Qa(_)});su(()=>{var _=z(m),v=_.length;p&&v===0||(p=v===0,y_(_,u,a,i,t,r,n),s!==null&&(v===0?f?ds(f):f=Xr(()=>s(a)):f!==null&&fs(f,()=>{f=null})),z(m))})}function y_(e,t,n,r,i,s,a){var qt,ce,kn,K;var u=(i&Og)!==0,l=(i&(eu|nu))!==0,c=e.length,f=t.items,p=t.first,m=p,_,v=null,A,w=[],x=[],N,M,k,U;if(u)for(U=0;U<c;U+=1)N=e[U],M=s(N,U),k=f.get(M),k!==void 0&&((qt=k.a)==null||qt.measure(),(A??(A=new Set)).add(k));for(U=0;U<c;U+=1){if(N=e[U],M=s(N,U),k=f.get(M),k===void 0){var H=m?m.e.nodes_start:n;v=w_(H,t,v,v===null?t.first:v.next,N,M,U,r,i,a),f.set(M,v),w=[],x=[],m=v.next;continue}if(l&&v_(k,N,U,i),(k.e.f&Ne)!==0&&(ds(k.e),u&&((ce=k.a)==null||ce.unfix(),(A??(A=new Set)).delete(k))),k!==m){if(_!==void 0&&_.has(k)){if(w.length<x.length){var I=x[0],y;v=I.prev;var E=w[0],b=w[w.length-1];for(y=0;y<w.length;y+=1)vc(w[y],I,n);for(y=0;y<x.length;y+=1)_.delete(x[y]);We(t,E.prev,b.next),We(t,v,E),We(t,b,I),m=I,v=b,U-=1,w=[],x=[]}else _.delete(k),vc(k,m,n),We(t,k.prev,k.next),We(t,k,v===null?t.first:v.next),We(t,v,k),v=k;continue}for(w=[],x=[];m!==null&&m.k!==M;)(m.e.f&Ne)===0&&(_??(_=new Set)).add(m),x.push(m),m=m.next;if(m===null)continue;k=m}w.push(k),v=k,m=k.next}if(m!==null||_!==void 0){for(var R=_===void 0?[]:Qa(_);m!==null;)(m.e.f&Ne)===0&&R.push(m),m=m.next;var C=R.length;if(C>0){var T=(i&Tf)!==0&&c===0?n:null;if(u){for(U=0;U<C;U+=1)(kn=R[U].a)==null||kn.measure();for(U=0;U<C;U+=1)(K=R[U].a)==null||K.fix()}__(t,R,T,f)}}u&&jf(()=>{var $;if(A!==void 0)for(k of A)($=k.a)==null||$.apply()}),rt.first=t.first&&t.first.e,rt.last=v&&v.e}function v_(e,t,n,r){(r&eu)!==0&&la(e.v,t),(r&nu)!==0?la(e.i,n):e.i=n}function w_(e,t,n,r,i,s,a,u,l,c){var f=(l&eu)!==0,p=(l&Mg)===0,m=f?p?yn(i,!1,!1):Qr(i):i,_=(l&nu)===0?a:Qr(a),v={i:_,v:m,k:s,a:null,e:null,prev:n,next:r};try{return v.e=Xr(()=>u(e,m,_,c),qg),v.e.prev=n&&n.e,v.e.next=r&&r.e,n===null?t.first=v:(n.next=v,n.e.next=v.e),r!==null&&(r.prev=v,r.e.prev=v.e),v}finally{}}function vc(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var a=js(s);i.before(s),s=a}}function We(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function E_(e,t,n=!1,r=!1,i=!1){var s=e,a="";Nr(()=>{var u=rt;if(a!==(a=t()??"")&&(u.nodes_start!==null&&(Uf(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),a!=="")){var l=a+"";n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var c=cu(l);if((n||r)&&(c=Pe(c)),Hs(Pe(c),c.lastChild),n||r)for(;Pe(c);)s.before(Pe(c));else s.before(c)}})}const T_=Symbol("is custom element"),A_=Symbol("is html");function he(e,t,n,r){var i=I_(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[Ig]=n),n==null?e.removeAttribute(t):typeof n!="string"&&b_(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function I_(e){return e.__attributes??(e.__attributes={[T_]:e.nodeName.includes("-"),[A_]:e.namespaceURI===Lg})}var wc=new Map;function b_(e){var t=wc.get(e.nodeName);if(t)return t;wc.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=mf(r);for(var s in n)n[s].set&&t.push(s);r=Xa(r)}return t}function R_(e,t,n=t){var r=fi();l_(e,"input",i=>{var s=i?e.defaultValue:e.value;if(s=Go(e)?Wo(s):s,n(s),r&&s!==(s=t())){var a=e.selectionStart,u=e.selectionEnd;e.value=s??"",u!==null&&(e.selectionStart=a,e.selectionEnd=Math.min(u,e.value.length))}}),lu(t)==null&&e.value&&n(Go(e)?Wo(e.value):e.value),Mf(()=>{var i=t();Go(e)&&i===Wo(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function Go(e){var t=e.type;return t==="number"||t==="range"}function Wo(e){return e===""?null:+e}function S_(e=!1){const t=ft,n=t.l.u;if(!n)return;let r=()=>s_(t.s);if(e){let i=0,s={};const a=ru(()=>{let u=!1;const l=t.s;for(const c in l)l[c]!==s[c]&&(s[c]=l[c],u=!0);return u&&i++,i});r=()=>z(a)}n.b.length&&Gg(()=>{Ec(t,r),aa(n.b)}),ca(()=>{const i=lu(()=>n.m.map(Tg));return()=>{for(const s of i)typeof s=="function"&&s()}}),n.a.length&&ca(()=>{Ec(t,r),aa(n.a)})}function Ec(e,t){if(e.l.s)for(const n of e.l.s)z(n);t()}function C_(e){ft===null&&Ug(),hi&&ft.l!==null?x_(ft).m.push(e):ca(()=>{const t=lu(e);if(typeof t=="function")return t})}function x_(e){var t=e.l;return t.u??(t.u={a:[],b:[],m:[]})}const P_="5";var pf;typeof window<"u"&&((pf=window.__svelte??(window.__svelte={})).v??(pf.v=new Set)).add(P_);kg();const V_=()=>{};var Tc={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},N_=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],a=e[n++],u=e[n++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(l>>10)),t[r++]=String.fromCharCode(56320+(l&1023))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return t.join("")},Yf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],a=i+1<e.length,u=a?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,f=s>>2,p=(s&3)<<4|u>>4;let m=(u&15)<<2|c>>6,_=c&63;l||(_=64,a||(m=64)),r.push(n[f],n[p],n[m],n[_])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Jf(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):N_(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],u=i<e.length?n[e.charAt(i)]:0;++i;const c=i<e.length?n[e.charAt(i)]:64;++i;const p=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||u==null||c==null||p==null)throw new D_;const m=s<<2|u>>4;if(r.push(m),c!==64){const _=u<<4&240|c>>2;if(r.push(_),p!==64){const v=c<<6&192|p;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class D_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const k_=function(e){const t=Jf(e);return Yf.encodeByteArray(t,!0)},ys=function(e){return k_(e).replace(/\./g,"")},O_=function(e){try{return Yf.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=()=>M_().__FIREBASE_DEFAULTS__,L_=()=>{if(typeof process>"u"||typeof Tc>"u")return;const e=Tc.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},U_=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&O_(e[1]);return t&&JSON.parse(t)},hu=()=>{try{return V_()||F_()||L_()||U_()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},B_=e=>{var t,n;return(n=(t=hu())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},q_=e=>{const t=B_(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Zf=()=>{var e;return(e=hu())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function j_(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ys(JSON.stringify(n)),ys(JSON.stringify(a)),""].join(".")}const jr={};function H_(){const e={prod:[],emulator:[]};for(const t of Object.keys(jr))jr[t]?e.emulator.push(t):e.prod.push(t);return e}function G_(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let Ac=!1;function W_(e,t){if(typeof window>"u"||typeof document>"u"||!fu(window.location.host)||jr[e]===t||jr[e]||Ac)return;jr[e]=t;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=H_().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function u(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,_){m.setAttribute("width","24"),m.setAttribute("id",_),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Ac=!0,a()},m}function f(m,_){m.setAttribute("id",_),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=G_(r),_=n("text"),v=document.getElementById(_)||document.createElement("span"),A=n("learnmore"),w=document.getElementById(A)||document.createElement("a"),x=n("preprendIcon"),N=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const M=m.element;u(M),f(w,A);const k=c();l(N,x),M.append(N,v,w,k),document.body.appendChild(M)}s?(v.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Q_(){var e;const t=(e=hu())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function X_(){return!Q_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function J_(){try{return typeof indexedDB=="object"}catch{return!1}}function Y_(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="FirebaseError";class ar extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Z_,Object.setPrototypeOf(this,ar.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,td.prototype.create)}}class td{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],a=s?ty(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new ar(i,u,r)}}function ty(e,t){return e.replace(ey,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const ey=/\{\$([^}]+)}/g;function vs(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],a=t[i];if(Ic(s)&&Ic(a)){if(!vs(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ic(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(e){return e&&e._delegate?e._delegate:e}class Jr{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new $_;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(iy(t))try{this.getOrInitializeService({instanceIdentifier:vn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=vn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=vn){return this.instances.has(t)}getOptions(t=vn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&t(a,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ry(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=vn){return this.component?this.component.multipleInstances?t:vn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ry(e){return e===vn?void 0:e}function iy(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new ny(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Z;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Z||(Z={}));const oy={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},ay=Z.INFO,uy={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},ly=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=uy[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ed{constructor(t){this.name=t,this._logLevel=ay,this._logHandler=ly,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Z))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?oy[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...t),this._logHandler(this,Z.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...t),this._logHandler(this,Z.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...t),this._logHandler(this,Z.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...t),this._logHandler(this,Z.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...t),this._logHandler(this,Z.ERROR,...t)}}const cy=(e,t)=>t.some(n=>e instanceof n);let bc,Rc;function hy(){return bc||(bc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fy(){return Rc||(Rc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nd=new WeakMap,da=new WeakMap,rd=new WeakMap,Ko=new WeakMap,du=new WeakMap;function dy(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{n(Je(e.result)),i()},a=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(n=>{n instanceof IDBCursor&&nd.set(n,e)}).catch(()=>{}),du.set(t,e),t}function py(e){if(da.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});da.set(e,t)}let pa={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return da.get(e);if(t==="objectStoreNames")return e.objectStoreNames||rd.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Je(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function my(e){pa=e(pa)}function gy(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(Qo(this),t,...n);return rd.set(r,t.sort?t.sort():[t]),Je(r)}:fy().includes(e)?function(...t){return e.apply(Qo(this),t),Je(nd.get(this))}:function(...t){return Je(e.apply(Qo(this),t))}}function _y(e){return typeof e=="function"?gy(e):(e instanceof IDBTransaction&&py(e),cy(e,hy())?new Proxy(e,pa):e)}function Je(e){if(e instanceof IDBRequest)return dy(e);if(Ko.has(e))return Ko.get(e);const t=_y(e);return t!==e&&(Ko.set(e,t),du.set(t,e)),t}const Qo=e=>du.get(e);function yy(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),u=Je(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Je(a.result),l.oldVersion,l.newVersion,Je(a.transaction),l)}),n&&a.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),u}const vy=["get","getKey","getAll","getAllKeys","count"],wy=["put","add","delete","clear"],Xo=new Map;function Sc(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Xo.get(t))return Xo.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=wy.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||vy.includes(n)))return;const s=async function(a,...u){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(u.shift())),(await Promise.all([c[n](...u),i&&l.done]))[0]};return Xo.set(t,s),s}my(e=>({...e,get:(t,n,r)=>Sc(t,n)||e.get(t,n,r),has:(t,n)=>!!Sc(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Ty(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Ty(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ma="@firebase/app",Cc="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me=new ed("@firebase/app"),Ay="@firebase/app-compat",Iy="@firebase/analytics-compat",by="@firebase/analytics",Ry="@firebase/app-check-compat",Sy="@firebase/app-check",Cy="@firebase/auth",xy="@firebase/auth-compat",Py="@firebase/database",Vy="@firebase/data-connect",Ny="@firebase/database-compat",Dy="@firebase/functions",ky="@firebase/functions-compat",Oy="@firebase/installations",My="@firebase/installations-compat",Fy="@firebase/messaging",Ly="@firebase/messaging-compat",Uy="@firebase/performance",By="@firebase/performance-compat",qy="@firebase/remote-config",$y="@firebase/remote-config-compat",jy="@firebase/storage",zy="@firebase/storage-compat",Hy="@firebase/firestore",Gy="@firebase/ai",Wy="@firebase/firestore-compat",Ky="firebase",Qy="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga="[DEFAULT]",Xy={[ma]:"fire-core",[Ay]:"fire-core-compat",[by]:"fire-analytics",[Iy]:"fire-analytics-compat",[Sy]:"fire-app-check",[Ry]:"fire-app-check-compat",[Cy]:"fire-auth",[xy]:"fire-auth-compat",[Py]:"fire-rtdb",[Vy]:"fire-data-connect",[Ny]:"fire-rtdb-compat",[Dy]:"fire-fn",[ky]:"fire-fn-compat",[Oy]:"fire-iid",[My]:"fire-iid-compat",[Fy]:"fire-fcm",[Ly]:"fire-fcm-compat",[Uy]:"fire-perf",[By]:"fire-perf-compat",[qy]:"fire-rc",[$y]:"fire-rc-compat",[jy]:"fire-gcs",[zy]:"fire-gcs-compat",[Hy]:"fire-fst",[Wy]:"fire-fst-compat",[Gy]:"fire-vertex","fire-js":"fire-js",[Ky]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws=new Map,Jy=new Map,_a=new Map;function xc(e,t){try{e.container.addComponent(t)}catch(n){Me.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Es(e){const t=e.name;if(_a.has(t))return Me.debug(`There were multiple attempts to register component ${t}.`),!1;_a.set(t,e);for(const n of ws.values())xc(n,e);for(const n of Jy.values())xc(n,e);return!0}function Yy(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Zy(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ye=new td("app","Firebase",tv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Jr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ye.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nv=Qy;function id(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:ga,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw Ye.create("bad-app-name",{appName:String(i)});if(n||(n=Zf()),!n)throw Ye.create("no-options");const s=ws.get(i);if(s){if(vs(n,s.options)&&vs(r,s.config))return s;throw Ye.create("duplicate-app",{appName:i})}const a=new sy(i);for(const l of _a.values())a.addComponent(l);const u=new ev(n,r,a);return ws.set(i,u),u}function rv(e=ga){const t=ws.get(e);if(!t&&e===ga&&Zf())return id();if(!t)throw Ye.create("no-app",{appName:e});return t}function Gn(e,t,n){var r;let i=(r=Xy[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const u=[`Unable to register library "${i}" with version "${t}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Me.warn(u.join(" "));return}Es(new Jr(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iv="firebase-heartbeat-database",sv=1,Yr="firebase-heartbeat-store";let Jo=null;function sd(){return Jo||(Jo=yy(iv,sv,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Yr)}catch(n){console.warn(n)}}}}).catch(e=>{throw Ye.create("idb-open",{originalErrorMessage:e.message})})),Jo}async function ov(e){try{const n=(await sd()).transaction(Yr),r=await n.objectStore(Yr).get(od(e));return await n.done,r}catch(t){if(t instanceof ar)Me.warn(t.message);else{const n=Ye.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Me.warn(n.message)}}}async function Pc(e,t){try{const r=(await sd()).transaction(Yr,"readwrite");await r.objectStore(Yr).put(t,od(e)),await r.done}catch(n){if(n instanceof ar)Me.warn(n.message);else{const r=Ye.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Me.warn(r.message)}}}function od(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const av=1024,uv=30;class lv{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new hv(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Vc();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>uv){const a=fv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Me.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Vc(),{heartbeatsToSend:r,unsentEntries:i}=cv(this._heartbeatsCache.heartbeats),s=ys(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Me.warn(n),""}}}function Vc(){return new Date().toISOString().substring(0,10)}function cv(e,t=av){const n=[];let r=e.slice();for(const i of e){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Nc(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Nc(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class hv{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return J_()?Y_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ov(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Pc(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Pc(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Nc(e){return ys(JSON.stringify({version:2,heartbeats:e})).length}function fv(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(e){Es(new Jr("platform-logger",t=>new Ey(t),"PRIVATE")),Es(new Jr("heartbeat",t=>new lv(t),"PRIVATE")),Gn(ma,Cc,e),Gn(ma,Cc,"esm2017"),Gn("fire-js","")}dv("");var pv="firebase",mv="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gn(pv,mv,"app");var Dc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ze,ad;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,y){function E(){}E.prototype=y.prototype,I.D=y.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(b,R,C){for(var T=Array(arguments.length-2),qt=2;qt<arguments.length;qt++)T[qt-2]=arguments[qt];return y.prototype[R].apply(b,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,y,E){E||(E=0);var b=Array(16);if(typeof y=="string")for(var R=0;16>R;++R)b[R]=y.charCodeAt(E++)|y.charCodeAt(E++)<<8|y.charCodeAt(E++)<<16|y.charCodeAt(E++)<<24;else for(R=0;16>R;++R)b[R]=y[E++]|y[E++]<<8|y[E++]<<16|y[E++]<<24;y=I.g[0],E=I.g[1],R=I.g[2];var C=I.g[3],T=y+(C^E&(R^C))+b[0]+3614090360&4294967295;y=E+(T<<7&4294967295|T>>>25),T=C+(R^y&(E^R))+b[1]+3905402710&4294967295,C=y+(T<<12&4294967295|T>>>20),T=R+(E^C&(y^E))+b[2]+606105819&4294967295,R=C+(T<<17&4294967295|T>>>15),T=E+(y^R&(C^y))+b[3]+3250441966&4294967295,E=R+(T<<22&4294967295|T>>>10),T=y+(C^E&(R^C))+b[4]+4118548399&4294967295,y=E+(T<<7&4294967295|T>>>25),T=C+(R^y&(E^R))+b[5]+1200080426&4294967295,C=y+(T<<12&4294967295|T>>>20),T=R+(E^C&(y^E))+b[6]+2821735955&4294967295,R=C+(T<<17&4294967295|T>>>15),T=E+(y^R&(C^y))+b[7]+4249261313&4294967295,E=R+(T<<22&4294967295|T>>>10),T=y+(C^E&(R^C))+b[8]+1770035416&4294967295,y=E+(T<<7&4294967295|T>>>25),T=C+(R^y&(E^R))+b[9]+2336552879&4294967295,C=y+(T<<12&4294967295|T>>>20),T=R+(E^C&(y^E))+b[10]+4294925233&4294967295,R=C+(T<<17&4294967295|T>>>15),T=E+(y^R&(C^y))+b[11]+2304563134&4294967295,E=R+(T<<22&4294967295|T>>>10),T=y+(C^E&(R^C))+b[12]+1804603682&4294967295,y=E+(T<<7&4294967295|T>>>25),T=C+(R^y&(E^R))+b[13]+4254626195&4294967295,C=y+(T<<12&4294967295|T>>>20),T=R+(E^C&(y^E))+b[14]+2792965006&4294967295,R=C+(T<<17&4294967295|T>>>15),T=E+(y^R&(C^y))+b[15]+1236535329&4294967295,E=R+(T<<22&4294967295|T>>>10),T=y+(R^C&(E^R))+b[1]+4129170786&4294967295,y=E+(T<<5&4294967295|T>>>27),T=C+(E^R&(y^E))+b[6]+3225465664&4294967295,C=y+(T<<9&4294967295|T>>>23),T=R+(y^E&(C^y))+b[11]+643717713&4294967295,R=C+(T<<14&4294967295|T>>>18),T=E+(C^y&(R^C))+b[0]+3921069994&4294967295,E=R+(T<<20&4294967295|T>>>12),T=y+(R^C&(E^R))+b[5]+3593408605&4294967295,y=E+(T<<5&4294967295|T>>>27),T=C+(E^R&(y^E))+b[10]+38016083&4294967295,C=y+(T<<9&4294967295|T>>>23),T=R+(y^E&(C^y))+b[15]+3634488961&4294967295,R=C+(T<<14&4294967295|T>>>18),T=E+(C^y&(R^C))+b[4]+3889429448&4294967295,E=R+(T<<20&4294967295|T>>>12),T=y+(R^C&(E^R))+b[9]+568446438&4294967295,y=E+(T<<5&4294967295|T>>>27),T=C+(E^R&(y^E))+b[14]+3275163606&4294967295,C=y+(T<<9&4294967295|T>>>23),T=R+(y^E&(C^y))+b[3]+4107603335&4294967295,R=C+(T<<14&4294967295|T>>>18),T=E+(C^y&(R^C))+b[8]+1163531501&4294967295,E=R+(T<<20&4294967295|T>>>12),T=y+(R^C&(E^R))+b[13]+2850285829&4294967295,y=E+(T<<5&4294967295|T>>>27),T=C+(E^R&(y^E))+b[2]+4243563512&4294967295,C=y+(T<<9&4294967295|T>>>23),T=R+(y^E&(C^y))+b[7]+1735328473&4294967295,R=C+(T<<14&4294967295|T>>>18),T=E+(C^y&(R^C))+b[12]+2368359562&4294967295,E=R+(T<<20&4294967295|T>>>12),T=y+(E^R^C)+b[5]+4294588738&4294967295,y=E+(T<<4&4294967295|T>>>28),T=C+(y^E^R)+b[8]+2272392833&4294967295,C=y+(T<<11&4294967295|T>>>21),T=R+(C^y^E)+b[11]+1839030562&4294967295,R=C+(T<<16&4294967295|T>>>16),T=E+(R^C^y)+b[14]+4259657740&4294967295,E=R+(T<<23&4294967295|T>>>9),T=y+(E^R^C)+b[1]+2763975236&4294967295,y=E+(T<<4&4294967295|T>>>28),T=C+(y^E^R)+b[4]+1272893353&4294967295,C=y+(T<<11&4294967295|T>>>21),T=R+(C^y^E)+b[7]+4139469664&4294967295,R=C+(T<<16&4294967295|T>>>16),T=E+(R^C^y)+b[10]+3200236656&4294967295,E=R+(T<<23&4294967295|T>>>9),T=y+(E^R^C)+b[13]+681279174&4294967295,y=E+(T<<4&4294967295|T>>>28),T=C+(y^E^R)+b[0]+3936430074&4294967295,C=y+(T<<11&4294967295|T>>>21),T=R+(C^y^E)+b[3]+3572445317&4294967295,R=C+(T<<16&4294967295|T>>>16),T=E+(R^C^y)+b[6]+76029189&4294967295,E=R+(T<<23&4294967295|T>>>9),T=y+(E^R^C)+b[9]+3654602809&4294967295,y=E+(T<<4&4294967295|T>>>28),T=C+(y^E^R)+b[12]+3873151461&4294967295,C=y+(T<<11&4294967295|T>>>21),T=R+(C^y^E)+b[15]+530742520&4294967295,R=C+(T<<16&4294967295|T>>>16),T=E+(R^C^y)+b[2]+3299628645&4294967295,E=R+(T<<23&4294967295|T>>>9),T=y+(R^(E|~C))+b[0]+4096336452&4294967295,y=E+(T<<6&4294967295|T>>>26),T=C+(E^(y|~R))+b[7]+1126891415&4294967295,C=y+(T<<10&4294967295|T>>>22),T=R+(y^(C|~E))+b[14]+2878612391&4294967295,R=C+(T<<15&4294967295|T>>>17),T=E+(C^(R|~y))+b[5]+4237533241&4294967295,E=R+(T<<21&4294967295|T>>>11),T=y+(R^(E|~C))+b[12]+1700485571&4294967295,y=E+(T<<6&4294967295|T>>>26),T=C+(E^(y|~R))+b[3]+2399980690&4294967295,C=y+(T<<10&4294967295|T>>>22),T=R+(y^(C|~E))+b[10]+4293915773&4294967295,R=C+(T<<15&4294967295|T>>>17),T=E+(C^(R|~y))+b[1]+2240044497&4294967295,E=R+(T<<21&4294967295|T>>>11),T=y+(R^(E|~C))+b[8]+1873313359&4294967295,y=E+(T<<6&4294967295|T>>>26),T=C+(E^(y|~R))+b[15]+4264355552&4294967295,C=y+(T<<10&4294967295|T>>>22),T=R+(y^(C|~E))+b[6]+2734768916&4294967295,R=C+(T<<15&4294967295|T>>>17),T=E+(C^(R|~y))+b[13]+1309151649&4294967295,E=R+(T<<21&4294967295|T>>>11),T=y+(R^(E|~C))+b[4]+4149444226&4294967295,y=E+(T<<6&4294967295|T>>>26),T=C+(E^(y|~R))+b[11]+3174756917&4294967295,C=y+(T<<10&4294967295|T>>>22),T=R+(y^(C|~E))+b[2]+718787259&4294967295,R=C+(T<<15&4294967295|T>>>17),T=E+(C^(R|~y))+b[9]+3951481745&4294967295,I.g[0]=I.g[0]+y&4294967295,I.g[1]=I.g[1]+(R+(T<<21&4294967295|T>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+C&4294967295}r.prototype.u=function(I,y){y===void 0&&(y=I.length);for(var E=y-this.blockSize,b=this.B,R=this.h,C=0;C<y;){if(R==0)for(;C<=E;)i(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<y;)if(b[R++]=I.charCodeAt(C++),R==this.blockSize){i(this,b),R=0;break}}else for(;C<y;)if(b[R++]=I[C++],R==this.blockSize){i(this,b),R=0;break}}this.h=R,this.o+=y},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var y=1;y<I.length-8;++y)I[y]=0;var E=8*this.o;for(y=I.length-8;y<I.length;++y)I[y]=E&255,E/=256;for(this.u(I),I=Array(16),y=E=0;4>y;++y)for(var b=0;32>b;b+=8)I[E++]=this.g[y]>>>b&255;return I};function s(I,y){var E=u;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=y(I)}function a(I,y){this.h=y;for(var E=[],b=!0,R=I.length-1;0<=R;R--){var C=I[R]|0;b&&C==y||(E[R]=C,b=!1)}this.g=E}var u={};function l(I){return-128<=I&&128>I?s(I,function(y){return new a([y|0],0>y?-1:0)}):new a([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return w(c(-I));for(var y=[],E=1,b=0;I>=E;b++)y[b]=I/E|0,E*=4294967296;return new a(y,0)}function f(I,y){if(I.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(I.charAt(0)=="-")return w(f(I.substring(1),y));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=c(Math.pow(y,8)),b=p,R=0;R<I.length;R+=8){var C=Math.min(8,I.length-R),T=parseInt(I.substring(R,R+C),y);8>C?(C=c(Math.pow(y,C)),b=b.j(C).add(c(T))):(b=b.j(E),b=b.add(c(T)))}return b}var p=l(0),m=l(1),_=l(16777216);e=a.prototype,e.m=function(){if(A(this))return-w(this).m();for(var I=0,y=1,E=0;E<this.g.length;E++){var b=this.i(E);I+=(0<=b?b:4294967296+b)*y,y*=4294967296}return I},e.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(A(this))return"-"+w(this).toString(I);for(var y=c(Math.pow(I,6)),E=this,b="";;){var R=k(E,y).g;E=x(E,R.j(y));var C=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=R,v(E))return C+b;for(;6>C.length;)C="0"+C;b=C+b}},e.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(var y=0;y<I.g.length;y++)if(I.g[y]!=0)return!1;return!0}function A(I){return I.h==-1}e.l=function(I){return I=x(this,I),A(I)?-1:v(I)?0:1};function w(I){for(var y=I.g.length,E=[],b=0;b<y;b++)E[b]=~I.g[b];return new a(E,~I.h).add(m)}e.abs=function(){return A(this)?w(this):this},e.add=function(I){for(var y=Math.max(this.g.length,I.g.length),E=[],b=0,R=0;R<=y;R++){var C=b+(this.i(R)&65535)+(I.i(R)&65535),T=(C>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);b=T>>>16,C&=65535,T&=65535,E[R]=T<<16|C}return new a(E,E[E.length-1]&-2147483648?-1:0)};function x(I,y){return I.add(w(y))}e.j=function(I){if(v(this)||v(I))return p;if(A(this))return A(I)?w(this).j(w(I)):w(w(this).j(I));if(A(I))return w(this.j(w(I)));if(0>this.l(_)&&0>I.l(_))return c(this.m()*I.m());for(var y=this.g.length+I.g.length,E=[],b=0;b<2*y;b++)E[b]=0;for(b=0;b<this.g.length;b++)for(var R=0;R<I.g.length;R++){var C=this.i(b)>>>16,T=this.i(b)&65535,qt=I.i(R)>>>16,ce=I.i(R)&65535;E[2*b+2*R]+=T*ce,N(E,2*b+2*R),E[2*b+2*R+1]+=C*ce,N(E,2*b+2*R+1),E[2*b+2*R+1]+=T*qt,N(E,2*b+2*R+1),E[2*b+2*R+2]+=C*qt,N(E,2*b+2*R+2)}for(b=0;b<y;b++)E[b]=E[2*b+1]<<16|E[2*b];for(b=y;b<2*y;b++)E[b]=0;return new a(E,0)};function N(I,y){for(;(I[y]&65535)!=I[y];)I[y+1]+=I[y]>>>16,I[y]&=65535,y++}function M(I,y){this.g=I,this.h=y}function k(I,y){if(v(y))throw Error("division by zero");if(v(I))return new M(p,p);if(A(I))return y=k(w(I),y),new M(w(y.g),w(y.h));if(A(y))return y=k(I,w(y)),new M(w(y.g),y.h);if(30<I.g.length){if(A(I)||A(y))throw Error("slowDivide_ only works with positive integers.");for(var E=m,b=y;0>=b.l(I);)E=U(E),b=U(b);var R=H(E,1),C=H(b,1);for(b=H(b,2),E=H(E,2);!v(b);){var T=C.add(b);0>=T.l(I)&&(R=R.add(E),C=T),b=H(b,1),E=H(E,1)}return y=x(I,R.j(y)),new M(R,y)}for(R=p;0<=I.l(y);){for(E=Math.max(1,Math.floor(I.m()/y.m())),b=Math.ceil(Math.log(E)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),C=c(E),T=C.j(y);A(T)||0<T.l(I);)E-=b,C=c(E),T=C.j(y);v(C)&&(C=m),R=R.add(C),I=x(I,T)}return new M(R,I)}e.A=function(I){return k(this,I).h},e.and=function(I){for(var y=Math.max(this.g.length,I.g.length),E=[],b=0;b<y;b++)E[b]=this.i(b)&I.i(b);return new a(E,this.h&I.h)},e.or=function(I){for(var y=Math.max(this.g.length,I.g.length),E=[],b=0;b<y;b++)E[b]=this.i(b)|I.i(b);return new a(E,this.h|I.h)},e.xor=function(I){for(var y=Math.max(this.g.length,I.g.length),E=[],b=0;b<y;b++)E[b]=this.i(b)^I.i(b);return new a(E,this.h^I.h)};function U(I){for(var y=I.g.length+1,E=[],b=0;b<y;b++)E[b]=I.i(b)<<1|I.i(b-1)>>>31;return new a(E,I.h)}function H(I,y){var E=y>>5;y%=32;for(var b=I.g.length-E,R=[],C=0;C<b;C++)R[C]=0<y?I.i(C+E)>>>y|I.i(C+E+1)<<32-y:I.i(C+E);return new a(R,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,ad=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=f,Ze=a}).apply(typeof Dc<"u"?Dc:typeof self<"u"?self:typeof window<"u"?window:{});var zi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ud,kr,ld,Zi,ya,cd,hd,fd;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,h,d){return o==Array.prototype||o==Object.prototype||(o[h]=d.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof zi=="object"&&zi];for(var h=0;h<o.length;++h){var d=o[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=n(this);function i(o,h){if(h)t:{var d=r;o=o.split(".");for(var g=0;g<o.length-1;g++){var S=o[g];if(!(S in d))break t;d=d[S]}o=o[o.length-1],g=d[o],h=h(g),h!=g&&h!=null&&t(d,o,{configurable:!0,writable:!0,value:h})}}function s(o,h){o instanceof String&&(o+="");var d=0,g=!1,S={next:function(){if(!g&&d<o.length){var V=d++;return{value:h(V,o[V]),done:!1}}return g=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}i("Array.prototype.values",function(o){return o||function(){return s(this,function(h,d){return d})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function l(o){var h=typeof o;return h=h!="object"?h:o?Array.isArray(o)?"array":h:"null",h=="array"||h=="object"&&typeof o.length=="number"}function c(o){var h=typeof o;return h=="object"&&o!=null||h=="function"}function f(o,h,d){return o.call.apply(o.bind,arguments)}function p(o,h,d){if(!o)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var S=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(S,g),o.apply(h,S)}}return function(){return o.apply(h,arguments)}}function m(o,h,d){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function _(o,h){var d=Array.prototype.slice.call(arguments,1);return function(){var g=d.slice();return g.push.apply(g,arguments),o.apply(this,g)}}function v(o,h){function d(){}d.prototype=h.prototype,o.aa=h.prototype,o.prototype=new d,o.prototype.constructor=o,o.Qb=function(g,S,V){for(var F=Array(arguments.length-2),it=2;it<arguments.length;it++)F[it-2]=arguments[it];return h.prototype[S].apply(g,F)}}function A(o){const h=o.length;if(0<h){const d=Array(h);for(let g=0;g<h;g++)d[g]=o[g];return d}return[]}function w(o,h){for(let d=1;d<arguments.length;d++){const g=arguments[d];if(l(g)){const S=o.length||0,V=g.length||0;o.length=S+V;for(let F=0;F<V;F++)o[S+F]=g[F]}else o.push(g)}}class x{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function N(o){return/^[\s\xa0]*$/.test(o)}function M(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function k(o){return k[" "](o),o}k[" "]=function(){};var U=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function H(o,h,d){for(const g in o)h.call(d,o[g],g,o)}function I(o,h){for(const d in o)h.call(void 0,o[d],d,o)}function y(o){const h={};for(const d in o)h[d]=o[d];return h}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(o,h){let d,g;for(let S=1;S<arguments.length;S++){g=arguments[S];for(d in g)o[d]=g[d];for(let V=0;V<E.length;V++)d=E[V],Object.prototype.hasOwnProperty.call(g,d)&&(o[d]=g[d])}}function R(o){var h=1;o=o.split(":");const d=[];for(;0<h&&o.length;)d.push(o.shift()),h--;return o.length&&d.push(o.join(":")),d}function C(o){u.setTimeout(()=>{throw o},0)}function T(){var o=st;let h=null;return o.g&&(h=o.g,o.g=o.g.next,o.g||(o.h=null),h.next=null),h}class qt{constructor(){this.h=this.g=null}add(h,d){const g=ce.get();g.set(h,d),this.h?this.h.next=g:this.g=g,this.h=g}}var ce=new x(()=>new kn,o=>o.reset());class kn{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let K,$=!1,st=new qt,$t=()=>{const o=u.Promise.resolve(void 0);K=()=>{o.then($e)}};var $e=()=>{for(var o;o=T();){try{o.h.call(o.g)}catch(d){C(d)}var h=ce;h.j(o),100>h.h&&(h.h++,o.next=h.g,h.g=o)}$=!1};function Et(){this.s=this.s,this.C=this.C}Et.prototype.s=!1,Et.prototype.ma=function(){this.s||(this.s=!0,this.N())},Et.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function at(o,h){this.type=o,this.g=this.target=h,this.defaultPrevented=!1}at.prototype.h=function(){this.defaultPrevented=!0};var mr=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,h=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const d=()=>{};u.addEventListener("test",d,h),u.removeEventListener("test",d,h)}catch{}return o}();function be(o,h){if(at.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var d=this.type=o.type,g=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=h,h=o.relatedTarget){if(U){t:{try{k(h.nodeName);var S=!0;break t}catch{}S=!1}S||(h=null)}}else d=="mouseover"?h=o.fromElement:d=="mouseout"&&(h=o.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:yo[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&be.aa.h.call(this)}}v(be,at);var yo={2:"touch",3:"pen",4:"mouse"};be.prototype.h=function(){be.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var On="closure_listenable_"+(1e6*Math.random()|0),Um=0;function Bm(o,h,d,g,S){this.listener=o,this.proxy=null,this.src=h,this.type=d,this.capture=!!g,this.ha=S,this.key=++Um,this.da=this.fa=!1}function Ii(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function bi(o){this.src=o,this.g={},this.h=0}bi.prototype.add=function(o,h,d,g,S){var V=o.toString();o=this.g[V],o||(o=this.g[V]=[],this.h++);var F=wo(o,h,g,S);return-1<F?(h=o[F],d||(h.fa=!1)):(h=new Bm(h,this.src,V,!!g,S),h.fa=d,o.push(h)),h};function vo(o,h){var d=h.type;if(d in o.g){var g=o.g[d],S=Array.prototype.indexOf.call(g,h,void 0),V;(V=0<=S)&&Array.prototype.splice.call(g,S,1),V&&(Ii(h),o.g[d].length==0&&(delete o.g[d],o.h--))}}function wo(o,h,d,g){for(var S=0;S<o.length;++S){var V=o[S];if(!V.da&&V.listener==h&&V.capture==!!d&&V.ha==g)return S}return-1}var Eo="closure_lm_"+(1e6*Math.random()|0),To={};function hl(o,h,d,g,S){if(Array.isArray(h)){for(var V=0;V<h.length;V++)hl(o,h[V],d,g,S);return null}return d=pl(d),o&&o[On]?o.K(h,d,c(g)?!!g.capture:!1,S):qm(o,h,d,!1,g,S)}function qm(o,h,d,g,S,V){if(!h)throw Error("Invalid event type");var F=c(S)?!!S.capture:!!S,it=Io(o);if(it||(o[Eo]=it=new bi(o)),d=it.add(h,d,g,F,V),d.proxy)return d;if(g=$m(),d.proxy=g,g.src=o,g.listener=d,o.addEventListener)mr||(S=F),S===void 0&&(S=!1),o.addEventListener(h.toString(),g,S);else if(o.attachEvent)o.attachEvent(dl(h.toString()),g);else if(o.addListener&&o.removeListener)o.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return d}function $m(){function o(d){return h.call(o.src,o.listener,d)}const h=jm;return o}function fl(o,h,d,g,S){if(Array.isArray(h))for(var V=0;V<h.length;V++)fl(o,h[V],d,g,S);else g=c(g)?!!g.capture:!!g,d=pl(d),o&&o[On]?(o=o.i,h=String(h).toString(),h in o.g&&(V=o.g[h],d=wo(V,d,g,S),-1<d&&(Ii(V[d]),Array.prototype.splice.call(V,d,1),V.length==0&&(delete o.g[h],o.h--)))):o&&(o=Io(o))&&(h=o.g[h.toString()],o=-1,h&&(o=wo(h,d,g,S)),(d=-1<o?h[o]:null)&&Ao(d))}function Ao(o){if(typeof o!="number"&&o&&!o.da){var h=o.src;if(h&&h[On])vo(h.i,o);else{var d=o.type,g=o.proxy;h.removeEventListener?h.removeEventListener(d,g,o.capture):h.detachEvent?h.detachEvent(dl(d),g):h.addListener&&h.removeListener&&h.removeListener(g),(d=Io(h))?(vo(d,o),d.h==0&&(d.src=null,h[Eo]=null)):Ii(o)}}}function dl(o){return o in To?To[o]:To[o]="on"+o}function jm(o,h){if(o.da)o=!0;else{h=new be(h,this);var d=o.listener,g=o.ha||o.src;o.fa&&Ao(o),o=d.call(g,h)}return o}function Io(o){return o=o[Eo],o instanceof bi?o:null}var bo="__closure_events_fn_"+(1e9*Math.random()>>>0);function pl(o){return typeof o=="function"?o:(o[bo]||(o[bo]=function(h){return o.handleEvent(h)}),o[bo])}function Ct(){Et.call(this),this.i=new bi(this),this.M=this,this.F=null}v(Ct,Et),Ct.prototype[On]=!0,Ct.prototype.removeEventListener=function(o,h,d,g){fl(this,o,h,d,g)};function Mt(o,h){var d,g=o.F;if(g)for(d=[];g;g=g.F)d.push(g);if(o=o.M,g=h.type||h,typeof h=="string")h=new at(h,o);else if(h instanceof at)h.target=h.target||o;else{var S=h;h=new at(g,o),b(h,S)}if(S=!0,d)for(var V=d.length-1;0<=V;V--){var F=h.g=d[V];S=Ri(F,g,!0,h)&&S}if(F=h.g=o,S=Ri(F,g,!0,h)&&S,S=Ri(F,g,!1,h)&&S,d)for(V=0;V<d.length;V++)F=h.g=d[V],S=Ri(F,g,!1,h)&&S}Ct.prototype.N=function(){if(Ct.aa.N.call(this),this.i){var o=this.i,h;for(h in o.g){for(var d=o.g[h],g=0;g<d.length;g++)Ii(d[g]);delete o.g[h],o.h--}}this.F=null},Ct.prototype.K=function(o,h,d,g){return this.i.add(String(o),h,!1,d,g)},Ct.prototype.L=function(o,h,d,g){return this.i.add(String(o),h,!0,d,g)};function Ri(o,h,d,g){if(h=o.i.g[String(h)],!h)return!0;h=h.concat();for(var S=!0,V=0;V<h.length;++V){var F=h[V];if(F&&!F.da&&F.capture==d){var it=F.listener,It=F.ha||F.src;F.fa&&vo(o.i,F),S=it.call(It,g)!==!1&&S}}return S&&!g.defaultPrevented}function ml(o,h,d){if(typeof o=="function")d&&(o=m(o,d));else if(o&&typeof o.handleEvent=="function")o=m(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:u.setTimeout(o,h||0)}function gl(o){o.g=ml(()=>{o.g=null,o.i&&(o.i=!1,gl(o))},o.l);const h=o.h;o.h=null,o.m.apply(null,h)}class zm extends Et{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:gl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gr(o){Et.call(this),this.h=o,this.g={}}v(gr,Et);var _l=[];function yl(o){H(o.g,function(h,d){this.g.hasOwnProperty(d)&&Ao(h)},o),o.g={}}gr.prototype.N=function(){gr.aa.N.call(this),yl(this)},gr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ro=u.JSON.stringify,Hm=u.JSON.parse,Gm=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function So(){}So.prototype.h=null;function vl(o){return o.h||(o.h=o.i())}function wl(){}var _r={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Co(){at.call(this,"d")}v(Co,at);function xo(){at.call(this,"c")}v(xo,at);var pn={},El=null;function Si(){return El=El||new Ct}pn.La="serverreachability";function Tl(o){at.call(this,pn.La,o)}v(Tl,at);function yr(o){const h=Si();Mt(h,new Tl(h))}pn.STAT_EVENT="statevent";function Al(o,h){at.call(this,pn.STAT_EVENT,o),this.stat=h}v(Al,at);function Ft(o){const h=Si();Mt(h,new Al(h,o))}pn.Ma="timingevent";function Il(o,h){at.call(this,pn.Ma,o),this.size=h}v(Il,at);function vr(o,h){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},h)}function wr(){this.g=!0}wr.prototype.xa=function(){this.g=!1};function Wm(o,h,d,g,S,V){o.info(function(){if(o.g)if(V)for(var F="",it=V.split("&"),It=0;It<it.length;It++){var tt=it[It].split("=");if(1<tt.length){var xt=tt[0];tt=tt[1];var Pt=xt.split("_");F=2<=Pt.length&&Pt[1]=="type"?F+(xt+"="+tt+"&"):F+(xt+"=redacted&")}}else F=null;else F=V;return"XMLHTTP REQ ("+g+") [attempt "+S+"]: "+h+`
`+d+`
`+F})}function Km(o,h,d,g,S,V,F){o.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+S+"]: "+h+`
`+d+`
`+V+" "+F})}function Mn(o,h,d,g){o.info(function(){return"XMLHTTP TEXT ("+h+"): "+Xm(o,d)+(g?" "+g:"")})}function Qm(o,h){o.info(function(){return"TIMEOUT: "+h})}wr.prototype.info=function(){};function Xm(o,h){if(!o.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(o=0;o<d.length;o++)if(Array.isArray(d[o])){var g=d[o];if(!(2>g.length)){var S=g[1];if(Array.isArray(S)&&!(1>S.length)){var V=S[0];if(V!="noop"&&V!="stop"&&V!="close")for(var F=1;F<S.length;F++)S[F]=""}}}}return Ro(d)}catch{return h}}var Ci={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Po;function xi(){}v(xi,So),xi.prototype.g=function(){return new XMLHttpRequest},xi.prototype.i=function(){return{}},Po=new xi;function je(o,h,d,g){this.j=o,this.i=h,this.l=d,this.R=g||1,this.U=new gr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Rl}function Rl(){this.i=null,this.g="",this.h=!1}var Sl={},Vo={};function No(o,h,d){o.L=1,o.v=Di(Re(h)),o.m=d,o.P=!0,Cl(o,null)}function Cl(o,h){o.F=Date.now(),Pi(o),o.A=Re(o.v);var d=o.A,g=o.R;Array.isArray(g)||(g=[String(g)]),$l(d.i,"t",g),o.C=0,d=o.j.J,o.h=new Rl,o.g=oc(o.j,d?h:null,!o.m),0<o.O&&(o.M=new zm(m(o.Y,o,o.g),o.O)),h=o.U,d=o.g,g=o.ca;var S="readystatechange";Array.isArray(S)||(S&&(_l[0]=S.toString()),S=_l);for(var V=0;V<S.length;V++){var F=hl(d,S[V],g||h.handleEvent,!1,h.h||h);if(!F)break;h.g[F.key]=F}h=o.H?y(o.H):{},o.m?(o.u||(o.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,h)):(o.u="GET",o.g.ea(o.A,o.u,null,h)),yr(),Wm(o.i,o.u,o.A,o.l,o.R,o.m)}je.prototype.ca=function(o){o=o.target;const h=this.M;h&&Se(o)==3?h.j():this.Y(o)},je.prototype.Y=function(o){try{if(o==this.g)t:{const Pt=Se(this.g);var h=this.g.Ba();const Un=this.g.Z();if(!(3>Pt)&&(Pt!=3||this.g&&(this.h.h||this.g.oa()||Ql(this.g)))){this.J||Pt!=4||h==7||(h==8||0>=Un?yr(3):yr(2)),Do(this);var d=this.g.Z();this.X=d;e:if(xl(this)){var g=Ql(this.g);o="";var S=g.length,V=Se(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mn(this),Er(this);var F="";break e}this.h.i=new u.TextDecoder}for(h=0;h<S;h++)this.h.h=!0,o+=this.h.i.decode(g[h],{stream:!(V&&h==S-1)});g.length=0,this.h.g+=o,this.C=0,F=this.h.g}else F=this.g.oa();if(this.o=d==200,Km(this.i,this.u,this.A,this.l,this.R,Pt,d),this.o){if(this.T&&!this.K){e:{if(this.g){var it,It=this.g;if((it=It.g?It.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(it)){var tt=it;break e}}tt=null}if(d=tt)Mn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ko(this,d);else{this.o=!1,this.s=3,Ft(12),mn(this),Er(this);break t}}if(this.P){d=!0;let re;for(;!this.J&&this.C<F.length;)if(re=Jm(this,F),re==Vo){Pt==4&&(this.s=4,Ft(14),d=!1),Mn(this.i,this.l,null,"[Incomplete Response]");break}else if(re==Sl){this.s=4,Ft(15),Mn(this.i,this.l,F,"[Invalid Chunk]"),d=!1;break}else Mn(this.i,this.l,re,null),ko(this,re);if(xl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pt!=4||F.length!=0||this.h.h||(this.s=1,Ft(16),d=!1),this.o=this.o&&d,!d)Mn(this.i,this.l,F,"[Invalid Chunked Response]"),mn(this),Er(this);else if(0<F.length&&!this.W){this.W=!0;var xt=this.j;xt.g==this&&xt.ba&&!xt.M&&(xt.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),Bo(xt),xt.M=!0,Ft(11))}}else Mn(this.i,this.l,F,null),ko(this,F);Pt==4&&mn(this),this.o&&!this.J&&(Pt==4?nc(this.j,this):(this.o=!1,Pi(this)))}else pg(this.g),d==400&&0<F.indexOf("Unknown SID")?(this.s=3,Ft(12)):(this.s=0,Ft(13)),mn(this),Er(this)}}}catch{}finally{}};function xl(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Jm(o,h){var d=o.C,g=h.indexOf(`
`,d);return g==-1?Vo:(d=Number(h.substring(d,g)),isNaN(d)?Sl:(g+=1,g+d>h.length?Vo:(h=h.slice(g,g+d),o.C=g+d,h)))}je.prototype.cancel=function(){this.J=!0,mn(this)};function Pi(o){o.S=Date.now()+o.I,Pl(o,o.I)}function Pl(o,h){if(o.B!=null)throw Error("WatchDog timer not null");o.B=vr(m(o.ba,o),h)}function Do(o){o.B&&(u.clearTimeout(o.B),o.B=null)}je.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Qm(this.i,this.A),this.L!=2&&(yr(),Ft(17)),mn(this),this.s=2,Er(this)):Pl(this,this.S-o)};function Er(o){o.j.G==0||o.J||nc(o.j,o)}function mn(o){Do(o);var h=o.M;h&&typeof h.ma=="function"&&h.ma(),o.M=null,yl(o.U),o.g&&(h=o.g,o.g=null,h.abort(),h.ma())}function ko(o,h){try{var d=o.j;if(d.G!=0&&(d.g==o||Oo(d.h,o))){if(!o.K&&Oo(d.h,o)&&d.G==3){try{var g=d.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var S=g;if(S[0]==0){t:if(!d.u){if(d.g)if(d.g.F+3e3<o.F)Ui(d),Fi(d);else break t;Uo(d),Ft(18)}}else d.za=S[1],0<d.za-d.T&&37500>S[2]&&d.F&&d.v==0&&!d.C&&(d.C=vr(m(d.Za,d),6e3));if(1>=Dl(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else _n(d,11)}else if((o.K||d.g==o)&&Ui(d),!N(h))for(S=d.Da.g.parse(h),h=0;h<S.length;h++){let tt=S[h];if(d.T=tt[0],tt=tt[1],d.G==2)if(tt[0]=="c"){d.K=tt[1],d.ia=tt[2];const xt=tt[3];xt!=null&&(d.la=xt,d.j.info("VER="+d.la));const Pt=tt[4];Pt!=null&&(d.Aa=Pt,d.j.info("SVER="+d.Aa));const Un=tt[5];Un!=null&&typeof Un=="number"&&0<Un&&(g=1.5*Un,d.L=g,d.j.info("backChannelRequestTimeoutMs_="+g)),g=d;const re=o.g;if(re){const qi=re.g?re.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qi){var V=g.h;V.g||qi.indexOf("spdy")==-1&&qi.indexOf("quic")==-1&&qi.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(Mo(V,V.h),V.h=null))}if(g.D){const qo=re.g?re.g.getResponseHeader("X-HTTP-Session-Id"):null;qo&&(g.ya=qo,ut(g.I,g.D,qo))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-o.F,d.j.info("Handshake RTT: "+d.R+"ms")),g=d;var F=o;if(g.qa=sc(g,g.J?g.ia:null,g.W),F.K){kl(g.h,F);var it=F,It=g.L;It&&(it.I=It),it.B&&(Do(it),Pi(it)),g.g=F}else tc(g);0<d.i.length&&Li(d)}else tt[0]!="stop"&&tt[0]!="close"||_n(d,7);else d.G==3&&(tt[0]=="stop"||tt[0]=="close"?tt[0]=="stop"?_n(d,7):Lo(d):tt[0]!="noop"&&d.l&&d.l.ta(tt),d.v=0)}}yr(4)}catch{}}var Ym=class{constructor(o,h){this.g=o,this.map=h}};function Vl(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Nl(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Dl(o){return o.h?1:o.g?o.g.size:0}function Oo(o,h){return o.h?o.h==h:o.g?o.g.has(h):!1}function Mo(o,h){o.g?o.g.add(h):o.h=h}function kl(o,h){o.h&&o.h==h?o.h=null:o.g&&o.g.has(h)&&o.g.delete(h)}Vl.prototype.cancel=function(){if(this.i=Ol(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Ol(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let h=o.i;for(const d of o.g.values())h=h.concat(d.D);return h}return A(o.i)}function Zm(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var h=[],d=o.length,g=0;g<d;g++)h.push(o[g]);return h}h=[],d=0;for(g in o)h[d++]=o[g];return h}function tg(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var h=[];o=o.length;for(var d=0;d<o;d++)h.push(d);return h}h=[],d=0;for(const g in o)h[d++]=g;return h}}}function Ml(o,h){if(o.forEach&&typeof o.forEach=="function")o.forEach(h,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,h,void 0);else for(var d=tg(o),g=Zm(o),S=g.length,V=0;V<S;V++)h.call(void 0,g[V],d&&d[V],o)}var Fl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eg(o,h){if(o){o=o.split("&");for(var d=0;d<o.length;d++){var g=o[d].indexOf("="),S=null;if(0<=g){var V=o[d].substring(0,g);S=o[d].substring(g+1)}else V=o[d];h(V,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function gn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof gn){this.h=o.h,Vi(this,o.j),this.o=o.o,this.g=o.g,Ni(this,o.s),this.l=o.l;var h=o.i,d=new Ir;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),Ll(this,d),this.m=o.m}else o&&(h=String(o).match(Fl))?(this.h=!1,Vi(this,h[1]||"",!0),this.o=Tr(h[2]||""),this.g=Tr(h[3]||"",!0),Ni(this,h[4]),this.l=Tr(h[5]||"",!0),Ll(this,h[6]||"",!0),this.m=Tr(h[7]||"")):(this.h=!1,this.i=new Ir(null,this.h))}gn.prototype.toString=function(){var o=[],h=this.j;h&&o.push(Ar(h,Ul,!0),":");var d=this.g;return(d||h=="file")&&(o.push("//"),(h=this.o)&&o.push(Ar(h,Ul,!0),"@"),o.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&o.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(Ar(d,d.charAt(0)=="/"?ig:rg,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",Ar(d,og)),o.join("")};function Re(o){return new gn(o)}function Vi(o,h,d){o.j=d?Tr(h,!0):h,o.j&&(o.j=o.j.replace(/:$/,""))}function Ni(o,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);o.s=h}else o.s=null}function Ll(o,h,d){h instanceof Ir?(o.i=h,ag(o.i,o.h)):(d||(h=Ar(h,sg)),o.i=new Ir(h,o.h))}function ut(o,h,d){o.i.set(h,d)}function Di(o){return ut(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Tr(o,h){return o?h?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ar(o,h,d){return typeof o=="string"?(o=encodeURI(o).replace(h,ng),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function ng(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Ul=/[#\/\?@]/g,rg=/[#\?:]/g,ig=/[#\?]/g,sg=/[#\?@]/g,og=/#/g;function Ir(o,h){this.h=this.g=null,this.i=o||null,this.j=!!h}function ze(o){o.g||(o.g=new Map,o.h=0,o.i&&eg(o.i,function(h,d){o.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}e=Ir.prototype,e.add=function(o,h){ze(this),this.i=null,o=Fn(this,o);var d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(h),this.h+=1,this};function Bl(o,h){ze(o),h=Fn(o,h),o.g.has(h)&&(o.i=null,o.h-=o.g.get(h).length,o.g.delete(h))}function ql(o,h){return ze(o),h=Fn(o,h),o.g.has(h)}e.forEach=function(o,h){ze(this),this.g.forEach(function(d,g){d.forEach(function(S){o.call(h,S,g,this)},this)},this)},e.na=function(){ze(this);const o=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let g=0;g<h.length;g++){const S=o[g];for(let V=0;V<S.length;V++)d.push(h[g])}return d},e.V=function(o){ze(this);let h=[];if(typeof o=="string")ql(this,o)&&(h=h.concat(this.g.get(Fn(this,o))));else{o=Array.from(this.g.values());for(let d=0;d<o.length;d++)h=h.concat(o[d])}return h},e.set=function(o,h){return ze(this),this.i=null,o=Fn(this,o),ql(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[h]),this.h+=1,this},e.get=function(o,h){return o?(o=this.V(o),0<o.length?String(o[0]):h):h};function $l(o,h,d){Bl(o,h),0<d.length&&(o.i=null,o.g.set(Fn(o,h),A(d)),o.h+=d.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var g=h[d];const V=encodeURIComponent(String(g)),F=this.V(g);for(g=0;g<F.length;g++){var S=V;F[g]!==""&&(S+="="+encodeURIComponent(String(F[g]))),o.push(S)}}return this.i=o.join("&")};function Fn(o,h){return h=String(h),o.j&&(h=h.toLowerCase()),h}function ag(o,h){h&&!o.j&&(ze(o),o.i=null,o.g.forEach(function(d,g){var S=g.toLowerCase();g!=S&&(Bl(this,g),$l(this,S,d))},o)),o.j=h}function ug(o,h){const d=new wr;if(u.Image){const g=new Image;g.onload=_(He,d,"TestLoadImage: loaded",!0,h,g),g.onerror=_(He,d,"TestLoadImage: error",!1,h,g),g.onabort=_(He,d,"TestLoadImage: abort",!1,h,g),g.ontimeout=_(He,d,"TestLoadImage: timeout",!1,h,g),u.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=o}else h(!1)}function lg(o,h){const d=new wr,g=new AbortController,S=setTimeout(()=>{g.abort(),He(d,"TestPingServer: timeout",!1,h)},1e4);fetch(o,{signal:g.signal}).then(V=>{clearTimeout(S),V.ok?He(d,"TestPingServer: ok",!0,h):He(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(S),He(d,"TestPingServer: error",!1,h)})}function He(o,h,d,g,S){try{S&&(S.onload=null,S.onerror=null,S.onabort=null,S.ontimeout=null),g(d)}catch{}}function cg(){this.g=new Gm}function hg(o,h,d){const g=d||"";try{Ml(o,function(S,V){let F=S;c(S)&&(F=Ro(S)),h.push(g+V+"="+encodeURIComponent(F))})}catch(S){throw h.push(g+"type="+encodeURIComponent("_badmap")),S}}function ki(o){this.l=o.Ub||null,this.j=o.eb||!1}v(ki,So),ki.prototype.g=function(){return new Oi(this.l,this.j)},ki.prototype.i=function(o){return function(){return o}}({});function Oi(o,h){Ct.call(this),this.D=o,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Oi,Ct),e=Oi.prototype,e.open=function(o,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=h,this.readyState=1,Rr(this)},e.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(h.body=o),(this.D||u).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,br(this)),this.readyState=0},e.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Rr(this)),this.g&&(this.readyState=3,Rr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;jl(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function jl(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}e.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var h=o.value?o.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!o.done}))&&(this.response=this.responseText+=h)}o.done?br(this):Rr(this),this.readyState==3&&jl(this)}},e.Ra=function(o){this.g&&(this.response=this.responseText=o,br(this))},e.Qa=function(o){this.g&&(this.response=o,br(this))},e.ga=function(){this.g&&br(this)};function br(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Rr(o)}e.setRequestHeader=function(o,h){this.u.append(o,h)},e.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=h.next();return o.join(`\r
`)};function Rr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function zl(o){let h="";return H(o,function(d,g){h+=g,h+=":",h+=d,h+=`\r
`}),h}function Fo(o,h,d){t:{for(g in d){var g=!1;break t}g=!0}g||(d=zl(d),typeof o=="string"?d!=null&&encodeURIComponent(String(d)):ut(o,h,d))}function ht(o){Ct.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(ht,Ct);var fg=/^https?$/i,dg=["POST","PUT"];e=ht.prototype,e.Ha=function(o){this.J=o},e.ea=function(o,h,d,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);h=h?h.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Po.g(),this.v=this.o?vl(this.o):vl(Po),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(o),!0),this.B=!1}catch(V){Hl(this,V);return}if(o=d||"",d=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var S in g)d.set(S,g[S]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(const V of g.keys())d.set(V,g.get(V));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(d.keys()).find(V=>V.toLowerCase()=="content-type"),S=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(dg,h,void 0))||g||S||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,F]of d)this.g.setRequestHeader(V,F);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Kl(this),this.u=!0,this.g.send(o),this.u=!1}catch(V){Hl(this,V)}};function Hl(o,h){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=h,o.m=5,Gl(o),Mi(o)}function Gl(o){o.A||(o.A=!0,Mt(o,"complete"),Mt(o,"error"))}e.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Mt(this,"complete"),Mt(this,"abort"),Mi(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mi(this,!0)),ht.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Wl(this):this.bb())},e.bb=function(){Wl(this)};function Wl(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Se(o)!=4||o.Z()!=2)){if(o.u&&Se(o)==4)ml(o.Ea,0,o);else if(Mt(o,"readystatechange"),Se(o)==4){o.h=!1;try{const F=o.Z();t:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break t;default:h=!1}var d;if(!(d=h)){var g;if(g=F===0){var S=String(o.D).match(Fl)[1]||null;!S&&u.self&&u.self.location&&(S=u.self.location.protocol.slice(0,-1)),g=!fg.test(S?S.toLowerCase():"")}d=g}if(d)Mt(o,"complete"),Mt(o,"success");else{o.m=6;try{var V=2<Se(o)?o.g.statusText:""}catch{V=""}o.l=V+" ["+o.Z()+"]",Gl(o)}}finally{Mi(o)}}}}function Mi(o,h){if(o.g){Kl(o);const d=o.g,g=o.v[0]?()=>{}:null;o.g=null,o.v=null,h||Mt(o,"ready");try{d.onreadystatechange=g}catch{}}}function Kl(o){o.I&&(u.clearTimeout(o.I),o.I=null)}e.isActive=function(){return!!this.g};function Se(o){return o.g?o.g.readyState:0}e.Z=function(){try{return 2<Se(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(o){if(this.g){var h=this.g.responseText;return o&&h.indexOf(o)==0&&(h=h.substring(o.length)),Hm(h)}};function Ql(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function pg(o){const h={};o=(o.g&&2<=Se(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<o.length;g++){if(N(o[g]))continue;var d=R(o[g]);const S=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();const V=h[S]||[];h[S]=V,V.push(d)}I(h,function(g){return g.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Sr(o,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||h}function Xl(o){this.Aa=0,this.i=[],this.j=new wr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Sr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Sr("baseRetryDelayMs",5e3,o),this.cb=Sr("retryDelaySeedMs",1e4,o),this.Wa=Sr("forwardChannelMaxRetries",2,o),this.wa=Sr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Vl(o&&o.concurrentRequestLimit),this.Da=new cg,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Xl.prototype,e.la=8,e.G=1,e.connect=function(o,h,d,g){Ft(0),this.W=o,this.H=h||{},d&&g!==void 0&&(this.H.OSID=d,this.H.OAID=g),this.F=this.X,this.I=sc(this,null,this.W),Li(this)};function Lo(o){if(Jl(o),o.G==3){var h=o.U++,d=Re(o.I);if(ut(d,"SID",o.K),ut(d,"RID",h),ut(d,"TYPE","terminate"),Cr(o,d),h=new je(o,o.j,h),h.L=2,h.v=Di(Re(d)),d=!1,u.navigator&&u.navigator.sendBeacon)try{d=u.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&u.Image&&(new Image().src=h.v,d=!0),d||(h.g=oc(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Pi(h)}ic(o)}function Fi(o){o.g&&(Bo(o),o.g.cancel(),o.g=null)}function Jl(o){Fi(o),o.u&&(u.clearTimeout(o.u),o.u=null),Ui(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function Li(o){if(!Nl(o.h)&&!o.s){o.s=!0;var h=o.Ga;K||$t(),$||(K(),$=!0),st.add(h,o),o.B=0}}function mg(o,h){return Dl(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=h.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=vr(m(o.Ga,o,h),rc(o,o.B)),o.B++,!0)}e.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const S=new je(this,this.j,o);let V=this.o;if(this.S&&(V?(V=y(V),b(V,this.S)):V=this.S),this.m!==null||this.O||(S.H=V,V=null),this.P)t:{for(var h=0,d=0;d<this.i.length;d++){e:{var g=this.i[d];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break e}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=d;break t}if(h===4096||d===this.i.length-1){h=d+1;break t}}h=1e3}else h=1e3;h=Zl(this,S,h),d=Re(this.I),ut(d,"RID",o),ut(d,"CVER",22),this.D&&ut(d,"X-HTTP-Session-Id",this.D),Cr(this,d),V&&(this.O?h="headers="+encodeURIComponent(String(zl(V)))+"&"+h:this.m&&Fo(d,this.m,V)),Mo(this.h,S),this.Ua&&ut(d,"TYPE","init"),this.P?(ut(d,"$req",h),ut(d,"SID","null"),S.T=!0,No(S,d,null)):No(S,d,h),this.G=2}}else this.G==3&&(o?Yl(this,o):this.i.length==0||Nl(this.h)||Yl(this))};function Yl(o,h){var d;h?d=h.l:d=o.U++;const g=Re(o.I);ut(g,"SID",o.K),ut(g,"RID",d),ut(g,"AID",o.T),Cr(o,g),o.m&&o.o&&Fo(g,o.m,o.o),d=new je(o,o.j,d,o.B+1),o.m===null&&(d.H=o.o),h&&(o.i=h.D.concat(o.i)),h=Zl(o,d,1e3),d.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Mo(o.h,d),No(d,g,h)}function Cr(o,h){o.H&&H(o.H,function(d,g){ut(h,g,d)}),o.l&&Ml({},function(d,g){ut(h,g,d)})}function Zl(o,h,d){d=Math.min(o.i.length,d);var g=o.l?m(o.l.Na,o.l,o):null;t:{var S=o.i;let V=-1;for(;;){const F=["count="+d];V==-1?0<d?(V=S[0].g,F.push("ofs="+V)):V=0:F.push("ofs="+V);let it=!0;for(let It=0;It<d;It++){let tt=S[It].g;const xt=S[It].map;if(tt-=V,0>tt)V=Math.max(0,S[It].g-100),it=!1;else try{hg(xt,F,"req"+tt+"_")}catch{g&&g(xt)}}if(it){g=F.join("&");break t}}}return o=o.i.splice(0,d),h.D=o,g}function tc(o){if(!o.g&&!o.u){o.Y=1;var h=o.Fa;K||$t(),$||(K(),$=!0),st.add(h,o),o.v=0}}function Uo(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=vr(m(o.Fa,o),rc(o,o.v)),o.v++,!0)}e.Fa=function(){if(this.u=null,ec(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=vr(m(this.ab,this),o)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ft(10),Fi(this),ec(this))};function Bo(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function ec(o){o.g=new je(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var h=Re(o.qa);ut(h,"RID","rpc"),ut(h,"SID",o.K),ut(h,"AID",o.T),ut(h,"CI",o.F?"0":"1"),!o.F&&o.ja&&ut(h,"TO",o.ja),ut(h,"TYPE","xmlhttp"),Cr(o,h),o.m&&o.o&&Fo(h,o.m,o.o),o.L&&(o.g.I=o.L);var d=o.g;o=o.ia,d.L=1,d.v=Di(Re(h)),d.m=null,d.P=!0,Cl(d,o)}e.Za=function(){this.C!=null&&(this.C=null,Fi(this),Uo(this),Ft(19))};function Ui(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function nc(o,h){var d=null;if(o.g==h){Ui(o),Bo(o),o.g=null;var g=2}else if(Oo(o.h,h))d=h.D,kl(o.h,h),g=1;else return;if(o.G!=0){if(h.o)if(g==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var S=o.B;g=Si(),Mt(g,new Il(g,d)),Li(o)}else tc(o);else if(S=h.s,S==3||S==0&&0<h.X||!(g==1&&mg(o,h)||g==2&&Uo(o)))switch(d&&0<d.length&&(h=o.h,h.i=h.i.concat(d)),S){case 1:_n(o,5);break;case 4:_n(o,10);break;case 3:_n(o,6);break;default:_n(o,2)}}}function rc(o,h){let d=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(d*=2),d*h}function _n(o,h){if(o.j.info("Error code "+h),h==2){var d=m(o.fb,o),g=o.Xa;const S=!g;g=new gn(g||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Vi(g,"https"),Di(g),S?ug(g.toString(),d):lg(g.toString(),d)}else Ft(2);o.G=0,o.l&&o.l.sa(h),ic(o),Jl(o)}e.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function ic(o){if(o.G=0,o.ka=[],o.l){const h=Ol(o.h);(h.length!=0||o.i.length!=0)&&(w(o.ka,h),w(o.ka,o.i),o.h.i.length=0,A(o.i),o.i.length=0),o.l.ra()}}function sc(o,h,d){var g=d instanceof gn?Re(d):new gn(d);if(g.g!="")h&&(g.g=h+"."+g.g),Ni(g,g.s);else{var S=u.location;g=S.protocol,h=h?h+"."+S.hostname:S.hostname,S=+S.port;var V=new gn(null);g&&Vi(V,g),h&&(V.g=h),S&&Ni(V,S),d&&(V.l=d),g=V}return d=o.D,h=o.ya,d&&h&&ut(g,d,h),ut(g,"VER",o.la),Cr(o,g),g}function oc(o,h,d){if(h&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=o.Ca&&!o.pa?new ht(new ki({eb:d})):new ht(o.pa),h.Ha(o.J),h}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function ac(){}e=ac.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Bi(){}Bi.prototype.g=function(o,h){return new Qt(o,h)};function Qt(o,h){Ct.call(this),this.g=new Xl(h),this.l=o,this.h=h&&h.messageUrlParams||null,o=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(o?o["X-WebChannel-Content-Type"]=h.messageContentType:o={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(o?o["X-WebChannel-Client-Profile"]=h.va:o={"X-WebChannel-Client-Profile":h.va}),this.g.S=o,(o=h&&h.Sb)&&!N(o)&&(this.g.m=o),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!N(h)&&(this.g.D=h,o=this.h,o!==null&&h in o&&(o=this.h,h in o&&delete o[h])),this.j=new Ln(this)}v(Qt,Ct),Qt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Qt.prototype.close=function(){Lo(this.g)},Qt.prototype.o=function(o){var h=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.u&&(d={},d.__data__=Ro(o),o=d);h.i.push(new Ym(h.Ya++,o)),h.G==3&&Li(h)},Qt.prototype.N=function(){this.g.l=null,delete this.j,Lo(this.g),delete this.g,Qt.aa.N.call(this)};function uc(o){Co.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var h=o.__sm__;if(h){t:{for(const d in h){o=d;break t}o=void 0}(this.i=o)&&(o=this.i,h=h!==null&&o in h?h[o]:void 0),this.data=h}else this.data=o}v(uc,Co);function lc(){xo.call(this),this.status=1}v(lc,xo);function Ln(o){this.g=o}v(Ln,ac),Ln.prototype.ua=function(){Mt(this.g,"a")},Ln.prototype.ta=function(o){Mt(this.g,new uc(o))},Ln.prototype.sa=function(o){Mt(this.g,new lc)},Ln.prototype.ra=function(){Mt(this.g,"b")},Bi.prototype.createWebChannel=Bi.prototype.g,Qt.prototype.send=Qt.prototype.o,Qt.prototype.open=Qt.prototype.m,Qt.prototype.close=Qt.prototype.close,fd=function(){return new Bi},hd=function(){return Si()},cd=pn,ya={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ci.NO_ERROR=0,Ci.TIMEOUT=8,Ci.HTTP_ERROR=6,Zi=Ci,bl.COMPLETE="complete",ld=bl,wl.EventType=_r,_r.OPEN="a",_r.CLOSE="b",_r.ERROR="c",_r.MESSAGE="d",Ct.prototype.listen=Ct.prototype.K,kr=wl,ht.prototype.listenOnce=ht.prototype.L,ht.prototype.getLastError=ht.prototype.Ka,ht.prototype.getLastErrorCode=ht.prototype.Ba,ht.prototype.getStatus=ht.prototype.Z,ht.prototype.getResponseJson=ht.prototype.Oa,ht.prototype.getResponseText=ht.prototype.oa,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Ha,ud=ht}).apply(typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{});const kc="@firebase/firestore",Oc="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Dt.UNAUTHENTICATED=new Dt(null),Dt.GOOGLE_CREDENTIALS=new Dt("google-credentials-uid"),Dt.FIRST_PARTY=new Dt("first-party-uid"),Dt.MOCK_USER=new Dt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ur="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn=new ed("@firebase/firestore");function qn(){return Sn.logLevel}function B(e,...t){if(Sn.logLevel<=Z.DEBUG){const n=t.map(pu);Sn.debug(`Firestore (${ur}): ${e}`,...n)}}function Fe(e,...t){if(Sn.logLevel<=Z.ERROR){const n=t.map(pu);Sn.error(`Firestore (${ur}): ${e}`,...n)}}function rn(e,...t){if(Sn.logLevel<=Z.WARN){const n=t.map(pu);Sn.warn(`Firestore (${ur}): ${e}`,...n)}}function pu(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,dd(e,r,n)}function dd(e,t,n){let r=`FIRESTORE (${ur}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Fe(r),new Error(r)}function nt(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||dd(t,i,r)}function W(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends ar{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class gv{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Dt.UNAUTHENTICATED))}shutdown(){}}class _v{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class yv{constructor(t){this.t=t,this.currentUser=Dt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){nt(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new De;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new De,t.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},u=l=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new De)}},0),a()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nt(typeof r.accessToken=="string",31837,{l:r}),new pd(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return nt(t===null||typeof t=="string",2055,{h:t}),new Dt(t)}}class vv{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=Dt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class wv{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new vv(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(Dt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Mc{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ev{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Zy(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){nt(this.o===void 0,3512);const r=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,B("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Mc(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(nt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Mc(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Tv(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%62))}return r}}function X(e,t){return e<t?-1:e>t?1:0}function va(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return X(r,i);{const s=md(),a=Av(s.encode(Fc(e,n)),s.encode(Fc(t,n)));return a!==0?a:X(r,i)}}n+=r>65535?2:1}return X(e.length,t.length)}function Fc(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Av(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return X(e[n],t[n]);return X(e.length,t.length)}function Xn(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc="__name__";class de{constructor(t,n,r){n===void 0?n=0:n>t.length&&j(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&j(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return de.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof de?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const s=de.compareSegments(t.get(i),n.get(i));if(s!==0)return s}return X(t.length,n.length)}static compareSegments(t,n){const r=de.isNumericId(t),i=de.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?de.extractNumericId(t).compare(de.extractNumericId(n)):va(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ze.fromString(t.substring(4,t.length-2))}}class ot extends de{construct(t,n,r){return new ot(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new L(D.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ot(n)}static emptyPath(){return new ot([])}}const Iv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rt extends de{construct(t,n,r){return new Rt(t,n,r)}static isValidIdentifier(t){return Iv.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Lc}static keyField(){return new Rt([Lc])}static fromServerFormat(t){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new L(D.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new L(D.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=l,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new L(D.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Rt(n)}static emptyPath(){return new Rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(t){this.path=t}static fromPath(t){return new q(ot.fromString(t))}static fromName(t){return new q(ot.fromString(t).popFirst(5))}static empty(){return new q(ot.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ot.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return ot.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new q(new ot(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(e,t,n){if(!n)throw new L(D.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function bv(e,t,n,r){if(t===!0&&r===!0)throw new L(D.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Uc(e){if(!q.isDocumentKey(e))throw new L(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Bc(e){if(q.isDocumentKey(e))throw new L(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function _d(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function Gs(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":j(12329,{type:typeof e})}function Le(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new L(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Gs(e);throw new L(D.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Rv(e,t){if(t<=0)throw new L(D.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(e,t){const n={typeString:e};return t&&(n.value=t),n}function di(e,t){if(!_d(e))throw new L(D.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const a=e[r];if(i&&typeof a!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new L(D.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc=-62135596800,$c=1e6;class lt{static now(){return lt.fromMillis(Date.now())}static fromDate(t){return lt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*$c);return new lt(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<qc)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/$c}_compareTo(t){return this.seconds===t.seconds?X(this.nanoseconds,t.nanoseconds):X(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:lt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(di(t,lt._jsonSchema))return new lt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-qc;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}lt._jsonSchemaVersion="firestore/timestamp/1.0",lt._jsonSchema={type:vt("string",lt._jsonSchemaVersion),seconds:vt("number"),nanoseconds:vt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{static fromTimestamp(t){return new G(t)}static min(){return new G(new lt(0,0))}static max(){return new G(new lt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=-1;function Sv(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=G.fromTimestamp(r===1e9?new lt(n+1,0):new lt(n,r));return new sn(i,q.empty(),t)}function Cv(e){return new sn(e.readTime,e.key,Zr)}class sn{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new sn(G.min(),q.empty(),Zr)}static max(){return new sn(G.max(),q.empty(),Zr)}}function xv(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=q.comparator(e.documentKey,t.documentKey),n!==0?n:X(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Vv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lr(e){if(e.code!==D.FAILED_PRECONDITION||e.message!==Pv)throw e;B("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new O((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):O.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):O.reject(n)}static resolve(t){return new O((n,r)=>{n(t)})}static reject(t){return new O((n,r)=>{r(t)})}static waitFor(t){return new O((n,r)=>{let i=0,s=0,a=!1;t.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&n()},l=>r(l))}),a=!0,s===i&&n()})}static or(t){let n=O.resolve(!1);for(const r of t)n=n.next(i=>i?O.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new O((r,i)=>{const s=t.length,a=new Array(s);let u=0;for(let l=0;l<s;l++){const c=l;n(t[c]).next(f=>{a[c]=f,++u,u===s&&r(a)},f=>i(f))}})}static doWhile(t,n){return new O((r,i)=>{const s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}}function Nv(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function cr(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}Ws.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu=-1;function Ks(e){return e==null}function Ts(e){return e===0&&1/e==-1/0}function Dv(e){return typeof e=="number"&&Number.isInteger(e)&&!Ts(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd="";function kv(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=jc(t)),t=Ov(e.get(n),t);return jc(t)}function Ov(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const s=e.charAt(i);switch(s){case"\0":n+="";break;case yd:n+="";break;default:n+=s}}return n}function jc(e){return e+yd+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function hn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function vd(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(t,n){this.comparator=t,this.root=n||bt.EMPTY}insert(t,n){return new ct(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(t){return new ct(this.comparator,this.root.remove(t,this.comparator).copy(null,null,bt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Hi(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Hi(this.root,t,this.comparator,!1)}getReverseIterator(){return new Hi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Hi(this.root,t,this.comparator,!0)}}class Hi{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class bt{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??bt.RED,this.left=i??bt.EMPTY,this.right=s??bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new bt(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return bt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw j(27949);return t+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(t,n,r,i,s){return this}insert(t,n,r){return new bt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(t){this.comparator=t,this.data=new ct(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new Hc(this.data.getIterator())}getIteratorFrom(t){return new Hc(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof wt)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new wt(this.comparator);return n.data=t,n}}class Hc{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(t){this.fields=t,t.sort(Rt.comparator)}static empty(){return new Jt([])}unionWith(t){let n=new wt(Rt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Jt(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Xn(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new wd("Invalid base64 string: "+s):s}}(t);return new St(n)}static fromUint8Array(t){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(t);return new St(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return X(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}St.EMPTY_BYTE_STRING=new St("");const Mv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function on(e){if(nt(!!e,39018),typeof e=="string"){let t=0;const n=Mv.exec(e);if(nt(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:pt(e.seconds),nanos:pt(e.nanos)}}function pt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function an(e){return typeof e=="string"?St.fromBase64String(e):St.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed="server_timestamp",Td="__type__",Ad="__previous_value__",Id="__local_write_time__";function _u(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[Td])===null||n===void 0?void 0:n.stringValue)===Ed}function Qs(e){const t=e.mapValue.fields[Ad];return _u(t)?Qs(t):t}function ti(e){const t=on(e.mapValue.fields[Id].timestampValue);return new lt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(t,n,r,i,s,a,u,l,c,f){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=f}}const As="(default)";class ei{constructor(t,n){this.projectId=t,this.database=n||As}static empty(){return new ei("","")}get isDefaultDatabase(){return this.database===As}isEqual(t){return t instanceof ei&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd="__type__",Lv="__max__",Gi={mapValue:{}},Rd="__vector__",Is="value";function un(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?_u(e)?4:Bv(e)?9007199254740991:Uv(e)?10:11:j(28295,{value:e})}function Ae(e,t){if(e===t)return!0;const n=un(e);if(n!==un(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ti(e).isEqual(ti(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=on(i.timestampValue),u=on(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return an(i.bytesValue).isEqual(an(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return pt(i.geoPointValue.latitude)===pt(s.geoPointValue.latitude)&&pt(i.geoPointValue.longitude)===pt(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return pt(i.integerValue)===pt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=pt(i.doubleValue),u=pt(s.doubleValue);return a===u?Ts(a)===Ts(u):isNaN(a)&&isNaN(u)}return!1}(e,t);case 9:return Xn(e.arrayValue.values||[],t.arrayValue.values||[],Ae);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(zc(a)!==zc(u))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!Ae(a[l],u[l])))return!1;return!0}(e,t);default:return j(52216,{left:e})}}function ni(e,t){return(e.values||[]).find(n=>Ae(n,t))!==void 0}function Jn(e,t){if(e===t)return 0;const n=un(e),r=un(t);if(n!==r)return X(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return X(e.booleanValue,t.booleanValue);case 2:return function(s,a){const u=pt(s.integerValue||s.doubleValue),l=pt(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(e,t);case 3:return Gc(e.timestampValue,t.timestampValue);case 4:return Gc(ti(e),ti(t));case 5:return va(e.stringValue,t.stringValue);case 6:return function(s,a){const u=an(s),l=an(a);return u.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,a){const u=s.split("/"),l=a.split("/");for(let c=0;c<u.length&&c<l.length;c++){const f=X(u[c],l[c]);if(f!==0)return f}return X(u.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,a){const u=X(pt(s.latitude),pt(a.latitude));return u!==0?u:X(pt(s.longitude),pt(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Wc(e.arrayValue,t.arrayValue);case 10:return function(s,a){var u,l,c,f;const p=s.fields||{},m=a.fields||{},_=(u=p[Is])===null||u===void 0?void 0:u.arrayValue,v=(l=m[Is])===null||l===void 0?void 0:l.arrayValue,A=X(((c=_==null?void 0:_.values)===null||c===void 0?void 0:c.length)||0,((f=v==null?void 0:v.values)===null||f===void 0?void 0:f.length)||0);return A!==0?A:Wc(_,v)}(e.mapValue,t.mapValue);case 11:return function(s,a){if(s===Gi.mapValue&&a===Gi.mapValue)return 0;if(s===Gi.mapValue)return 1;if(a===Gi.mapValue)return-1;const u=s.fields||{},l=Object.keys(u),c=a.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const m=va(l[p],f[p]);if(m!==0)return m;const _=Jn(u[l[p]],c[f[p]]);if(_!==0)return _}return X(l.length,f.length)}(e.mapValue,t.mapValue);default:throw j(23264,{le:n})}}function Gc(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return X(e,t);const n=on(e),r=on(t),i=X(n.seconds,r.seconds);return i!==0?i:X(n.nanos,r.nanos)}function Wc(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Jn(n[i],r[i]);if(s)return s}return X(n.length,r.length)}function Yn(e){return wa(e)}function wa(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=on(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return an(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return q.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=wa(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${wa(n.fields[a])}`;return i+"}"}(e.mapValue):j(61005,{value:e})}function ts(e){switch(un(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Qs(e);return t?16+ts(t):16;case 5:return 2*e.stringValue.length;case 6:return an(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+ts(s),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return hn(r.fields,(s,a)=>{i+=s.length+ts(a)}),i}(e.mapValue);default:throw j(13486,{value:e})}}function Kc(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ea(e){return!!e&&"integerValue"in e}function yu(e){return!!e&&"arrayValue"in e}function Qc(e){return!!e&&"nullValue"in e}function Xc(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function es(e){return!!e&&"mapValue"in e}function Uv(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[bd])===null||n===void 0?void 0:n.stringValue)===Rd}function zr(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return hn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=zr(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=zr(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Bv(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Lv}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(t){this.value=t}static empty(){return new Ht({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!es(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=zr(n)}setAll(t){let n=Rt.emptyPath(),r={},i=[];t.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=u.popLast()}a?r[u.lastSegment()]=zr(a):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){const n=this.field(t.popLast());es(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Ae(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];es(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){hn(n,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new Ht(zr(this.value))}}function Sd(e){const t=[];return hn(e.fields,(n,r)=>{const i=new Rt([n]);if(es(r)){const s=Sd(r.mapValue).fields;if(s.length===0)t.push(i);else for(const a of s)t.push(i.child(a))}else t.push(i)}),new Jt(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(t,n,r,i,s,a,u){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(t){return new kt(t,0,G.min(),G.min(),G.min(),Ht.empty(),0)}static newFoundDocument(t,n,r,i){return new kt(t,1,n,G.min(),r,i,0)}static newNoDocument(t,n){return new kt(t,2,n,G.min(),G.min(),Ht.empty(),0)}static newUnknownDocument(t,n){return new kt(t,3,n,G.min(),G.min(),Ht.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ht.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof kt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(t,n){this.position=t,this.inclusive=n}}function Jc(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(s.field.isKeyField()?r=q.comparator(q.fromName(a.referenceValue),n.key):r=Jn(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Yc(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ae(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(t,n="asc"){this.field=t,this.dir=n}}function qv(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{}class yt extends Cd{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new jv(t,n,r):n==="array-contains"?new Gv(t,r):n==="in"?new Wv(t,r):n==="not-in"?new Kv(t,r):n==="array-contains-any"?new Qv(t,r):new yt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new zv(t,r):new Hv(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Jn(n,this.value)):n!==null&&un(this.value)===un(n)&&this.matchesComparison(Jn(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return j(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oe extends Cd{constructor(t,n){super(),this.filters=t,this.op=n,this.he=null}static create(t,n){return new oe(t,n)}matches(t){return xd(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function xd(e){return e.op==="and"}function Pd(e){return $v(e)&&xd(e)}function $v(e){for(const t of e.filters)if(t instanceof oe)return!1;return!0}function Ta(e){if(e instanceof yt)return e.field.canonicalString()+e.op.toString()+Yn(e.value);if(Pd(e))return e.filters.map(t=>Ta(t)).join(",");{const t=e.filters.map(n=>Ta(n)).join(",");return`${e.op}(${t})`}}function Vd(e,t){return e instanceof yt?function(r,i){return i instanceof yt&&r.op===i.op&&r.field.isEqual(i.field)&&Ae(r.value,i.value)}(e,t):e instanceof oe?function(r,i){return i instanceof oe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&Vd(a,i.filters[u]),!0):!1}(e,t):void j(19439)}function Nd(e){return e instanceof yt?function(n){return`${n.field.canonicalString()} ${n.op} ${Yn(n.value)}`}(e):e instanceof oe?function(n){return n.op.toString()+" {"+n.getFilters().map(Nd).join(" ,")+"}"}(e):"Filter"}class jv extends yt{constructor(t,n,r){super(t,n,r),this.key=q.fromName(r.referenceValue)}matches(t){const n=q.comparator(t.key,this.key);return this.matchesComparison(n)}}class zv extends yt{constructor(t,n){super(t,"in",n),this.keys=Dd("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class Hv extends yt{constructor(t,n){super(t,"not-in",n),this.keys=Dd("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function Dd(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>q.fromName(r.referenceValue))}class Gv extends yt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return yu(n)&&ni(n.arrayValue,this.value)}}class Wv extends yt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&ni(this.value.arrayValue,n)}}class Kv extends yt{constructor(t,n){super(t,"not-in",n)}matches(t){if(ni(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ni(this.value.arrayValue,n)}}class Qv extends yt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!yu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ni(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(t,n=null,r=[],i=[],s=null,a=null,u=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.Pe=null}}function Zc(e,t=null,n=[],r=[],i=null,s=null,a=null){return new Xv(e,t,n,r,i,s,a)}function vu(e){const t=W(e);if(t.Pe===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>Ta(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ks(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Yn(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Yn(r)).join(",")),t.Pe=n}return t.Pe}function wu(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!qv(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Vd(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Yc(e.startAt,t.startAt)&&Yc(e.endAt,t.endAt)}function Aa(e){return q.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(t,n=null,r=[],i=[],s=null,a="F",u=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Jv(e,t,n,r,i,s,a,u){return new hr(e,t,n,r,i,s,a,u)}function Eu(e){return new hr(e)}function th(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function kd(e){return e.collectionGroup!==null}function Hr(e){const t=W(e);if(t.Te===null){t.Te=[];const n=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new wt(Rt.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(u=u.add(c.field))})}),u})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Te.push(new ri(s,r))}),n.has(Rt.keyField().canonicalString())||t.Te.push(new ri(Rt.keyField(),r))}return t.Te}function me(e){const t=W(e);return t.Ie||(t.Ie=Yv(t,Hr(e))),t.Ie}function Yv(e,t){if(e.limitType==="F")return Zc(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ri(i.field,s)});const n=e.endAt?new bs(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new bs(e.startAt.position,e.startAt.inclusive):null;return Zc(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Ia(e,t){const n=e.filters.concat([t]);return new hr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Rs(e,t,n){return new hr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Xs(e,t){return wu(me(e),me(t))&&e.limitType===t.limitType}function Od(e){return`${vu(me(e))}|lt:${e.limitType}`}function $n(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Nd(i)).join(", ")}]`),Ks(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Yn(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Yn(i)).join(",")),`Target(${r})`}(me(e))}; limitType=${e.limitType})`}function Js(e,t){return t.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(const s of Hr(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(a,u,l){const c=Jc(a,u,l);return a.inclusive?c<=0:c<0}(r.startAt,Hr(r),i)||r.endAt&&!function(a,u,l){const c=Jc(a,u,l);return a.inclusive?c>=0:c>0}(r.endAt,Hr(r),i))}(e,t)}function Zv(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Md(e){return(t,n)=>{let r=!1;for(const i of Hr(e)){const s=tw(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function tw(e,t,n){const r=e.field.isKeyField()?q.comparator(t.key,n.key):function(s,a,u){const l=a.data.field(s),c=u.data.field(s);return l!==null&&c!==null?Jn(l,c):j(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return j(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){hn(this.inner,(n,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return vd(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew=new ct(q.comparator);function Ue(){return ew}const Fd=new ct(q.comparator);function Or(...e){let t=Fd;for(const n of e)t=t.insert(n.key,n);return t}function Ld(e){let t=Fd;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function wn(){return Gr()}function Ud(){return Gr()}function Gr(){return new Nn(e=>e.toString(),(e,t)=>e.isEqual(t))}const nw=new ct(q.comparator),rw=new wt(q.comparator);function J(...e){let t=rw;for(const n of e)t=t.add(n);return t}const iw=new wt(X);function sw(){return iw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ts(t)?"-0":t}}function Bd(e){return{integerValue:""+e}}function ow(e,t){return Dv(t)?Bd(t):Tu(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(){this._=void 0}}function aw(e,t,n){return e instanceof Ss?function(i,s){const a={fields:{[Td]:{stringValue:Ed},[Id]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&_u(s)&&(s=Qs(s)),s&&(a.fields[Ad]=s),{mapValue:a}}(n,t):e instanceof ii?$d(e,t):e instanceof si?jd(e,t):function(i,s){const a=qd(i,s),u=eh(a)+eh(i.Ee);return Ea(a)&&Ea(i.Ee)?Bd(u):Tu(i.serializer,u)}(e,t)}function uw(e,t,n){return e instanceof ii?$d(e,t):e instanceof si?jd(e,t):n}function qd(e,t){return e instanceof Cs?function(r){return Ea(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}class Ss extends Ys{}class ii extends Ys{constructor(t){super(),this.elements=t}}function $d(e,t){const n=zd(t);for(const r of e.elements)n.some(i=>Ae(i,r))||n.push(r);return{arrayValue:{values:n}}}class si extends Ys{constructor(t){super(),this.elements=t}}function jd(e,t){let n=zd(t);for(const r of e.elements)n=n.filter(i=>!Ae(i,r));return{arrayValue:{values:n}}}class Cs extends Ys{constructor(t,n){super(),this.serializer=t,this.Ee=n}}function eh(e){return pt(e.integerValue||e.doubleValue)}function zd(e){return yu(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function lw(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof ii&&i instanceof ii||r instanceof si&&i instanceof si?Xn(r.elements,i.elements,Ae):r instanceof Cs&&i instanceof Cs?Ae(r.Ee,i.Ee):r instanceof Ss&&i instanceof Ss}(e.transform,t.transform)}class cw{constructor(t,n){this.version=t,this.transformResults=n}}class ge{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new ge}static exists(t){return new ge(void 0,t)}static updateTime(t){return new ge(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ns(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Zs{}function Hd(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Wd(e.key,ge.none()):new pi(e.key,e.data,ge.none());{const n=e.data,r=Ht.empty();let i=new wt(Rt.comparator);for(let s of t.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new fn(e.key,r,new Jt(i.toArray()),ge.none())}}function hw(e,t,n){e instanceof pi?function(i,s,a){const u=i.value.clone(),l=rh(i.fieldTransforms,s,a.transformResults);u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(e,t,n):e instanceof fn?function(i,s,a){if(!ns(i.precondition,s))return void s.convertToUnknownDocument(a.version);const u=rh(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Gd(i)),l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(e,t,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,n)}function Wr(e,t,n,r){return e instanceof pi?function(s,a,u,l){if(!ns(s.precondition,a))return u;const c=s.value.clone(),f=ih(s.fieldTransforms,l,a);return c.setAll(f),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(e,t,n,r):e instanceof fn?function(s,a,u,l){if(!ns(s.precondition,a))return u;const c=ih(s.fieldTransforms,l,a),f=a.data;return f.setAll(Gd(s)),f.setAll(c),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(e,t,n,r):function(s,a,u){return ns(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(e,t,n)}function fw(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),s=qd(r.transform,i||null);s!=null&&(n===null&&(n=Ht.empty()),n.set(r.field,s))}return n||null}function nh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xn(r,i,(s,a)=>lw(s,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class pi extends Zs{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fn extends Zs{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Gd(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function rh(e,t,n){const r=new Map;nt(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],a=s.transform,u=t.data.field(s.field);r.set(s.field,uw(a,u,n[i]))}return r}function ih(e,t,n){const r=new Map;for(const i of e){const s=i.transform,a=n.data.field(i.field);r.set(i.field,aw(s,a,t))}return r}class Wd extends Zs{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dw extends Zs{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&hw(s,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Wr(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Wr(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=Ud();return this.mutations.forEach(i=>{const s=t.get(i.key),a=s.overlayedDocument;let u=this.applyToLocalView(a,s.mutatedFields);u=n.has(i.key)?null:u;const l=Hd(a,u);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(G.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),J())}isEqual(t){return this.batchId===t.batchId&&Xn(this.mutations,t.mutations,(n,r)=>nh(n,r))&&Xn(this.baseMutations,t.baseMutations,(n,r)=>nh(n,r))}}class Au{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){nt(t.mutations.length===r.length,58842,{Ve:t.mutations.length,me:r.length});let i=function(){return nw}();const s=t.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Au(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t,Y;function _w(e){switch(e){case D.OK:return j(64938);case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0;default:return j(15467,{code:e})}}function Kd(e){if(e===void 0)return Fe("GRPC error has no .code"),D.UNKNOWN;switch(e){case _t.OK:return D.OK;case _t.CANCELLED:return D.CANCELLED;case _t.UNKNOWN:return D.UNKNOWN;case _t.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case _t.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case _t.INTERNAL:return D.INTERNAL;case _t.UNAVAILABLE:return D.UNAVAILABLE;case _t.UNAUTHENTICATED:return D.UNAUTHENTICATED;case _t.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case _t.NOT_FOUND:return D.NOT_FOUND;case _t.ALREADY_EXISTS:return D.ALREADY_EXISTS;case _t.PERMISSION_DENIED:return D.PERMISSION_DENIED;case _t.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case _t.ABORTED:return D.ABORTED;case _t.OUT_OF_RANGE:return D.OUT_OF_RANGE;case _t.UNIMPLEMENTED:return D.UNIMPLEMENTED;case _t.DATA_LOSS:return D.DATA_LOSS;default:return j(39323,{code:e})}}(Y=_t||(_t={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw=new Ze([4294967295,4294967295],0);function sh(e){const t=md().encode(e),n=new ad;return n.update(t),new Uint8Array(n.digest())}function oh(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Ze([n,r],0),new Ze([i,s],0)]}class Iu{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Mr(`Invalid padding: ${n}`);if(r<0)throw new Mr(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Mr(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Mr(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*t.length-n,this.ge=Ze.fromNumber(this.fe)}pe(t,n,r){let i=t.add(n.multiply(Ze.fromNumber(r)));return i.compare(yw)===1&&(i=new Ze([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const n=sh(t),[r,i]=oh(n);for(let s=0;s<this.hashCount;s++){const a=this.pe(r,i,s);if(!this.ye(a))return!1}return!0}static create(t,n,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new Iu(s,i,n);return r.forEach(u=>a.insert(u)),a}insert(t){if(this.fe===0)return;const n=sh(t),[r,i]=oh(n);for(let s=0;s<this.hashCount;s++){const a=this.pe(r,i,s);this.we(a)}}we(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Mr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const i=new Map;return i.set(t,mi.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new to(G.min(),i,new ct(X),Ue(),J())}}class mi{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new mi(r,n,J(),J(),J())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(t,n,r,i){this.Se=t,this.removedTargetIds=n,this.key=r,this.be=i}}class Qd{constructor(t,n){this.targetId=t,this.De=n}}class Xd{constructor(t,n,r=St.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ah{constructor(){this.ve=0,this.Ce=uh(),this.Fe=St.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=J(),n=J(),r=J();return this.Ce.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:j(38017,{changeType:s})}}),new mi(this.Fe,this.Me,t,n,r)}ke(){this.xe=!1,this.Ce=uh()}qe(t,n){this.xe=!0,this.Ce=this.Ce.insert(t,n)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,nt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class vw{constructor(t){this.We=t,this.Ge=new Map,this.ze=Ue(),this.je=Wi(),this.Je=Wi(),this.He=new ct(X)}Ye(t){for(const n of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(n,t.be):this.Xe(n,t.key,t.be);for(const n of t.removedTargetIds)this.Xe(n,t.key,t.be)}et(t){this.forEachTarget(t,n=>{const r=this.tt(n);switch(t.state){case 0:this.nt(n)&&r.Be(t.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(t.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(t.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(t.resumeToken));break;default:j(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(t){const n=t.targetId,r=t.De.count,i=this.st(n);if(i){const s=i.target;if(Aa(s))if(r===0){const a=new q(s.path);this.Xe(n,a,kt.newNoDocument(a,G.min()))}else nt(r===1,20013,{expectedCount:r});else{const a=this.ot(n);if(a!==r){const u=this._t(t),l=u?this.ut(u,t,a):1;if(l!==0){this.rt(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,c)}}}}}_t(t){const n=t.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,u;try{a=an(r).toUint8Array()}catch(l){if(l instanceof wd)return rn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new Iu(a,i,s)}catch(l){return rn(l instanceof Mr?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.fe===0?null:u}ut(t,n,r){return n.De.count===r-this.ht(t,n.targetId)?0:2}ht(t,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.We.lt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(u)||(this.Xe(n,s,null),i++)}),i}Pt(t){const n=new Map;this.Ge.forEach((s,a)=>{const u=this.st(a);if(u){if(s.current&&Aa(u.target)){const l=new q(u.target.path);this.Tt(l).has(a)||this.It(a,l)||this.Xe(a,l,kt.newNoDocument(l,t))}s.Ne&&(n.set(a,s.Le()),s.ke())}});let r=J();this.Je.forEach((s,a)=>{let u=!0;a.forEachWhile(l=>{const c=this.st(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,a)=>a.setReadTime(t));const i=new to(t,n,this.He,this.ze,r);return this.ze=Ue(),this.je=Wi(),this.Je=Wi(),this.He=new ct(X),i}Ze(t,n){if(!this.nt(t))return;const r=this.It(t,n.key)?2:0;this.tt(t).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(t)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(t))}Xe(t,n,r){if(!this.nt(t))return;const i=this.tt(t);this.It(t,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(t)),this.Je=this.Je.insert(n,this.dt(n).add(t)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(t){this.Ge.delete(t)}ot(t){const n=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let n=this.Ge.get(t);return n||(n=new ah,this.Ge.set(t,n)),n}dt(t){let n=this.Je.get(t);return n||(n=new wt(X),this.Je=this.Je.insert(t,n)),n}Tt(t){let n=this.je.get(t);return n||(n=new wt(X),this.je=this.je.insert(t,n)),n}nt(t){const n=this.st(t)!==null;return n||B("WatchChangeAggregator","Detected inactive target",t),n}st(t){const n=this.Ge.get(t);return n&&n.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new ah),this.We.getRemoteKeysForTarget(t).forEach(n=>{this.Xe(t,n,null)})}It(t,n){return this.We.getRemoteKeysForTarget(t).has(n)}}function Wi(){return new ct(q.comparator)}function uh(){return new ct(q.comparator)}const ww={asc:"ASCENDING",desc:"DESCENDING"},Ew={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Tw={and:"AND",or:"OR"};class Aw{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function ba(e,t){return e.useProto3Json||Ks(t)?t:{value:t}}function xs(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Jd(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Iw(e,t){return xs(e,t.toTimestamp())}function _e(e){return nt(!!e,49232),G.fromTimestamp(function(n){const r=on(n);return new lt(r.seconds,r.nanos)}(e))}function bu(e,t){return Ra(e,t).canonicalString()}function Ra(e,t){const n=function(i){return new ot(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Yd(e){const t=ot.fromString(e);return nt(rp(t),10190,{key:t.toString()}),t}function Sa(e,t){return bu(e.databaseId,t.path)}function Yo(e,t){const n=Yd(t);if(n.get(1)!==e.databaseId.projectId)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new q(tp(n))}function Zd(e,t){return bu(e.databaseId,t)}function bw(e){const t=Yd(e);return t.length===4?ot.emptyPath():tp(t)}function Ca(e){return new ot(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function tp(e){return nt(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function lh(e,t,n){return{name:Sa(e,t),fields:n.value.mapValue.fields}}function Rw(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:j(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(c,f){return c.useProto3Json?(nt(f===void 0||typeof f=="string",58123),St.fromBase64String(f||"")):(nt(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),St.fromUint8Array(f||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,u=a&&function(c){const f=c.code===void 0?D.UNKNOWN:Kd(c.code);return new L(f,c.message||"")}(a);n=new Xd(r,i,s,u||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Yo(e,r.document.name),s=_e(r.document.updateTime),a=r.document.createTime?_e(r.document.createTime):G.min(),u=new Ht({mapValue:{fields:r.document.fields}}),l=kt.newFoundDocument(i,s,a,u),c=r.targetIds||[],f=r.removedTargetIds||[];n=new rs(c,f,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Yo(e,r.document),s=r.readTime?_e(r.readTime):G.min(),a=kt.newNoDocument(i,s),u=r.removedTargetIds||[];n=new rs([],u,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Yo(e,r.document),s=r.removedTargetIds||[];n=new rs([],s,i,null)}else{if(!("filter"in t))return j(11601,{At:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new gw(i,s),u=r.targetId;n=new Qd(u,a)}}return n}function Sw(e,t){let n;if(t instanceof pi)n={update:lh(e,t.key,t.value)};else if(t instanceof Wd)n={delete:Sa(e,t.key)};else if(t instanceof fn)n={update:lh(e,t.key,t.data),updateMask:Mw(t.fieldMask)};else{if(!(t instanceof dw))return j(16599,{Rt:t.type});n={verify:Sa(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,a){const u=a.transform;if(u instanceof Ss)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ii)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof si)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Cs)return{fieldPath:a.field.canonicalString(),increment:u.Ee};throw j(20930,{transform:a.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Iw(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:j(27497)}(e,t.precondition)),n}function Cw(e,t){return e&&e.length>0?(nt(t!==void 0,14353),e.map(n=>function(i,s){let a=i.updateTime?_e(i.updateTime):_e(s);return a.isEqual(G.min())&&(a=_e(s)),new cw(a,i.transformResults||[])}(n,t))):[]}function xw(e,t){return{documents:[Zd(e,t.path)]}}function Pw(e,t){const n={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Zd(e,i);const s=function(c){if(c.length!==0)return np(oe.create(c,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(f=>function(m){return{field:jn(m.field),direction:Dw(m.dir)}}(f))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const u=ba(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{Vt:n,parent:i}}function Vw(e){let t=bw(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){nt(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:t=t.child(f.collectionId)}let s=[];n.where&&(s=function(p){const m=ep(p);return m instanceof oe&&Pd(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(p){return p.map(m=>function(v){return new ri(zn(v.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(n.orderBy));let u=null;n.limit&&(u=function(p){let m;return m=typeof p=="object"?p.value:p,Ks(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(p){const m=!!p.before,_=p.values||[];return new bs(_,m)}(n.startAt));let c=null;return n.endAt&&(c=function(p){const m=!p.before,_=p.values||[];return new bs(_,m)}(n.endAt)),Jv(t,i,a,s,u,"F",l,c)}function Nw(e,t){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j(28987,{purpose:i})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function ep(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=zn(n.unaryFilter.field);return yt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=zn(n.unaryFilter.field);return yt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=zn(n.unaryFilter.field);return yt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=zn(n.unaryFilter.field);return yt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return j(61313);default:return j(60726)}}(e):e.fieldFilter!==void 0?function(n){return yt.create(zn(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return j(58110);default:return j(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return oe.create(n.compositeFilter.filters.map(r=>ep(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return j(1026)}}(n.compositeFilter.op))}(e):j(30097,{filter:e})}function Dw(e){return ww[e]}function kw(e){return Ew[e]}function Ow(e){return Tw[e]}function jn(e){return{fieldPath:e.canonicalString()}}function zn(e){return Rt.fromServerFormat(e.fieldPath)}function np(e){return e instanceof yt?function(n){if(n.op==="=="){if(Xc(n.value))return{unaryFilter:{field:jn(n.field),op:"IS_NAN"}};if(Qc(n.value))return{unaryFilter:{field:jn(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Xc(n.value))return{unaryFilter:{field:jn(n.field),op:"IS_NOT_NAN"}};if(Qc(n.value))return{unaryFilter:{field:jn(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jn(n.field),op:kw(n.op),value:n.value}}}(e):e instanceof oe?function(n){const r=n.getFilters().map(i=>np(i));return r.length===1?r[0]:{compositeFilter:{op:Ow(n.op),filters:r}}}(e):j(54877,{filter:e})}function Mw(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function rp(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(t,n,r,i,s=G.min(),a=G.min(),u=St.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(t){return new Xe(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new Xe(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Xe(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Xe(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(t){this.gt=t}}function Lw(e){const t=Vw({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Rs(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(){this.Dn=new Bw}addToCollectionParentIndex(t,n){return this.Dn.add(n),O.resolve()}getCollectionParents(t,n){return O.resolve(this.Dn.getEntries(n))}addFieldIndex(t,n){return O.resolve()}deleteFieldIndex(t,n){return O.resolve()}deleteAllFieldIndexes(t){return O.resolve()}createTargetIndexes(t,n){return O.resolve()}getDocumentsMatchingTarget(t,n){return O.resolve(null)}getIndexType(t,n){return O.resolve(0)}getFieldIndexes(t,n){return O.resolve([])}getNextCollectionGroupToUpdate(t){return O.resolve(null)}getMinOffset(t,n){return O.resolve(sn.min())}getMinOffsetFromCollectionGroup(t,n){return O.resolve(sn.min())}updateCollectionGroup(t,n,r){return O.resolve()}updateIndexEntries(t,n){return O.resolve()}}class Bw{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new wt(ot.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new wt(ot.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ip=41943040;class zt{static withCacheSize(t){return new zt(t,zt.DEFAULT_COLLECTION_PERCENTILE,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zt.DEFAULT_COLLECTION_PERCENTILE=10,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zt.DEFAULT=new zt(ip,zt.DEFAULT_COLLECTION_PERCENTILE,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zt.DISABLED=new zt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Zn(0)}static ur(){return new Zn(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="LruGarbageCollector",qw=1048576;function fh([e,t],[n,r]){const i=X(e,n);return i===0?X(t,r):i}class $w{constructor(t){this.Tr=t,this.buffer=new wt(fh),this.Ir=0}dr(){return++this.Ir}Er(t){const n=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();fh(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class jw{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){B(hh,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){cr(n)?B(hh,"Ignoring IndexedDB error during garbage collection: ",n):await lr(n)}await this.Rr(3e5)})}}class zw{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.mr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return O.resolve(Ws.ue);const r=new $w(n);return this.Vr.forEachTarget(t,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(t,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.Vr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(ch)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ch):this.pr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,n){let r,i,s,a,u,l,c;const f=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,a=Date.now(),this.nthSequenceNumber(t,i))).next(p=>(r=p,u=Date.now(),this.removeTargets(t,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(t,r))).next(p=>(c=Date.now(),qn()<=Z.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(l-u)+`ms
	Removed ${p} documents in `+(c-l)+`ms
Total Duration: ${c-f}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function Hw(e,t){return new zw(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(){this.changes=new Nn(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,kt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&Wr(r.mutation,i,Jt.empty(),lt.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,J()).next(()=>r))}getLocalViewOfDocuments(t,n,r=J()){const i=wn();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let a=Or();return s.forEach((u,l)=>{a=a.insert(u,l.overlayedDocument)}),a}))}getOverlayedDocuments(t,n){const r=wn();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,J()))}populateOverlays(t,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((a,u)=>{n.set(a,u)})})}computeViews(t,n,r,i){let s=Ue();const a=Gr(),u=function(){return Gr()}();return n.forEach((l,c)=>{const f=r.get(c.key);i.has(c.key)&&(f===void 0||f.mutation instanceof fn)?s=s.insert(c.key,c):f!==void 0?(a.set(c.key,f.mutation.getFieldMask()),Wr(f.mutation,c,f.mutation.getFieldMask(),lt.now())):a.set(c.key,Jt.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,f)=>a.set(c,f)),n.forEach((c,f)=>{var p;return u.set(c,new Ww(f,(p=a.get(c))!==null&&p!==void 0?p:null))}),u))}recalculateAndSaveOverlays(t,n){const r=Gr();let i=new ct((a,u)=>a-u),s=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(a=>{for(const u of a)u.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let f=r.get(l)||Jt.empty();f=u.applyToLocalView(c,f),r.set(l,f);const p=(i.get(u.batchId)||J()).add(l);i=i.insert(u.batchId,p)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const l=u.getNext(),c=l.key,f=l.value,p=Ud();f.forEach(m=>{if(!s.has(m)){const _=Hd(n.get(m),r.get(m));_!==null&&p.set(m,_),s=s.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(t,c,p))}return O.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(a){return q.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):kd(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):O.resolve(wn());let u=Zr,l=s;return a.next(c=>O.forEach(c,(f,p)=>(u<p.largestBatchId&&(u=p.largestBatchId),s.get(f)?O.resolve():this.remoteDocumentCache.getEntry(t,f).next(m=>{l=l.insert(f,m)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,J())).next(f=>({batchId:u,changes:Ld(f)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new q(n)).next(r=>{let i=Or();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const s=n.collectionGroup;let a=Or();return this.indexManager.getCollectionParents(t,s).next(u=>O.forEach(u,l=>{const c=function(p,m){return new hr(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,r,i).next(f=>{f.forEach((p,m)=>{a=a.insert(p,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(a=>{s.forEach((l,c)=>{const f=c.getKey();a.get(f)===null&&(a=a.insert(f,kt.newInvalidDocument(f)))});let u=Or();return a.forEach((l,c)=>{const f=s.get(l);f!==void 0&&Wr(f.mutation,c,Jt.empty(),lt.now()),Js(n,c)&&(u=u.insert(l,c))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,n){return O.resolve(this.Br.get(n))}saveBundleMetadata(t,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:_e(i.createTime)}}(n)),O.resolve()}getNamedQuery(t,n){return O.resolve(this.Lr.get(n))}saveNamedQuery(t,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:Lw(i.bundledQuery),readTime:_e(i.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(){this.overlays=new ct(q.comparator),this.kr=new Map}getOverlay(t,n){return O.resolve(this.overlays.get(n))}getOverlays(t,n){const r=wn();return O.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.wt(t,n,s)}),O.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),O.resolve()}getOverlaysForCollection(t,n,r){const i=wn(),s=n.length+1,a=new q(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const l=u.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return O.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new ct((c,f)=>c-f);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let f=s.get(c.largestBatchId);f===null&&(f=wn(),s=s.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const u=wn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>u.set(c,f)),!(u.size()>=i)););return O.resolve(u)}wt(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new mw(n,r));let s=this.kr.get(n);s===void 0&&(s=J(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(){this.sessionToken=St.EMPTY_BYTE_STRING}getSessionToken(t){return O.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(){this.qr=new wt(Tt.Qr),this.$r=new wt(Tt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,n){const r=new Tt(t,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Wr(new Tt(t,n))}Gr(t,n){t.forEach(r=>this.removeReference(r,n))}zr(t){const n=new q(new ot([])),r=new Tt(n,t),i=new Tt(n,t+1),s=[];return this.$r.forEachInRange([r,i],a=>{this.Wr(a),s.push(a.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const n=new q(new ot([])),r=new Tt(n,t),i=new Tt(n,t+1);let s=J();return this.$r.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(t){const n=new Tt(t,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class Tt{constructor(t,n){this.key=t,this.Hr=n}static Qr(t,n){return q.comparator(t.key,n.key)||X(t.Hr,n.Hr)}static Ur(t,n){return X(t.Hr,n.Hr)||q.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new wt(Tt.Qr)}checkEmpty(t){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new pw(s,n,r,i);this.mutationQueue.push(a);for(const u of i)this.Yr=this.Yr.add(new Tt(u.key,s)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return O.resolve(a)}lookupMutationBatch(t,n){return O.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?gu:this.er-1)}getAllMutationBatches(t){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new Tt(n,0),i=new Tt(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],a=>{const u=this.Zr(a.Hr);s.push(u)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new wt(X);return n.forEach(i=>{const s=new Tt(i,0),a=new Tt(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,a],u=>{r=r.add(u.Hr)})}),O.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let s=r;q.isDocumentKey(s)||(s=s.child(""));const a=new Tt(new q(s),0);let u=new wt(X);return this.Yr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(u=u.add(l.Hr)),!0)},a),O.resolve(this.ei(u))}ei(t){const n=[];return t.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){nt(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return O.forEach(n.mutations,i=>{const s=new Tt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Yr=r})}rr(t){}containsKey(t,n){const r=new Tt(n,0),i=this.Yr.firstAfterOrEqual(r);return O.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,O.resolve()}ti(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(t){this.ni=t,this.docs=function(){return new ct(q.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():kt.newInvalidDocument(n))}getEntries(t,n){let r=Ue();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():kt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=Ue();const a=n.path,u=new q(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||xv(Cv(f),r)<=0||(i.has(f.key)||Js(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(t,n,r,i){j(9500)}ri(t,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new t0(this)}getSize(t){return O.resolve(this.size)}}class t0 extends Gw{constructor(t){super(),this.Or=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(t,i)):this.Or.removeEntry(r)}),O.waitFor(n)}getFromCache(t,n){return this.Or.getEntry(t,n)}getAllFromCache(t,n){return this.Or.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(t){this.persistence=t,this.ii=new Nn(n=>vu(n),wu),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.si=0,this.oi=new Ru,this.targetCount=0,this._i=Zn.ar()}forEachTarget(t,n){return this.ii.forEach((r,i)=>n(i)),O.resolve()}getLastRemoteSnapshotVersion(t){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return O.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),O.resolve()}hr(t){this.ii.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this._i=new Zn(n),this.highestTargetId=n),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,n){return this.hr(n),this.targetCount+=1,O.resolve()}updateTargetData(t,n){return this.hr(n),O.resolve()}removeTargetData(t,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(t,n,r){let i=0;const s=[];return this.ii.forEach((a,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(a),s.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(t){return O.resolve(this.targetCount)}getTargetData(t,n){const r=this.ii.get(n)||null;return O.resolve(r)}addMatchingKeys(t,n,r){return this.oi.Kr(n,r),O.resolve()}removeMatchingKeys(t,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(t,a))}),O.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.oi.zr(n),O.resolve()}getMatchingKeysForTargetId(t,n){const r=this.oi.Jr(n);return O.resolve(r)}containsKey(t,n){return O.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(t,n){this.ai={},this.overlays={},this.ui=new Ws(0),this.ci=!1,this.ci=!0,this.li=new Jw,this.referenceDelegate=t(this),this.hi=new e0(this),this.indexManager=new Uw,this.remoteDocumentCache=function(i){return new Zw(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new Fw(n),this.Ti=new Qw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new Xw,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ai[t.toKey()];return r||(r=new Yw(n,this.referenceDelegate),this.ai[t.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,n,r){B("MemoryPersistence","Starting transaction:",t);const i=new n0(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(t,n){return O.or(Object.values(this.ai).map(r=>()=>r.containsKey(t,n)))}}class n0 extends Vv{constructor(t){super(),this.currentSequenceNumber=t}}class Su{constructor(t){this.persistence=t,this.Ai=new Ru,this.Ri=null}static Vi(t){return new Su(t)}get mi(){if(this.Ri)return this.Ri;throw j(60996)}addReference(t,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),O.resolve()}removeReference(t,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(t,n){return this.mi.add(n.toString()),O.resolve()}removeTarget(t,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ii(){this.Ri=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.mi,r=>{const i=q.fromPath(r);return this.fi(t,i).next(s=>{s||n.removeEntry(i,G.min())})}).next(()=>(this.Ri=null,n.apply(t)))}updateLimboDocument(t,n){return this.fi(t,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(t){return 0}fi(t,n){return O.or([()=>O.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class Ps{constructor(t,n){this.persistence=t,this.gi=new Nn(r=>kv(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Hw(this,n)}static Vi(t,n){return new Ps(t,n)}Ii(){}di(t){return O.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}mr(t){const n=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}yr(t){let n=0;return this.gr(t,r=>{n++}).next(()=>n)}gr(t,n){return O.forEach(this.gi,(r,i)=>this.Sr(t,r,i).next(s=>s?O.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(t,a=>this.Sr(t,a,n).next(u=>{u||(r++,s.removeEntry(a,G.min()))})).next(()=>s.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.gi.set(n,t.currentSequenceNumber),O.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),O.resolve()}removeReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),O.resolve()}updateLimboDocument(t,n){return this.gi.set(n,t.currentSequenceNumber),O.resolve()}Pi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=ts(t.data.value)),n}Sr(t,n,r){return O.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.gi.get(n);return O.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.Is=r,this.ds=i}static Es(t,n){let r=J(),i=J();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Cu(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return X_()?8:Nv(K_())>0?6:4}()}initialize(t,n){this.gs=t,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(t,n,r,i){const s={result:null};return this.ps(t,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ys(t,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new r0;return this.ws(t,n,a).next(u=>{if(s.result=u,this.Rs)return this.Ss(t,n,a,u.size)})}).next(()=>s.result)}Ss(t,n,r,i){return r.documentReadCount<this.Vs?(qn()<=Z.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",$n(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),O.resolve()):(qn()<=Z.DEBUG&&B("QueryEngine","Query:",$n(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(qn()<=Z.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",$n(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,me(n))):O.resolve())}ps(t,n){if(th(n))return O.resolve(null);let r=me(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Rs(n,null,"F"),r=me(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const a=J(...s);return this.gs.getDocuments(t,a).next(u=>this.indexManager.getMinOffset(t,r).next(l=>{const c=this.bs(n,u);return this.Ds(n,c,a,l.readTime)?this.ps(t,Rs(n,null,"F")):this.vs(t,c,n,l)}))})))}ys(t,n,r,i){return th(n)||i.isEqual(G.min())?O.resolve(null):this.gs.getDocuments(t,r).next(s=>{const a=this.bs(n,s);return this.Ds(n,a,r,i)?O.resolve(null):(qn()<=Z.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),$n(n)),this.vs(t,a,n,Sv(i,Zr)).next(u=>u))})}bs(t,n){let r=new wt(Md(t));return n.forEach((i,s)=>{Js(t,s)&&(r=r.add(s))}),r}Ds(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(t,n,r){return qn()<=Z.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",$n(n)),this.gs.getDocumentsMatchingQuery(t,n,sn.min(),r)}vs(t,n,r,i){return this.gs.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xu="LocalStore",s0=3e8;class o0{constructor(t,n,r,i){this.persistence=t,this.Cs=n,this.serializer=i,this.Fs=new ct(X),this.Ms=new Nn(s=>vu(s),wu),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(r)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Kw(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Fs))}}function a0(e,t,n,r){return new o0(e,t,n,r)}async function op(e,t){const n=W(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],u=[];let l=J();for(const c of i){a.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of s){u.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Bs:c,removedBatchIds:a,addedBatchIds:u}))})})}function u0(e,t){const n=W(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,l,c,f){const p=c.batch,m=p.keys();let _=O.resolve();return m.forEach(v=>{_=_.next(()=>f.getEntry(l,v)).next(A=>{const w=c.docVersions.get(v);nt(w!==null,48541),A.version.compareTo(w)<0&&(p.applyToRemoteDocument(A,c),A.isValidDocument()&&(A.setReadTime(c.commitVersion),f.addEntry(A)))})}),_.next(()=>u.mutationQueue.removeMutationBatch(l,p))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=J();for(let c=0;c<u.mutationResults.length;++c)u.mutationResults[c].transformResults.length>0&&(l=l.add(u.batch.mutations[c].key));return l}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function ap(e){const t=W(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.hi.getLastRemoteSnapshotVersion(n))}function l0(e,t){const n=W(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const u=[];t.targetChanges.forEach((f,p)=>{const m=i.get(p);if(!m)return;u.push(n.hi.removeMatchingKeys(s,f.removedDocuments,p).next(()=>n.hi.addMatchingKeys(s,f.addedDocuments,p)));let _=m.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(p)!==null?_=_.withResumeToken(St.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):f.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(f.resumeToken,r)),i=i.insert(p,_),function(A,w,x){return A.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=s0?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(m,_,f)&&u.push(n.hi.updateTargetData(s,_))});let l=Ue(),c=J();if(t.documentUpdates.forEach(f=>{t.resolvedLimboDocuments.has(f)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),u.push(c0(s,a,t.documentUpdates).next(f=>{l=f.Ls,c=f.ks})),!r.isEqual(G.min())){const f=n.hi.getLastRemoteSnapshotVersion(s).next(p=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(f)}return O.waitFor(u).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.Fs=i,s))}function c0(e,t,n){let r=J(),i=J();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let a=Ue();return n.forEach((u,l)=>{const c=s.get(u);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(G.min())?(t.removeEntry(u,l.readTime),a=a.insert(u,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),a=a.insert(u,l)):B(xu,"Ignoring outdated watch update for ",u,". Current version:",c.version," Watch version:",l.version)}),{Ls:a,ks:i}})}function h0(e,t){const n=W(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=gu),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function f0(e,t){const n=W(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,t).next(s=>s?(i=s,O.resolve(i)):n.hi.allocateTargetId(r).next(a=>(i=new Xe(t,a,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(t,r.targetId)),r})}async function xa(e,t,n){const r=W(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!cr(a))throw a;B(xu,`Failed to update sequence numbers for target ${t}: ${a}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function dh(e,t,n){const r=W(e);let i=G.min(),s=J();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,f){const p=W(l),m=p.Ms.get(f);return m!==void 0?O.resolve(p.Fs.get(m)):p.hi.getTargetData(c,f)}(r,a,me(t)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(a,u.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(a,t,n?i:G.min(),n?s:J())).next(u=>(d0(r,Zv(t),u),{documents:u,qs:s})))}function d0(e,t,n){let r=e.xs.get(t)||G.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.xs.set(t,r)}class ph{constructor(){this.activeTargetIds=sw()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class p0{constructor(){this.Fo=new ph,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,n,r){this.Mo[t]=n}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new ph,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="ConnectivityMonitor";class gh{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){B(mh,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){B(mh,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ki=null;function Pa(){return Ki===null?Ki=function(){return 268435456+Math.round(2147483648*Math.random())}():Ki++,"0x"+Ki.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo="RestConnection",g0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class _0{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===As?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,n,r,i,s){const a=Pa(),u=this.Go(t,n.toUriEncodedString());B(Zo,`Sending RPC '${t}' ${a}:`,u,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,i,s);const{host:c}=new URL(u),f=fu(c);return this.jo(t,u,l,r,f).then(p=>(B(Zo,`Received RPC '${t}' ${a}: `,p),p),p=>{throw rn(Zo,`RPC '${t}' ${a} failed with error: `,p,"url: ",u,"request:",r),p})}Jo(t,n,r,i,s,a){return this.Wo(t,n,r,i,s)}zo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ur}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}Go(t,n){const r=g0[t];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nt="WebChannelConnection";class v0 extends _0{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,n,r,i,s){const a=Pa();return new Promise((u,l)=>{const c=new ud;c.setWithCredentials(!0),c.listenOnce(ld.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Zi.NO_ERROR:const p=c.getResponseJson();B(Nt,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(p)),u(p);break;case Zi.TIMEOUT:B(Nt,`RPC '${t}' ${a} timed out`),l(new L(D.DEADLINE_EXCEEDED,"Request time out"));break;case Zi.HTTP_ERROR:const m=c.getStatus();if(B(Nt,`RPC '${t}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);const v=_==null?void 0:_.error;if(v&&v.status&&v.message){const A=function(x){const N=x.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(N)>=0?N:D.UNKNOWN}(v.status);l(new L(A,v.message))}else l(new L(D.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new L(D.UNAVAILABLE,"Connection failed."));break;default:j(9055,{c_:t,streamId:a,l_:c.getLastErrorCode(),h_:c.getLastError()})}}finally{B(Nt,`RPC '${t}' ${a} completed.`)}});const f=JSON.stringify(i);B(Nt,`RPC '${t}' ${a} sending request:`,i),c.send(n,"POST",f,r,15)})}P_(t,n,r){const i=Pa(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=fd(),u=hd(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");B(Nt,`Creating RPC '${t}' stream ${i}: ${f}`,l);const p=a.createWebChannel(f,l);this.T_(p);let m=!1,_=!1;const v=new y0({Ho:w=>{_?B(Nt,`Not sending because RPC '${t}' stream ${i} is closed:`,w):(m||(B(Nt,`Opening RPC '${t}' stream ${i} transport.`),p.open(),m=!0),B(Nt,`RPC '${t}' stream ${i} sending:`,w),p.send(w))},Yo:()=>p.close()}),A=(w,x,N)=>{w.listen(x,M=>{try{N(M)}catch(k){setTimeout(()=>{throw k},0)}})};return A(p,kr.EventType.OPEN,()=>{_||(B(Nt,`RPC '${t}' stream ${i} transport opened.`),v.s_())}),A(p,kr.EventType.CLOSE,()=>{_||(_=!0,B(Nt,`RPC '${t}' stream ${i} transport closed`),v.__(),this.I_(p))}),A(p,kr.EventType.ERROR,w=>{_||(_=!0,rn(Nt,`RPC '${t}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),v.__(new L(D.UNAVAILABLE,"The operation could not be completed")))}),A(p,kr.EventType.MESSAGE,w=>{var x;if(!_){const N=w.data[0];nt(!!N,16349);const M=N,k=(M==null?void 0:M.error)||((x=M[0])===null||x===void 0?void 0:x.error);if(k){B(Nt,`RPC '${t}' stream ${i} received error:`,k);const U=k.status;let H=function(E){const b=_t[E];if(b!==void 0)return Kd(b)}(U),I=k.message;H===void 0&&(H=D.INTERNAL,I="Unknown error status: "+U+" with message "+k.message),_=!0,v.__(new L(H,I)),p.close()}else B(Nt,`RPC '${t}' stream ${i} received:`,N),v.a_(N)}}),A(u,cd.STAT_EVENT,w=>{w.stat===ya.PROXY?B(Nt,`RPC '${t}' stream ${i} detected buffering proxy`):w.stat===ya.NOPROXY&&B(Nt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.o_()},0),v}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(n=>n===t)}}function ta(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(e){return new Aw(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(t,n,r=1e3,i=1.5,s=6e4){this.Fi=t,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&B("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="PersistentStream";class lp{constructor(t,n,r,i,s,a,u,l){this.Fi=t,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new up(t,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():n&&n.code===D.RESOURCE_EXHAUSTED?(Fe(n.toString()),Fe("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(n)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{t(()=>{const i=new L(D.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(t,n){const r=this.K_(this.b_);this.stream=this.z_(t,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return B(_h,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return n=>{this.Fi.enqueueAndForget(()=>this.b_===t?n():(B(_h,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class w0 extends lp{constructor(t,n,r,i,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}z_(t,n){return this.connection.P_("Listen",t,n)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const n=Rw(this.serializer,t),r=function(s){if(!("targetChange"in s))return G.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?G.min():a.readTime?_e(a.readTime):G.min()}(t);return this.listener.J_(n,r)}H_(t){const n={};n.database=Ca(this.serializer),n.addTarget=function(s,a){let u;const l=a.target;if(u=Aa(l)?{documents:xw(s,l)}:{query:Pw(s,l).Vt},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Jd(s,a.resumeToken);const c=ba(s,a.expectedCount);c!==null&&(u.expectedCount=c)}else if(a.snapshotVersion.compareTo(G.min())>0){u.readTime=xs(s,a.snapshotVersion.toTimestamp());const c=ba(s,a.expectedCount);c!==null&&(u.expectedCount=c)}return u}(this.serializer,t);const r=Nw(this.serializer,t);r&&(n.labels=r),this.k_(n)}Y_(t){const n={};n.database=Ca(this.serializer),n.removeTarget=t,this.k_(n)}}class E0 extends lp{constructor(t,n,r,i,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,n){return this.connection.P_("Write",t,n)}j_(t){return nt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,nt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){nt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const n=Cw(t.writeResults,t.commitTime),r=_e(t.commitTime);return this.listener.ta(r,n)}na(){const t={};t.database=Ca(this.serializer),this.k_(t)}X_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>Sw(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{}class A0 extends T0{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Wo(t,Ra(n,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(D.UNKNOWN,s.toString())})}Jo(t,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Jo(t,Ra(n,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(D.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class I0{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Fe(n),this._a=!1):B("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn="RemoteStore";class b0{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(a=>{r.enqueueAndForget(async()=>{Dn(this)&&(B(Cn,"Restarting streams for network reachability change."),await async function(l){const c=W(l);c.Ia.add(4),await gi(c),c.Aa.set("Unknown"),c.Ia.delete(4),await no(c)}(this))})}),this.Aa=new I0(r,i)}}async function no(e){if(Dn(e))for(const t of e.da)await t(!0)}async function gi(e){for(const t of e.da)await t(!1)}function cp(e,t){const n=W(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),Du(n)?Nu(n):fr(n).x_()&&Vu(n,t))}function Pu(e,t){const n=W(e),r=fr(n);n.Ta.delete(t),r.x_()&&hp(n,t),n.Ta.size===0&&(r.x_()?r.B_():Dn(n)&&n.Aa.set("Unknown"))}function Vu(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(G.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}fr(e).H_(t)}function hp(e,t){e.Ra.$e(t),fr(e).Y_(t)}function Nu(e){e.Ra=new vw({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),fr(e).start(),e.Aa.aa()}function Du(e){return Dn(e)&&!fr(e).M_()&&e.Ta.size>0}function Dn(e){return W(e).Ia.size===0}function fp(e){e.Ra=void 0}async function R0(e){e.Aa.set("Online")}async function S0(e){e.Ta.forEach((t,n)=>{Vu(e,t)})}async function C0(e,t){fp(e),Du(e)?(e.Aa.la(t),Nu(e)):e.Aa.set("Unknown")}async function x0(e,t,n){if(e.Aa.set("Online"),t instanceof Xd&&t.state===2&&t.cause)try{await async function(i,s){const a=s.cause;for(const u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.Ta.delete(u),i.Ra.removeTarget(u))}(e,t)}catch(r){B(Cn,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Vs(e,r)}else if(t instanceof rs?e.Ra.Ye(t):t instanceof Qd?e.Ra.it(t):e.Ra.et(t),!n.isEqual(G.min()))try{const r=await ap(e.localStore);n.compareTo(r)>=0&&await function(s,a){const u=s.Ra.Pt(a);return u.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ta.get(c);f&&s.Ta.set(c,f.withResumeToken(l.resumeToken,a))}}),u.targetMismatches.forEach((l,c)=>{const f=s.Ta.get(l);if(!f)return;s.Ta.set(l,f.withResumeToken(St.EMPTY_BYTE_STRING,f.snapshotVersion)),hp(s,l);const p=new Xe(f.target,l,c,f.sequenceNumber);Vu(s,p)}),s.remoteSyncer.applyRemoteEvent(u)}(e,n)}catch(r){B(Cn,"Failed to raise snapshot:",r),await Vs(e,r)}}async function Vs(e,t,n){if(!cr(t))throw t;e.Ia.add(1),await gi(e),e.Aa.set("Offline"),n||(n=()=>ap(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{B(Cn,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await no(e)})}function dp(e,t){return t().catch(n=>Vs(e,n,t))}async function ro(e){const t=W(e),n=ln(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:gu;for(;P0(t);)try{const i=await h0(t.localStore,r);if(i===null){t.Pa.length===0&&n.B_();break}r=i.batchId,V0(t,i)}catch(i){await Vs(t,i)}pp(t)&&mp(t)}function P0(e){return Dn(e)&&e.Pa.length<10}function V0(e,t){e.Pa.push(t);const n=ln(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function pp(e){return Dn(e)&&!ln(e).M_()&&e.Pa.length>0}function mp(e){ln(e).start()}async function N0(e){ln(e).na()}async function D0(e){const t=ln(e);for(const n of e.Pa)t.X_(n.mutations)}async function k0(e,t,n){const r=e.Pa.shift(),i=Au.from(r,t,n);await dp(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await ro(e)}async function O0(e,t){t&&ln(e).Z_&&await async function(r,i){if(function(a){return _w(a)&&a!==D.ABORTED}(i.code)){const s=r.Pa.shift();ln(r).N_(),await dp(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await ro(r)}}(e,t),pp(e)&&mp(e)}async function yh(e,t){const n=W(e);n.asyncQueue.verifyOperationInProgress(),B(Cn,"RemoteStore received new credentials");const r=Dn(n);n.Ia.add(3),await gi(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await no(n)}async function M0(e,t){const n=W(e);t?(n.Ia.delete(2),await no(n)):t||(n.Ia.add(2),await gi(n),n.Aa.set("Unknown"))}function fr(e){return e.Va||(e.Va=function(n,r,i){const s=W(n);return s.ia(),new w0(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:R0.bind(null,e),e_:S0.bind(null,e),n_:C0.bind(null,e),J_:x0.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),Du(e)?Nu(e):e.Aa.set("Unknown")):(await e.Va.stop(),fp(e))})),e.Va}function ln(e){return e.ma||(e.ma=function(n,r,i){const s=W(n);return s.ia(),new E0(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:N0.bind(null,e),n_:O0.bind(null,e),ea:D0.bind(null,e),ta:k0.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await ro(e)):(await e.ma.stop(),e.Pa.length>0&&(B(Cn,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new De,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){const a=Date.now()+r,u=new ku(t,n,a,i,s);return u.start(r),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(D.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ou(e,t){if(Fe("AsyncQueue",`${t}: ${e}`),cr(e))return new L(D.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{static emptySet(t){return new Wn(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||q.comparator(n.key,r.key):(n,r)=>q.comparator(n.key,r.key),this.keyedMap=Or(),this.sortedSet=new ct(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Wn)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new Wn;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(){this.fa=new ct(q.comparator)}track(t){const n=t.doc.key,r=this.fa.get(n);r?t.type!==0&&r.type===3?this.fa=this.fa.insert(n,t):t.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.fa=this.fa.remove(n):t.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):j(63341,{At:t,ga:r}):this.fa=this.fa.insert(n,t)}pa(){const t=[];return this.fa.inorderTraversal((n,r)=>{t.push(r)}),t}}class tr{constructor(t,n,r,i,s,a,u,l,c){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,r,i,s){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new tr(t,n,Wn.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Xs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class L0{constructor(){this.queries=wh(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=W(n),s=i.queries;i.queries=wh(),s.forEach((a,u)=>{for(const l of u.wa)l.onError(r)})})(this,new L(D.ABORTED,"Firestore shutting down"))}}function wh(){return new Nn(e=>Od(e),Xs)}async function gp(e,t){const n=W(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new F0,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const u=Ou(a,`Initialization of query '${$n(t.query)}' failed`);return void t.onError(u)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&Mu(n)}async function _p(e,t){const n=W(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const a=s.wa.indexOf(t);a>=0&&(s.wa.splice(a,1),s.wa.length===0?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function U0(e,t){const n=W(e);let r=!1;for(const i of t){const s=i.query,a=n.queries.get(s);if(a){for(const u of a.wa)u.Ca(i)&&(r=!0);a.ya=i}}r&&Mu(n)}function B0(e,t,n){const r=W(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function Mu(e){e.Da.forEach(t=>{t.next()})}var Va,Eh;(Eh=Va||(Va={})).Fa="default",Eh.Cache="cache";class yp{constructor(t,n,r){this.query=t,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new tr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),n=!0):this.Ba(t,this.onlineState)&&(this.La(t),n=!0),this.Oa=t,n}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),n=!0),n}Ba(t,n){if(!t.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(t){t=tr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==Va.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(t){this.key=t}}class wp{constructor(t){this.key=t}}class q0{constructor(t,n){this.query=t,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=J(),this.mutatedKeys=J(),this.Xa=Md(t),this.eu=new Wn(this.Xa)}get tu(){return this.Ha}nu(t,n){const r=n?n.ru:new vh,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,u=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((f,p)=>{const m=i.get(f),_=Js(this.query,p)?p:null,v=!!m&&this.mutatedKeys.has(m.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let w=!1;m&&_?m.data.isEqual(_.data)?v!==A&&(r.track({type:3,doc:_}),w=!0):this.iu(m,_)||(r.track({type:2,doc:_}),w=!0,(l&&this.Xa(_,l)>0||c&&this.Xa(_,c)<0)&&(u=!0)):!m&&_?(r.track({type:0,doc:_}),w=!0):m&&!_&&(r.track({type:1,doc:m}),w=!0,(l||c)&&(u=!0)),w&&(_?(a=a.add(_),s=A?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{eu:a,ru:r,Ds:u,mutatedKeys:s}}iu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const a=t.ru.pa();a.sort((f,p)=>function(_,v){const A=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j(20277,{At:w})}};return A(_)-A(v)}(f.type,p.type)||this.Xa(f.doc,p.doc)),this.su(r),i=i!=null&&i;const u=n&&!i?this.ou():[],l=this.Za.size===0&&this.current&&!i?1:0,c=l!==this.Ya;return this.Ya=l,a.length!==0||c?{snapshot:new tr(this.query,t.eu,s,a,t.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new vh,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=J(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return t.forEach(r=>{this.Za.has(r)||n.push(new wp(r))}),this.Za.forEach(r=>{t.has(r)||n.push(new vp(r))}),n}uu(t){this.Ha=t.qs,this.Za=J();const n=this.nu(t.documents);return this.applyChanges(n,!0)}cu(){return tr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Fu="SyncEngine";class $0{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class j0{constructor(t){this.key=t,this.lu=!1}}class z0{constructor(t,n,r,i,s,a){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new Nn(u=>Od(u),Xs),this.Tu=new Map,this.Iu=new Set,this.du=new ct(q.comparator),this.Eu=new Map,this.Au=new Ru,this.Ru={},this.Vu=new Map,this.mu=Zn.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function H0(e,t,n=!0){const r=Rp(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Ep(r,t,n,!0),i}async function G0(e,t){const n=Rp(e);await Ep(n,t,!0,!1)}async function Ep(e,t,n,r){const i=await f0(e.localStore,me(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await W0(e,t,s,a==="current",i.resumeToken)),e.isPrimaryClient&&n&&cp(e.remoteStore,i),u}async function W0(e,t,n,r,i){e.gu=(p,m,_)=>async function(A,w,x,N){let M=w.view.nu(x);M.Ds&&(M=await dh(A.localStore,w.query,!1).then(({documents:I})=>w.view.nu(I,M)));const k=N&&N.targetChanges.get(w.targetId),U=N&&N.targetMismatches.get(w.targetId)!=null,H=w.view.applyChanges(M,A.isPrimaryClient,k,U);return Ah(A,w.targetId,H._u),H.snapshot}(e,p,m,_);const s=await dh(e.localStore,t,!0),a=new q0(t,s.qs),u=a.nu(s.documents),l=mi.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),c=a.applyChanges(u,e.isPrimaryClient,l);Ah(e,n,c._u);const f=new $0(t,n,a);return e.Pu.set(t,f),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function K0(e,t,n){const r=W(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(a=>!Xs(a,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xa(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Pu(r.remoteStore,i.targetId),Na(r,i.targetId)}).catch(lr)):(Na(r,i.targetId),await xa(r.localStore,i.targetId,!0))}async function Q0(e,t){const n=W(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Pu(n.remoteStore,r.targetId))}async function X0(e,t,n){const r=rE(e);try{const i=await function(a,u){const l=W(a),c=lt.now(),f=u.reduce((_,v)=>_.add(v.key),J());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let v=Ue(),A=J();return l.Os.getEntries(_,f).next(w=>{v=w,v.forEach((x,N)=>{N.isValidDocument()||(A=A.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,v)).next(w=>{p=w;const x=[];for(const N of u){const M=fw(N,p.get(N.key).overlayedDocument);M!=null&&x.push(new fn(N.key,M,Sd(M.value.mapValue),ge.exists(!0)))}return l.mutationQueue.addMutationBatch(_,c,x,u)}).next(w=>{m=w;const x=w.applyToLocalDocumentSet(p,A);return l.documentOverlayCache.saveOverlays(_,w.batchId,x)})}).then(()=>({batchId:m.batchId,changes:Ld(p)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,l){let c=a.Ru[a.currentUser.toKey()];c||(c=new ct(X)),c=c.insert(u,l),a.Ru[a.currentUser.toKey()]=c}(r,i.batchId,n),await _i(r,i.changes),await ro(r.remoteStore)}catch(i){const s=Ou(i,"Failed to persist write");n.reject(s)}}async function Tp(e,t){const n=W(e);try{const r=await l0(n.localStore,t);t.targetChanges.forEach((i,s)=>{const a=n.Eu.get(s);a&&(nt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.lu=!0:i.modifiedDocuments.size>0?nt(a.lu,14607):i.removedDocuments.size>0&&(nt(a.lu,42227),a.lu=!1))}),await _i(n,r,t)}catch(r){await lr(r)}}function Th(e,t,n){const r=W(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,a)=>{const u=a.view.va(t);u.snapshot&&i.push(u.snapshot)}),function(a,u){const l=W(a);l.onlineState=u;let c=!1;l.queries.forEach((f,p)=>{for(const m of p.wa)m.va(u)&&(c=!0)}),c&&Mu(l)}(r.eventManager,t),i.length&&r.hu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function J0(e,t,n){const r=W(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let a=new ct(q.comparator);a=a.insert(s,kt.newNoDocument(s,G.min()));const u=J().add(s),l=new to(G.min(),new Map,new ct(X),a,u);await Tp(r,l),r.du=r.du.remove(s),r.Eu.delete(t),Lu(r)}else await xa(r.localStore,t,!1).then(()=>Na(r,t,n)).catch(lr)}async function Y0(e,t){const n=W(e),r=t.batch.batchId;try{const i=await u0(n.localStore,t);Ip(n,r,null),Ap(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await _i(n,i)}catch(i){await lr(i)}}async function Z0(e,t,n){const r=W(e);try{const i=await function(a,u){const l=W(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,u).next(p=>(nt(p!==null,37113),f=p.keys(),l.mutationQueue.removeMutationBatch(c,p))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(r.localStore,t);Ip(r,t,n),Ap(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await _i(r,i)}catch(i){await lr(i)}}function Ap(e,t){(e.Vu.get(t)||[]).forEach(n=>{n.resolve()}),e.Vu.delete(t)}function Ip(e,t,n){const r=W(e);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function Na(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(r=>{e.Au.containsKey(r)||bp(e,r)})}function bp(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(Pu(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),Lu(e))}function Ah(e,t,n){for(const r of n)r instanceof vp?(e.Au.addReference(r.key,t),tE(e,r)):r instanceof wp?(B(Fu,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||bp(e,r.key)):j(19791,{yu:r})}function tE(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(B(Fu,"New document in limbo: "+n),e.Iu.add(r),Lu(e))}function Lu(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new q(ot.fromString(t)),r=e.mu.next();e.Eu.set(r,new j0(n)),e.du=e.du.insert(n,r),cp(e.remoteStore,new Xe(me(Eu(n.path)),r,"TargetPurposeLimboResolution",Ws.ue))}}async function _i(e,t,n){const r=W(e),i=[],s=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach((u,l)=>{a.push(r.gu(l,t,n).then(c=>{var f;if((c||n)&&r.isPrimaryClient){const p=c?!c.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(c){i.push(c);const p=Cu.Es(l.targetId,c);s.push(p)}}))}),await Promise.all(a),r.hu.J_(i),await async function(l,c){const f=W(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>O.forEach(c,m=>O.forEach(m.Is,_=>f.persistence.referenceDelegate.addReference(p,m.targetId,_)).next(()=>O.forEach(m.ds,_=>f.persistence.referenceDelegate.removeReference(p,m.targetId,_)))))}catch(p){if(!cr(p))throw p;B(xu,"Failed to update sequence numbers: "+p)}for(const p of c){const m=p.targetId;if(!p.fromCache){const _=f.Fs.get(m),v=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(v);f.Fs=f.Fs.insert(m,A)}}}(r.localStore,s))}async function eE(e,t){const n=W(e);if(!n.currentUser.isEqual(t)){B(Fu,"User change. New user:",t.toKey());const r=await op(n.localStore,t);n.currentUser=t,function(s,a){s.Vu.forEach(u=>{u.forEach(l=>{l.reject(new L(D.CANCELLED,a))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await _i(n,r.Bs)}}function nE(e,t){const n=W(e),r=n.Eu.get(t);if(r&&r.lu)return J().add(r.key);{let i=J();const s=n.Tu.get(t);if(!s)return i;for(const a of s){const u=n.Pu.get(a);i=i.unionWith(u.view.tu)}return i}}function Rp(e){const t=W(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Tp.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=nE.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=J0.bind(null,t),t.hu.J_=U0.bind(null,t.eventManager),t.hu.pu=B0.bind(null,t.eventManager),t}function rE(e){const t=W(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Y0.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Z0.bind(null,t),t}class Ns{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=eo(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,n){return null}Fu(t,n){return null}vu(t){return a0(this.persistence,new i0,t.initialUser,this.serializer)}Du(t){return new sp(Su.Vi,this.serializer)}bu(t){return new p0}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ns.provider={build:()=>new Ns};class iE extends Ns{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,n){nt(this.persistence.referenceDelegate instanceof Ps,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new jw(r,t.asyncQueue,n)}Du(t){const n=this.cacheSizeBytes!==void 0?zt.withCacheSize(this.cacheSizeBytes):zt.DEFAULT;return new sp(r=>Ps.Vi(r,n),this.serializer)}}class Da{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Th(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=eE.bind(null,this.syncEngine),await M0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new L0}()}createDatastore(t){const n=eo(t.databaseInfo.databaseId),r=function(s){return new v0(s)}(t.databaseInfo);return function(s,a,u,l){return new A0(s,a,u,l)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,a,u){return new b0(r,i,s,a,u)}(this.localStore,this.datastore,t.asyncQueue,n=>Th(this.syncEngine,n,0),function(){return gh.C()?new gh:new m0}())}createSyncEngine(t,n){return function(i,s,a,u,l,c,f){const p=new z0(i,s,a,u,l,c);return f&&(p.fu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const s=W(i);B(Cn,"RemoteStore shutting down."),s.Ia.add(5),await gi(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Da.provider={build:()=>new Da};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):Fe("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn="FirestoreClient";class sE{constructor(t,n,r,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Dt.UNAUTHENTICATED,this.clientId=mu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{B(cn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(B(cn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new De;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=Ou(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function ea(e,t){e.asyncQueue.verifyOperationInProgress(),B(cn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await op(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>{rn("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{B("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{rn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),e._offlineComponents=t}async function Ih(e,t){e.asyncQueue.verifyOperationInProgress();const n=await oE(e);B(cn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>yh(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>yh(t.remoteStore,i)),e._onlineComponents=t}async function oE(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){B(cn,"Using user provided OfflineComponentProvider");try{await ea(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===D.FAILED_PRECONDITION||i.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;rn("Error using user provided cache. Falling back to memory cache: "+n),await ea(e,new Ns)}}else B(cn,"Using default OfflineComponentProvider"),await ea(e,new iE(void 0));return e._offlineComponents}async function Cp(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(B(cn,"Using user provided OnlineComponentProvider"),await Ih(e,e._uninitializedComponentsProvider._online)):(B(cn,"Using default OnlineComponentProvider"),await Ih(e,new Da))),e._onlineComponents}function aE(e){return Cp(e).then(t=>t.syncEngine)}async function xp(e){const t=await Cp(e),n=t.eventManager;return n.onListen=H0.bind(null,t.syncEngine),n.onUnlisten=K0.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=G0.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Q0.bind(null,t.syncEngine),n}function uE(e,t,n={}){const r=new De;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,u,l,c){const f=new Sp({next:m=>{f.Ou(),a.enqueueAndForget(()=>_p(s,p));const _=m.docs.has(u);!_&&m.fromCache?c.reject(new L(D.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&l&&l.source==="server"?c.reject(new L(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new yp(Eu(u.path),f,{includeMetadataChanges:!0,ka:!0});return gp(s,p)}(await xp(e),e.asyncQueue,t,n,r)),r.promise}function lE(e,t,n={}){const r=new De;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,u,l,c){const f=new Sp({next:m=>{f.Ou(),a.enqueueAndForget(()=>_p(s,p)),m.fromCache&&l.source==="server"?c.reject(new L(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new yp(u,f,{includeMetadataChanges:!0,ka:!0});return gp(s,p)}(await xp(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="firestore.googleapis.com",Rh=!0;class Sh{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new L(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Vp,this.ssl=Rh}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Rh;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=ip;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<qw)throw new L(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}bv("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Pp((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class io{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new L(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sh(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gv;switch(r.type){case"firstParty":return new wv(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=bh.get(n);r&&(B("ComponentProvider","Removing Datastore"),bh.delete(n),r.terminate())}(this),Promise.resolve()}}function cE(e,t,n,r={}){var i;e=Le(e,io);const s=fu(t),a=e._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;s&&(j_(`https://${l}`),W_("Firestore",!0)),a.host!==Vp&&a.host!==l&&rn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:r});if(!vs(c,u)&&(e._setSettings(c),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=Dt.MOCK_USER;else{f=z_(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new L(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Dt(m)}e._authCredentials=new _v(new pd(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new dn(this.firestore,t,this._query)}}class mt{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new mt(this.firestore,t,this._key)}toJSON(){return{type:mt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(di(n,mt._jsonSchema))return new mt(t,r||null,new q(ot.fromString(n.referencePath)))}}mt._jsonSchemaVersion="firestore/documentReference/1.0",mt._jsonSchema={type:vt("string",mt._jsonSchemaVersion),referencePath:vt("string")};class tn extends dn{constructor(t,n,r){super(t,n,Eu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new mt(this.firestore,null,new q(t))}withConverter(t){return new tn(this.firestore,t,this._path)}}function Np(e,t,...n){if(e=Oe(e),gd("collection","path",t),e instanceof io){const r=ot.fromString(t,...n);return Bc(r),new tn(e,null,r)}{if(!(e instanceof mt||e instanceof tn))throw new L(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(ot.fromString(t,...n));return Bc(r),new tn(e.firestore,null,r)}}function hE(e,t,...n){if(e=Oe(e),arguments.length===1&&(t=mu.newId()),gd("doc","path",t),e instanceof io){const r=ot.fromString(t,...n);return Uc(r),new mt(e,null,new q(r))}{if(!(e instanceof mt||e instanceof tn))throw new L(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(ot.fromString(t,...n));return Uc(r),new mt(e.firestore,e instanceof tn?e.converter:null,new q(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="AsyncQueue";class xh{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new up(this,"async_queue_retry"),this.oc=()=>{const r=ta();r&&B(Ch,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=t;const n=ta();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const n=ta();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new De;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!cr(t))throw t;B(Ch,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const n=this._c.then(()=>(this.nc=!0,t().catch(r=>{throw this.tc=r,this.nc=!1,Fe("INTERNAL UNHANDLED ERROR: ",Ph(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(t,n,r){this.ac(),this.sc.indexOf(t)>-1&&(n=0);const i=ku.createAndSchedule(this,t,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&j(47125,{hc:Ph(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const n of this.ec)if(n.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const n=this.ec.indexOf(t);this.ec.splice(n,1)}}function Ph(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class yi extends io{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new xh,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new xh(t),this._firestoreClient=void 0,await t}}}function fE(e,t){const n=typeof e=="object"?e:rv(),r=typeof e=="string"?e:As,i=Yy(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=q_("firestore");s&&cE(i,...s)}return i}function Uu(e){if(e._terminated)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||dE(e),e._firestoreClient}function dE(e){var t,n,r;const i=e._freezeSettings(),s=function(u,l,c,f){return new Fv(u,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Pp(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new sE(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(u){const l=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(t){this._byteString=t}static fromBase64String(t){try{return new te(St.fromBase64String(t))}catch(n){throw new L(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new te(St.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:te._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(di(t,te._jsonSchema))return te.fromBase64String(t.bytes)}}te._jsonSchemaVersion="firestore/bytes/1.0",te._jsonSchema={type:vt("string",te._jsonSchemaVersion),bytes:vt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new L(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new L(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new L(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return X(this._lat,t._lat)||X(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ye._jsonSchemaVersion}}static fromJSON(t){if(di(t,ye._jsonSchema))return new ye(t.latitude,t.longitude)}}ye._jsonSchemaVersion="firestore/geoPoint/1.0",ye._jsonSchema={type:vt("string",ye._jsonSchemaVersion),latitude:vt("number"),longitude:vt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:ve._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(di(t,ve._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new ve(t.vectorValues);throw new L(D.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ve._jsonSchemaVersion="firestore/vectorValue/1.0",ve._jsonSchema={type:vt("string",ve._jsonSchemaVersion),vectorValues:vt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE=/^__.*__$/;class mE{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new fn(t,this.data,this.fieldMask,n,this.fieldTransforms):new pi(t,this.data,n,this.fieldTransforms)}}class Dp{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new fn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function kp(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j(40011,{Ec:e})}}class qu{constructor(t,n,r,i,s,a){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new qu(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.fc(t),i}gc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return Ds(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(kp(this.Ec)&&pE.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class gE{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||eo(t)}Dc(t,n,r,i=!1){return new qu({Ec:t,methodName:n,bc:r,path:Rt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $u(e){const t=e._freezeSettings(),n=eo(e._databaseId);return new gE(e._databaseId,!!t.ignoreUndefinedProperties,n)}function _E(e,t,n,r,i,s={}){const a=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);ju("Data must be an object, but it was:",a,r);const u=Op(r,a);let l,c;if(s.merge)l=new Jt(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const m=ka(t,p,n);if(!a.contains(m))throw new L(D.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Fp(f,m)||f.push(m)}l=new Jt(f),c=a.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,c=a.fieldTransforms;return new mE(new Ht(u),l,c)}class oo extends Bu{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof oo}}function yE(e,t,n,r){const i=e.Dc(1,t,n);ju("Data must be an object, but it was:",i,r);const s=[],a=Ht.empty();hn(r,(l,c)=>{const f=zu(t,l,n);c=Oe(c);const p=i.gc(f);if(c instanceof oo)s.push(f);else{const m=vi(c,p);m!=null&&(s.push(f),a.set(f,m))}});const u=new Jt(s);return new Dp(a,u,i.fieldTransforms)}function vE(e,t,n,r,i,s){const a=e.Dc(1,t,n),u=[ka(t,r,n)],l=[i];if(s.length%2!=0)throw new L(D.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)u.push(ka(t,s[m])),l.push(s[m+1]);const c=[],f=Ht.empty();for(let m=u.length-1;m>=0;--m)if(!Fp(c,u[m])){const _=u[m];let v=l[m];v=Oe(v);const A=a.gc(_);if(v instanceof oo)c.push(_);else{const w=vi(v,A);w!=null&&(c.push(_),f.set(_,w))}}const p=new Jt(c);return new Dp(f,p,a.fieldTransforms)}function wE(e,t,n,r=!1){return vi(n,e.Dc(r?4:3,t))}function vi(e,t){if(Mp(e=Oe(e)))return ju("Unsupported field value:",t,e),Op(e,t);if(e instanceof Bu)return function(r,i){if(!kp(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const u of r){let l=vi(u,i.yc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=Oe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ow(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=lt.fromDate(r);return{timestampValue:xs(i.serializer,s)}}if(r instanceof lt){const s=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xs(i.serializer,s)}}if(r instanceof ye)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof te)return{bytesValue:Jd(i.serializer,r._byteString)};if(r instanceof mt){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:bu(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ve)return function(a,u){return{mapValue:{fields:{[bd]:{stringValue:Rd},[Is]:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw u.wc("VectorValues must only contain numeric values.");return Tu(u.serializer,c)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${Gs(r)}`)}(e,t)}function Op(e,t){const n={};return vd(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):hn(e,(r,i)=>{const s=vi(i,t.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Mp(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof lt||e instanceof ye||e instanceof te||e instanceof mt||e instanceof Bu||e instanceof ve)}function ju(e,t,n){if(!Mp(n)||!_d(n)){const r=Gs(n);throw r==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function ka(e,t,n){if((t=Oe(t))instanceof so)return t._internalPath;if(typeof t=="string")return zu(e,t);throw Ds("Field path arguments must be of type string or ",e,!1,void 0,n)}const EE=new RegExp("[~\\*/\\[\\]]");function zu(e,t,n){if(t.search(EE)>=0)throw Ds(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new so(...t.split("."))._internalPath}catch{throw Ds(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Ds(e,t,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let u=`Function ${t}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new L(D.INVALID_ARGUMENT,u+e+l)}function Fp(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new TE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Hu("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class TE extends Lp{data(){return super.data()}}function Hu(e,t){return typeof t=="string"?zu(e,t):t instanceof so?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new L(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gu{}class Wu extends Gu{}function IE(e,t,...n){let r=[];t instanceof Gu&&r.push(t),r=r.concat(n),function(s){const a=s.filter(l=>l instanceof Qu).length,u=s.filter(l=>l instanceof Ku).length;if(a>1||a>0&&u>0)throw new L(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class Ku extends Wu{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new Ku(t,n,r)}_apply(t){const n=this._parse(t);return Up(t._query,n),new dn(t.firestore,t.converter,Ia(t._query,n))}_parse(t){const n=$u(t.firestore);return function(s,a,u,l,c,f,p){let m;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new L(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Nh(p,f);const v=[];for(const A of p)v.push(Vh(l,s,A));m={arrayValue:{values:v}}}else m=Vh(l,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Nh(p,f),m=wE(u,a,p,f==="in"||f==="not-in");return yt.create(c,f,m)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class Qu extends Gu{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new Qu(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:oe.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,s){let a=i;const u=s.getFlattenedFilters();for(const l of u)Up(a,l),a=Ia(a,l)}(t._query,n),new dn(t.firestore,t.converter,Ia(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Xu extends Wu{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new Xu(t,n)}_apply(t){const n=function(i,s,a){if(i.startAt!==null)throw new L(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new L(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ri(s,a)}(t._query,this._field,this._direction);return new dn(t.firestore,t.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new hr(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function bE(e,t="asc"){const n=t,r=Hu("orderBy",e);return Xu._create(r,n)}class Ju extends Wu{constructor(t,n,r){super(),this.type=t,this._limit=n,this._limitType=r}static _create(t,n,r){return new Ju(t,n,r)}_apply(t){return new dn(t.firestore,t.converter,Rs(t._query,this._limit,this._limitType))}}function RE(e){return Rv("limit",e),Ju._create("limit",e,"F")}function Vh(e,t,n){if(typeof(n=Oe(n))=="string"){if(n==="")throw new L(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kd(t)&&n.indexOf("/")!==-1)throw new L(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(ot.fromString(n));if(!q.isDocumentKey(r))throw new L(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Kc(e,new q(r))}if(n instanceof mt)return Kc(e,n._key);throw new L(D.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gs(n)}.`)}function Nh(e,t){if(!Array.isArray(e)||e.length===0)throw new L(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Up(e,t){const n=function(i,s){for(const a of i)for(const u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new L(D.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new L(D.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class SE{convertValue(t,n="none"){switch(un(t)){case 0:return null;case 1:return t.booleanValue;case 2:return pt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(an(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw j(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return hn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(t){var n,r,i;const s=(i=(r=(n=t.fields)===null||n===void 0?void 0:n[Is].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>pt(a.doubleValue));return new ve(s)}convertGeoPoint(t){return new ye(pt(t.latitude),pt(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=Qs(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ti(t));default:return null}}convertTimestamp(t){const n=on(t);return new lt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=ot.fromString(t);nt(rp(r),9688,{name:t});const i=new ei(r.get(1),r.get(3)),s=new q(r.popFirst(5));return i.isEqual(n)||Fe(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CE(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class Fr{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class In extends Lp{constructor(t,n,r,i,s,a){super(t,n,r,i,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new is(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(Hu("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(D.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=In._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}In._jsonSchemaVersion="firestore/documentSnapshot/1.0",In._jsonSchema={type:vt("string",In._jsonSchemaVersion),bundleSource:vt("string","DocumentSnapshot"),bundleName:vt("string"),bundle:vt("string")};class is extends In{data(t={}){return super.data(t)}}class Kn{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Fr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new is(this._firestore,this._userDataWriter,r.key,r,new Fr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new L(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{const l=new is(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Fr(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const l=new is(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Fr(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,f=-1;return u.type!==0&&(c=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),f=a.indexOf(u.doc.key)),{type:xE(u.type),doc:l,oldIndex:c,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(D.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Kn._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=mu.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function xE(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(e){e=Le(e,mt);const t=Le(e.firestore,yi);return uE(Uu(t),e._key).then(n=>DE(t,e,n))}Kn._jsonSchemaVersion="firestore/querySnapshot/1.0",Kn._jsonSchema={type:vt("string",Kn._jsonSchemaVersion),bundleSource:vt("string","QuerySnapshot"),bundleName:vt("string"),bundle:vt("string")};class Bp extends SE{constructor(t){super(),this.firestore=t}convertBytes(t){return new te(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new mt(this.firestore,null,n)}}function qp(e){e=Le(e,dn);const t=Le(e.firestore,yi),n=Uu(t),r=new Bp(t);return AE(e._query),lE(n,e._query).then(i=>new Kn(t,r,e,i))}function VE(e,t,n){e=Le(e,mt);const r=Le(e.firestore,yi),i=CE(e.converter,t);return $p(r,[_E($u(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,ge.none())])}function NE(e,t,n,...r){e=Le(e,mt);const i=Le(e.firestore,yi),s=$u(i);let a;return a=typeof(t=Oe(t))=="string"||t instanceof so?vE(s,"updateDoc",e._key,t,n,r):yE(s,"updateDoc",e._key,t),$p(i,[a.toMutation(e._key,ge.exists(!0))])}function $p(e,t){return function(r,i){const s=new De;return r.asyncQueue.enqueueAndForget(async()=>X0(await aE(r),i,s)),s.promise}(Uu(e),t)}function DE(e,t,n){const r=n.docs.get(t._key),i=new Bp(e);return new In(e,i,t._key,r,new Fr(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){ur=i})(nv),Es(new Jr("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),u=new yi(new yv(r.getProvider("auth-internal")),new Ev(a,r.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new L(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ei(c.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Gn(kc,Oc,t),Gn(kc,Oc,"esm2017")})();const kE={apiKey:"AIzaSyAZsdXZU6WbM33SaKP5PoYm7G0V2ABYUSU",authDomain:"great-wave-everywhere.firebaseapp.com",projectId:"great-wave-everywhere",storageBucket:"great-wave-everywhere.firebasestorage.app",messagingSenderId:"636756607685",appId:"1:636756607685:web:2199075bc12821f89466ac",measurementId:"G-XRVYGKFWJ8"},OE=id(kE),Yu=fE(OE);async function ME(e){const t=hE(Yu,"words",e.toLowerCase()),n=await PE(t);n.exists()?await NE(t,{count:n.data().count+1}):await VE(t,{count:1})}async function Dh(){return(await qp(Np(Yu,"words"))).docs.map(t=>({id:t.id,count:t.data().count}))}async function kh(e=5){const t=IE(Np(Yu,"words"),bE("count","desc"),RE(e));return(await qp(t)).docs.map(r=>({id:r.id,count:r.data().count}))}function jp(e,t){return function(){return e.apply(t,arguments)}}const{toString:FE}=Object.prototype,{getPrototypeOf:Zu}=Object,{iterator:ao,toStringTag:zp}=Symbol,uo=(e=>t=>{const n=FE.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ue=e=>(e=e.toLowerCase(),t=>uo(t)===e),lo=e=>t=>typeof t===e,{isArray:dr}=Array,oi=lo("undefined");function LE(e){return e!==null&&!oi(e)&&e.constructor!==null&&!oi(e.constructor)&&Wt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Hp=ue("ArrayBuffer");function UE(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Hp(e.buffer),t}const BE=lo("string"),Wt=lo("function"),Gp=lo("number"),co=e=>e!==null&&typeof e=="object",qE=e=>e===!0||e===!1,ss=e=>{if(uo(e)!=="object")return!1;const t=Zu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(zp in e)&&!(ao in e)},$E=ue("Date"),jE=ue("File"),zE=ue("Blob"),HE=ue("FileList"),GE=e=>co(e)&&Wt(e.pipe),WE=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Wt(e.append)&&((t=uo(e))==="formdata"||t==="object"&&Wt(e.toString)&&e.toString()==="[object FormData]"))},KE=ue("URLSearchParams"),[QE,XE,JE,YE]=["ReadableStream","Request","Response","Headers"].map(ue),ZE=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wi(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),dr(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),a=s.length;let u;for(r=0;r<a;r++)u=s[r],t.call(null,e[u],u,e)}}function Wp(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const En=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Kp=e=>!oi(e)&&e!==En;function Oa(){const{caseless:e}=Kp(this)&&this||{},t={},n=(r,i)=>{const s=e&&Wp(t,i)||i;ss(t[s])&&ss(r)?t[s]=Oa(t[s],r):ss(r)?t[s]=Oa({},r):dr(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&wi(arguments[r],n);return t}const tT=(e,t,n,{allOwnKeys:r}={})=>(wi(t,(i,s)=>{n&&Wt(i)?e[s]=jp(i,n):e[s]=i},{allOwnKeys:r}),e),eT=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),nT=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},rT=(e,t,n,r)=>{let i,s,a;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)a=i[s],(!r||r(a,e,t))&&!u[a]&&(t[a]=e[a],u[a]=!0);e=n!==!1&&Zu(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},iT=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},sT=e=>{if(!e)return null;if(dr(e))return e;let t=e.length;if(!Gp(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},oT=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Zu(Uint8Array)),aT=(e,t)=>{const r=(e&&e[ao]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},uT=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},lT=ue("HTMLFormElement"),cT=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Oh=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),hT=ue("RegExp"),Qp=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};wi(n,(i,s)=>{let a;(a=t(i,s,e))!==!1&&(r[s]=a||i)}),Object.defineProperties(e,r)},fT=e=>{Qp(e,(t,n)=>{if(Wt(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Wt(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},dT=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return dr(e)?r(e):r(String(e).split(t)),n},pT=()=>{},mT=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function gT(e){return!!(e&&Wt(e.append)&&e[zp]==="FormData"&&e[ao])}const _T=e=>{const t=new Array(10),n=(r,i)=>{if(co(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=dr(r)?[]:{};return wi(r,(a,u)=>{const l=n(a,i+1);!oi(l)&&(s[u]=l)}),t[i]=void 0,s}}return r};return n(e,0)},yT=ue("AsyncFunction"),vT=e=>e&&(co(e)||Wt(e))&&Wt(e.then)&&Wt(e.catch),Xp=((e,t)=>e?setImmediate:t?((n,r)=>(En.addEventListener("message",({source:i,data:s})=>{i===En&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),En.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Wt(En.postMessage)),wT=typeof queueMicrotask<"u"?queueMicrotask.bind(En):typeof process<"u"&&process.nextTick||Xp,ET=e=>e!=null&&Wt(e[ao]),P={isArray:dr,isArrayBuffer:Hp,isBuffer:LE,isFormData:WE,isArrayBufferView:UE,isString:BE,isNumber:Gp,isBoolean:qE,isObject:co,isPlainObject:ss,isReadableStream:QE,isRequest:XE,isResponse:JE,isHeaders:YE,isUndefined:oi,isDate:$E,isFile:jE,isBlob:zE,isRegExp:hT,isFunction:Wt,isStream:GE,isURLSearchParams:KE,isTypedArray:oT,isFileList:HE,forEach:wi,merge:Oa,extend:tT,trim:ZE,stripBOM:eT,inherits:nT,toFlatObject:rT,kindOf:uo,kindOfTest:ue,endsWith:iT,toArray:sT,forEachEntry:aT,matchAll:uT,isHTMLForm:lT,hasOwnProperty:Oh,hasOwnProp:Oh,reduceDescriptors:Qp,freezeMethods:fT,toObjectSet:dT,toCamelCase:cT,noop:pT,toFiniteNumber:mT,findKey:Wp,global:En,isContextDefined:Kp,isSpecCompliantForm:gT,toJSONObject:_T,isAsyncFn:yT,isThenable:vT,setImmediate:Xp,asap:wT,isIterable:ET};function Q(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}P.inherits(Q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:P.toJSONObject(this.config),code:this.code,status:this.status}}});const Jp=Q.prototype,Yp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Yp[e]={value:e}});Object.defineProperties(Q,Yp);Object.defineProperty(Jp,"isAxiosError",{value:!0});Q.from=(e,t,n,r,i,s)=>{const a=Object.create(Jp);return P.toFlatObject(e,a,function(l){return l!==Error.prototype},u=>u!=="isAxiosError"),Q.call(a,e.message,t,n,r,i),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};const TT=null;function Ma(e){return P.isPlainObject(e)||P.isArray(e)}function Zp(e){return P.endsWith(e,"[]")?e.slice(0,-2):e}function Mh(e,t,n){return e?e.concat(t).map(function(i,s){return i=Zp(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function AT(e){return P.isArray(e)&&!e.some(Ma)}const IT=P.toFlatObject(P,{},null,function(t){return/^is[A-Z]/.test(t)});function ho(e,t,n){if(!P.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=P.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,w){return!P.isUndefined(w[A])});const r=n.metaTokens,i=n.visitor||f,s=n.dots,a=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&P.isSpecCompliantForm(t);if(!P.isFunction(i))throw new TypeError("visitor must be a function");function c(v){if(v===null)return"";if(P.isDate(v))return v.toISOString();if(P.isBoolean(v))return v.toString();if(!l&&P.isBlob(v))throw new Q("Blob is not supported. Use a Buffer instead.");return P.isArrayBuffer(v)||P.isTypedArray(v)?l&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function f(v,A,w){let x=v;if(v&&!w&&typeof v=="object"){if(P.endsWith(A,"{}"))A=r?A:A.slice(0,-2),v=JSON.stringify(v);else if(P.isArray(v)&&AT(v)||(P.isFileList(v)||P.endsWith(A,"[]"))&&(x=P.toArray(v)))return A=Zp(A),x.forEach(function(M,k){!(P.isUndefined(M)||M===null)&&t.append(a===!0?Mh([A],k,s):a===null?A:A+"[]",c(M))}),!1}return Ma(v)?!0:(t.append(Mh(w,A,s),c(v)),!1)}const p=[],m=Object.assign(IT,{defaultVisitor:f,convertValue:c,isVisitable:Ma});function _(v,A){if(!P.isUndefined(v)){if(p.indexOf(v)!==-1)throw Error("Circular reference detected in "+A.join("."));p.push(v),P.forEach(v,function(x,N){(!(P.isUndefined(x)||x===null)&&i.call(t,x,P.isString(N)?N.trim():N,A,m))===!0&&_(x,A?A.concat(N):[N])}),p.pop()}}if(!P.isObject(e))throw new TypeError("data must be an object");return _(e),t}function Fh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function tl(e,t){this._pairs=[],e&&ho(e,this,t)}const tm=tl.prototype;tm.append=function(t,n){this._pairs.push([t,n])};tm.toString=function(t){const n=t?function(r){return t.call(this,r,Fh)}:Fh;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function bT(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function em(e,t,n){if(!t)return e;const r=n&&n.encode||bT;P.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=P.isURLSearchParams(t)?t.toString():new tl(t,n).toString(r),s){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Lh{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){P.forEach(this.handlers,function(r){r!==null&&t(r)})}}const nm={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RT=typeof URLSearchParams<"u"?URLSearchParams:tl,ST=typeof FormData<"u"?FormData:null,CT=typeof Blob<"u"?Blob:null,xT={isBrowser:!0,classes:{URLSearchParams:RT,FormData:ST,Blob:CT},protocols:["http","https","file","blob","url","data"]},el=typeof window<"u"&&typeof document<"u",Fa=typeof navigator=="object"&&navigator||void 0,PT=el&&(!Fa||["ReactNative","NativeScript","NS"].indexOf(Fa.product)<0),VT=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",NT=el&&window.location.href||"http://localhost",DT=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:el,hasStandardBrowserEnv:PT,hasStandardBrowserWebWorkerEnv:VT,navigator:Fa,origin:NT},Symbol.toStringTag,{value:"Module"})),Ot={...DT,...xT};function kT(e,t){return ho(e,new Ot.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Ot.isNode&&P.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function OT(e){return P.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function MT(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function rm(e){function t(n,r,i,s){let a=n[s++];if(a==="__proto__")return!0;const u=Number.isFinite(+a),l=s>=n.length;return a=!a&&P.isArray(i)?i.length:a,l?(P.hasOwnProp(i,a)?i[a]=[i[a],r]:i[a]=r,!u):((!i[a]||!P.isObject(i[a]))&&(i[a]=[]),t(n,r,i[a],s)&&P.isArray(i[a])&&(i[a]=MT(i[a])),!u)}if(P.isFormData(e)&&P.isFunction(e.entries)){const n={};return P.forEachEntry(e,(r,i)=>{t(OT(r),i,n,0)}),n}return null}function FT(e,t,n){if(P.isString(e))try{return(t||JSON.parse)(e),P.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Ei={transitional:nm,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=P.isObject(t);if(s&&P.isHTMLForm(t)&&(t=new FormData(t)),P.isFormData(t))return i?JSON.stringify(rm(t)):t;if(P.isArrayBuffer(t)||P.isBuffer(t)||P.isStream(t)||P.isFile(t)||P.isBlob(t)||P.isReadableStream(t))return t;if(P.isArrayBufferView(t))return t.buffer;if(P.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return kT(t,this.formSerializer).toString();if((u=P.isFileList(t))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return ho(u?{"files[]":t}:t,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),FT(t)):t}],transformResponse:[function(t){const n=this.transitional||Ei.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(P.isResponse(t)||P.isReadableStream(t))return t;if(t&&P.isString(t)&&(r&&!this.responseType||i)){const a=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(a)throw u.name==="SyntaxError"?Q.from(u,Q.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ot.classes.FormData,Blob:Ot.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};P.forEach(["delete","get","head","post","put","patch"],e=>{Ei.headers[e]={}});const LT=P.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UT=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(a){i=a.indexOf(":"),n=a.substring(0,i).trim().toLowerCase(),r=a.substring(i+1).trim(),!(!n||t[n]&&LT[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Uh=Symbol("internals");function xr(e){return e&&String(e).trim().toLowerCase()}function os(e){return e===!1||e==null?e:P.isArray(e)?e.map(os):String(e)}function BT(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const qT=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function na(e,t,n,r,i){if(P.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!P.isString(t)){if(P.isString(r))return t.indexOf(r)!==-1;if(P.isRegExp(r))return r.test(t)}}function $T(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function jT(e,t){const n=P.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,a){return this[r].call(this,t,i,s,a)},configurable:!0})})}let Kt=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,l,c){const f=xr(l);if(!f)throw new Error("header name must be a non-empty string");const p=P.findKey(i,f);(!p||i[p]===void 0||c===!0||c===void 0&&i[p]!==!1)&&(i[p||l]=os(u))}const a=(u,l)=>P.forEach(u,(c,f)=>s(c,f,l));if(P.isPlainObject(t)||t instanceof this.constructor)a(t,n);else if(P.isString(t)&&(t=t.trim())&&!qT(t))a(UT(t),n);else if(P.isObject(t)&&P.isIterable(t)){let u={},l,c;for(const f of t){if(!P.isArray(f))throw TypeError("Object iterator must return a key-value pair");u[c=f[0]]=(l=u[c])?P.isArray(l)?[...l,f[1]]:[l,f[1]]:f[1]}a(u,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=xr(t),t){const r=P.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return BT(i);if(P.isFunction(n))return n.call(this,i,r);if(P.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=xr(t),t){const r=P.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||na(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(a){if(a=xr(a),a){const u=P.findKey(r,a);u&&(!n||na(r,r[u],u,n))&&(delete r[u],i=!0)}}return P.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||na(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return P.forEach(this,(i,s)=>{const a=P.findKey(r,s);if(a){n[a]=os(i),delete n[s];return}const u=t?$T(s):String(s).trim();u!==s&&delete n[s],n[u]=os(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return P.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&P.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[Uh]=this[Uh]={accessors:{}}).accessors,i=this.prototype;function s(a){const u=xr(a);r[u]||(jT(i,a),r[u]=!0)}return P.isArray(t)?t.forEach(s):s(t),this}};Kt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);P.reduceDescriptors(Kt.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});P.freezeMethods(Kt);function ra(e,t){const n=this||Ei,r=t||n,i=Kt.from(r.headers);let s=r.data;return P.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function im(e){return!!(e&&e.__CANCEL__)}function pr(e,t,n){Q.call(this,e??"canceled",Q.ERR_CANCELED,t,n),this.name="CanceledError"}P.inherits(pr,Q,{__CANCEL__:!0});function sm(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Q("Request failed with status code "+n.status,[Q.ERR_BAD_REQUEST,Q.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function zT(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function HT(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,a;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),f=r[s];a||(a=c),n[i]=l,r[i]=c;let p=s,m=0;for(;p!==i;)m+=n[p++],p=p%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),c-a<t)return;const _=f&&c-f;return _?Math.round(m*1e3/_):void 0}}function GT(e,t){let n=0,r=1e3/t,i,s;const a=(c,f=Date.now())=>{n=f,i=null,s&&(clearTimeout(s),s=null),e.apply(null,c)};return[(...c)=>{const f=Date.now(),p=f-n;p>=r?a(c,f):(i=c,s||(s=setTimeout(()=>{s=null,a(i)},r-p)))},()=>i&&a(i)]}const ks=(e,t,n=3)=>{let r=0;const i=HT(50,250);return GT(s=>{const a=s.loaded,u=s.lengthComputable?s.total:void 0,l=a-r,c=i(l),f=a<=u;r=a;const p={loaded:a,total:u,progress:u?a/u:void 0,bytes:l,rate:c||void 0,estimated:c&&u&&f?(u-a)/c:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(p)},n)},Bh=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},qh=e=>(...t)=>P.asap(()=>e(...t)),WT=Ot.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Ot.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Ot.origin),Ot.navigator&&/(msie|trident)/i.test(Ot.navigator.userAgent)):()=>!0,KT=Ot.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const a=[e+"="+encodeURIComponent(t)];P.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),P.isString(r)&&a.push("path="+r),P.isString(i)&&a.push("domain="+i),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function QT(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function XT(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function om(e,t,n){let r=!QT(t);return e&&(r||n==!1)?XT(e,t):t}const $h=e=>e instanceof Kt?{...e}:e;function xn(e,t){t=t||{};const n={};function r(c,f,p,m){return P.isPlainObject(c)&&P.isPlainObject(f)?P.merge.call({caseless:m},c,f):P.isPlainObject(f)?P.merge({},f):P.isArray(f)?f.slice():f}function i(c,f,p,m){if(P.isUndefined(f)){if(!P.isUndefined(c))return r(void 0,c,p,m)}else return r(c,f,p,m)}function s(c,f){if(!P.isUndefined(f))return r(void 0,f)}function a(c,f){if(P.isUndefined(f)){if(!P.isUndefined(c))return r(void 0,c)}else return r(void 0,f)}function u(c,f,p){if(p in t)return r(c,f);if(p in e)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:u,headers:(c,f,p)=>i($h(c),$h(f),p,!0)};return P.forEach(Object.keys(Object.assign({},e,t)),function(f){const p=l[f]||i,m=p(e[f],t[f],f);P.isUndefined(m)&&p!==u||(n[f]=m)}),n}const am=e=>{const t=xn({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:a,auth:u}=t;t.headers=a=Kt.from(a),t.url=em(om(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&a.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let l;if(P.isFormData(n)){if(Ot.hasStandardBrowserEnv||Ot.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...f]=l?l.split(";").map(p=>p.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...f].join("; "))}}if(Ot.hasStandardBrowserEnv&&(r&&P.isFunction(r)&&(r=r(t)),r||r!==!1&&WT(t.url))){const c=i&&s&&KT.read(s);c&&a.set(i,c)}return t},JT=typeof XMLHttpRequest<"u",YT=JT&&function(e){return new Promise(function(n,r){const i=am(e);let s=i.data;const a=Kt.from(i.headers).normalize();let{responseType:u,onUploadProgress:l,onDownloadProgress:c}=i,f,p,m,_,v;function A(){_&&_(),v&&v(),i.cancelToken&&i.cancelToken.unsubscribe(f),i.signal&&i.signal.removeEventListener("abort",f)}let w=new XMLHttpRequest;w.open(i.method.toUpperCase(),i.url,!0),w.timeout=i.timeout;function x(){if(!w)return;const M=Kt.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),U={data:!u||u==="text"||u==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:M,config:e,request:w};sm(function(I){n(I),A()},function(I){r(I),A()},U),w=null}"onloadend"in w?w.onloadend=x:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(x)},w.onabort=function(){w&&(r(new Q("Request aborted",Q.ECONNABORTED,e,w)),w=null)},w.onerror=function(){r(new Q("Network Error",Q.ERR_NETWORK,e,w)),w=null},w.ontimeout=function(){let k=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const U=i.transitional||nm;i.timeoutErrorMessage&&(k=i.timeoutErrorMessage),r(new Q(k,U.clarifyTimeoutError?Q.ETIMEDOUT:Q.ECONNABORTED,e,w)),w=null},s===void 0&&a.setContentType(null),"setRequestHeader"in w&&P.forEach(a.toJSON(),function(k,U){w.setRequestHeader(U,k)}),P.isUndefined(i.withCredentials)||(w.withCredentials=!!i.withCredentials),u&&u!=="json"&&(w.responseType=i.responseType),c&&([m,v]=ks(c,!0),w.addEventListener("progress",m)),l&&w.upload&&([p,_]=ks(l),w.upload.addEventListener("progress",p),w.upload.addEventListener("loadend",_)),(i.cancelToken||i.signal)&&(f=M=>{w&&(r(!M||M.type?new pr(null,e,w):M),w.abort(),w=null)},i.cancelToken&&i.cancelToken.subscribe(f),i.signal&&(i.signal.aborted?f():i.signal.addEventListener("abort",f)));const N=zT(i.url);if(N&&Ot.protocols.indexOf(N)===-1){r(new Q("Unsupported protocol "+N+":",Q.ERR_BAD_REQUEST,e));return}w.send(s||null)})},ZT=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(c){if(!i){i=!0,u();const f=c instanceof Error?c:this.reason;r.abort(f instanceof Q?f:new pr(f instanceof Error?f.message:f))}};let a=t&&setTimeout(()=>{a=null,s(new Q(`timeout ${t} of ms exceeded`,Q.ETIMEDOUT))},t);const u=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>P.asap(u),l}},tA=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},eA=async function*(e,t){for await(const n of nA(e))yield*tA(n,t)},nA=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},jh=(e,t,n,r)=>{const i=eA(e,t);let s=0,a,u=l=>{a||(a=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:f}=await i.next();if(c){u(),l.close();return}let p=f.byteLength;if(n){let m=s+=p;n(m)}l.enqueue(new Uint8Array(f))}catch(c){throw u(c),c}},cancel(l){return u(l),i.return()}},{highWaterMark:2})},fo=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",um=fo&&typeof ReadableStream=="function",rA=fo&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),lm=(e,...t)=>{try{return!!e(...t)}catch{return!1}},iA=um&&lm(()=>{let e=!1;const t=new Request(Ot.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),zh=64*1024,La=um&&lm(()=>P.isReadableStream(new Response("").body)),Os={stream:La&&(e=>e.body)};fo&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Os[t]&&(Os[t]=P.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Q(`Response type '${t}' is not supported`,Q.ERR_NOT_SUPPORT,r)})})})(new Response);const sA=async e=>{if(e==null)return 0;if(P.isBlob(e))return e.size;if(P.isSpecCompliantForm(e))return(await new Request(Ot.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(P.isArrayBufferView(e)||P.isArrayBuffer(e))return e.byteLength;if(P.isURLSearchParams(e)&&(e=e+""),P.isString(e))return(await rA(e)).byteLength},oA=async(e,t)=>{const n=P.toFiniteNumber(e.getContentLength());return n??sA(t)},aA=fo&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:a,onDownloadProgress:u,onUploadProgress:l,responseType:c,headers:f,withCredentials:p="same-origin",fetchOptions:m}=am(e);c=c?(c+"").toLowerCase():"text";let _=ZT([i,s&&s.toAbortSignal()],a),v;const A=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let w;try{if(l&&iA&&n!=="get"&&n!=="head"&&(w=await oA(f,r))!==0){let U=new Request(t,{method:"POST",body:r,duplex:"half"}),H;if(P.isFormData(r)&&(H=U.headers.get("content-type"))&&f.setContentType(H),U.body){const[I,y]=Bh(w,ks(qh(l)));r=jh(U.body,zh,I,y)}}P.isString(p)||(p=p?"include":"omit");const x="credentials"in Request.prototype;v=new Request(t,{...m,signal:_,method:n.toUpperCase(),headers:f.normalize().toJSON(),body:r,duplex:"half",credentials:x?p:void 0});let N=await fetch(v,m);const M=La&&(c==="stream"||c==="response");if(La&&(u||M&&A)){const U={};["status","statusText","headers"].forEach(E=>{U[E]=N[E]});const H=P.toFiniteNumber(N.headers.get("content-length")),[I,y]=u&&Bh(H,ks(qh(u),!0))||[];N=new Response(jh(N.body,zh,I,()=>{y&&y(),A&&A()}),U)}c=c||"text";let k=await Os[P.findKey(Os,c)||"text"](N,e);return!M&&A&&A(),await new Promise((U,H)=>{sm(U,H,{data:k,headers:Kt.from(N.headers),status:N.status,statusText:N.statusText,config:e,request:v})})}catch(x){throw A&&A(),x&&x.name==="TypeError"&&/Load failed|fetch/i.test(x.message)?Object.assign(new Q("Network Error",Q.ERR_NETWORK,e,v),{cause:x.cause||x}):Q.from(x,x&&x.code,e,v)}}),Ua={http:TT,xhr:YT,fetch:aA};P.forEach(Ua,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Hh=e=>`- ${e}`,uA=e=>P.isFunction(e)||e===null||e===!1,cm={getAdapter:e=>{e=P.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let a;if(r=n,!uA(n)&&(r=Ua[(a=String(n)).toLowerCase()],r===void 0))throw new Q(`Unknown adapter '${a}'`);if(r)break;i[a||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,l])=>`adapter ${u} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=t?s.length>1?`since :
`+s.map(Hh).join(`
`):" "+Hh(s[0]):"as no adapter specified";throw new Q("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Ua};function ia(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new pr(null,e)}function Gh(e){return ia(e),e.headers=Kt.from(e.headers),e.data=ra.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),cm.getAdapter(e.adapter||Ei.adapter)(e).then(function(r){return ia(e),r.data=ra.call(e,e.transformResponse,r),r.headers=Kt.from(r.headers),r},function(r){return im(r)||(ia(e),r&&r.response&&(r.response.data=ra.call(e,e.transformResponse,r.response),r.response.headers=Kt.from(r.response.headers))),Promise.reject(r)})}const hm="1.10.0",po={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{po[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Wh={};po.transitional=function(t,n,r){function i(s,a){return"[Axios v"+hm+"] Transitional option '"+s+"'"+a+(r?". "+r:"")}return(s,a,u)=>{if(t===!1)throw new Q(i(a," has been removed"+(n?" in "+n:"")),Q.ERR_DEPRECATED);return n&&!Wh[a]&&(Wh[a]=!0,console.warn(i(a," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,a,u):!0}};po.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function lA(e,t,n){if(typeof e!="object")throw new Q("options must be an object",Q.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],a=t[s];if(a){const u=e[s],l=u===void 0||a(u,s,e);if(l!==!0)throw new Q("option "+s+" must be "+l,Q.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Q("Unknown option "+s,Q.ERR_BAD_OPTION)}}const as={assertOptions:lA,validators:po},fe=as.validators;let bn=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Lh,response:new Lh}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=xn(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&as.assertOptions(r,{silentJSONParsing:fe.transitional(fe.boolean),forcedJSONParsing:fe.transitional(fe.boolean),clarifyTimeoutError:fe.transitional(fe.boolean)},!1),i!=null&&(P.isFunction(i)?n.paramsSerializer={serialize:i}:as.assertOptions(i,{encode:fe.function,serialize:fe.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),as.assertOptions(n,{baseUrl:fe.spelling("baseURL"),withXsrfToken:fe.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=s&&P.merge(s.common,s[n.method]);s&&P.forEach(["delete","get","head","post","put","patch","common"],v=>{delete s[v]}),n.headers=Kt.concat(a,s);const u=[];let l=!0;this.interceptors.request.forEach(function(A){typeof A.runWhen=="function"&&A.runWhen(n)===!1||(l=l&&A.synchronous,u.unshift(A.fulfilled,A.rejected))});const c=[];this.interceptors.response.forEach(function(A){c.push(A.fulfilled,A.rejected)});let f,p=0,m;if(!l){const v=[Gh.bind(this),void 0];for(v.unshift.apply(v,u),v.push.apply(v,c),m=v.length,f=Promise.resolve(n);p<m;)f=f.then(v[p++],v[p++]);return f}m=u.length;let _=n;for(p=0;p<m;){const v=u[p++],A=u[p++];try{_=v(_)}catch(w){A.call(this,w);break}}try{f=Gh.call(this,_)}catch(v){return Promise.reject(v)}for(p=0,m=c.length;p<m;)f=f.then(c[p++],c[p++]);return f}getUri(t){t=xn(this.defaults,t);const n=om(t.baseURL,t.url,t.allowAbsoluteUrls);return em(n,t.params,t.paramsSerializer)}};P.forEach(["delete","get","head","options"],function(t){bn.prototype[t]=function(n,r){return this.request(xn(r||{},{method:t,url:n,data:(r||{}).data}))}});P.forEach(["post","put","patch"],function(t){function n(r){return function(s,a,u){return this.request(xn(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}bn.prototype[t]=n(),bn.prototype[t+"Form"]=n(!0)});let cA=class fm{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(u=>{r.subscribe(u),s=u}).then(i);return a.cancel=function(){r.unsubscribe(s)},a},t(function(s,a,u){r.reason||(r.reason=new pr(s,a,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new fm(function(i){t=i}),cancel:t}}};function hA(e){return function(n){return e.apply(null,n)}}function fA(e){return P.isObject(e)&&e.isAxiosError===!0}const Ba={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ba).forEach(([e,t])=>{Ba[t]=e});function dm(e){const t=new bn(e),n=jp(bn.prototype.request,t);return P.extend(n,bn.prototype,t,{allOwnKeys:!0}),P.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return dm(xn(e,i))},n}const gt=dm(Ei);gt.Axios=bn;gt.CanceledError=pr;gt.CancelToken=cA;gt.isCancel=im;gt.VERSION=hm;gt.toFormData=ho;gt.AxiosError=Q;gt.Cancel=gt.CanceledError;gt.all=function(t){return Promise.all(t)};gt.spread=hA;gt.isAxiosError=fA;gt.mergeConfig=xn;gt.AxiosHeaders=Kt;gt.formToJSON=e=>rm(P.isHTMLForm(e)?new FormData(e):e);gt.getAdapter=cm.getAdapter;gt.HttpStatusCode=Ba;gt.default=gt;const{Axios:yR,AxiosError:vR,CanceledError:wR,isCancel:ER,CancelToken:TR,VERSION:AR,all:IR,Cancel:bR,isAxiosError:RR,spread:SR,toFormData:CR,AxiosHeaders:xR,HttpStatusCode:PR,formToJSON:VR,getAdapter:NR,mergeConfig:DR}=gt;var dA={value:()=>{}};function nl(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new us(n)}function us(e){this._=e}function pA(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}us.prototype=nl.prototype={constructor:us,on:function(e,t){var n=this._,r=pA(e+"",n),i,s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((i=(e=r[s]).type)&&(i=mA(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(i=(e=r[s]).type)n[i]=Kh(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Kh(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new us(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function mA(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Kh(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=dA,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var qa="http://www.w3.org/1999/xhtml";const Qh={svg:"http://www.w3.org/2000/svg",xhtml:qa,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mo(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Qh.hasOwnProperty(t)?{space:Qh[t],local:e}:e}function gA(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===qa&&t.documentElement.namespaceURI===qa?t.createElement(e):t.createElementNS(n,e)}}function _A(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function pm(e){var t=mo(e);return(t.local?_A:gA)(t)}function yA(){}function rl(e){return e==null?yA:function(){return this.querySelector(e)}}function vA(e){typeof e!="function"&&(e=rl(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,u=r[i]=new Array(a),l,c,f=0;f<a;++f)(l=s[f])&&(c=e.call(l,l.__data__,f,s))&&("__data__"in l&&(c.__data__=l.__data__),u[f]=c);return new ae(r,this._parents)}function wA(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function EA(){return[]}function mm(e){return e==null?EA:function(){return this.querySelectorAll(e)}}function TA(e){return function(){return wA(e.apply(this,arguments))}}function AA(e){typeof e=="function"?e=TA(e):e=mm(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var a=t[s],u=a.length,l,c=0;c<u;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),i.push(l));return new ae(r,i)}function gm(e){return function(){return this.matches(e)}}function _m(e){return function(t){return t.matches(e)}}var IA=Array.prototype.find;function bA(e){return function(){return IA.call(this.children,e)}}function RA(){return this.firstElementChild}function SA(e){return this.select(e==null?RA:bA(typeof e=="function"?e:_m(e)))}var CA=Array.prototype.filter;function xA(){return Array.from(this.children)}function PA(e){return function(){return CA.call(this.children,e)}}function VA(e){return this.selectAll(e==null?xA:PA(typeof e=="function"?e:_m(e)))}function NA(e){typeof e!="function"&&(e=gm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,u=r[i]=[],l,c=0;c<a;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&u.push(l);return new ae(r,this._parents)}function ym(e){return new Array(e.length)}function DA(){return new ae(this._enter||this._groups.map(ym),this._parents)}function Ms(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ms.prototype={constructor:Ms,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function kA(e){return function(){return e}}function OA(e,t,n,r,i,s){for(var a=0,u,l=t.length,c=s.length;a<c;++a)(u=t[a])?(u.__data__=s[a],r[a]=u):n[a]=new Ms(e,s[a]);for(;a<l;++a)(u=t[a])&&(i[a]=u)}function MA(e,t,n,r,i,s,a){var u,l,c=new Map,f=t.length,p=s.length,m=new Array(f),_;for(u=0;u<f;++u)(l=t[u])&&(m[u]=_=a.call(l,l.__data__,u,t)+"",c.has(_)?i[u]=l:c.set(_,l));for(u=0;u<p;++u)_=a.call(e,s[u],u,s)+"",(l=c.get(_))?(r[u]=l,l.__data__=s[u],c.delete(_)):n[u]=new Ms(e,s[u]);for(u=0;u<f;++u)(l=t[u])&&c.get(m[u])===l&&(i[u]=l)}function FA(e){return e.__data__}function LA(e,t){if(!arguments.length)return Array.from(this,FA);var n=t?MA:OA,r=this._parents,i=this._groups;typeof e!="function"&&(e=kA(e));for(var s=i.length,a=new Array(s),u=new Array(s),l=new Array(s),c=0;c<s;++c){var f=r[c],p=i[c],m=p.length,_=UA(e.call(f,f&&f.__data__,c,r)),v=_.length,A=u[c]=new Array(v),w=a[c]=new Array(v),x=l[c]=new Array(m);n(f,p,A,w,x,_,t);for(var N=0,M=0,k,U;N<v;++N)if(k=A[N]){for(N>=M&&(M=N+1);!(U=w[M])&&++M<v;);k._next=U||null}}return a=new ae(a,r),a._enter=u,a._exit=l,a}function UA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function BA(){return new ae(this._exit||this._groups.map(ym),this._parents)}function qA(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function $A(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,a=Math.min(i,s),u=new Array(i),l=0;l<a;++l)for(var c=n[l],f=r[l],p=c.length,m=u[l]=new Array(p),_,v=0;v<p;++v)(_=c[v]||f[v])&&(m[v]=_);for(;l<i;++l)u[l]=n[l];return new ae(u,this._parents)}function jA(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],a;--i>=0;)(a=r[i])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function zA(e){e||(e=HA);function t(p,m){return p&&m?e(p.__data__,m.__data__):!p-!m}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var a=n[s],u=a.length,l=i[s]=new Array(u),c,f=0;f<u;++f)(c=a[f])&&(l[f]=c);l.sort(t)}return new ae(i,this._parents).order()}function HA(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function GA(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function WA(){return Array.from(this)}function KA(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null}function QA(){let e=0;for(const t of this)++e;return e}function XA(){return!this.node()}function JA(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,a=i.length,u;s<a;++s)(u=i[s])&&e.call(u,u.__data__,s,i);return this}function YA(e){return function(){this.removeAttribute(e)}}function ZA(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tI(e,t){return function(){this.setAttribute(e,t)}}function eI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function nI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function rI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function iI(e,t){var n=mo(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?ZA:YA:typeof t=="function"?n.local?rI:nI:n.local?eI:tI)(n,t))}function vm(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function sI(e){return function(){this.style.removeProperty(e)}}function oI(e,t,n){return function(){this.style.setProperty(e,t,n)}}function aI(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function uI(e,t,n){return arguments.length>1?this.each((t==null?sI:typeof t=="function"?aI:oI)(e,t,n??"")):er(this.node(),e)}function er(e,t){return e.style.getPropertyValue(t)||vm(e).getComputedStyle(e,null).getPropertyValue(t)}function lI(e){return function(){delete this[e]}}function cI(e,t){return function(){this[e]=t}}function hI(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function fI(e,t){return arguments.length>1?this.each((t==null?lI:typeof t=="function"?hI:cI)(e,t)):this.node()[e]}function wm(e){return e.trim().split(/^|\s+/)}function il(e){return e.classList||new Em(e)}function Em(e){this._node=e,this._names=wm(e.getAttribute("class")||"")}Em.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Tm(e,t){for(var n=il(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Am(e,t){for(var n=il(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function dI(e){return function(){Tm(this,e)}}function pI(e){return function(){Am(this,e)}}function mI(e,t){return function(){(t.apply(this,arguments)?Tm:Am)(this,e)}}function gI(e,t){var n=wm(e+"");if(arguments.length<2){for(var r=il(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?mI:t?dI:pI)(n,t))}function _I(){this.textContent=""}function yI(e){return function(){this.textContent=e}}function vI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function wI(e){return arguments.length?this.each(e==null?_I:(typeof e=="function"?vI:yI)(e)):this.node().textContent}function EI(){this.innerHTML=""}function TI(e){return function(){this.innerHTML=e}}function AI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function II(e){return arguments.length?this.each(e==null?EI:(typeof e=="function"?AI:TI)(e)):this.node().innerHTML}function bI(){this.nextSibling&&this.parentNode.appendChild(this)}function RI(){return this.each(bI)}function SI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function CI(){return this.each(SI)}function xI(e){var t=typeof e=="function"?e:pm(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function PI(){return null}function VI(e,t){var n=typeof e=="function"?e:pm(e),r=t==null?PI:typeof t=="function"?t:rl(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function NI(){var e=this.parentNode;e&&e.removeChild(this)}function DI(){return this.each(NI)}function kI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function OI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function MI(e){return this.select(e?OI:kI)}function FI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function LI(e){return function(t){e.call(this,t,this.__data__)}}function UI(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function BI(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function qI(e,t,n){return function(){var r=this.__on,i,s=LI(t);if(r){for(var a=0,u=r.length;a<u;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function $I(e,t,n){var r=UI(e+""),i,s=r.length,a;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,c=u.length,f;l<c;++l)for(i=0,f=u[l];i<s;++i)if((a=r[i]).type===f.type&&a.name===f.name)return f.value}return}for(u=t?qI:BI,i=0;i<s;++i)this.each(u(r[i],t,n));return this}function Im(e,t,n){var r=vm(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function jI(e,t){return function(){return Im(this,e,t)}}function zI(e,t){return function(){return Im(this,e,t.apply(this,arguments))}}function HI(e,t){return this.each((typeof t=="function"?zI:jI)(e,t))}function*GI(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,a;i<s;++i)(a=r[i])&&(yield a)}var WI=[null];function ae(e,t){this._groups=e,this._parents=t}function Ti(){return new ae([[document.documentElement]],WI)}function KI(){return this}ae.prototype=Ti.prototype={constructor:ae,select:vA,selectAll:AA,selectChild:SA,selectChildren:VA,filter:NA,data:LA,enter:DA,exit:BA,join:qA,merge:$A,selection:KI,order:jA,sort:zA,call:GA,nodes:WA,node:KA,size:QA,empty:XA,each:JA,attr:iI,style:uI,property:fI,classed:gI,text:wI,html:II,raise:RI,lower:CI,append:xI,insert:VI,remove:DI,clone:MI,datum:FI,on:$I,dispatch:HI,[Symbol.iterator]:GI};function sl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function bm(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ai(){}var ai=.7,Fs=1/ai,Qn="\\s*([+-]?\\d+)\\s*",ui="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",we="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",QI=/^#([0-9a-f]{3,8})$/,XI=new RegExp(`^rgb\\(${Qn},${Qn},${Qn}\\)$`),JI=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),YI=new RegExp(`^rgba\\(${Qn},${Qn},${Qn},${ui}\\)$`),ZI=new RegExp(`^rgba\\(${we},${we},${we},${ui}\\)$`),t1=new RegExp(`^hsl\\(${ui},${we},${we}\\)$`),e1=new RegExp(`^hsla\\(${ui},${we},${we},${ui}\\)$`),Xh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sl(Ai,li,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Jh,formatHex:Jh,formatHex8:n1,formatHsl:r1,formatRgb:Yh,toString:Yh});function Jh(){return this.rgb().formatHex()}function n1(){return this.rgb().formatHex8()}function r1(){return Rm(this).formatHsl()}function Yh(){return this.rgb().formatRgb()}function li(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=QI.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Zh(t):n===3?new Gt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qi(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qi(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=XI.exec(e))?new Gt(t[1],t[2],t[3],1):(t=JI.exec(e))?new Gt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=YI.exec(e))?Qi(t[1],t[2],t[3],t[4]):(t=ZI.exec(e))?Qi(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=t1.exec(e))?nf(t[1],t[2]/100,t[3]/100,1):(t=e1.exec(e))?nf(t[1],t[2]/100,t[3]/100,t[4]):Xh.hasOwnProperty(e)?Zh(Xh[e]):e==="transparent"?new Gt(NaN,NaN,NaN,0):null}function Zh(e){return new Gt(e>>16&255,e>>8&255,e&255,1)}function Qi(e,t,n,r){return r<=0&&(e=t=n=NaN),new Gt(e,t,n,r)}function i1(e){return e instanceof Ai||(e=li(e)),e?(e=e.rgb(),new Gt(e.r,e.g,e.b,e.opacity)):new Gt}function $a(e,t,n,r){return arguments.length===1?i1(e):new Gt(e,t,n,r??1)}function Gt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}sl(Gt,$a,bm(Ai,{brighter(e){return e=e==null?Fs:Math.pow(Fs,e),new Gt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ai:Math.pow(ai,e),new Gt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Gt(Rn(this.r),Rn(this.g),Rn(this.b),Ls(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tf,formatHex:tf,formatHex8:s1,formatRgb:ef,toString:ef}));function tf(){return`#${Tn(this.r)}${Tn(this.g)}${Tn(this.b)}`}function s1(){return`#${Tn(this.r)}${Tn(this.g)}${Tn(this.b)}${Tn((isNaN(this.opacity)?1:this.opacity)*255)}`}function ef(){const e=Ls(this.opacity);return`${e===1?"rgb(":"rgba("}${Rn(this.r)}, ${Rn(this.g)}, ${Rn(this.b)}${e===1?")":`, ${e})`}`}function Ls(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Rn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Tn(e){return e=Rn(e),(e<16?"0":"")+e.toString(16)}function nf(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new se(e,t,n,r)}function Rm(e){if(e instanceof se)return new se(e.h,e.s,e.l,e.opacity);if(e instanceof Ai||(e=li(e)),!e)return new se;if(e instanceof se)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,u=s-i,l=(s+i)/2;return u?(t===s?a=(n-r)/u+(n<r)*6:n===s?a=(r-t)/u+2:a=(t-n)/u+4,u/=l<.5?s+i:2-s-i,a*=60):u=l>0&&l<1?0:a,new se(a,u,l,e.opacity)}function o1(e,t,n,r){return arguments.length===1?Rm(e):new se(e,t,n,r??1)}function se(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}sl(se,o1,bm(Ai,{brighter(e){return e=e==null?Fs:Math.pow(Fs,e),new se(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ai:Math.pow(ai,e),new se(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Gt(sa(e>=240?e-240:e+120,i,r),sa(e,i,r),sa(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new se(rf(this.h),Xi(this.s),Xi(this.l),Ls(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ls(this.opacity);return`${e===1?"hsl(":"hsla("}${rf(this.h)}, ${Xi(this.s)*100}%, ${Xi(this.l)*100}%${e===1?")":`, ${e})`}`}}));function rf(e){return e=(e||0)%360,e<0?e+360:e}function Xi(e){return Math.max(0,Math.min(1,e||0))}function sa(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Sm=e=>()=>e;function a1(e,t){return function(n){return e+n*t}}function u1(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function l1(e){return(e=+e)==1?Cm:function(t,n){return n-t?u1(t,n,e):Sm(isNaN(t)?n:t)}}function Cm(e,t){var n=t-e;return n?a1(e,n):Sm(isNaN(e)?t:e)}const sf=function e(t){var n=l1(t);function r(i,s){var a=n((i=$a(i)).r,(s=$a(s)).r),u=n(i.g,s.g),l=n(i.b,s.b),c=Cm(i.opacity,s.opacity);return function(f){return i.r=a(f),i.g=u(f),i.b=l(f),i.opacity=c(f),i+""}}return r.gamma=e,r}(1);function Ke(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ja=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oa=new RegExp(ja.source,"g");function c1(e){return function(){return e}}function h1(e){return function(t){return e(t)+""}}function f1(e,t){var n=ja.lastIndex=oa.lastIndex=0,r,i,s,a=-1,u=[],l=[];for(e=e+"",t=t+"";(r=ja.exec(e))&&(i=oa.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),u[a]?u[a]+=s:u[++a]=s),(r=r[0])===(i=i[0])?u[a]?u[a]+=i:u[++a]=i:(u[++a]=null,l.push({i:a,x:Ke(r,i)})),n=oa.lastIndex;return n<t.length&&(s=t.slice(n),u[a]?u[a]+=s:u[++a]=s),u.length<2?l[0]?h1(l[0].x):c1(t):(t=l.length,function(c){for(var f=0,p;f<t;++f)u[(p=l[f]).i]=p.x(c);return u.join("")})}var of=180/Math.PI,za={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xm(e,t,n,r,i,s){var a,u,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,l/=u),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*of,skewX:Math.atan(l)*of,scaleX:a,scaleY:u}}var Ji;function d1(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?za:xm(t.a,t.b,t.c,t.d,t.e,t.f)}function p1(e){return e==null||(Ji||(Ji=document.createElementNS("http://www.w3.org/2000/svg","g")),Ji.setAttribute("transform",e),!(e=Ji.transform.baseVal.consolidate()))?za:(e=e.matrix,xm(e.a,e.b,e.c,e.d,e.e,e.f))}function Pm(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,f,p,m,_,v){if(c!==p||f!==m){var A=_.push("translate(",null,t,null,n);v.push({i:A-4,x:Ke(c,p)},{i:A-2,x:Ke(f,m)})}else(p||m)&&_.push("translate("+p+t+m+n)}function a(c,f,p,m){c!==f?(c-f>180?f+=360:f-c>180&&(c+=360),m.push({i:p.push(i(p)+"rotate(",null,r)-2,x:Ke(c,f)})):f&&p.push(i(p)+"rotate("+f+r)}function u(c,f,p,m){c!==f?m.push({i:p.push(i(p)+"skewX(",null,r)-2,x:Ke(c,f)}):f&&p.push(i(p)+"skewX("+f+r)}function l(c,f,p,m,_,v){if(c!==p||f!==m){var A=_.push(i(_)+"scale(",null,",",null,")");v.push({i:A-4,x:Ke(c,p)},{i:A-2,x:Ke(f,m)})}else(p!==1||m!==1)&&_.push(i(_)+"scale("+p+","+m+")")}return function(c,f){var p=[],m=[];return c=e(c),f=e(f),s(c.translateX,c.translateY,f.translateX,f.translateY,p,m),a(c.rotate,f.rotate,p,m),u(c.skewX,f.skewX,p,m),l(c.scaleX,c.scaleY,f.scaleX,f.scaleY,p,m),c=f=null,function(_){for(var v=-1,A=m.length,w;++v<A;)p[(w=m[v]).i]=w.x(_);return p.join("")}}}var m1=Pm(d1,"px, ","px)","deg)"),g1=Pm(p1,", ",")",")"),nr=0,Lr=0,Pr=0,Vm=1e3,Us,Ur,Bs=0,Pn=0,go=0,ci=typeof performance=="object"&&performance.now?performance:Date,Nm=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ol(){return Pn||(Nm(_1),Pn=ci.now()+go)}function _1(){Pn=0}function qs(){this._call=this._time=this._next=null}qs.prototype=al.prototype={constructor:qs,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ol():+n)+(t==null?0:+t),!this._next&&Ur!==this&&(Ur?Ur._next=this:Us=this,Ur=this),this._call=e,this._time=n,Ha()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ha())}};function al(e,t,n){var r=new qs;return r.restart(e,t,n),r}function y1(){ol(),++nr;for(var e=Us,t;e;)(t=Pn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--nr}function af(){Pn=(Bs=ci.now())+go,nr=Lr=0;try{y1()}finally{nr=0,w1(),Pn=0}}function v1(){var e=ci.now(),t=e-Bs;t>Vm&&(go-=t,Bs=e)}function w1(){for(var e,t=Us,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Us=n);Ur=e,Ha(r)}function Ha(e){if(!nr){Lr&&(Lr=clearTimeout(Lr));var t=e-Pn;t>24?(e<1/0&&(Lr=setTimeout(af,e-ci.now()-go)),Pr&&(Pr=clearInterval(Pr))):(Pr||(Bs=ci.now(),Pr=setInterval(v1,Vm)),nr=1,Nm(af))}}function uf(e,t,n){var r=new qs;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var E1=nl("start","end","cancel","interrupt"),T1=[],Dm=0,lf=1,Ga=2,ls=3,cf=4,Wa=5,cs=6;function _o(e,t,n,r,i,s){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;A1(e,n,{name:t,index:r,group:i,on:E1,tween:T1,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Dm})}function ul(e,t){var n=le(e,t);if(n.state>Dm)throw new Error("too late; already scheduled");return n}function Ie(e,t){var n=le(e,t);if(n.state>ls)throw new Error("too late; already running");return n}function le(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function A1(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=al(s,0,n.time);function s(c){n.state=lf,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var f,p,m,_;if(n.state!==lf)return l();for(f in r)if(_=r[f],_.name===n.name){if(_.state===ls)return uf(a);_.state===cf?(_.state=cs,_.timer.stop(),_.on.call("interrupt",e,e.__data__,_.index,_.group),delete r[f]):+f<t&&(_.state=cs,_.timer.stop(),_.on.call("cancel",e,e.__data__,_.index,_.group),delete r[f])}if(uf(function(){n.state===ls&&(n.state=cf,n.timer.restart(u,n.delay,n.time),u(c))}),n.state=Ga,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Ga){for(n.state=ls,i=new Array(m=n.tween.length),f=0,p=-1;f<m;++f)(_=n.tween[f].value.call(e,e.__data__,n.index,n.group))&&(i[++p]=_);i.length=p+1}}function u(c){for(var f=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Wa,1),p=-1,m=i.length;++p<m;)i[p].call(e,f);n.state===Wa&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=cs,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function I1(e,t){var n=e.__transition,r,i,s=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){s=!1;continue}i=r.state>Ga&&r.state<Wa,r.state=cs,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}s&&delete e.__transition}}function b1(e){return this.each(function(){I1(this,e)})}function R1(e,t){var n,r;return function(){var i=Ie(this,e),s=i.tween;if(s!==n){r=n=s;for(var a=0,u=r.length;a<u;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function S1(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Ie(this,e),a=s.tween;if(a!==r){i=(r=a).slice();for(var u={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=u;break}l===c&&i.push(u)}s.tween=i}}function C1(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=le(this.node(),n).tween,i=0,s=r.length,a;i<s;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?R1:S1)(n,e,t))}function ll(e,t,n){var r=e._id;return e.each(function(){var i=Ie(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return le(i,r).value[t]}}function km(e,t){var n;return(typeof t=="number"?Ke:t instanceof li?sf:(n=li(t))?(t=n,sf):f1)(e,t)}function x1(e){return function(){this.removeAttribute(e)}}function P1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function V1(e,t,n){var r,i=n+"",s;return function(){var a=this.getAttribute(e);return a===i?null:a===r?s:s=t(r=a,n)}}function N1(e,t,n){var r,i=n+"",s;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?s:s=t(r=a,n)}}function D1(e,t,n){var r,i,s;return function(){var a,u=n(this),l;return u==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=u+"",a===l?null:a===r&&l===i?s:(i=l,s=t(r=a,u)))}}function k1(e,t,n){var r,i,s;return function(){var a,u=n(this),l;return u==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=u+"",a===l?null:a===r&&l===i?s:(i=l,s=t(r=a,u)))}}function O1(e,t){var n=mo(e),r=n==="transform"?g1:km;return this.attrTween(e,typeof t=="function"?(n.local?k1:D1)(n,r,ll(this,"attr."+e,t)):t==null?(n.local?P1:x1)(n):(n.local?N1:V1)(n,r,t))}function M1(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function F1(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function L1(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&F1(e,s)),n}return i._value=t,i}function U1(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&M1(e,s)),n}return i._value=t,i}function B1(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=mo(e);return this.tween(n,(r.local?L1:U1)(r,t))}function q1(e,t){return function(){ul(this,e).delay=+t.apply(this,arguments)}}function $1(e,t){return t=+t,function(){ul(this,e).delay=t}}function j1(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?q1:$1)(t,e)):le(this.node(),t).delay}function z1(e,t){return function(){Ie(this,e).duration=+t.apply(this,arguments)}}function H1(e,t){return t=+t,function(){Ie(this,e).duration=t}}function G1(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?z1:H1)(t,e)):le(this.node(),t).duration}function W1(e,t){if(typeof t!="function")throw new Error;return function(){Ie(this,e).ease=t}}function K1(e){var t=this._id;return arguments.length?this.each(W1(t,e)):le(this.node(),t).ease}function Q1(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ie(this,e).ease=n}}function X1(e){if(typeof e!="function")throw new Error;return this.each(Q1(this._id,e))}function J1(e){typeof e!="function"&&(e=gm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,u=r[i]=[],l,c=0;c<a;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&u.push(l);return new Be(r,this._parents,this._name,this._id)}function Y1(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),a=new Array(r),u=0;u<s;++u)for(var l=t[u],c=n[u],f=l.length,p=a[u]=new Array(f),m,_=0;_<f;++_)(m=l[_]||c[_])&&(p[_]=m);for(;u<r;++u)a[u]=t[u];return new Be(a,this._parents,this._name,this._id)}function Z1(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function tb(e,t,n){var r,i,s=Z1(t)?ul:Ie;return function(){var a=s(this,e),u=a.on;u!==r&&(i=(r=u).copy()).on(t,n),a.on=i}}function eb(e,t){var n=this._id;return arguments.length<2?le(this.node(),n).on.on(e):this.each(tb(n,e,t))}function nb(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function rb(){return this.on("end.remove",nb(this._id))}function ib(e){var t=this._name,n=this._id;typeof e!="function"&&(e=rl(e));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var u=r[a],l=u.length,c=s[a]=new Array(l),f,p,m=0;m<l;++m)(f=u[m])&&(p=e.call(f,f.__data__,m,u))&&("__data__"in f&&(p.__data__=f.__data__),c[m]=p,_o(c[m],t,n,m,c,le(f,n)));return new Be(s,this._parents,t,n)}function sb(e){var t=this._name,n=this._id;typeof e!="function"&&(e=mm(e));for(var r=this._groups,i=r.length,s=[],a=[],u=0;u<i;++u)for(var l=r[u],c=l.length,f,p=0;p<c;++p)if(f=l[p]){for(var m=e.call(f,f.__data__,p,l),_,v=le(f,n),A=0,w=m.length;A<w;++A)(_=m[A])&&_o(_,t,n,A,m,v);s.push(m),a.push(f)}return new Be(s,a,t,n)}var ob=Ti.prototype.constructor;function ab(){return new ob(this._groups,this._parents)}function ub(e,t){var n,r,i;return function(){var s=er(this,e),a=(this.style.removeProperty(e),er(this,e));return s===a?null:s===n&&a===r?i:i=t(n=s,r=a)}}function Om(e){return function(){this.style.removeProperty(e)}}function lb(e,t,n){var r,i=n+"",s;return function(){var a=er(this,e);return a===i?null:a===r?s:s=t(r=a,n)}}function cb(e,t,n){var r,i,s;return function(){var a=er(this,e),u=n(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(e),er(this,e))),a===l?null:a===r&&l===i?s:(i=l,s=t(r=a,u))}}function hb(e,t){var n,r,i,s="style."+t,a="end."+s,u;return function(){var l=Ie(this,e),c=l.on,f=l.value[s]==null?u||(u=Om(t)):void 0;(c!==n||i!==f)&&(r=(n=c).copy()).on(a,i=f),l.on=r}}function fb(e,t,n){var r=(e+="")=="transform"?m1:km;return t==null?this.styleTween(e,ub(e,r)).on("end.style."+e,Om(e)):typeof t=="function"?this.styleTween(e,cb(e,r,ll(this,"style."+e,t))).each(hb(this._id,e)):this.styleTween(e,lb(e,r,t),n).on("end.style."+e,null)}function db(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function pb(e,t,n){var r,i;function s(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&db(e,a,n)),r}return s._value=t,s}function mb(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,pb(e,t,n??""))}function gb(e){return function(){this.textContent=e}}function _b(e){return function(){var t=e(this);this.textContent=t??""}}function yb(e){return this.tween("text",typeof e=="function"?_b(ll(this,"text",e)):gb(e==null?"":e+""))}function vb(e){return function(t){this.textContent=e.call(this,t)}}function wb(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&vb(i)),t}return r._value=e,r}function Eb(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,wb(e))}function Tb(){for(var e=this._name,t=this._id,n=Mm(),r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],u=a.length,l,c=0;c<u;++c)if(l=a[c]){var f=le(l,t);_o(l,e,n,c,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Be(r,this._parents,e,n)}function Ab(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,a){var u={value:a},l={value:function(){--i===0&&s()}};n.each(function(){var c=Ie(this,r),f=c.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(l)),c.on=t}),i===0&&s()})}var Ib=0;function Be(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Mm(){return++Ib}var xe=Ti.prototype;Be.prototype={constructor:Be,select:ib,selectAll:sb,selectChild:xe.selectChild,selectChildren:xe.selectChildren,filter:J1,merge:Y1,selection:ab,transition:Tb,call:xe.call,nodes:xe.nodes,node:xe.node,size:xe.size,empty:xe.empty,each:xe.each,on:eb,attr:O1,attrTween:B1,style:fb,styleTween:mb,text:yb,textTween:Eb,remove:rb,tween:C1,delay:j1,duration:G1,ease:K1,easeVarying:X1,end:Ab,[Symbol.iterator]:xe[Symbol.iterator]};function bb(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Rb={time:null,delay:0,duration:250,ease:bb};function Sb(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Cb(e){var t,n;e instanceof Be?(t=e._id,e=e._name):(t=Mm(),(n=Rb).time=ol(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],u=a.length,l,c=0;c<u;++c)(l=a[c])&&_o(l,e,t,c,a,n||Sb(l,t));return new Be(r,this._parents,e,t)}Ti.prototype.interrupt=b1;Ti.prototype.transition=Cb;function xb(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,a=n.length,u,l=0,c=0;for(s=0;s<a;++s)u=n[s],l+=u.x,c+=u.y;for(l=(l/a-e)*r,c=(c/a-t)*r,s=0;s<a;++s)u=n[s],u.x-=l,u.y-=c}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function Pb(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Fm(this.cover(t,n),t,n,e)}function Fm(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,a={data:r},u=e._x0,l=e._y0,c=e._x1,f=e._y1,p,m,_,v,A,w,x,N;if(!s)return e._root=a,e;for(;s.length;)if((A=t>=(p=(u+c)/2))?u=p:c=p,(w=n>=(m=(l+f)/2))?l=m:f=m,i=s,!(s=s[x=w<<1|A]))return i[x]=a,e;if(_=+e._x.call(null,s.data),v=+e._y.call(null,s.data),t===_&&n===v)return a.next=s,i?i[x]=a:e._root=a,e;do i=i?i[x]=new Array(4):e._root=new Array(4),(A=t>=(p=(u+c)/2))?u=p:c=p,(w=n>=(m=(l+f)/2))?l=m:f=m;while((x=w<<1|A)===(N=(v>=m)<<1|_>=p));return i[N]=s,i[x]=a,e}function Vb(e){var t,n,r=e.length,i,s,a=new Array(r),u=new Array(r),l=1/0,c=1/0,f=-1/0,p=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(a[n]=i,u[n]=s,i<l&&(l=i),i>f&&(f=i),s<c&&(c=s),s>p&&(p=s));if(l>f||c>p)return this;for(this.cover(l,c).cover(f,p),n=0;n<r;++n)Fm(this,a[n],u[n],e[n]);return this}function Nb(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var a=i-n||1,u=this._root,l,c;n>e||e>=i||r>t||t>=s;)switch(c=(t<r)<<1|e<n,l=new Array(4),l[c]=u,u=l,a*=2,c){case 0:i=n+a,s=r+a;break;case 1:n=i-a,s=r+a;break;case 2:i=n+a,r=s-a;break;case 3:n=i-a,r=s-a;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function Db(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function kb(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Ut(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Ob(e,t,n){var r,i=this._x0,s=this._y0,a,u,l,c,f=this._x1,p=this._y1,m=[],_=this._root,v,A;for(_&&m.push(new Ut(_,i,s,f,p)),n==null?n=1/0:(i=e-n,s=t-n,f=e+n,p=t+n,n*=n);v=m.pop();)if(!(!(_=v.node)||(a=v.x0)>f||(u=v.y0)>p||(l=v.x1)<i||(c=v.y1)<s))if(_.length){var w=(a+l)/2,x=(u+c)/2;m.push(new Ut(_[3],w,x,l,c),new Ut(_[2],a,x,w,c),new Ut(_[1],w,u,l,x),new Ut(_[0],a,u,w,x)),(A=(t>=x)<<1|e>=w)&&(v=m[m.length-1],m[m.length-1]=m[m.length-1-A],m[m.length-1-A]=v)}else{var N=e-+this._x.call(null,_.data),M=t-+this._y.call(null,_.data),k=N*N+M*M;if(k<n){var U=Math.sqrt(n=k);i=e-U,s=t-U,f=e+U,p=t+U,r=_.data}}return r}function Mb(e){if(isNaN(f=+this._x.call(null,e))||isNaN(p=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,a=this._x0,u=this._y0,l=this._x1,c=this._y1,f,p,m,_,v,A,w,x;if(!n)return this;if(n.length)for(;;){if((v=f>=(m=(a+l)/2))?a=m:l=m,(A=p>=(_=(u+c)/2))?u=_:c=_,t=n,!(n=n[w=A<<1|v]))return this;if(!n.length)break;(t[w+1&3]||t[w+2&3]||t[w+3&3])&&(r=t,x=w)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[w]=s:delete t[w],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[x]=n:this._root=n),this):(this._root=s,this)}function Fb(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Lb(){return this._root}function Ub(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Bb(e){var t=[],n,r=this._root,i,s,a,u,l;for(r&&t.push(new Ut(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,a=n.y0,u=n.x1,l=n.y1)&&r.length){var c=(s+u)/2,f=(a+l)/2;(i=r[3])&&t.push(new Ut(i,c,f,u,l)),(i=r[2])&&t.push(new Ut(i,s,f,c,l)),(i=r[1])&&t.push(new Ut(i,c,a,u,f)),(i=r[0])&&t.push(new Ut(i,s,a,c,f))}return this}function qb(e){var t=[],n=[],r;for(this._root&&t.push(new Ut(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,a=r.x0,u=r.y0,l=r.x1,c=r.y1,f=(a+l)/2,p=(u+c)/2;(s=i[0])&&t.push(new Ut(s,a,u,f,p)),(s=i[1])&&t.push(new Ut(s,f,u,l,p)),(s=i[2])&&t.push(new Ut(s,a,p,f,c)),(s=i[3])&&t.push(new Ut(s,f,p,l,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function $b(e){return e[0]}function jb(e){return arguments.length?(this._x=e,this):this._x}function zb(e){return e[1]}function Hb(e){return arguments.length?(this._y=e,this):this._y}function Lm(e,t,n){var r=new cl(t??$b,n??zb,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function cl(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function hf(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Bt=Lm.prototype=cl.prototype;Bt.copy=function(){var e=new cl(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=hf(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=hf(r));return e};Bt.add=Pb;Bt.addAll=Vb;Bt.cover=Nb;Bt.data=Db;Bt.extent=kb;Bt.find=Ob;Bt.remove=Mb;Bt.removeAll=Fb;Bt.root=Lb;Bt.size=Ub;Bt.visit=Bb;Bt.visitAfter=qb;Bt.x=jb;Bt.y=Hb;function Ve(e){return function(){return e}}function Hn(e){return(e()-.5)*1e-6}function Gb(e){return e.index}function ff(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Wb(e){var t=Gb,n=p,r,i=Ve(30),s,a,u,l,c,f=1;e==null&&(e=[]);function p(w){return 1/Math.min(u[w.source.index],u[w.target.index])}function m(w){for(var x=0,N=e.length;x<f;++x)for(var M=0,k,U,H,I,y,E,b;M<N;++M)k=e[M],U=k.source,H=k.target,I=H.x+H.vx-U.x-U.vx||Hn(c),y=H.y+H.vy-U.y-U.vy||Hn(c),E=Math.sqrt(I*I+y*y),E=(E-s[M])/E*w*r[M],I*=E,y*=E,H.vx-=I*(b=l[M]),H.vy-=y*b,U.vx+=I*(b=1-b),U.vy+=y*b}function _(){if(a){var w,x=a.length,N=e.length,M=new Map(a.map((U,H)=>[t(U,H,a),U])),k;for(w=0,u=new Array(x);w<N;++w)k=e[w],k.index=w,typeof k.source!="object"&&(k.source=ff(M,k.source)),typeof k.target!="object"&&(k.target=ff(M,k.target)),u[k.source.index]=(u[k.source.index]||0)+1,u[k.target.index]=(u[k.target.index]||0)+1;for(w=0,l=new Array(N);w<N;++w)k=e[w],l[w]=u[k.source.index]/(u[k.source.index]+u[k.target.index]);r=new Array(N),v(),s=new Array(N),A()}}function v(){if(a)for(var w=0,x=e.length;w<x;++w)r[w]=+n(e[w],w,e)}function A(){if(a)for(var w=0,x=e.length;w<x;++w)s[w]=+i(e[w],w,e)}return m.initialize=function(w,x){a=w,c=x,_()},m.links=function(w){return arguments.length?(e=w,_(),m):e},m.id=function(w){return arguments.length?(t=w,m):t},m.iterations=function(w){return arguments.length?(f=+w,m):f},m.strength=function(w){return arguments.length?(n=typeof w=="function"?w:Ve(+w),v(),m):n},m.distance=function(w){return arguments.length?(i=typeof w=="function"?w:Ve(+w),A(),m):i},m}const Kb=1664525,Qb=1013904223,df=4294967296;function Xb(){let e=1;return()=>(e=(Kb*e+Qb)%df)/df}function Jb(e){return e.x}function Yb(e){return e.y}var Zb=10,tR=Math.PI*(3-Math.sqrt(5));function eR(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,a=.6,u=new Map,l=al(p),c=nl("tick","end"),f=Xb();e==null&&(e=[]);function p(){m(),c.call("tick",t),n<r&&(l.stop(),c.call("end",t))}function m(A){var w,x=e.length,N;A===void 0&&(A=1);for(var M=0;M<A;++M)for(n+=(s-n)*i,u.forEach(function(k){k(n)}),w=0;w<x;++w)N=e[w],N.fx==null?N.x+=N.vx*=a:(N.x=N.fx,N.vx=0),N.fy==null?N.y+=N.vy*=a:(N.y=N.fy,N.vy=0);return t}function _(){for(var A=0,w=e.length,x;A<w;++A){if(x=e[A],x.index=A,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),isNaN(x.x)||isNaN(x.y)){var N=Zb*Math.sqrt(.5+A),M=A*tR;x.x=N*Math.cos(M),x.y=N*Math.sin(M)}(isNaN(x.vx)||isNaN(x.vy))&&(x.vx=x.vy=0)}}function v(A){return A.initialize&&A.initialize(e,f),A}return _(),t={tick:m,restart:function(){return l.restart(p),t},stop:function(){return l.stop(),t},nodes:function(A){return arguments.length?(e=A,_(),u.forEach(v),t):e},alpha:function(A){return arguments.length?(n=+A,t):n},alphaMin:function(A){return arguments.length?(r=+A,t):r},alphaDecay:function(A){return arguments.length?(i=+A,t):+i},alphaTarget:function(A){return arguments.length?(s=+A,t):s},velocityDecay:function(A){return arguments.length?(a=1-A,t):1-a},randomSource:function(A){return arguments.length?(f=A,u.forEach(v),t):f},force:function(A,w){return arguments.length>1?(w==null?u.delete(A):u.set(A,v(w)),t):u.get(A)},find:function(A,w,x){var N=0,M=e.length,k,U,H,I,y;for(x==null?x=1/0:x*=x,N=0;N<M;++N)I=e[N],k=A-I.x,U=w-I.y,H=k*k+U*U,H<x&&(y=I,x=H);return y},on:function(A,w){return arguments.length>1?(c.on(A,w),t):c.on(A)}}}function nR(){var e,t,n,r,i=Ve(-30),s,a=1,u=1/0,l=.81;function c(_){var v,A=e.length,w=Lm(e,Jb,Yb).visitAfter(p);for(r=_,v=0;v<A;++v)t=e[v],w.visit(m)}function f(){if(e){var _,v=e.length,A;for(s=new Array(v),_=0;_<v;++_)A=e[_],s[A.index]=+i(A,_,e)}}function p(_){var v=0,A,w,x=0,N,M,k;if(_.length){for(N=M=k=0;k<4;++k)(A=_[k])&&(w=Math.abs(A.value))&&(v+=A.value,x+=w,N+=w*A.x,M+=w*A.y);_.x=N/x,_.y=M/x}else{A=_,A.x=A.data.x,A.y=A.data.y;do v+=s[A.data.index];while(A=A.next)}_.value=v}function m(_,v,A,w){if(!_.value)return!0;var x=_.x-t.x,N=_.y-t.y,M=w-v,k=x*x+N*N;if(M*M/l<k)return k<u&&(x===0&&(x=Hn(n),k+=x*x),N===0&&(N=Hn(n),k+=N*N),k<a&&(k=Math.sqrt(a*k)),t.vx+=x*_.value*r/k,t.vy+=N*_.value*r/k),!0;if(_.length||k>=u)return;(_.data!==t||_.next)&&(x===0&&(x=Hn(n),k+=x*x),N===0&&(N=Hn(n),k+=N*N),k<a&&(k=Math.sqrt(a*k)));do _.data!==t&&(M=s[_.data.index]*r/k,t.vx+=x*M,t.vy+=N*M);while(_=_.next)}return c.initialize=function(_,v){e=_,n=v,f()},c.strength=function(_){return arguments.length?(i=typeof _=="function"?_:Ve(+_),f(),c):i},c.distanceMin=function(_){return arguments.length?(a=_*_,c):Math.sqrt(a)},c.distanceMax=function(_){return arguments.length?(u=_*_,c):Math.sqrt(u)},c.theta=function(_){return arguments.length?(l=_*_,c):Math.sqrt(l)},c}function rR(e,t,n){var r,i=Ve(.1),s,a;typeof e!="function"&&(e=Ve(+e)),t==null&&(t=0),n==null&&(n=0);function u(c){for(var f=0,p=r.length;f<p;++f){var m=r[f],_=m.x-t||1e-6,v=m.y-n||1e-6,A=Math.sqrt(_*_+v*v),w=(a[f]-A)*s[f]*c/A;m.vx+=_*w,m.vy+=v*w}}function l(){if(r){var c,f=r.length;for(s=new Array(f),a=new Array(f),c=0;c<f;++c)a[c]=+e(r[c],c,r),s[c]=isNaN(a[c])?0:+i(r[c],c,r)}}return u.initialize=function(c){r=c,l()},u.strength=function(c){return arguments.length?(i=typeof c=="function"?c:Ve(+c),l(),u):i},u.radius=function(c){return arguments.length?(e=typeof c=="function"?c:Ve(+c),l(),u):e},u.x=function(c){return arguments.length?(t=+c,u):t},u.y=function(c){return arguments.length?(n=+c,u):n},u}function Br(e,t,n){this.k=e,this.x=t,this.y=n}Br.prototype={constructor:Br,scale:function(e){return e===1?this:new Br(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Br(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Br.prototype;var iR=or('<div class="loading-indicator svelte-1ov5n50">Loading...</div>'),sR=or('<div class="image-with-title svelte-1ov5n50"><a target="_blank" rel="noopener noreferrer"><img class="svelte-1ov5n50"/></a> <div class="image-title-box"><!></div></div>'),oR=or('<div class="image-container svelte-1ov5n50"></div>'),aR=or('<div class="no-images-placeholder svelte-1ov5n50"><p>Your search results will appear here</p></div>'),uR=Xf('<line stroke="#fff" stroke-opacity="0.6" stroke-width="2" class="svelte-1ov5n50"></line>'),lR=Xf('<text fill="steelblue" text-anchor="middle" alignment-baseline="middle" filter="url(#dropshadow)" class="svelte-1ov5n50"> </text>'),cR=or('<li class="svelte-1ov5n50"> <span class="count svelte-1ov5n50"> </span></li>'),hR=or(`<main class="svelte-1ov5n50"><!> <div class="header svelte-1ov5n50"><img src="src/main-image.jpeg" alt="Great Wave" class="svelte-1ov5n50"/> <div><div class="title svelte-1ov5n50">GREAT WAVE <span style="color: #F0BF91;">REMIX</span></div> <p class="subtitle svelte-1ov5n50">Discover Hokusai's "Great Wave off Kanagawa" in diverse contexts
        worldwide. Search for any term to see how this iconic artwork appears
        across various themes and locations.</p></div></div> <h1 class="svelte-1ov5n50">Hokusai's legendary <span class="italic svelte-1ov5n50">Great Wave off Kanagawa</span> can
    be <input type="text" placeholder="ANYTHING" class="svelte-1ov5n50"/> <div class="search-container svelte-1ov5n50"><div class="button-wrapper svelte-1ov5n50"><button class="svelte-1ov5n50">Search</button></div> <div class="call-to-action svelte-1ov5n50">No images yet  try a search!</div></div></h1> <div class="main-grid svelte-1ov5n50"><div class="left-column svelte-1ov5n50"><!></div> <div class="right-column svelte-1ov5n50"><div class="word-cloud-container svelte-1ov5n50"><h2 class="svelte-1ov5n50">Trending</h2> <svg width="100%" height="600" viewBox="0 0 400 600" class="svelte-1ov5n50"><defs><filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.3"></feDropShadow></filter></defs><!><!></svg> <div class="trending-panel svelte-1ov5n50"><ul class="svelte-1ov5n50"></ul></div></div></div></div> <h2 class="svelte-1ov5n50">Google Ngram Viewer shows a steady rise in mentions of "Great Wave off
    Kanagawa"</h2> <div class="bottom-panel svelte-1ov5n50"><div class="chart-container svelte-1ov5n50"><iframe name="ngram_chart" src="https://books.google.com/ngrams/interactive_chart?content=Great+Wave+off+Kanagawa&amp;year_start=1800&amp;year_end=2022&amp;corpus=en&amp;smoothing=3" width="900" height="400" marginwidth="50" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" class="svelte-1ov5n50"></iframe></div></div></main>`);function fR(e,t){Af(t,!1);let n=yn([]),r=yn(""),i=yn([]),s=yn([]),a=yn([]),u=yn(!1);C_(async()=>{dt(u,!0);try{dt(i,await Dh()),dt(a,await kh(5)),c(),f()}finally{dt(u,!1)}});async function l(){if(z(r)){dt(u,!0);try{const K=await gt.get(`https://great-wave-api-1muq.onrender.com/api/images?q=${z(r)}`);dt(n,K.data),console.log("Fetched images:",z(n)),await ME(z(r)),dt(i,await Dh()),dt(a,await kh(5)),c(),f(),dt(r,"")}catch(K){console.error("Error fetching images",K)}finally{dt(u,!1)}}}function c(){dt(s,[]);for(let K=1;K<z(i).length;K++)z(s).push({source:z(i)[K-1].id,target:z(i)[K].id})}function f(){const K=Math.max(...z(i).map($=>$.count));eR(z(i)).force("link",Wb(z(s)).id($=>$.id).distance(25)).force("charge",nR().strength(-100)).force("center",xb(200,300)).force("gravity",rR($=>150*(1-$.count/K),200,300).strength(.5)).force("boundary",()=>{z(i).forEach($=>{$.x=Math.max(20,Math.min(380,$.x||0)),$.y=Math.max(20,Math.min(580,$.y||0))})}).on("tick",()=>{dt(i,[...z(i)])})}function p(K){return z(i).find($=>$.id===K)}function m(K){const $=p(K.source),st=p(K.target);return{x1:($==null?void 0:$.x)||0,y1:($==null?void 0:$.y)||0,x2:(st==null?void 0:st.x)||0,y2:(st==null?void 0:st.y)||0}}S_();var _=hR(),v=Vt(_);{var A=K=>{var $=iR();Ce(K,$)};Ho(v,K=>{z(u)&&K(A)})}var w=ie(v,4),x=ie(Vt(w),3),N=ie(x,2),M=Vt(N),k=Vt(M),U=ie(w,2),H=Vt(U),I=Vt(H);{var y=K=>{var $=oR();ji($,5,()=>z(n),$i,(st,$t)=>{var $e=sR(),Et=Vt($e),at=Vt(Et),mr=ie(Et,2),be=Vt(mr);E_(be,()=>`<textarea readonly rows='2'>${z($t).title}</textarea>`),Nr(()=>{he(Et,"href",z($t).link),he(at,"src",z($t).link),he(at,"alt",z($t).title)}),Ce(st,$e)}),Ce(K,$)},E=K=>{var $=aR();Ce(K,$)};Ho(I,K=>{z(n).length>0?K(y):K(E,!1)})}var b=ie(H,2),R=Vt(b),C=ie(Vt(R),2),T=ie(Vt(C));ji(T,1,()=>z(s),$i,(K,$)=>{var st=d_(),$t=jg(st);{var $e=Et=>{var at=uR();Nr((mr,be,yo,On)=>{he(at,"x1",mr),he(at,"y1",be),he(at,"x2",yo),he(at,"y2",On)},[()=>m(z($)).x1,()=>m(z($)).y1,()=>m(z($)).x2,()=>m(z($)).y2],bf),Ce(Et,at)};Ho($t,Et=>{p(z($).source)&&p(z($).target)&&Et($e)})}Ce(K,st)});var qt=ie(T);ji(qt,1,()=>z(i),$i,(K,$)=>{var st=lR(),$t=Vt(st);Nr(()=>{he(st,"x",z($).x),he(st,"y",z($).y),he(st,"font-size",`${10*z($).count}px`),zo($t,z($).id)}),yc("mouseover",st,()=>console.log(z($).id)),Ce(K,st)});var ce=ie(C,2),kn=Vt(ce);ji(kn,5,()=>z(a),$i,(K,$)=>{var st=cR(),$t=Vt(st),$e=ie($t),Et=Vt($e);Nr(()=>{zo($t,`${z($).id??""} `),zo(Et,`(${z($).count??""})`)}),Ce(K,st)}),R_(x,()=>z(r),K=>dt(r,K)),yc("click",k,l),Ce(e,_),If()}p_(fR,{target:document.getElementById("app")});
