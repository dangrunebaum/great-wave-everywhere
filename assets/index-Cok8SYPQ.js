var oy=Object.defineProperty;var ay=(e,t,n)=>t in e?oy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ga=(e,t,n)=>ay(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Ih=!1;var gl=Array.isArray,uy=Array.prototype.indexOf,ml=Array.from,ly=Object.defineProperty,Li=Object.getOwnPropertyDescriptor,cy=Object.getOwnPropertyDescriptors,hy=Object.prototype,fy=Array.prototype,Kd=Object.getPrototypeOf,Rh=Object.isExtensible;function dy(e){for(var t=0;t<e.length;t++)e[t]()}const Pe=2,Qd=4,Zo=8,_l=16,In=32,Xr=64,yl=128,Ae=256,fo=512,Ve=1024,_n=2048,mr=4096,gn=8192,vl=16384,Xd=32768,wl=65536,Sh=1<<17,py=1<<18,Jd=1<<19,pu=1<<20,Wa=Symbol("$state"),gy=Symbol(""),Yd=new class extends Error{constructor(){super(...arguments);Ga(this,"name","StaleReactionError");Ga(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Zd(e){return e===this.v}function my(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function tp(e){return!my(e,this.v)}function _y(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function yy(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function vy(e){throw new Error("https://svelte.dev/e/effect_orphan")}function wy(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ey(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ty(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ay(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Iy=!1;const El=1,Tl=2,ep=4,Ry=8,Sy=16,by=1,xy=2,le=Symbol(),Cy="http://www.w3.org/1999/xhtml";function np(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let de=null;function bh(e){de=e}function rp(e,t=!1,n){var r=de={p:de,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};dp(()=>{r.d=!0})}function ip(e){const t=de;if(t!==null){const o=t.e;if(o!==null){var n=gt,r=lt;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];Fn(s.effect),nn(s.reaction),pp(s.fn)}}finally{Fn(n),nn(r)}}de=t.p,t.m=!0}return{}}function sp(){return!0}function Ge(e){if(typeof e!="object"||e===null||Wa in e)return e;const t=Kd(e);if(t!==hy&&t!==fy)return e;var n=new Map,r=gl(e),i=Ut(0),s=lt,o=u=>{var l=lt;nn(s);var c=u();return nn(l),c};return r&&n.set("length",Ut(e.length)),new Proxy(e,{defineProperty(u,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Ey();var h=n.get(l);return h===void 0?h=o(()=>{var d=Ut(c.value);return n.set(l,d),d}):tt(h,c.value,!0),!0},deleteProperty(u,l){var c=n.get(l);if(c===void 0){if(l in u){const p=o(()=>Ut(le));n.set(l,p),Ka(i)}}else{if(r&&typeof l=="string"){var h=n.get("length"),d=Number(l);Number.isInteger(d)&&d<h.v&&tt(h,d)}tt(c,le),Ka(i)}return!0},get(u,l,c){var m;if(l===Wa)return e;var h=n.get(l),d=l in u;if(h===void 0&&(!d||(m=Li(u,l))!=null&&m.writable)&&(h=o(()=>{var _=Ge(d?u[l]:le),E=Ut(_);return E}),n.set(l,h)),h!==void 0){var p=$(h);return p===le?void 0:p}return Reflect.get(u,l,c)},getOwnPropertyDescriptor(u,l){var c=Reflect.getOwnPropertyDescriptor(u,l);if(c&&"value"in c){var h=n.get(l);h&&(c.value=$(h))}else if(c===void 0){var d=n.get(l),p=d==null?void 0:d.v;if(d!==void 0&&p!==le)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return c},has(u,l){var p;if(l===Wa)return!0;var c=n.get(l),h=c!==void 0&&c.v!==le||Reflect.has(u,l);if(c!==void 0||gt!==null&&(!h||(p=Li(u,l))!=null&&p.writable)){c===void 0&&(c=o(()=>{var m=h?Ge(u[l]):le,_=Ut(m);return _}),n.set(l,c));var d=$(c);if(d===le)return!1}return h},set(u,l,c,h){var N;var d=n.get(l),p=l in u;if(r&&l==="length")for(var m=c;m<d.v;m+=1){var _=n.get(m+"");_!==void 0?tt(_,le):m in u&&(_=o(()=>Ut(le)),n.set(m+"",_))}if(d===void 0)(!p||(N=Li(u,l))!=null&&N.writable)&&(d=o(()=>Ut(void 0)),tt(d,Ge(c)),n.set(l,d));else{p=d.v!==le;var E=o(()=>Ge(c));tt(d,E)}var v=Reflect.getOwnPropertyDescriptor(u,l);if(v!=null&&v.set&&v.set.call(h,c),!p){if(r&&typeof l=="string"){var C=n.get("length"),b=Number(l);Number.isInteger(b)&&b>=C.v&&tt(C,b+1)}Ka(i)}return!0},ownKeys(u){$(i);var l=Reflect.ownKeys(u).filter(d=>{var p=n.get(d);return p===void 0||p.v!==le});for(var[c,h]of n)h.v!==le&&!(c in u)&&l.push(c);return l},setPrototypeOf(){Ty()}})}function Ka(e,t=1){tt(e,e.v+t)}function Al(e){var t=Pe|_n,n=lt!==null&&(lt.f&Pe)!==0?lt:null;return gt===null||n!==null&&(n.f&Ae)!==0?t|=Ae:gt.f|=Jd,{ctx:de,deps:null,effects:null,equals:Zd,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??gt,ac:null}}function Fs(e){const t=Al(e);return Tp(t),t}function Py(e){const t=Al(e);return t.equals=tp,t}function op(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Ln(t[n])}}function Vy(e){for(var t=e.parent;t!==null;){if((t.f&Pe)===0)return t;t=t.parent}return null}function ap(e){var t,n=gt;Fn(Vy(e));try{op(e),t=Sp(e)}finally{Fn(n)}return t}function up(e){var t=ap(e);if(e.equals(t)||(e.v=t,e.wv=Ip()),!Yr){var n=(Vn||(e.f&Ae)!==0)&&e.deps!==null?mr:Ve;rn(e,n)}}const ji=new Map;function po(e,t){var n={f:0,v:e,reactions:null,equals:Zd,rv:0,wv:0};return n}function Ut(e,t){const n=po(e);return Tp(n),n}function Ny(e,t=!1,n=!0){const r=po(e);return t||(r.equals=tp),r}function tt(e,t,n=!1){lt!==null&&(!We||(lt.f&Sh)!==0)&&sp()&&(lt.f&(Pe|_l|Sh))!==0&&!(jt!=null&&jt[1].includes(e)&&jt[0]===lt)&&Ay();let r=n?Ge(t):t;return gu(e,r)}function gu(e,t){if(!e.equals(t)){var n=e.v;Yr?ji.set(e,t):ji.set(e,n),e.v=t,(e.f&Pe)!==0&&((e.f&_n)!==0&&ap(e),rn(e,(e.f&Ae)===0?Ve:mr)),e.wv=Ip(),lp(e,_n),gt!==null&&(gt.f&Ve)!==0&&(gt.f&(In|Xr))===0&&(Re===null?Hy([e]):Re.push(e))}return t}function lp(e,t){var n=e.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i],o=s.f;(o&_n)===0&&(rn(s,t),(o&(Ve|Ae))!==0&&((o&Pe)!==0?lp(s,mr):bl(s)))}}let Dy=!1;var xh,cp,hp,fp;function ky(){if(xh===void 0){xh=window,cp=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;hp=Li(t,"firstChild").get,fp=Li(t,"nextSibling").get,Rh(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Rh(n)&&(n.__t=void 0)}}function ta(e=""){return document.createTextNode(e)}function Br(e){return hp.call(e)}function ea(e){return fp.call(e)}function wt(e,t){return Br(e)}function Ei(e,t){{var n=Br(e);return n instanceof Comment&&n.data===""?ea(n):n}}function Ht(e,t=1,n=!1){let r=e;for(;t--;)r=ea(r);return r}function Oy(e){e.textContent=""}function My(e){gt===null&&lt===null&&vy(),lt!==null&&(lt.f&Ae)!==0&&gt===null&&yy(),Yr&&_y()}function Ly(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Jr(e,t,n,r=!0){var i=gt,s={ctx:de,deps:null,nodes_start:null,nodes_end:null,f:e|_n,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Sl(s),s.f|=Xd}catch(l){throw Ln(s),l}else t!==null&&bl(s);var o=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(Jd|yl))===0;if(!o&&r&&(i!==null&&Ly(s,i),lt!==null&&(lt.f&Pe)!==0)){var u=lt;(u.effects??(u.effects=[])).push(s)}return s}function dp(e){const t=Jr(Zo,null,!1);return rn(t,Ve),t.teardown=e,t}function Fy(e){My();var t=gt!==null&&(gt.f&In)!==0&&de!==null&&!de.m;if(t){var n=de;(n.e??(n.e=[])).push({fn:e,effect:gt,reaction:lt})}else{var r=pp(e);return r}}function Uy(e){const t=Jr(Xr,e,!0);return(n={})=>new Promise(r=>{n.outro?go(t,()=>{Ln(t),r(void 0)}):(Ln(t),r(void 0))})}function pp(e){return Jr(Qd,e,!1)}function By(e){return Jr(Zo,e,!0)}function ln(e,t=[],n=Al){const r=t.map(n);return Il(()=>e(...r.map($)))}function Il(e,t=0){var n=Jr(Zo|_l|t,e,!0);return n}function zi(e,t=!0){return Jr(Zo|In,e,!0,t)}function gp(e){var t=e.teardown;if(t!==null){const n=Yr,r=lt;Ch(!0),nn(null);try{t.call(null)}finally{Ch(n),nn(r)}}}function mp(e,t=!1){var i;var n=e.first;for(e.first=e.last=null;n!==null;){(i=n.ac)==null||i.abort(Yd);var r=n.next;(n.f&Xr)!==0?n.parent=null:Ln(n,t),n=r}}function $y(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&In)===0&&Ln(t),t=n}}function Ln(e,t=!0){var n=!1;(t||(e.f&py)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(qy(e.nodes_start,e.nodes_end),n=!0),mp(e,t&&!n),wo(e,0),rn(e,vl);var r=e.transitions;if(r!==null)for(const s of r)s.stop();gp(e);var i=e.parent;i!==null&&i.first!==null&&_p(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function qy(e,t){for(;e!==null;){var n=e===t?null:ea(e);e.remove(),e=n}}function _p(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function go(e,t){var n=[];Rl(e,n,!0),yp(n,()=>{Ln(e),t&&t()})}function yp(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Rl(e,t,n){if((e.f&gn)===0){if(e.f^=gn,e.transitions!==null)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&wl)!==0||(r.f&In)!==0;Rl(r,t,s?n:!1),r=i}}}function mo(e){vp(e,!0)}function vp(e,t){if((e.f&gn)!==0){e.f^=gn;for(var n=e.first;n!==null;){var r=n.next,i=(n.f&wl)!==0||(n.f&In)!==0;vp(n,i?t:!1),n=r}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let _o=[];function jy(){var e=_o;_o=[],dy(e)}function wp(e){_o.length===0&&queueMicrotask(jy),_o.push(e)}function zy(e){var t=gt;if((t.f&Xd)===0){if((t.f&yl)===0)throw e;t.fn(e)}else Ep(e,t)}function Ep(e,t){for(;t!==null;){if((t.f&yl)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let mu=!1,yo=null,or=!1,Yr=!1;function Ch(e){Yr=e}let Ys=[];let lt=null,We=!1;function nn(e){lt=e}let gt=null;function Fn(e){gt=e}let jt=null;function Tp(e){lt!==null&&lt.f&pu&&(jt===null?jt=[lt,[e]]:jt[1].push(e))}let ie=null,we=0,Re=null;function Hy(e){Re=e}let Ap=1,vo=0,Vn=!1;function Ip(){return++Ap}function na(e){var d;var t=e.f;if((t&_n)!==0)return!0;if((t&mr)!==0){var n=e.deps,r=(t&Ae)!==0;if(n!==null){var i,s,o=(t&fo)!==0,u=r&&gt!==null&&!Vn,l=n.length;if(o||u){var c=e,h=c.parent;for(i=0;i<l;i++)s=n[i],(o||!((d=s==null?void 0:s.reactions)!=null&&d.includes(c)))&&(s.reactions??(s.reactions=[])).push(c);o&&(c.f^=fo),u&&h!==null&&(h.f&Ae)===0&&(c.f^=Ae)}for(i=0;i<l;i++)if(s=n[i],na(s)&&up(s),s.wv>e.wv)return!0}(!r||gt!==null&&!Vn)&&rn(e,Ve)}return!1}function Rp(e,t,n=!0){var r=e.reactions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];jt!=null&&jt[1].includes(e)&&jt[0]===lt||((s.f&Pe)!==0?Rp(s,t,!1):t===s&&(n?rn(s,_n):(s.f&Ve)!==0&&rn(s,mr),bl(s)))}}function Sp(e){var m;var t=ie,n=we,r=Re,i=lt,s=Vn,o=jt,u=de,l=We,c=e.f;ie=null,we=0,Re=null,Vn=(c&Ae)!==0&&(We||!or||lt===null),lt=(c&(In|Xr))===0?e:null,jt=null,bh(e.ctx),We=!1,vo++,e.f|=pu,e.ac!==null&&(e.ac.abort(Yd),e.ac=null);try{var h=(0,e.fn)(),d=e.deps;if(ie!==null){var p;if(wo(e,we),d!==null&&we>0)for(d.length=we+ie.length,p=0;p<ie.length;p++)d[we+p]=ie[p];else e.deps=d=ie;if(!Vn||(c&Pe)!==0&&e.reactions!==null)for(p=we;p<d.length;p++)((m=d[p]).reactions??(m.reactions=[])).push(e)}else d!==null&&we<d.length&&(wo(e,we),d.length=we);if(sp()&&Re!==null&&!We&&d!==null&&(e.f&(Pe|mr|_n))===0)for(p=0;p<Re.length;p++)Rp(Re[p],e);return i!==null&&i!==e&&(vo++,Re!==null&&(r===null?r=Re:r.push(...Re))),h}catch(_){zy(_)}finally{ie=t,we=n,Re=r,lt=i,Vn=s,jt=o,bh(u),We=l,e.f^=pu}}function Gy(e,t){let n=t.reactions;if(n!==null){var r=uy.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&Pe)!==0&&(ie===null||!ie.includes(t))&&(rn(t,mr),(t.f&(Ae|fo))===0&&(t.f^=fo),op(t),wo(t,0))}function wo(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Gy(e,n[r])}function Sl(e){var t=e.f;if((t&vl)===0){rn(e,Ve);var n=gt,r=or;gt=e,or=!0;try{(t&_l)!==0?$y(e):mp(e),gp(e);var i=Sp(e);e.teardown=typeof i=="function"?i:null,e.wv=Ap;var s;Ih&&Iy&&(e.f&_n)!==0&&e.deps}finally{or=r,gt=n}}}function Wy(){try{wy()}catch(e){if(yo!==null)Ep(e,yo);else throw e}}function Ky(){var e=or;try{var t=0;for(or=!0;Ys.length>0;){t++>1e3&&Wy();var n=Ys,r=n.length;Ys=[];for(var i=0;i<r;i++){var s=Xy(n[i]);Qy(s)}ji.clear()}}finally{mu=!1,or=e,yo=null}}function Qy(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(vl|gn))===0&&na(r)&&(Sl(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?_p(r):r.fn=null))}}function bl(e){mu||(mu=!0,queueMicrotask(Ky));for(var t=yo=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(Xr|In))!==0){if((n&Ve)===0)return;t.f^=Ve}}Ys.push(t)}function Xy(e){for(var t=[],n=e;n!==null;){var r=n.f,i=(r&(In|Xr))!==0,s=i&&(r&Ve)!==0;if(!s&&(r&gn)===0){(r&Qd)!==0?t.push(n):i?n.f^=Ve:na(n)&&Sl(n);var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return t}function $(e){var t=e.f,n=(t&Pe)!==0;if(lt!==null&&!We){if(!(jt!=null&&jt[1].includes(e))||jt[0]!==lt){var r=lt.deps;e.rv<vo&&(e.rv=vo,ie===null&&r!==null&&r[we]===e?we++:ie===null?ie=[e]:(!Vn||!ie.includes(e))&&ie.push(e))}}else if(n&&e.deps===null&&e.effects===null){var i=e,s=i.parent;s!==null&&(s.f&Ae)===0&&(i.f^=Ae)}return n&&(i=e,na(i)&&up(i)),Yr&&ji.has(e)?ji.get(e):e.v}function xl(e){var t=We;try{return We=!0,e()}finally{We=t}}const Jy=-7169;function rn(e,t){e.f=e.f&Jy|t}const Yy=["touchstart","touchmove"];function Zy(e){return Yy.includes(e)}let Ph=!1;function tv(){Ph||(Ph=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function bp(e){var t=lt,n=gt;nn(null),Fn(null);try{return e()}finally{nn(t),Fn(n)}}function ev(e,t,n,r=n){e.addEventListener(t,()=>bp(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),tv()}const xp=new Set,_u=new Set;function nv(e,t,n,r={}){function i(s){if(r.capture||Ii.call(t,s),!s.cancelBubble)return bp(()=>n==null?void 0:n.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?wp(()=>{t.addEventListener(e,i,r)}):t.addEventListener(e,i,r),i}function rv(e,t,n,r,i){var s={capture:r,passive:i},o=nv(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&dp(()=>{t.removeEventListener(e,o,s)})}function iv(e){for(var t=0;t<e.length;t++)xp.add(e[t]);for(var n of _u)n(e)}function Ii(e){var b;var t=this,n=t.ownerDocument,r=e.type,i=((b=e.composedPath)==null?void 0:b.call(e))||[],s=i[0]||e.target,o=0,u=e.__root;if(u){var l=i.indexOf(u);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=i.indexOf(t);if(c===-1)return;l<=c&&(o=l)}if(s=i[o]||e.target,s!==t){ly(e,"currentTarget",{configurable:!0,get(){return s||n}});var h=lt,d=gt;nn(null),Fn(null);try{for(var p,m=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+r];if(E!=null&&(!s.disabled||e.target===s))if(gl(E)){var[v,...C]=E;v.apply(s,[e,...C])}else E.call(s,e)}catch(N){p?m.push(N):p=N}if(e.cancelBubble||_===t||_===null)break;s=_}if(p){for(let N of m)queueMicrotask(()=>{throw N});throw p}}finally{e.__root=t,delete e.currentTarget,nn(h),Fn(d)}}}function Cp(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Hi(e,t){var n=gt;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function Gn(e,t){var n=(t&by)!==0,r=(t&xy)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=Cp(s?e:"<!>"+e),n||(i=Br(i)));var o=r||cp?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=Br(o),l=o.lastChild;Hi(u,l)}else Hi(o,o);return o}}function sv(e,t,n="svg"){var r=!e.startsWith("<!>"),i=`<${n}>${r?e:"<!>"+e}</${n}>`,s;return()=>{if(!s){var o=Cp(i),u=Br(o);s=Br(u)}var l=s.cloneNode(!0);return Hi(l,l),l}}function cs(e,t){return sv(e,t,"svg")}function ov(e=""){{var t=ta(e+"");return Hi(t,t),t}}function Us(){var e=document.createDocumentFragment(),t=document.createComment(""),n=ta();return e.append(t,n),Hi(t,n),e}function $t(e,t){e!==null&&e.before(t)}function Sr(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function av(e,t){return uv(e,t)}const br=new Map;function uv(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:o=!0}){ky();var u=new Set,l=d=>{for(var p=0;p<d.length;p++){var m=d[p];if(!u.has(m)){u.add(m);var _=Zy(m);t.addEventListener(m,Ii,{passive:_});var E=br.get(m);E===void 0?(document.addEventListener(m,Ii,{passive:_}),br.set(m,1)):br.set(m,E+1)}}};l(ml(xp)),_u.add(l);var c=void 0,h=Uy(()=>{var d=n??t.appendChild(ta());return zi(()=>{if(s){rp({});var p=de;p.c=s}i&&(r.$$events=i),c=e(d,r)||{},s&&ip()}),()=>{var _;for(var p of u){t.removeEventListener(p,Ii);var m=br.get(p);--m===0?(document.removeEventListener(p,Ii),br.delete(p)):br.set(p,m)}_u.delete(l),d!==n&&((_=d.parentNode)==null||_.removeChild(d))}});return lv.set(c,h),c}let lv=new WeakMap;function cn(e,t,[n,r]=[0,0]){var i=e,s=null,o=null,u=le,l=n>0?wl:0,c=!1;const h=(p,m=!0)=>{c=!0,d(m,p)},d=(p,m)=>{u!==(u=p)&&(u?(s?mo(s):m&&(s=zi(()=>m(i))),o&&go(o,()=>{o=null})):(o?mo(o):m&&(o=zi(()=>m(i,[n+1,r]))),s&&go(s,()=>{s=null})))};Il(()=>{c=!1,t(h),c||d(null,null)},l)}function xr(e,t){return t}function cv(e,t,n,r){for(var i=[],s=t.length,o=0;o<s;o++)Rl(t[o].e,i,!0);var u=s>0&&i.length===0&&n!==null;if(u){var l=n.parentNode;Oy(l),l.append(n),r.clear(),Cn(e,t[0].prev,t[s-1].next)}yp(i,()=>{for(var c=0;c<s;c++){var h=t[c];u||(r.delete(h.k),Cn(e,h.prev,h.next)),Ln(h.e,!u)}})}function er(e,t,n,r,i,s=null){var o=e,u={flags:t,items:new Map,first:null},l=(t&ep)!==0;if(l){var c=e;o=c.appendChild(ta())}var h=null,d=!1,p=Py(()=>{var m=n();return gl(m)?m:m==null?[]:ml(m)});Il(()=>{var m=$(p),_=m.length;d&&_===0||(d=_===0,hv(m,u,o,i,t,r,n),s!==null&&(_===0?h?mo(h):h=zi(()=>s(o)):h!==null&&go(h,()=>{h=null})),$(p))})}function hv(e,t,n,r,i,s,o){var J,F,Y,ht;var u=(i&Ry)!==0,l=(i&(El|Tl))!==0,c=e.length,h=t.items,d=t.first,p=d,m,_=null,E,v=[],C=[],b,N,P,M;if(u)for(M=0;M<c;M+=1)b=e[M],N=s(b,M),P=h.get(N),P!==void 0&&((J=P.a)==null||J.measure(),(E??(E=new Set)).add(P));for(M=0;M<c;M+=1){if(b=e[M],N=s(b,M),P=h.get(N),P===void 0){var U=p?p.e.nodes_start:n;_=dv(U,t,_,_===null?t.first:_.next,b,N,M,r,i,o),h.set(N,_),v=[],C=[],p=_.next;continue}if(l&&fv(P,b,M,i),(P.e.f&gn)!==0&&(mo(P.e),u&&((F=P.a)==null||F.unfix(),(E??(E=new Set)).delete(P))),P!==p){if(m!==void 0&&m.has(P)){if(v.length<C.length){var I=C[0],w;_=I.prev;var T=v[0],S=v[v.length-1];for(w=0;w<v.length;w+=1)Vh(v[w],I,n);for(w=0;w<C.length;w+=1)m.delete(C[w]);Cn(t,T.prev,S.next),Cn(t,_,T),Cn(t,S,I),p=I,_=S,M-=1,v=[],C=[]}else m.delete(P),Vh(P,p,n),Cn(t,P.prev,P.next),Cn(t,P,_===null?t.first:_.next),Cn(t,_,P),_=P;continue}for(v=[],C=[];p!==null&&p.k!==N;)(p.e.f&gn)===0&&(m??(m=new Set)).add(p),C.push(p),p=p.next;if(p===null)continue;P=p}v.push(P),_=P,p=P.next}if(p!==null||m!==void 0){for(var R=m===void 0?[]:ml(m);p!==null;)(p.e.f&gn)===0&&R.push(p),p=p.next;var x=R.length;if(x>0){var A=(i&ep)!==0&&c===0?n:null;if(u){for(M=0;M<x;M+=1)(Y=R[M].a)==null||Y.measure();for(M=0;M<x;M+=1)(ht=R[M].a)==null||ht.fix()}cv(t,R,A,h)}}u&&wp(()=>{var mt;if(E!==void 0)for(P of E)(mt=P.a)==null||mt.apply()}),gt.first=t.first&&t.first.e,gt.last=_&&_.e}function fv(e,t,n,r){(r&El)!==0&&gu(e.v,t),(r&Tl)!==0?gu(e.i,n):e.i=n}function dv(e,t,n,r,i,s,o,u,l,c){var h=(l&El)!==0,d=(l&Sy)===0,p=h?d?Ny(i,!1,!1):po(i):i,m=(l&Tl)===0?o:po(o),_={i:m,v:p,k:s,a:null,e:null,prev:n,next:r};try{return _.e=zi(()=>u(e,p,m,c),Dy),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function Vh(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var o=ea(s);i.before(s),s=o}}function Cn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}const Nh=[...` 	
\r\fÂ \v\uFEFF`];function pv(e,t,n){var r=""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,o=0;(o=r.indexOf(i,o))>=0;){var u=o+s;(o===0||Nh.includes(r[o-1]))&&(u===r.length||Nh.includes(r[u]))?r=(o===0?"":r.substring(0,o))+r.substring(u+1):o=u}}return r===""?null:r}function gv(e,t,n,r,i,s){var o=e.__className;if(o!==n||o===void 0){var u=pv(n,r,s);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(s&&i!==s)for(var l in s){var c=!!s[l];(i==null||c!==!!i[l])&&e.classList.toggle(l,c)}return s}const mv=Symbol("is custom element"),_v=Symbol("is html");function Yt(e,t,n,r){var i=yv(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[gy]=n),n==null?e.removeAttribute(t):typeof n!="string"&&vv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function yv(e){return e.__attributes??(e.__attributes={[mv]:e.nodeName.includes("-"),[_v]:e.namespaceURI===Cy})}var Dh=new Map;function vv(e){var t=Dh.get(e.nodeName);if(t)return t;Dh.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=cy(r);for(var s in n)n[s].set&&t.push(s);r=Kd(r)}return t}function wv(e,t,n=t){ev(e,"input",r=>{var i=r?e.defaultValue:e.value;if(i=Qa(e)?Xa(i):i,n(i),i!==(i=t())){var s=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(o,e.value.length))}}),xl(t)==null&&e.value&&n(Qa(e)?Xa(e.value):e.value),By(()=>{var r=t();Qa(e)&&r===Xa(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Qa(e){var t=e.type;return t==="number"||t==="range"}function Xa(e){return e===""?null:+e}function yu(e){de===null&&np(),Fy(()=>{const t=xl(e);if(typeof t=="function")return t})}function Ev(e){de===null&&np(),yu(()=>()=>xl(e))}const Tv="5";var Wd;typeof window<"u"&&((Wd=window.__svelte??(window.__svelte={})).v??(Wd.v=new Set)).add(Tv);function Pp(e,t){return function(){return e.apply(t,arguments)}}const{toString:Av}=Object.prototype,{getPrototypeOf:Cl}=Object,{iterator:ra,toStringTag:Vp}=Symbol,ia=(e=>t=>{const n=Av.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ue=e=>(e=e.toLowerCase(),t=>ia(t)===e),sa=e=>t=>typeof t===e,{isArray:Zr}=Array,Gi=sa("undefined");function Iv(e){return e!==null&&!Gi(e)&&e.constructor!==null&&!Gi(e.constructor)&&pe(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Np=Ue("ArrayBuffer");function Rv(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Np(e.buffer),t}const Sv=sa("string"),pe=sa("function"),Dp=sa("number"),oa=e=>e!==null&&typeof e=="object",bv=e=>e===!0||e===!1,Zs=e=>{if(ia(e)!=="object")return!1;const t=Cl(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Vp in e)&&!(ra in e)},xv=Ue("Date"),Cv=Ue("File"),Pv=Ue("Blob"),Vv=Ue("FileList"),Nv=e=>oa(e)&&pe(e.pipe),Dv=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||pe(e.append)&&((t=ia(e))==="formdata"||t==="object"&&pe(e.toString)&&e.toString()==="[object FormData]"))},kv=Ue("URLSearchParams"),[Ov,Mv,Lv,Fv]=["ReadableStream","Request","Response","Headers"].map(Ue),Uv=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hs(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),Zr(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],t.call(null,e[u],u,e)}}function kp(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const rr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Op=e=>!Gi(e)&&e!==rr;function vu(){const{caseless:e}=Op(this)&&this||{},t={},n=(r,i)=>{const s=e&&kp(t,i)||i;Zs(t[s])&&Zs(r)?t[s]=vu(t[s],r):Zs(r)?t[s]=vu({},r):Zr(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&hs(arguments[r],n);return t}const Bv=(e,t,n,{allOwnKeys:r}={})=>(hs(t,(i,s)=>{n&&pe(i)?e[s]=Pp(i,n):e[s]=i},{allOwnKeys:r}),e),$v=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),qv=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},jv=(e,t,n,r)=>{let i,s,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&Cl(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},zv=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},Hv=e=>{if(!e)return null;if(Zr(e))return e;let t=e.length;if(!Dp(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Gv=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Cl(Uint8Array)),Wv=(e,t)=>{const r=(e&&e[ra]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},Kv=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Qv=Ue("HTMLFormElement"),Xv=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),kh=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Jv=Ue("RegExp"),Mp=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};hs(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},Yv=e=>{Mp(e,(t,n)=>{if(pe(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(pe(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Zv=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return Zr(e)?r(e):r(String(e).split(t)),n},t0=()=>{},e0=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function n0(e){return!!(e&&pe(e.append)&&e[Vp]==="FormData"&&e[ra])}const r0=e=>{const t=new Array(10),n=(r,i)=>{if(oa(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=Zr(r)?[]:{};return hs(r,(o,u)=>{const l=n(o,i+1);!Gi(l)&&(s[u]=l)}),t[i]=void 0,s}}return r};return n(e,0)},i0=Ue("AsyncFunction"),s0=e=>e&&(oa(e)||pe(e))&&pe(e.then)&&pe(e.catch),Lp=((e,t)=>e?setImmediate:t?((n,r)=>(rr.addEventListener("message",({source:i,data:s})=>{i===rr&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),rr.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",pe(rr.postMessage)),o0=typeof queueMicrotask<"u"?queueMicrotask.bind(rr):typeof process<"u"&&process.nextTick||Lp,a0=e=>e!=null&&pe(e[ra]),D={isArray:Zr,isArrayBuffer:Np,isBuffer:Iv,isFormData:Dv,isArrayBufferView:Rv,isString:Sv,isNumber:Dp,isBoolean:bv,isObject:oa,isPlainObject:Zs,isReadableStream:Ov,isRequest:Mv,isResponse:Lv,isHeaders:Fv,isUndefined:Gi,isDate:xv,isFile:Cv,isBlob:Pv,isRegExp:Jv,isFunction:pe,isStream:Nv,isURLSearchParams:kv,isTypedArray:Gv,isFileList:Vv,forEach:hs,merge:vu,extend:Bv,trim:Uv,stripBOM:$v,inherits:qv,toFlatObject:jv,kindOf:ia,kindOfTest:Ue,endsWith:zv,toArray:Hv,forEachEntry:Wv,matchAll:Kv,isHTMLForm:Qv,hasOwnProperty:kh,hasOwnProp:kh,reduceDescriptors:Mp,freezeMethods:Yv,toObjectSet:Zv,toCamelCase:Xv,noop:t0,toFiniteNumber:e0,findKey:kp,global:rr,isContextDefined:Op,isSpecCompliantForm:n0,toJSONObject:r0,isAsyncFn:i0,isThenable:s0,setImmediate:Lp,asap:o0,isIterable:a0};function Z(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}D.inherits(Z,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const Fp=Z.prototype,Up={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Up[e]={value:e}});Object.defineProperties(Z,Up);Object.defineProperty(Fp,"isAxiosError",{value:!0});Z.from=(e,t,n,r,i,s)=>{const o=Object.create(Fp);return D.toFlatObject(e,o,function(l){return l!==Error.prototype},u=>u!=="isAxiosError"),Z.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const u0=null;function wu(e){return D.isPlainObject(e)||D.isArray(e)}function Bp(e){return D.endsWith(e,"[]")?e.slice(0,-2):e}function Oh(e,t,n){return e?e.concat(t).map(function(i,s){return i=Bp(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function l0(e){return D.isArray(e)&&!e.some(wu)}const c0=D.toFlatObject(D,{},null,function(t){return/^is[A-Z]/.test(t)});function aa(e,t,n){if(!D.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=D.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,v){return!D.isUndefined(v[E])});const r=n.metaTokens,i=n.visitor||h,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(i))throw new TypeError("visitor must be a function");function c(_){if(_===null)return"";if(D.isDate(_))return _.toISOString();if(D.isBoolean(_))return _.toString();if(!l&&D.isBlob(_))throw new Z("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(_)||D.isTypedArray(_)?l&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,E,v){let C=_;if(_&&!v&&typeof _=="object"){if(D.endsWith(E,"{}"))E=r?E:E.slice(0,-2),_=JSON.stringify(_);else if(D.isArray(_)&&l0(_)||(D.isFileList(_)||D.endsWith(E,"[]"))&&(C=D.toArray(_)))return E=Bp(E),C.forEach(function(N,P){!(D.isUndefined(N)||N===null)&&t.append(o===!0?Oh([E],P,s):o===null?E:E+"[]",c(N))}),!1}return wu(_)?!0:(t.append(Oh(v,E,s),c(_)),!1)}const d=[],p=Object.assign(c0,{defaultVisitor:h,convertValue:c,isVisitable:wu});function m(_,E){if(!D.isUndefined(_)){if(d.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));d.push(_),D.forEach(_,function(C,b){(!(D.isUndefined(C)||C===null)&&i.call(t,C,D.isString(b)?b.trim():b,E,p))===!0&&m(C,E?E.concat(b):[b])}),d.pop()}}if(!D.isObject(e))throw new TypeError("data must be an object");return m(e),t}function Mh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Pl(e,t){this._pairs=[],e&&aa(e,this,t)}const $p=Pl.prototype;$p.append=function(t,n){this._pairs.push([t,n])};$p.toString=function(t){const n=t?function(r){return t.call(this,r,Mh)}:Mh;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function h0(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function qp(e,t,n){if(!t)return e;const r=n&&n.encode||h0;D.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=D.isURLSearchParams(t)?t.toString():new Pl(t,n).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Lh{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){D.forEach(this.handlers,function(r){r!==null&&t(r)})}}const jp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},f0=typeof URLSearchParams<"u"?URLSearchParams:Pl,d0=typeof FormData<"u"?FormData:null,p0=typeof Blob<"u"?Blob:null,g0={isBrowser:!0,classes:{URLSearchParams:f0,FormData:d0,Blob:p0},protocols:["http","https","file","blob","url","data"]},Vl=typeof window<"u"&&typeof document<"u",Eu=typeof navigator=="object"&&navigator||void 0,m0=Vl&&(!Eu||["ReactNative","NativeScript","NS"].indexOf(Eu.product)<0),_0=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",y0=Vl&&window.location.href||"http://localhost",v0=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Vl,hasStandardBrowserEnv:m0,hasStandardBrowserWebWorkerEnv:_0,navigator:Eu,origin:y0},Symbol.toStringTag,{value:"Module"})),ne={...v0,...g0};function w0(e,t){return aa(e,new ne.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return ne.isNode&&D.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function E0(e){return D.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function T0(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function zp(e){function t(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),l=s>=n.length;return o=!o&&D.isArray(i)?i.length:o,l?(D.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!D.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],s)&&D.isArray(i[o])&&(i[o]=T0(i[o])),!u)}if(D.isFormData(e)&&D.isFunction(e.entries)){const n={};return D.forEachEntry(e,(r,i)=>{t(E0(r),i,n,0)}),n}return null}function A0(e,t,n){if(D.isString(e))try{return(t||JSON.parse)(e),D.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const fs={transitional:jp,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=D.isObject(t);if(s&&D.isHTMLForm(t)&&(t=new FormData(t)),D.isFormData(t))return i?JSON.stringify(zp(t)):t;if(D.isArrayBuffer(t)||D.isBuffer(t)||D.isStream(t)||D.isFile(t)||D.isBlob(t)||D.isReadableStream(t))return t;if(D.isArrayBufferView(t))return t.buffer;if(D.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return w0(t,this.formSerializer).toString();if((u=D.isFileList(t))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return aa(u?{"files[]":t}:t,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),A0(t)):t}],transformResponse:[function(t){const n=this.transitional||fs.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(D.isResponse(t)||D.isReadableStream(t))return t;if(t&&D.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Z.from(u,Z.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ne.classes.FormData,Blob:ne.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],e=>{fs.headers[e]={}});const I0=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),R0=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&I0[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Fh=Symbol("internals");function Ti(e){return e&&String(e).trim().toLowerCase()}function to(e){return e===!1||e==null?e:D.isArray(e)?e.map(to):String(e)}function S0(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const b0=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ja(e,t,n,r,i){if(D.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!D.isString(t)){if(D.isString(r))return t.indexOf(r)!==-1;if(D.isRegExp(r))return r.test(t)}}function x0(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function C0(e,t){const n=D.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,o){return this[r].call(this,t,i,s,o)},configurable:!0})})}let ge=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,l,c){const h=Ti(l);if(!h)throw new Error("header name must be a non-empty string");const d=D.findKey(i,h);(!d||i[d]===void 0||c===!0||c===void 0&&i[d]!==!1)&&(i[d||l]=to(u))}const o=(u,l)=>D.forEach(u,(c,h)=>s(c,h,l));if(D.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(D.isString(t)&&(t=t.trim())&&!b0(t))o(R0(t),n);else if(D.isObject(t)&&D.isIterable(t)){let u={},l,c;for(const h of t){if(!D.isArray(h))throw TypeError("Object iterator must return a key-value pair");u[c=h[0]]=(l=u[c])?D.isArray(l)?[...l,h[1]]:[l,h[1]]:h[1]}o(u,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=Ti(t),t){const r=D.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return S0(i);if(D.isFunction(n))return n.call(this,i,r);if(D.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ti(t),t){const r=D.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Ja(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(o){if(o=Ti(o),o){const u=D.findKey(r,o);u&&(!n||Ja(r,r[u],u,n))&&(delete r[u],i=!0)}}return D.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||Ja(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return D.forEach(this,(i,s)=>{const o=D.findKey(r,s);if(o){n[o]=to(i),delete n[s];return}const u=t?x0(s):String(s).trim();u!==s&&delete n[s],n[u]=to(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return D.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&D.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[Fh]=this[Fh]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=Ti(o);r[u]||(C0(i,o),r[u]=!0)}return D.isArray(t)?t.forEach(s):s(t),this}};ge.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(ge.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});D.freezeMethods(ge);function Ya(e,t){const n=this||fs,r=t||n,i=ge.from(r.headers);let s=r.data;return D.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function Hp(e){return!!(e&&e.__CANCEL__)}function ti(e,t,n){Z.call(this,e??"canceled",Z.ERR_CANCELED,t,n),this.name="CanceledError"}D.inherits(ti,Z,{__CANCEL__:!0});function Gp(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Z("Request failed with status code "+n.status,[Z.ERR_BAD_REQUEST,Z.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function P0(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function V0(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),h=r[s];o||(o=c),n[i]=l,r[i]=c;let d=s,p=0;for(;d!==i;)p+=n[d++],d=d%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),c-o<t)return;const m=h&&c-h;return m?Math.round(p*1e3/m):void 0}}function N0(e,t){let n=0,r=1e3/t,i,s;const o=(c,h=Date.now())=>{n=h,i=null,s&&(clearTimeout(s),s=null),e.apply(null,c)};return[(...c)=>{const h=Date.now(),d=h-n;d>=r?o(c,h):(i=c,s||(s=setTimeout(()=>{s=null,o(i)},r-d)))},()=>i&&o(i)]}const Eo=(e,t,n=3)=>{let r=0;const i=V0(50,250);return N0(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,l=o-r,c=i(l),h=o<=u;r=o;const d={loaded:o,total:u,progress:u?o/u:void 0,bytes:l,rate:c||void 0,estimated:c&&u&&h?(u-o)/c:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(d)},n)},Uh=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Bh=e=>(...t)=>D.asap(()=>e(...t)),D0=ne.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ne.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ne.origin),ne.navigator&&/(msie|trident)/i.test(ne.navigator.userAgent)):()=>!0,k0=ne.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];D.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),D.isString(r)&&o.push("path="+r),D.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function O0(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function M0(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Wp(e,t,n){let r=!O0(t);return e&&(r||n==!1)?M0(e,t):t}const $h=e=>e instanceof ge?{...e}:e;function cr(e,t){t=t||{};const n={};function r(c,h,d,p){return D.isPlainObject(c)&&D.isPlainObject(h)?D.merge.call({caseless:p},c,h):D.isPlainObject(h)?D.merge({},h):D.isArray(h)?h.slice():h}function i(c,h,d,p){if(D.isUndefined(h)){if(!D.isUndefined(c))return r(void 0,c,d,p)}else return r(c,h,d,p)}function s(c,h){if(!D.isUndefined(h))return r(void 0,h)}function o(c,h){if(D.isUndefined(h)){if(!D.isUndefined(c))return r(void 0,c)}else return r(void 0,h)}function u(c,h,d){if(d in t)return r(c,h);if(d in e)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(c,h,d)=>i($h(c),$h(h),d,!0)};return D.forEach(Object.keys(Object.assign({},e,t)),function(h){const d=l[h]||i,p=d(e[h],t[h],h);D.isUndefined(p)&&d!==u||(n[h]=p)}),n}const Kp=e=>{const t=cr({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=t;t.headers=o=ge.from(o),t.url=qp(Wp(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let l;if(D.isFormData(n)){if(ne.hasStandardBrowserEnv||ne.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...h]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...h].join("; "))}}if(ne.hasStandardBrowserEnv&&(r&&D.isFunction(r)&&(r=r(t)),r||r!==!1&&D0(t.url))){const c=i&&s&&k0.read(s);c&&o.set(i,c)}return t},L0=typeof XMLHttpRequest<"u",F0=L0&&function(e){return new Promise(function(n,r){const i=Kp(e);let s=i.data;const o=ge.from(i.headers).normalize();let{responseType:u,onUploadProgress:l,onDownloadProgress:c}=i,h,d,p,m,_;function E(){m&&m(),_&&_(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(i.method.toUpperCase(),i.url,!0),v.timeout=i.timeout;function C(){if(!v)return;const N=ge.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),M={data:!u||u==="text"||u==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:N,config:e,request:v};Gp(function(I){n(I),E()},function(I){r(I),E()},M),v=null}"onloadend"in v?v.onloadend=C:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(C)},v.onabort=function(){v&&(r(new Z("Request aborted",Z.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new Z("Network Error",Z.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let P=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const M=i.transitional||jp;i.timeoutErrorMessage&&(P=i.timeoutErrorMessage),r(new Z(P,M.clarifyTimeoutError?Z.ETIMEDOUT:Z.ECONNABORTED,e,v)),v=null},s===void 0&&o.setContentType(null),"setRequestHeader"in v&&D.forEach(o.toJSON(),function(P,M){v.setRequestHeader(M,P)}),D.isUndefined(i.withCredentials)||(v.withCredentials=!!i.withCredentials),u&&u!=="json"&&(v.responseType=i.responseType),c&&([p,_]=Eo(c,!0),v.addEventListener("progress",p)),l&&v.upload&&([d,m]=Eo(l),v.upload.addEventListener("progress",d),v.upload.addEventListener("loadend",m)),(i.cancelToken||i.signal)&&(h=N=>{v&&(r(!N||N.type?new ti(null,e,v):N),v.abort(),v=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const b=P0(i.url);if(b&&ne.protocols.indexOf(b)===-1){r(new Z("Unsupported protocol "+b+":",Z.ERR_BAD_REQUEST,e));return}v.send(s||null)})},U0=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(c){if(!i){i=!0,u();const h=c instanceof Error?c:this.reason;r.abort(h instanceof Z?h:new ti(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new Z(`timeout ${t} of ms exceeded`,Z.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>D.asap(u),l}},B0=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},$0=async function*(e,t){for await(const n of q0(e))yield*B0(n,t)},q0=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},qh=(e,t,n,r)=>{const i=$0(e,t);let s=0,o,u=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:h}=await i.next();if(c){u(),l.close();return}let d=h.byteLength;if(n){let p=s+=d;n(p)}l.enqueue(new Uint8Array(h))}catch(c){throw u(c),c}},cancel(l){return u(l),i.return()}},{highWaterMark:2})},ua=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Qp=ua&&typeof ReadableStream=="function",j0=ua&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Xp=(e,...t)=>{try{return!!e(...t)}catch{return!1}},z0=Qp&&Xp(()=>{let e=!1;const t=new Request(ne.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),jh=64*1024,Tu=Qp&&Xp(()=>D.isReadableStream(new Response("").body)),To={stream:Tu&&(e=>e.body)};ua&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!To[t]&&(To[t]=D.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Z(`Response type '${t}' is not supported`,Z.ERR_NOT_SUPPORT,r)})})})(new Response);const H0=async e=>{if(e==null)return 0;if(D.isBlob(e))return e.size;if(D.isSpecCompliantForm(e))return(await new Request(ne.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(D.isArrayBufferView(e)||D.isArrayBuffer(e))return e.byteLength;if(D.isURLSearchParams(e)&&(e=e+""),D.isString(e))return(await j0(e)).byteLength},G0=async(e,t)=>{const n=D.toFiniteNumber(e.getContentLength());return n??H0(t)},W0=ua&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:l,responseType:c,headers:h,withCredentials:d="same-origin",fetchOptions:p}=Kp(e);c=c?(c+"").toLowerCase():"text";let m=U0([i,s&&s.toAbortSignal()],o),_;const E=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(l&&z0&&n!=="get"&&n!=="head"&&(v=await G0(h,r))!==0){let M=new Request(t,{method:"POST",body:r,duplex:"half"}),U;if(D.isFormData(r)&&(U=M.headers.get("content-type"))&&h.setContentType(U),M.body){const[I,w]=Uh(v,Eo(Bh(l)));r=qh(M.body,jh,I,w)}}D.isString(d)||(d=d?"include":"omit");const C="credentials"in Request.prototype;_=new Request(t,{...p,signal:m,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:C?d:void 0});let b=await fetch(_,p);const N=Tu&&(c==="stream"||c==="response");if(Tu&&(u||N&&E)){const M={};["status","statusText","headers"].forEach(T=>{M[T]=b[T]});const U=D.toFiniteNumber(b.headers.get("content-length")),[I,w]=u&&Uh(U,Eo(Bh(u),!0))||[];b=new Response(qh(b.body,jh,I,()=>{w&&w(),E&&E()}),M)}c=c||"text";let P=await To[D.findKey(To,c)||"text"](b,e);return!N&&E&&E(),await new Promise((M,U)=>{Gp(M,U,{data:P,headers:ge.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:_})})}catch(C){throw E&&E(),C&&C.name==="TypeError"&&/Load failed|fetch/i.test(C.message)?Object.assign(new Z("Network Error",Z.ERR_NETWORK,e,_),{cause:C.cause||C}):Z.from(C,C&&C.code,e,_)}}),Au={http:u0,xhr:F0,fetch:W0};D.forEach(Au,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const zh=e=>`- ${e}`,K0=e=>D.isFunction(e)||e===null||e===!1,Jp={getAdapter:e=>{e=D.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let o;if(r=n,!K0(n)&&(r=Au[(o=String(n)).toLowerCase()],r===void 0))throw new Z(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,l])=>`adapter ${u} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(zh).join(`
`):" "+zh(s[0]):"as no adapter specified";throw new Z("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Au};function Za(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ti(null,e)}function Hh(e){return Za(e),e.headers=ge.from(e.headers),e.data=Ya.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Jp.getAdapter(e.adapter||fs.adapter)(e).then(function(r){return Za(e),r.data=Ya.call(e,e.transformResponse,r),r.headers=ge.from(r.headers),r},function(r){return Hp(r)||(Za(e),r&&r.response&&(r.response.data=Ya.call(e,e.transformResponse,r.response),r.response.headers=ge.from(r.response.headers))),Promise.reject(r)})}const Yp="1.10.0",la={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{la[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Gh={};la.transitional=function(t,n,r){function i(s,o){return"[Axios v"+Yp+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(t===!1)throw new Z(i(o," has been removed"+(n?" in "+n:"")),Z.ERR_DEPRECATED);return n&&!Gh[o]&&(Gh[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,u):!0}};la.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function Q0(e,t,n){if(typeof e!="object")throw new Z("options must be an object",Z.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const u=e[s],l=u===void 0||o(u,s,e);if(l!==!0)throw new Z("option "+s+" must be "+l,Z.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Z("Unknown option "+s,Z.ERR_BAD_OPTION)}}const eo={assertOptions:Q0,validators:la},ze=eo.validators;let ar=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Lh,response:new Lh}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=cr(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&eo.assertOptions(r,{silentJSONParsing:ze.transitional(ze.boolean),forcedJSONParsing:ze.transitional(ze.boolean),clarifyTimeoutError:ze.transitional(ze.boolean)},!1),i!=null&&(D.isFunction(i)?n.paramsSerializer={serialize:i}:eo.assertOptions(i,{encode:ze.function,serialize:ze.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),eo.assertOptions(n,{baseUrl:ze.spelling("baseURL"),withXsrfToken:ze.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&D.merge(s.common,s[n.method]);s&&D.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),n.headers=ge.concat(o,s);const u=[];let l=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(n)===!1||(l=l&&E.synchronous,u.unshift(E.fulfilled,E.rejected))});const c=[];this.interceptors.response.forEach(function(E){c.push(E.fulfilled,E.rejected)});let h,d=0,p;if(!l){const _=[Hh.bind(this),void 0];for(_.unshift.apply(_,u),_.push.apply(_,c),p=_.length,h=Promise.resolve(n);d<p;)h=h.then(_[d++],_[d++]);return h}p=u.length;let m=n;for(d=0;d<p;){const _=u[d++],E=u[d++];try{m=_(m)}catch(v){E.call(this,v);break}}try{h=Hh.call(this,m)}catch(_){return Promise.reject(_)}for(d=0,p=c.length;d<p;)h=h.then(c[d++],c[d++]);return h}getUri(t){t=cr(this.defaults,t);const n=Wp(t.baseURL,t.url,t.allowAbsoluteUrls);return qp(n,t.params,t.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(t){ar.prototype[t]=function(n,r){return this.request(cr(r||{},{method:t,url:n,data:(r||{}).data}))}});D.forEach(["post","put","patch"],function(t){function n(r){return function(s,o,u){return this.request(cr(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}ar.prototype[t]=n(),ar.prototype[t+"Form"]=n(!0)});let X0=class Zp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},t(function(s,o,u){r.reason||(r.reason=new ti(s,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Zp(function(i){t=i}),cancel:t}}};function J0(e){return function(n){return e.apply(null,n)}}function Y0(e){return D.isObject(e)&&e.isAxiosError===!0}const Iu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Iu).forEach(([e,t])=>{Iu[t]=e});function tg(e){const t=new ar(e),n=Pp(ar.prototype.request,t);return D.extend(n,ar.prototype,t,{allOwnKeys:!0}),D.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return tg(cr(e,i))},n}const Et=tg(fs);Et.Axios=ar;Et.CanceledError=ti;Et.CancelToken=X0;Et.isCancel=Hp;Et.VERSION=Yp;Et.toFormData=aa;Et.AxiosError=Z;Et.Cancel=Et.CanceledError;Et.all=function(t){return Promise.all(t)};Et.spread=J0;Et.isAxiosError=Y0;Et.mergeConfig=cr;Et.AxiosHeaders=ge;Et.formToJSON=e=>zp(D.isHTMLForm(e)?new FormData(e):e);Et.getAdapter=Jp.getAdapter;Et.HttpStatusCode=Iu;Et.default=Et;const{Axios:cC,AxiosError:hC,CanceledError:fC,isCancel:dC,CancelToken:pC,VERSION:gC,all:mC,Cancel:_C,isAxiosError:yC,spread:vC,toFormData:wC,AxiosHeaders:EC,HttpStatusCode:TC,formToJSON:AC,getAdapter:IC,mergeConfig:RC}=Et;class hr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,u=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);u&&(n[r++]=u),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function*Z0(e){for(const t of e)yield*t}function eg(e){return Array.from(Z0(e))}var tw={value:()=>{}};function Nl(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new no(n)}function no(e){this._=e}function ew(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}no.prototype=Nl.prototype={constructor:no,on:function(e,t){var n=this._,r=ew(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=nw(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=Wh(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Wh(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new no(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function nw(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Wh(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=tw,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ru="http://www.w3.org/1999/xhtml";const Kh={svg:"http://www.w3.org/2000/svg",xhtml:Ru,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ca(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Kh.hasOwnProperty(t)?{space:Kh[t],local:e}:e}function rw(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ru&&t.documentElement.namespaceURI===Ru?t.createElement(e):t.createElementNS(n,e)}}function iw(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ng(e){var t=ca(e);return(t.local?iw:rw)(t)}function sw(){}function Dl(e){return e==null?sw:function(){return this.querySelector(e)}}function ow(e){typeof e!="function"&&(e=Dl(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=new Array(o),l,c,h=0;h<o;++h)(l=s[h])&&(c=e.call(l,l.__data__,h,s))&&("__data__"in l&&(c.__data__=l.__data__),u[h]=c);return new Le(r,this._parents)}function aw(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function uw(){return[]}function rg(e){return e==null?uw:function(){return this.querySelectorAll(e)}}function lw(e){return function(){return aw(e.apply(this,arguments))}}function cw(e){typeof e=="function"?e=lw(e):e=rg(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],u=o.length,l,c=0;c<u;++c)(l=o[c])&&(r.push(e.call(l,l.__data__,c,o)),i.push(l));return new Le(r,i)}function ig(e){return function(){return this.matches(e)}}function sg(e){return function(t){return t.matches(e)}}var hw=Array.prototype.find;function fw(e){return function(){return hw.call(this.children,e)}}function dw(){return this.firstElementChild}function pw(e){return this.select(e==null?dw:fw(typeof e=="function"?e:sg(e)))}var gw=Array.prototype.filter;function mw(){return Array.from(this.children)}function _w(e){return function(){return gw.call(this.children,e)}}function yw(e){return this.selectAll(e==null?mw:_w(typeof e=="function"?e:sg(e)))}function vw(e){typeof e!="function"&&(e=ig(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&u.push(l);return new Le(r,this._parents)}function og(e){return new Array(e.length)}function ww(){return new Le(this._enter||this._groups.map(og),this._parents)}function Ao(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ao.prototype={constructor:Ao,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ew(e){return function(){return e}}function Tw(e,t,n,r,i,s){for(var o=0,u,l=t.length,c=s.length;o<c;++o)(u=t[o])?(u.__data__=s[o],r[o]=u):n[o]=new Ao(e,s[o]);for(;o<l;++o)(u=t[o])&&(i[o]=u)}function Aw(e,t,n,r,i,s,o){var u,l,c=new Map,h=t.length,d=s.length,p=new Array(h),m;for(u=0;u<h;++u)(l=t[u])&&(p[u]=m=o.call(l,l.__data__,u,t)+"",c.has(m)?i[u]=l:c.set(m,l));for(u=0;u<d;++u)m=o.call(e,s[u],u,s)+"",(l=c.get(m))?(r[u]=l,l.__data__=s[u],c.delete(m)):n[u]=new Ao(e,s[u]);for(u=0;u<h;++u)(l=t[u])&&c.get(p[u])===l&&(i[u]=l)}function Iw(e){return e.__data__}function Rw(e,t){if(!arguments.length)return Array.from(this,Iw);var n=t?Aw:Tw,r=this._parents,i=this._groups;typeof e!="function"&&(e=Ew(e));for(var s=i.length,o=new Array(s),u=new Array(s),l=new Array(s),c=0;c<s;++c){var h=r[c],d=i[c],p=d.length,m=Sw(e.call(h,h&&h.__data__,c,r)),_=m.length,E=u[c]=new Array(_),v=o[c]=new Array(_),C=l[c]=new Array(p);n(h,d,E,v,C,m,t);for(var b=0,N=0,P,M;b<_;++b)if(P=E[b]){for(b>=N&&(N=b+1);!(M=v[N])&&++N<_;);P._next=M||null}}return o=new Le(o,r),o._enter=u,o._exit=l,o}function Sw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function bw(){return new Le(this._exit||this._groups.map(og),this._parents)}function xw(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Cw(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),u=new Array(i),l=0;l<o;++l)for(var c=n[l],h=r[l],d=c.length,p=u[l]=new Array(d),m,_=0;_<d;++_)(m=c[_]||h[_])&&(p[_]=m);for(;l<i;++l)u[l]=n[l];return new Le(u,this._parents)}function Pw(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Vw(e){e||(e=Nw);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],u=o.length,l=i[s]=new Array(u),c,h=0;h<u;++h)(c=o[h])&&(l[h]=c);l.sort(t)}return new Le(i,this._parents).order()}function Nw(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Dw(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function kw(){return Array.from(this)}function Ow(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function Mw(){let e=0;for(const t of this)++e;return e}function Lw(){return!this.node()}function Fw(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,u;s<o;++s)(u=i[s])&&e.call(u,u.__data__,s,i);return this}function Uw(e){return function(){this.removeAttribute(e)}}function Bw(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $w(e,t){return function(){this.setAttribute(e,t)}}function qw(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function jw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function zw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Hw(e,t){var n=ca(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Bw:Uw:typeof t=="function"?n.local?zw:jw:n.local?qw:$w)(n,t))}function ag(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Gw(e){return function(){this.style.removeProperty(e)}}function Ww(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Kw(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Qw(e,t,n){return arguments.length>1?this.each((t==null?Gw:typeof t=="function"?Kw:Ww)(e,t,n??"")):$r(this.node(),e)}function $r(e,t){return e.style.getPropertyValue(t)||ag(e).getComputedStyle(e,null).getPropertyValue(t)}function Xw(e){return function(){delete this[e]}}function Jw(e,t){return function(){this[e]=t}}function Yw(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Zw(e,t){return arguments.length>1?this.each((t==null?Xw:typeof t=="function"?Yw:Jw)(e,t)):this.node()[e]}function ug(e){return e.trim().split(/^|\s+/)}function kl(e){return e.classList||new lg(e)}function lg(e){this._node=e,this._names=ug(e.getAttribute("class")||"")}lg.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function cg(e,t){for(var n=kl(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function hg(e,t){for(var n=kl(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function tE(e){return function(){cg(this,e)}}function eE(e){return function(){hg(this,e)}}function nE(e,t){return function(){(t.apply(this,arguments)?cg:hg)(this,e)}}function rE(e,t){var n=ug(e+"");if(arguments.length<2){for(var r=kl(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?nE:t?tE:eE)(n,t))}function iE(){this.textContent=""}function sE(e){return function(){this.textContent=e}}function oE(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function aE(e){return arguments.length?this.each(e==null?iE:(typeof e=="function"?oE:sE)(e)):this.node().textContent}function uE(){this.innerHTML=""}function lE(e){return function(){this.innerHTML=e}}function cE(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function hE(e){return arguments.length?this.each(e==null?uE:(typeof e=="function"?cE:lE)(e)):this.node().innerHTML}function fE(){this.nextSibling&&this.parentNode.appendChild(this)}function dE(){return this.each(fE)}function pE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gE(){return this.each(pE)}function mE(e){var t=typeof e=="function"?e:ng(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function _E(){return null}function yE(e,t){var n=typeof e=="function"?e:ng(e),r=t==null?_E:typeof t=="function"?t:Dl(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function vE(){var e=this.parentNode;e&&e.removeChild(this)}function wE(){return this.each(vE)}function EE(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function TE(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function AE(e){return this.select(e?TE:EE)}function IE(e){return arguments.length?this.property("__data__",e):this.node().__data__}function RE(e){return function(t){e.call(this,t,this.__data__)}}function SE(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function bE(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function xE(e,t,n){return function(){var r=this.__on,i,s=RE(t);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function CE(e,t,n){var r=SE(e+""),i,s=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,c=u.length,h;l<c;++l)for(i=0,h=u[l];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(u=t?xE:bE,i=0;i<s;++i)this.each(u(r[i],t,n));return this}function fg(e,t,n){var r=ag(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function PE(e,t){return function(){return fg(this,e,t)}}function VE(e,t){return function(){return fg(this,e,t.apply(this,arguments))}}function NE(e,t){return this.each((typeof t=="function"?VE:PE)(e,t))}function*DE(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var kE=[null];function Le(e,t){this._groups=e,this._parents=t}function ds(){return new Le([[document.documentElement]],kE)}function OE(){return this}Le.prototype=ds.prototype={constructor:Le,select:ow,selectAll:cw,selectChild:pw,selectChildren:yw,filter:vw,data:Rw,enter:ww,exit:bw,join:xw,merge:Cw,selection:OE,order:Pw,sort:Vw,call:Dw,nodes:kw,node:Ow,size:Mw,empty:Lw,each:Fw,attr:Hw,style:Qw,property:Zw,classed:rE,text:aE,html:hE,raise:dE,lower:gE,append:mE,insert:yE,remove:wE,clone:AE,datum:IE,on:CE,dispatch:NE,[Symbol.iterator]:DE};function Ol(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function dg(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ps(){}var Wi=.7,Io=1/Wi,Mr="\\s*([+-]?\\d+)\\s*",Ki="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ME=/^#([0-9a-f]{3,8})$/,LE=new RegExp(`^rgb\\(${Mr},${Mr},${Mr}\\)$`),FE=new RegExp(`^rgb\\(${Xe},${Xe},${Xe}\\)$`),UE=new RegExp(`^rgba\\(${Mr},${Mr},${Mr},${Ki}\\)$`),BE=new RegExp(`^rgba\\(${Xe},${Xe},${Xe},${Ki}\\)$`),$E=new RegExp(`^hsl\\(${Ki},${Xe},${Xe}\\)$`),qE=new RegExp(`^hsla\\(${Ki},${Xe},${Xe},${Ki}\\)$`),Qh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ol(ps,Qi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Xh,formatHex:Xh,formatHex8:jE,formatHsl:zE,formatRgb:Jh,toString:Jh});function Xh(){return this.rgb().formatHex()}function jE(){return this.rgb().formatHex8()}function zE(){return pg(this).formatHsl()}function Jh(){return this.rgb().formatRgb()}function Qi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ME.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Yh(t):n===3?new fe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Bs(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Bs(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=LE.exec(e))?new fe(t[1],t[2],t[3],1):(t=FE.exec(e))?new fe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=UE.exec(e))?Bs(t[1],t[2],t[3],t[4]):(t=BE.exec(e))?Bs(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=$E.exec(e))?ef(t[1],t[2]/100,t[3]/100,1):(t=qE.exec(e))?ef(t[1],t[2]/100,t[3]/100,t[4]):Qh.hasOwnProperty(e)?Yh(Qh[e]):e==="transparent"?new fe(NaN,NaN,NaN,0):null}function Yh(e){return new fe(e>>16&255,e>>8&255,e&255,1)}function Bs(e,t,n,r){return r<=0&&(e=t=n=NaN),new fe(e,t,n,r)}function HE(e){return e instanceof ps||(e=Qi(e)),e?(e=e.rgb(),new fe(e.r,e.g,e.b,e.opacity)):new fe}function Su(e,t,n,r){return arguments.length===1?HE(e):new fe(e,t,n,r??1)}function fe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ol(fe,Su,dg(ps,{brighter(e){return e=e==null?Io:Math.pow(Io,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Wi:Math.pow(Wi,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new fe(ur(this.r),ur(this.g),ur(this.b),Ro(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zh,formatHex:Zh,formatHex8:GE,formatRgb:tf,toString:tf}));function Zh(){return`#${ir(this.r)}${ir(this.g)}${ir(this.b)}`}function GE(){return`#${ir(this.r)}${ir(this.g)}${ir(this.b)}${ir((isNaN(this.opacity)?1:this.opacity)*255)}`}function tf(){const e=Ro(this.opacity);return`${e===1?"rgb(":"rgba("}${ur(this.r)}, ${ur(this.g)}, ${ur(this.b)}${e===1?")":`, ${e})`}`}function Ro(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ur(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ir(e){return e=ur(e),(e<16?"0":"")+e.toString(16)}function ef(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Me(e,t,n,r)}function pg(e){if(e instanceof Me)return new Me(e.h,e.s,e.l,e.opacity);if(e instanceof ps||(e=Qi(e)),!e)return new Me;if(e instanceof Me)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,u=s-i,l=(s+i)/2;return u?(t===s?o=(n-r)/u+(n<r)*6:n===s?o=(r-t)/u+2:o=(t-n)/u+4,u/=l<.5?s+i:2-s-i,o*=60):u=l>0&&l<1?0:o,new Me(o,u,l,e.opacity)}function WE(e,t,n,r){return arguments.length===1?pg(e):new Me(e,t,n,r??1)}function Me(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ol(Me,WE,dg(ps,{brighter(e){return e=e==null?Io:Math.pow(Io,e),new Me(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Wi:Math.pow(Wi,e),new Me(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new fe(tu(e>=240?e-240:e+120,i,r),tu(e,i,r),tu(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Me(nf(this.h),$s(this.s),$s(this.l),Ro(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ro(this.opacity);return`${e===1?"hsl(":"hsla("}${nf(this.h)}, ${$s(this.s)*100}%, ${$s(this.l)*100}%${e===1?")":`, ${e})`}`}}));function nf(e){return e=(e||0)%360,e<0?e+360:e}function $s(e){return Math.max(0,Math.min(1,e||0))}function tu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const gg=e=>()=>e;function KE(e,t){return function(n){return e+n*t}}function QE(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function XE(e){return(e=+e)==1?mg:function(t,n){return n-t?QE(t,n,e):gg(isNaN(t)?n:t)}}function mg(e,t){var n=t-e;return n?KE(e,n):gg(isNaN(e)?t:e)}const rf=function e(t){var n=XE(t);function r(i,s){var o=n((i=Su(i)).r,(s=Su(s)).r),u=n(i.g,s.g),l=n(i.b,s.b),c=mg(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=u(h),i.b=l(h),i.opacity=c(h),i+""}}return r.gamma=e,r}(1);function Pn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var bu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eu=new RegExp(bu.source,"g");function JE(e){return function(){return e}}function YE(e){return function(t){return e(t)+""}}function ZE(e,t){var n=bu.lastIndex=eu.lastIndex=0,r,i,s,o=-1,u=[],l=[];for(e=e+"",t=t+"";(r=bu.exec(e))&&(i=eu.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),u[o]?u[o]+=s:u[++o]=s),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,l.push({i:o,x:Pn(r,i)})),n=eu.lastIndex;return n<t.length&&(s=t.slice(n),u[o]?u[o]+=s:u[++o]=s),u.length<2?l[0]?YE(l[0].x):JE(t):(t=l.length,function(c){for(var h=0,d;h<t;++h)u[(d=l[h]).i]=d.x(c);return u.join("")})}var sf=180/Math.PI,xu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _g(e,t,n,r,i,s){var o,u,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,l/=u),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*sf,skewX:Math.atan(l)*sf,scaleX:o,scaleY:u}}var qs;function tT(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?xu:_g(t.a,t.b,t.c,t.d,t.e,t.f)}function eT(e){return e==null||(qs||(qs=document.createElementNS("http://www.w3.org/2000/svg","g")),qs.setAttribute("transform",e),!(e=qs.transform.baseVal.consolidate()))?xu:(e=e.matrix,_g(e.a,e.b,e.c,e.d,e.e,e.f))}function yg(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,h,d,p,m,_){if(c!==d||h!==p){var E=m.push("translate(",null,t,null,n);_.push({i:E-4,x:Pn(c,d)},{i:E-2,x:Pn(h,p)})}else(d||p)&&m.push("translate("+d+t+p+n)}function o(c,h,d,p){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),p.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Pn(c,h)})):h&&d.push(i(d)+"rotate("+h+r)}function u(c,h,d,p){c!==h?p.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Pn(c,h)}):h&&d.push(i(d)+"skewX("+h+r)}function l(c,h,d,p,m,_){if(c!==d||h!==p){var E=m.push(i(m)+"scale(",null,",",null,")");_.push({i:E-4,x:Pn(c,d)},{i:E-2,x:Pn(h,p)})}else(d!==1||p!==1)&&m.push(i(m)+"scale("+d+","+p+")")}return function(c,h){var d=[],p=[];return c=e(c),h=e(h),s(c.translateX,c.translateY,h.translateX,h.translateY,d,p),o(c.rotate,h.rotate,d,p),u(c.skewX,h.skewX,d,p),l(c.scaleX,c.scaleY,h.scaleX,h.scaleY,d,p),c=h=null,function(m){for(var _=-1,E=p.length,v;++_<E;)d[(v=p[_]).i]=v.x(m);return d.join("")}}}var nT=yg(tT,"px, ","px)","deg)"),rT=yg(eT,", ",")",")"),qr=0,Ri=0,Ai=0,vg=1e3,So,Si,bo=0,fr=0,ha=0,Xi=typeof performance=="object"&&performance.now?performance:Date,wg=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ml(){return fr||(wg(iT),fr=Xi.now()+ha)}function iT(){fr=0}function xo(){this._call=this._time=this._next=null}xo.prototype=Ll.prototype={constructor:xo,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Ml():+n)+(t==null?0:+t),!this._next&&Si!==this&&(Si?Si._next=this:So=this,Si=this),this._call=e,this._time=n,Cu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cu())}};function Ll(e,t,n){var r=new xo;return r.restart(e,t,n),r}function sT(){Ml(),++qr;for(var e=So,t;e;)(t=fr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--qr}function of(){fr=(bo=Xi.now())+ha,qr=Ri=0;try{sT()}finally{qr=0,aT(),fr=0}}function oT(){var e=Xi.now(),t=e-bo;t>vg&&(ha-=t,bo=e)}function aT(){for(var e,t=So,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:So=n);Si=e,Cu(r)}function Cu(e){if(!qr){Ri&&(Ri=clearTimeout(Ri));var t=e-fr;t>24?(e<1/0&&(Ri=setTimeout(of,e-Xi.now()-ha)),Ai&&(Ai=clearInterval(Ai))):(Ai||(bo=Xi.now(),Ai=setInterval(oT,vg)),qr=1,wg(of))}}function af(e,t,n){var r=new xo;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var uT=Nl("start","end","cancel","interrupt"),lT=[],Eg=0,uf=1,Pu=2,ro=3,lf=4,Vu=5,io=6;function fa(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;cT(e,n,{name:t,index:r,group:i,on:uT,tween:lT,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Eg})}function Fl(e,t){var n=Be(e,t);if(n.state>Eg)throw new Error("too late; already scheduled");return n}function on(e,t){var n=Be(e,t);if(n.state>ro)throw new Error("too late; already running");return n}function Be(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function cT(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Ll(s,0,n.time);function s(c){n.state=uf,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var h,d,p,m;if(n.state!==uf)return l();for(h in r)if(m=r[h],m.name===n.name){if(m.state===ro)return af(o);m.state===lf?(m.state=io,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[h]):+h<t&&(m.state=io,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[h])}if(af(function(){n.state===ro&&(n.state=lf,n.timer.restart(u,n.delay,n.time),u(c))}),n.state=Pu,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Pu){for(n.state=ro,i=new Array(p=n.tween.length),h=0,d=-1;h<p;++h)(m=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=m);i.length=d+1}}function u(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Vu,1),d=-1,p=i.length;++d<p;)i[d].call(e,h);n.state===Vu&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=io,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function hT(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>Pu&&r.state<Vu,r.state=io,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function fT(e){return this.each(function(){hT(this,e)})}function dT(e,t){var n,r;return function(){var i=on(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,u=r.length;o<u;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function pT(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=on(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var u={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=u;break}l===c&&i.push(u)}s.tween=i}}function gT(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Be(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?dT:pT)(n,e,t))}function Ul(e,t,n){var r=e._id;return e.each(function(){var i=on(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Be(i,r).value[t]}}function Tg(e,t){var n;return(typeof t=="number"?Pn:t instanceof Qi?rf:(n=Qi(t))?(t=n,rf):ZE)(e,t)}function mT(e){return function(){this.removeAttribute(e)}}function _T(e){return function(){this.removeAttributeNS(e.space,e.local)}}function yT(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function vT(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function wT(e,t,n){var r,i,s;return function(){var o,u=n(this),l;return u==null?void this.removeAttribute(e):(o=this.getAttribute(e),l=u+"",o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,u)))}}function ET(e,t,n){var r,i,s;return function(){var o,u=n(this),l;return u==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),l=u+"",o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,u)))}}function TT(e,t){var n=ca(e),r=n==="transform"?rT:Tg;return this.attrTween(e,typeof t=="function"?(n.local?ET:wT)(n,r,Ul(this,"attr."+e,t)):t==null?(n.local?_T:mT)(n):(n.local?vT:yT)(n,r,t))}function AT(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function IT(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function RT(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&IT(e,s)),n}return i._value=t,i}function ST(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&AT(e,s)),n}return i._value=t,i}function bT(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=ca(e);return this.tween(n,(r.local?RT:ST)(r,t))}function xT(e,t){return function(){Fl(this,e).delay=+t.apply(this,arguments)}}function CT(e,t){return t=+t,function(){Fl(this,e).delay=t}}function PT(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?xT:CT)(t,e)):Be(this.node(),t).delay}function VT(e,t){return function(){on(this,e).duration=+t.apply(this,arguments)}}function NT(e,t){return t=+t,function(){on(this,e).duration=t}}function DT(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?VT:NT)(t,e)):Be(this.node(),t).duration}function kT(e,t){if(typeof t!="function")throw new Error;return function(){on(this,e).ease=t}}function OT(e){var t=this._id;return arguments.length?this.each(kT(t,e)):Be(this.node(),t).ease}function MT(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;on(this,e).ease=n}}function LT(e){if(typeof e!="function")throw new Error;return this.each(MT(this._id,e))}function FT(e){typeof e!="function"&&(e=ig(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&u.push(l);return new yn(r,this._parents,this._name,this._id)}function UT(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),u=0;u<s;++u)for(var l=t[u],c=n[u],h=l.length,d=o[u]=new Array(h),p,m=0;m<h;++m)(p=l[m]||c[m])&&(d[m]=p);for(;u<r;++u)o[u]=t[u];return new yn(o,this._parents,this._name,this._id)}function BT(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function $T(e,t,n){var r,i,s=BT(t)?Fl:on;return function(){var o=s(this,e),u=o.on;u!==r&&(i=(r=u).copy()).on(t,n),o.on=i}}function qT(e,t){var n=this._id;return arguments.length<2?Be(this.node(),n).on.on(e):this.each($T(n,e,t))}function jT(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function zT(){return this.on("end.remove",jT(this._id))}function HT(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Dl(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var u=r[o],l=u.length,c=s[o]=new Array(l),h,d,p=0;p<l;++p)(h=u[p])&&(d=e.call(h,h.__data__,p,u))&&("__data__"in h&&(d.__data__=h.__data__),c[p]=d,fa(c[p],t,n,p,c,Be(h,n)));return new yn(s,this._parents,t,n)}function GT(e){var t=this._name,n=this._id;typeof e!="function"&&(e=rg(e));for(var r=this._groups,i=r.length,s=[],o=[],u=0;u<i;++u)for(var l=r[u],c=l.length,h,d=0;d<c;++d)if(h=l[d]){for(var p=e.call(h,h.__data__,d,l),m,_=Be(h,n),E=0,v=p.length;E<v;++E)(m=p[E])&&fa(m,t,n,E,p,_);s.push(p),o.push(h)}return new yn(s,o,t,n)}var WT=ds.prototype.constructor;function KT(){return new WT(this._groups,this._parents)}function QT(e,t){var n,r,i;return function(){var s=$r(this,e),o=(this.style.removeProperty(e),$r(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function Ag(e){return function(){this.style.removeProperty(e)}}function XT(e,t,n){var r,i=n+"",s;return function(){var o=$r(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function JT(e,t,n){var r,i,s;return function(){var o=$r(this,e),u=n(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(e),$r(this,e))),o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,u))}}function YT(e,t){var n,r,i,s="style."+t,o="end."+s,u;return function(){var l=on(this,e),c=l.on,h=l.value[s]==null?u||(u=Ag(t)):void 0;(c!==n||i!==h)&&(r=(n=c).copy()).on(o,i=h),l.on=r}}function ZT(e,t,n){var r=(e+="")=="transform"?nT:Tg;return t==null?this.styleTween(e,QT(e,r)).on("end.style."+e,Ag(e)):typeof t=="function"?this.styleTween(e,JT(e,r,Ul(this,"style."+e,t))).each(YT(this._id,e)):this.styleTween(e,XT(e,r,t),n).on("end.style."+e,null)}function t1(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function e1(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&t1(e,o,n)),r}return s._value=t,s}function n1(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,e1(e,t,n??""))}function r1(e){return function(){this.textContent=e}}function i1(e){return function(){var t=e(this);this.textContent=t??""}}function s1(e){return this.tween("text",typeof e=="function"?i1(Ul(this,"text",e)):r1(e==null?"":e+""))}function o1(e){return function(t){this.textContent=e.call(this,t)}}function a1(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&o1(i)),t}return r._value=e,r}function u1(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,a1(e))}function l1(){for(var e=this._name,t=this._id,n=Ig(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,l,c=0;c<u;++c)if(l=o[c]){var h=Be(l,t);fa(l,e,n,c,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new yn(r,this._parents,e,n)}function c1(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var u={value:o},l={value:function(){--i===0&&s()}};n.each(function(){var c=on(this,r),h=c.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(l)),c.on=t}),i===0&&s()})}var h1=0;function yn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ig(){return++h1}var hn=ds.prototype;yn.prototype={constructor:yn,select:HT,selectAll:GT,selectChild:hn.selectChild,selectChildren:hn.selectChildren,filter:FT,merge:UT,selection:KT,transition:l1,call:hn.call,nodes:hn.nodes,node:hn.node,size:hn.size,empty:hn.empty,each:hn.each,on:qT,attr:TT,attrTween:bT,style:ZT,styleTween:n1,text:s1,textTween:u1,remove:zT,tween:gT,delay:PT,duration:DT,ease:OT,easeVarying:LT,end:c1,[Symbol.iterator]:hn[Symbol.iterator]};function f1(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var d1={time:null,delay:0,duration:250,ease:f1};function p1(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function g1(e){var t,n;e instanceof yn?(t=e._id,e=e._name):(t=Ig(),(n=d1).time=Ml(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,l,c=0;c<u;++c)(l=o[c])&&fa(l,e,t,c,o,n||p1(l,t));return new yn(r,this._parents,e,t)}ds.prototype.interrupt=fT;ds.prototype.transition=g1;function m1(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,o=n.length,u,l=0,c=0;for(s=0;s<o;++s)u=n[s],l+=u.x,c+=u.y;for(l=(l/o-e)*r,c=(c/o-t)*r,s=0;s<o;++s)u=n[s],u.x-=l,u.y-=c}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function _1(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Rg(this.cover(t,n),t,n,e)}function Rg(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},u=e._x0,l=e._y0,c=e._x1,h=e._y1,d,p,m,_,E,v,C,b;if(!s)return e._root=o,e;for(;s.length;)if((E=t>=(d=(u+c)/2))?u=d:c=d,(v=n>=(p=(l+h)/2))?l=p:h=p,i=s,!(s=s[C=v<<1|E]))return i[C]=o,e;if(m=+e._x.call(null,s.data),_=+e._y.call(null,s.data),t===m&&n===_)return o.next=s,i?i[C]=o:e._root=o,e;do i=i?i[C]=new Array(4):e._root=new Array(4),(E=t>=(d=(u+c)/2))?u=d:c=d,(v=n>=(p=(l+h)/2))?l=p:h=p;while((C=v<<1|E)===(b=(_>=p)<<1|m>=d));return i[b]=s,i[C]=o,e}function y1(e){var t,n,r=e.length,i,s,o=new Array(r),u=new Array(r),l=1/0,c=1/0,h=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,u[n]=s,i<l&&(l=i),i>h&&(h=i),s<c&&(c=s),s>d&&(d=s));if(l>h||c>d)return this;for(this.cover(l,c).cover(h,d),n=0;n<r;++n)Rg(this,o[n],u[n],e[n]);return this}function v1(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n||1,u=this._root,l,c;n>e||e>=i||r>t||t>=s;)switch(c=(t<r)<<1|e<n,l=new Array(4),l[c]=u,u=l,o*=2,c){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function w1(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function E1(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function se(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function T1(e,t,n){var r,i=this._x0,s=this._y0,o,u,l,c,h=this._x1,d=this._y1,p=[],m=this._root,_,E;for(m&&p.push(new se(m,i,s,h,d)),n==null?n=1/0:(i=e-n,s=t-n,h=e+n,d=t+n,n*=n);_=p.pop();)if(!(!(m=_.node)||(o=_.x0)>h||(u=_.y0)>d||(l=_.x1)<i||(c=_.y1)<s))if(m.length){var v=(o+l)/2,C=(u+c)/2;p.push(new se(m[3],v,C,l,c),new se(m[2],o,C,v,c),new se(m[1],v,u,l,C),new se(m[0],o,u,v,C)),(E=(t>=C)<<1|e>=v)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-E],p[p.length-1-E]=_)}else{var b=e-+this._x.call(null,m.data),N=t-+this._y.call(null,m.data),P=b*b+N*N;if(P<n){var M=Math.sqrt(n=P);i=e-M,s=t-M,h=e+M,d=t+M,r=m.data}}return r}function A1(e){if(isNaN(h=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,u=this._y0,l=this._x1,c=this._y1,h,d,p,m,_,E,v,C;if(!n)return this;if(n.length)for(;;){if((_=h>=(p=(o+l)/2))?o=p:l=p,(E=d>=(m=(u+c)/2))?u=m:c=m,t=n,!(n=n[v=E<<1|_]))return this;if(!n.length)break;(t[v+1&3]||t[v+2&3]||t[v+3&3])&&(r=t,C=v)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[v]=s:delete t[v],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[C]=n:this._root=n),this):(this._root=s,this)}function I1(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function R1(){return this._root}function S1(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function b1(e){var t=[],n,r=this._root,i,s,o,u,l;for(r&&t.push(new se(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,u=n.x1,l=n.y1)&&r.length){var c=(s+u)/2,h=(o+l)/2;(i=r[3])&&t.push(new se(i,c,h,u,l)),(i=r[2])&&t.push(new se(i,s,h,c,l)),(i=r[1])&&t.push(new se(i,c,o,u,h)),(i=r[0])&&t.push(new se(i,s,o,c,h))}return this}function x1(e){var t=[],n=[],r;for(this._root&&t.push(new se(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,u=r.y0,l=r.x1,c=r.y1,h=(o+l)/2,d=(u+c)/2;(s=i[0])&&t.push(new se(s,o,u,h,d)),(s=i[1])&&t.push(new se(s,h,u,l,d)),(s=i[2])&&t.push(new se(s,o,d,h,c)),(s=i[3])&&t.push(new se(s,h,d,l,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function C1(e){return e[0]}function P1(e){return arguments.length?(this._x=e,this):this._x}function V1(e){return e[1]}function N1(e){return arguments.length?(this._y=e,this):this._y}function Sg(e,t,n){var r=new Bl(t??C1,n??V1,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Bl(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function cf(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var oe=Sg.prototype=Bl.prototype;oe.copy=function(){var e=new Bl(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=cf(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=cf(r));return e};oe.add=_1;oe.addAll=y1;oe.cover=v1;oe.data=w1;oe.extent=E1;oe.find=T1;oe.remove=A1;oe.removeAll=I1;oe.root=R1;oe.size=S1;oe.visit=b1;oe.visitAfter=x1;oe.x=P1;oe.y=N1;function pn(e){return function(){return e}}function kr(e){return(e()-.5)*1e-6}function D1(e){return e.index}function hf(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function k1(e){var t=D1,n=d,r,i=pn(30),s,o,u,l,c,h=1;e==null&&(e=[]);function d(v){return 1/Math.min(u[v.source.index],u[v.target.index])}function p(v){for(var C=0,b=e.length;C<h;++C)for(var N=0,P,M,U,I,w,T,S;N<b;++N)P=e[N],M=P.source,U=P.target,I=U.x+U.vx-M.x-M.vx||kr(c),w=U.y+U.vy-M.y-M.vy||kr(c),T=Math.sqrt(I*I+w*w),T=(T-s[N])/T*v*r[N],I*=T,w*=T,U.vx-=I*(S=l[N]),U.vy-=w*S,M.vx+=I*(S=1-S),M.vy+=w*S}function m(){if(o){var v,C=o.length,b=e.length,N=new Map(o.map((M,U)=>[t(M,U,o),M])),P;for(v=0,u=new Array(C);v<b;++v)P=e[v],P.index=v,typeof P.source!="object"&&(P.source=hf(N,P.source)),typeof P.target!="object"&&(P.target=hf(N,P.target)),u[P.source.index]=(u[P.source.index]||0)+1,u[P.target.index]=(u[P.target.index]||0)+1;for(v=0,l=new Array(b);v<b;++v)P=e[v],l[v]=u[P.source.index]/(u[P.source.index]+u[P.target.index]);r=new Array(b),_(),s=new Array(b),E()}}function _(){if(o)for(var v=0,C=e.length;v<C;++v)r[v]=+n(e[v],v,e)}function E(){if(o)for(var v=0,C=e.length;v<C;++v)s[v]=+i(e[v],v,e)}return p.initialize=function(v,C){o=v,c=C,m()},p.links=function(v){return arguments.length?(e=v,m(),p):e},p.id=function(v){return arguments.length?(t=v,p):t},p.iterations=function(v){return arguments.length?(h=+v,p):h},p.strength=function(v){return arguments.length?(n=typeof v=="function"?v:pn(+v),_(),p):n},p.distance=function(v){return arguments.length?(i=typeof v=="function"?v:pn(+v),E(),p):i},p}const O1=1664525,M1=1013904223,ff=4294967296;function L1(){let e=1;return()=>(e=(O1*e+M1)%ff)/ff}function F1(e){return e.x}function U1(e){return e.y}var B1=10,$1=Math.PI*(3-Math.sqrt(5));function q1(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,u=new Map,l=Ll(d),c=Nl("tick","end"),h=L1();e==null&&(e=[]);function d(){p(),c.call("tick",t),n<r&&(l.stop(),c.call("end",t))}function p(E){var v,C=e.length,b;E===void 0&&(E=1);for(var N=0;N<E;++N)for(n+=(s-n)*i,u.forEach(function(P){P(n)}),v=0;v<C;++v)b=e[v],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function m(){for(var E=0,v=e.length,C;E<v;++E){if(C=e[E],C.index=E,C.fx!=null&&(C.x=C.fx),C.fy!=null&&(C.y=C.fy),isNaN(C.x)||isNaN(C.y)){var b=B1*Math.sqrt(.5+E),N=E*$1;C.x=b*Math.cos(N),C.y=b*Math.sin(N)}(isNaN(C.vx)||isNaN(C.vy))&&(C.vx=C.vy=0)}}function _(E){return E.initialize&&E.initialize(e,h),E}return m(),t={tick:p,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(E){return arguments.length?(e=E,m(),u.forEach(_),t):e},alpha:function(E){return arguments.length?(n=+E,t):n},alphaMin:function(E){return arguments.length?(r=+E,t):r},alphaDecay:function(E){return arguments.length?(i=+E,t):+i},alphaTarget:function(E){return arguments.length?(s=+E,t):s},velocityDecay:function(E){return arguments.length?(o=1-E,t):1-o},randomSource:function(E){return arguments.length?(h=E,u.forEach(_),t):h},force:function(E,v){return arguments.length>1?(v==null?u.delete(E):u.set(E,_(v)),t):u.get(E)},find:function(E,v,C){var b=0,N=e.length,P,M,U,I,w;for(C==null?C=1/0:C*=C,b=0;b<N;++b)I=e[b],P=E-I.x,M=v-I.y,U=P*P+M*M,U<C&&(w=I,C=U);return w},on:function(E,v){return arguments.length>1?(c.on(E,v),t):c.on(E)}}}function j1(){var e,t,n,r,i=pn(-30),s,o=1,u=1/0,l=.81;function c(m){var _,E=e.length,v=Sg(e,F1,U1).visitAfter(d);for(r=m,_=0;_<E;++_)t=e[_],v.visit(p)}function h(){if(e){var m,_=e.length,E;for(s=new Array(_),m=0;m<_;++m)E=e[m],s[E.index]=+i(E,m,e)}}function d(m){var _=0,E,v,C=0,b,N,P;if(m.length){for(b=N=P=0;P<4;++P)(E=m[P])&&(v=Math.abs(E.value))&&(_+=E.value,C+=v,b+=v*E.x,N+=v*E.y);m.x=b/C,m.y=N/C}else{E=m,E.x=E.data.x,E.y=E.data.y;do _+=s[E.data.index];while(E=E.next)}m.value=_}function p(m,_,E,v){if(!m.value)return!0;var C=m.x-t.x,b=m.y-t.y,N=v-_,P=C*C+b*b;if(N*N/l<P)return P<u&&(C===0&&(C=kr(n),P+=C*C),b===0&&(b=kr(n),P+=b*b),P<o&&(P=Math.sqrt(o*P)),t.vx+=C*m.value*r/P,t.vy+=b*m.value*r/P),!0;if(m.length||P>=u)return;(m.data!==t||m.next)&&(C===0&&(C=kr(n),P+=C*C),b===0&&(b=kr(n),P+=b*b),P<o&&(P=Math.sqrt(o*P)));do m.data!==t&&(N=s[m.data.index]*r/P,t.vx+=C*N,t.vy+=b*N);while(m=m.next)}return c.initialize=function(m,_){e=m,n=_,h()},c.strength=function(m){return arguments.length?(i=typeof m=="function"?m:pn(+m),h(),c):i},c.distanceMin=function(m){return arguments.length?(o=m*m,c):Math.sqrt(o)},c.distanceMax=function(m){return arguments.length?(u=m*m,c):Math.sqrt(u)},c.theta=function(m){return arguments.length?(l=m*m,c):Math.sqrt(l)},c}function z1(e,t,n){var r,i=pn(.1),s,o;typeof e!="function"&&(e=pn(+e)),t==null&&(t=0),n==null&&(n=0);function u(c){for(var h=0,d=r.length;h<d;++h){var p=r[h],m=p.x-t||1e-6,_=p.y-n||1e-6,E=Math.sqrt(m*m+_*_),v=(o[h]-E)*s[h]*c/E;p.vx+=m*v,p.vy+=_*v}}function l(){if(r){var c,h=r.length;for(s=new Array(h),o=new Array(h),c=0;c<h;++c)o[c]=+e(r[c],c,r),s[c]=isNaN(o[c])?0:+i(r[c],c,r)}}return u.initialize=function(c){r=c,l()},u.strength=function(c){return arguments.length?(i=typeof c=="function"?c:pn(+c),l(),u):i},u.radius=function(c){return arguments.length?(e=typeof c=="function"?c:pn(+c),l(),u):e},u.x=function(c){return arguments.length?(t=+c,u):t},u.y=function(c){return arguments.length?(n=+c,u):n},u}var pt=1e-6,ot=Math.PI,xe=ot/2,df=ot/4,Ne=ot*2,fn=180/ot,Ee=ot/180,Tt=Math.abs,H1=Math.atan,Ji=Math.atan2,Pt=Math.cos,Vt=Math.sin,G1=Math.sign||function(e){return e>0?1:e<0?-1:0},_r=Math.sqrt;function W1(e){return e>1?0:e<-1?ot:Math.acos(e)}function Yi(e){return e>1?xe:e<-1?-xe:Math.asin(e)}function Ce(){}function Co(e,t){e&&gf.hasOwnProperty(e.type)&&gf[e.type](e,t)}var pf={Feature:function(e,t){Co(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Co(n[r].geometry,t)}},gf={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Nu(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Nu(n[r],t,0)},Polygon:function(e,t){mf(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)mf(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Co(n[r],t)}};function Nu(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function mf(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Nu(e[n],t,1);t.polygonEnd()}function Cr(e,t){e&&pf.hasOwnProperty(e.type)?pf[e.type](e,t):Co(e,t)}function Du(e){return[Ji(e[1],e[0]),Yi(e[2])]}function jr(e){var t=e[0],n=e[1],r=Pt(n);return[r*Pt(t),r*Vt(t),Vt(n)]}function js(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Po(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function nu(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function zs(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function ku(e){var t=_r(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ou(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function Mu(e,t){return Tt(e)>ot&&(e-=Math.round(e/Ne)*Ne),[e,t]}Mu.invert=Mu;function K1(e,t,n){return(e%=Ne)?t||n?Ou(yf(e),vf(t,n)):yf(e):t||n?vf(t,n):Mu}function _f(e){return function(t,n){return t+=e,Tt(t)>ot&&(t-=Math.round(t/Ne)*Ne),[t,n]}}function yf(e){var t=_f(e);return t.invert=_f(-e),t}function vf(e,t){var n=Pt(e),r=Vt(e),i=Pt(t),s=Vt(t);function o(u,l){var c=Pt(l),h=Pt(u)*c,d=Vt(u)*c,p=Vt(l),m=p*n+h*r;return[Ji(d*i-m*s,h*n-p*r),Yi(m*i+d*s)]}return o.invert=function(u,l){var c=Pt(l),h=Pt(u)*c,d=Vt(u)*c,p=Vt(l),m=p*i-d*s;return[Ji(d*i+p*s,h*n+m*r),Yi(m*n-h*r)]},o}function Q1(e,t,n,r,i,s){if(n){var o=Pt(t),u=Vt(t),l=r*n;i==null?(i=t+r*Ne,s=t-l/2):(i=wf(o,i),s=wf(o,s),(r>0?i<s:i>s)&&(i+=r*Ne));for(var c,h=i;r>0?h>s:h<s;h-=l)c=Du([o,-u*Pt(h),-u*Vt(h)]),e.point(c[0],c[1])}}function wf(e,t){t=jr(t),t[0]-=e,ku(t);var n=W1(-t[1]);return((-t[2]<0?-n:n)+Ne-pt)%Ne}function bg(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Ce,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function so(e,t){return Tt(e[0]-t[0])<pt&&Tt(e[1]-t[1])<pt}function Hs(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function xg(e,t,n,r,i){var s=[],o=[],u,l;if(e.forEach(function(_){if(!((E=_.length-1)<=0)){var E,v=_[0],C=_[E],b;if(so(v,C)){if(!v[2]&&!C[2]){for(i.lineStart(),u=0;u<E;++u)i.point((v=_[u])[0],v[1]);i.lineEnd();return}C[0]+=2*pt}s.push(b=new Hs(v,_,null,!0)),o.push(b.o=new Hs(v,null,b,!1)),s.push(b=new Hs(C,_,null,!1)),o.push(b.o=new Hs(C,null,b,!0))}}),!!s.length){for(o.sort(t),Ef(s),Ef(o),u=0,l=o.length;u<l;++u)o[u].e=n=!n;for(var c=s[0],h,d;;){for(var p=c,m=!0;p.v;)if((p=p.n)===c)return;h=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(m)for(u=0,l=h.length;u<l;++u)i.point((d=h[u])[0],d[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(m)for(h=p.p.z,u=h.length-1;u>=0;--u)i.point((d=h[u])[0],d[1]);else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,h=p.z,m=!m}while(!p.v);i.lineEnd()}}}function Ef(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function ru(e){return Tt(e[0])<=ot?e[0]:G1(e[0])*((Tt(e[0])+ot)%Ne-ot)}function X1(e,t){var n=ru(t),r=t[1],i=Vt(r),s=[Vt(n),-Pt(n),0],o=0,u=0,l=new hr;i===1?r=xe+pt:i===-1&&(r=-xe-pt);for(var c=0,h=e.length;c<h;++c)if(p=(d=e[c]).length)for(var d,p,m=d[p-1],_=ru(m),E=m[1]/2+df,v=Vt(E),C=Pt(E),b=0;b<p;++b,_=P,v=U,C=I,m=N){var N=d[b],P=ru(N),M=N[1]/2+df,U=Vt(M),I=Pt(M),w=P-_,T=w>=0?1:-1,S=T*w,R=S>ot,x=v*U;if(l.add(Ji(x*T*Vt(S),C*I+x*Pt(S))),o+=R?w+T*Ne:w,R^_>=n^P>=n){var A=Po(jr(m),jr(N));ku(A);var J=Po(s,A);ku(J);var F=(R^w>=0?-1:1)*Yi(J[2]);(r>F||r===F&&(A[0]||A[1]))&&(u+=R^w>=0?1:-1)}}return(o<-pt||o<pt&&l<-1e-12)^u&1}function Cg(e,t,n,r){return function(i){var s=t(i),o=bg(),u=t(o),l=!1,c,h,d,p={point:m,lineStart:E,lineEnd:v,polygonStart:function(){p.point=C,p.lineStart=b,p.lineEnd=N,h=[],c=[]},polygonEnd:function(){p.point=m,p.lineStart=E,p.lineEnd=v,h=eg(h);var P=X1(c,r);h.length?(l||(i.polygonStart(),l=!0),xg(h,Y1,P,n,i)):P&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),h=c=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function m(P,M){e(P,M)&&i.point(P,M)}function _(P,M){s.point(P,M)}function E(){p.point=_,s.lineStart()}function v(){p.point=m,s.lineEnd()}function C(P,M){d.push([P,M]),u.point(P,M)}function b(){u.lineStart(),d=[]}function N(){C(d[0][0],d[0][1]),u.lineEnd();var P=u.clean(),M=o.result(),U,I=M.length,w,T,S;if(d.pop(),c.push(d),d=null,!!I){if(P&1){if(T=M[0],(w=T.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),U=0;U<w;++U)i.point((S=T[U])[0],S[1]);i.lineEnd()}return}I>1&&P&2&&M.push(M.pop().concat(M.shift())),h.push(M.filter(J1))}}return p}}function J1(e){return e.length>1}function Y1(e,t){return((e=e.x)[0]<0?e[1]-xe-pt:xe-e[1])-((t=t.x)[0]<0?t[1]-xe-pt:xe-t[1])}const Tf=Cg(function(){return!0},Z1,eA,[-ot,-xe]);function Z1(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var u=s>0?ot:-ot,l=Tt(s-t);Tt(l-ot)<pt?(e.point(t,n=(n+o)/2>0?xe:-xe),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&l>=ot&&(Tt(t-r)<pt&&(t-=r*pt),Tt(s-u)<pt&&(s-=u*pt),n=tA(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=o),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function tA(e,t,n,r){var i,s,o=Vt(e-n);return Tt(o)>pt?H1((Vt(t)*(s=Pt(r))*Vt(n)-Vt(r)*(i=Pt(t))*Vt(e))/(i*s*o)):(t+r)/2}function eA(e,t,n,r){var i;if(e==null)i=n*xe,r.point(-ot,i),r.point(0,i),r.point(ot,i),r.point(ot,0),r.point(ot,-i),r.point(0,-i),r.point(-ot,-i),r.point(-ot,0),r.point(-ot,i);else if(Tt(e[0]-t[0])>pt){var s=e[0]<t[0]?ot:-ot;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function nA(e){var t=Pt(e),n=2*Ee,r=t>0,i=Tt(t)>pt;function s(h,d,p,m){Q1(m,e,n,p,h,d)}function o(h,d){return Pt(h)*Pt(d)>t}function u(h){var d,p,m,_,E;return{lineStart:function(){_=m=!1,E=1},point:function(v,C){var b=[v,C],N,P=o(v,C),M=r?P?0:c(v,C):P?c(v+(v<0?ot:-ot),C):0;if(!d&&(_=m=P)&&h.lineStart(),P!==m&&(N=l(d,b),(!N||so(d,N)||so(b,N))&&(b[2]=1)),P!==m)E=0,P?(h.lineStart(),N=l(b,d),h.point(N[0],N[1])):(N=l(d,b),h.point(N[0],N[1],2),h.lineEnd()),d=N;else if(i&&d&&r^P){var U;!(M&p)&&(U=l(b,d,!0))&&(E=0,r?(h.lineStart(),h.point(U[0][0],U[0][1]),h.point(U[1][0],U[1][1]),h.lineEnd()):(h.point(U[1][0],U[1][1]),h.lineEnd(),h.lineStart(),h.point(U[0][0],U[0][1],3)))}P&&(!d||!so(d,b))&&h.point(b[0],b[1]),d=b,m=P,p=M},lineEnd:function(){m&&h.lineEnd(),d=null},clean:function(){return E|(_&&m)<<1}}}function l(h,d,p){var m=jr(h),_=jr(d),E=[1,0,0],v=Po(m,_),C=js(v,v),b=v[0],N=C-b*b;if(!N)return!p&&h;var P=t*C/N,M=-t*b/N,U=Po(E,v),I=zs(E,P),w=zs(v,M);nu(I,w);var T=U,S=js(I,T),R=js(T,T),x=S*S-R*(js(I,I)-1);if(!(x<0)){var A=_r(x),J=zs(T,(-S-A)/R);if(nu(J,I),J=Du(J),!p)return J;var F=h[0],Y=d[0],ht=h[1],mt=d[1],Lt;Y<F&&(Lt=F,F=Y,Y=Lt);var $e=Y-F,me=Tt($e-ot)<pt,Ft=me||$e<pt;if(!me&&mt<ht&&(Lt=ht,ht=mt,mt=Lt),Ft?me?ht+mt>0^J[1]<(Tt(J[0]-F)<pt?ht:mt):ht<=J[1]&&J[1]<=mt:$e>ot^(F<=J[0]&&J[0]<=Y)){var ft=zs(T,(-S+A)/R);return nu(ft,I),[J,Du(ft)]}}}function c(h,d){var p=r?e:ot-e,m=0;return h<-p?m|=1:h>p&&(m|=2),d<-p?m|=4:d>p&&(m|=8),m}return Cg(o,u,s,r?[0,-e]:[-ot,e-ot])}function rA(e,t,n,r,i,s){var o=e[0],u=e[1],l=t[0],c=t[1],h=0,d=1,p=l-o,m=c-u,_;if(_=n-o,!(!p&&_>0)){if(_/=p,p<0){if(_<h)return;_<d&&(d=_)}else if(p>0){if(_>d)return;_>h&&(h=_)}if(_=i-o,!(!p&&_<0)){if(_/=p,p<0){if(_>d)return;_>h&&(h=_)}else if(p>0){if(_<h)return;_<d&&(d=_)}if(_=r-u,!(!m&&_>0)){if(_/=m,m<0){if(_<h)return;_<d&&(d=_)}else if(m>0){if(_>d)return;_>h&&(h=_)}if(_=s-u,!(!m&&_<0)){if(_/=m,m<0){if(_>d)return;_>h&&(h=_)}else if(m>0){if(_<h)return;_<d&&(d=_)}return h>0&&(e[0]=o+h*p,e[1]=u+h*m),d<1&&(t[0]=o+d*p,t[1]=u+d*m),!0}}}}}var bi=1e9,Gs=-bi;function iA(e,t,n,r){function i(c,h){return e<=c&&c<=n&&t<=h&&h<=r}function s(c,h,d,p){var m=0,_=0;if(c==null||(m=o(c,d))!==(_=o(h,d))||l(c,h)<0^d>0)do p.point(m===0||m===3?e:n,m>1?r:t);while((m=(m+d+4)%4)!==_);else p.point(h[0],h[1])}function o(c,h){return Tt(c[0]-e)<pt?h>0?0:3:Tt(c[0]-n)<pt?h>0?2:1:Tt(c[1]-t)<pt?h>0?1:0:h>0?3:2}function u(c,h){return l(c.x,h.x)}function l(c,h){var d=o(c,1),p=o(h,1);return d!==p?d-p:d===0?h[1]-c[1]:d===1?c[0]-h[0]:d===2?c[1]-h[1]:h[0]-c[0]}return function(c){var h=c,d=bg(),p,m,_,E,v,C,b,N,P,M,U,I={point:w,lineStart:x,lineEnd:A,polygonStart:S,polygonEnd:R};function w(F,Y){i(F,Y)&&h.point(F,Y)}function T(){for(var F=0,Y=0,ht=m.length;Y<ht;++Y)for(var mt=m[Y],Lt=1,$e=mt.length,me=mt[0],Ft,ft,Rn=me[0],ae=me[1];Lt<$e;++Lt)Ft=Rn,ft=ae,me=mt[Lt],Rn=me[0],ae=me[1],ft<=r?ae>r&&(Rn-Ft)*(r-ft)>(ae-ft)*(e-Ft)&&++F:ae<=r&&(Rn-Ft)*(r-ft)<(ae-ft)*(e-Ft)&&--F;return F}function S(){h=d,p=[],m=[],U=!0}function R(){var F=T(),Y=U&&F,ht=(p=eg(p)).length;(Y||ht)&&(c.polygonStart(),Y&&(c.lineStart(),s(null,null,1,c),c.lineEnd()),ht&&xg(p,u,F,s,c),c.polygonEnd()),h=c,p=m=_=null}function x(){I.point=J,m&&m.push(_=[]),M=!0,P=!1,b=N=NaN}function A(){p&&(J(E,v),C&&P&&d.rejoin(),p.push(d.result())),I.point=w,P&&h.lineEnd()}function J(F,Y){var ht=i(F,Y);if(m&&_.push([F,Y]),M)E=F,v=Y,C=ht,M=!1,ht&&(h.lineStart(),h.point(F,Y));else if(ht&&P)h.point(F,Y);else{var mt=[b=Math.max(Gs,Math.min(bi,b)),N=Math.max(Gs,Math.min(bi,N))],Lt=[F=Math.max(Gs,Math.min(bi,F)),Y=Math.max(Gs,Math.min(bi,Y))];rA(mt,Lt,e,t,n,r)?(P||(h.lineStart(),h.point(mt[0],mt[1])),h.point(Lt[0],Lt[1]),ht||h.lineEnd(),U=!1):ht&&(h.lineStart(),h.point(F,Y),U=!1)}b=F,N=Y,P=ht}return I}}const Lu=e=>e;var iu=new hr,Fu=new hr,Pg,Vg,Uu,Bu,dn={point:Ce,lineStart:Ce,lineEnd:Ce,polygonStart:function(){dn.lineStart=sA,dn.lineEnd=aA},polygonEnd:function(){dn.lineStart=dn.lineEnd=dn.point=Ce,iu.add(Tt(Fu)),Fu=new hr},result:function(){var e=iu/2;return iu=new hr,e}};function sA(){dn.point=oA}function oA(e,t){dn.point=Ng,Pg=Uu=e,Vg=Bu=t}function Ng(e,t){Fu.add(Bu*e-Uu*t),Uu=e,Bu=t}function aA(){Ng(Pg,Vg)}var zr=1/0,Vo=zr,Zi=-zr,No=Zi,Do={point:uA,lineStart:Ce,lineEnd:Ce,polygonStart:Ce,polygonEnd:Ce,result:function(){var e=[[zr,Vo],[Zi,No]];return Zi=No=-(Vo=zr=1/0),e}};function uA(e,t){e<zr&&(zr=e),e>Zi&&(Zi=e),t<Vo&&(Vo=t),t>No&&(No=t)}var $u=0,qu=0,xi=0,ko=0,Oo=0,Or=0,ju=0,zu=0,Ci=0,Dg,kg,Ke,Qe,Se={point:dr,lineStart:Af,lineEnd:If,polygonStart:function(){Se.lineStart=hA,Se.lineEnd=fA},polygonEnd:function(){Se.point=dr,Se.lineStart=Af,Se.lineEnd=If},result:function(){var e=Ci?[ju/Ci,zu/Ci]:Or?[ko/Or,Oo/Or]:xi?[$u/xi,qu/xi]:[NaN,NaN];return $u=qu=xi=ko=Oo=Or=ju=zu=Ci=0,e}};function dr(e,t){$u+=e,qu+=t,++xi}function Af(){Se.point=lA}function lA(e,t){Se.point=cA,dr(Ke=e,Qe=t)}function cA(e,t){var n=e-Ke,r=t-Qe,i=_r(n*n+r*r);ko+=i*(Ke+e)/2,Oo+=i*(Qe+t)/2,Or+=i,dr(Ke=e,Qe=t)}function If(){Se.point=dr}function hA(){Se.point=dA}function fA(){Og(Dg,kg)}function dA(e,t){Se.point=Og,dr(Dg=Ke=e,kg=Qe=t)}function Og(e,t){var n=e-Ke,r=t-Qe,i=_r(n*n+r*r);ko+=i*(Ke+e)/2,Oo+=i*(Qe+t)/2,Or+=i,i=Qe*e-Ke*t,ju+=i*(Ke+e),zu+=i*(Qe+t),Ci+=i*3,dr(Ke=e,Qe=t)}function Mg(e){this._context=e}Mg.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ne);break}}},result:Ce};var Hu=new hr,su,Lg,Fg,Pi,Vi,ts={point:Ce,lineStart:function(){ts.point=pA},lineEnd:function(){su&&Ug(Lg,Fg),ts.point=Ce},polygonStart:function(){su=!0},polygonEnd:function(){su=null},result:function(){var e=+Hu;return Hu=new hr,e}};function pA(e,t){ts.point=Ug,Lg=Pi=e,Fg=Vi=t}function Ug(e,t){Pi-=e,Vi-=t,Hu.add(_r(Pi*Pi+Vi*Vi)),Pi=e,Vi=t}let Rf,Mo,Sf,bf;class xf{constructor(t){this._append=t==null?Bg:gA(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Sf||this._append!==Mo){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,Sf=r,Mo=this._append,bf=this._,this._=i}this._+=bf;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Bg(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function gA(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Bg;if(t!==Rf){const n=10**t;Rf=t,Mo=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return Mo}function mA(e,t){let n=3,r=4.5,i,s;function o(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Cr(u,i(s))),s.result()}return o.area=function(u){return Cr(u,i(dn)),dn.result()},o.measure=function(u){return Cr(u,i(ts)),ts.result()},o.bounds=function(u){return Cr(u,i(Do)),Do.result()},o.centroid=function(u){return Cr(u,i(Se)),Se.result()},o.projection=function(u){return arguments.length?(i=u==null?(e=null,Lu):(e=u).stream,o):e},o.context=function(u){return arguments.length?(s=u==null?(t=null,new xf(n)):new Mg(t=u),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),o):r},o.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const l=Math.floor(u);if(!(l>=0))throw new RangeError(`invalid digits: ${u}`);n=l}return t===null&&(s=new xf(n)),o},o.projection(e).digits(n).context(t)}function $l(e){return function(t){var n=new Gu;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Gu(){}Gu.prototype={constructor:Gu,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ql(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Cr(n,e.stream(Do)),t(Do.result()),r!=null&&e.clipExtent(r),e}function $g(e,t,n){return ql(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([u,l])},n)}function _A(e,t,n){return $g(e,[[0,0],t],n)}function yA(e,t,n){return ql(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([o,u])},n)}function vA(e,t,n){return ql(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,u])},n)}var Cf=16,wA=Pt(30*Ee);function Pf(e,t){return+t?TA(e,t):EA(e)}function EA(e){return $l({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function TA(e,t){function n(r,i,s,o,u,l,c,h,d,p,m,_,E,v){var C=c-r,b=h-i,N=C*C+b*b;if(N>4*t&&E--){var P=o+p,M=u+m,U=l+_,I=_r(P*P+M*M+U*U),w=Yi(U/=I),T=Tt(Tt(U)-1)<pt||Tt(s-d)<pt?(s+d)/2:Ji(M,P),S=e(T,w),R=S[0],x=S[1],A=R-r,J=x-i,F=b*A-C*J;(F*F/N>t||Tt((C*A+b*J)/N-.5)>.3||o*p+u*m+l*_<wA)&&(n(r,i,s,o,u,l,R,x,T,P/=I,M/=I,U,E,v),v.point(R,x),n(R,x,T,P,M,U,c,h,d,p,m,_,E,v))}}return function(r){var i,s,o,u,l,c,h,d,p,m,_,E,v={point:C,lineStart:b,lineEnd:P,polygonStart:function(){r.polygonStart(),v.lineStart=M},polygonEnd:function(){r.polygonEnd(),v.lineStart=b}};function C(w,T){w=e(w,T),r.point(w[0],w[1])}function b(){d=NaN,v.point=N,r.lineStart()}function N(w,T){var S=jr([w,T]),R=e(w,T);n(d,p,h,m,_,E,d=R[0],p=R[1],h=w,m=S[0],_=S[1],E=S[2],Cf,r),r.point(d,p)}function P(){v.point=C,r.lineEnd()}function M(){b(),v.point=U,v.lineEnd=I}function U(w,T){N(i=w,T),s=d,o=p,u=m,l=_,c=E,v.point=N}function I(){n(d,p,h,m,_,E,s,o,i,u,l,c,Cf,r),v.lineEnd=P,P()}return v}}var AA=$l({point:function(e,t){this.stream.point(e*Ee,t*Ee)}});function IA(e){return $l({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function RA(e,t,n,r,i){function s(o,u){return o*=r,u*=i,[t+e*o,n-e*u]}return s.invert=function(o,u){return[(o-t)/e*r,(n-u)/e*i]},s}function Vf(e,t,n,r,i,s){if(!s)return RA(e,t,n,r,i);var o=Pt(s),u=Vt(s),l=o*e,c=u*e,h=o/e,d=u/e,p=(u*n-o*t)/e,m=(u*t+o*n)/e;function _(E,v){return E*=r,v*=i,[l*E-c*v+t,n-c*E-l*v]}return _.invert=function(E,v){return[r*(h*E-d*v+p),i*(m-d*E-h*v)]},_}function SA(e){return bA(function(){return e})()}function bA(e){var t,n=150,r=480,i=250,s=0,o=0,u=0,l=0,c=0,h,d=0,p=1,m=1,_=null,E=Tf,v=null,C,b,N,P=Lu,M=.5,U,I,w,T,S;function R(F){return w(F[0]*Ee,F[1]*Ee)}function x(F){return F=w.invert(F[0],F[1]),F&&[F[0]*fn,F[1]*fn]}R.stream=function(F){return T&&S===F?T:T=AA(IA(h)(E(U(P(S=F)))))},R.preclip=function(F){return arguments.length?(E=F,_=void 0,J()):E},R.postclip=function(F){return arguments.length?(P=F,v=C=b=N=null,J()):P},R.clipAngle=function(F){return arguments.length?(E=+F?nA(_=F*Ee):(_=null,Tf),J()):_*fn},R.clipExtent=function(F){return arguments.length?(P=F==null?(v=C=b=N=null,Lu):iA(v=+F[0][0],C=+F[0][1],b=+F[1][0],N=+F[1][1]),J()):v==null?null:[[v,C],[b,N]]},R.scale=function(F){return arguments.length?(n=+F,A()):n},R.translate=function(F){return arguments.length?(r=+F[0],i=+F[1],A()):[r,i]},R.center=function(F){return arguments.length?(s=F[0]%360*Ee,o=F[1]%360*Ee,A()):[s*fn,o*fn]},R.rotate=function(F){return arguments.length?(u=F[0]%360*Ee,l=F[1]%360*Ee,c=F.length>2?F[2]%360*Ee:0,A()):[u*fn,l*fn,c*fn]},R.angle=function(F){return arguments.length?(d=F%360*Ee,A()):d*fn},R.reflectX=function(F){return arguments.length?(p=F?-1:1,A()):p<0},R.reflectY=function(F){return arguments.length?(m=F?-1:1,A()):m<0},R.precision=function(F){return arguments.length?(U=Pf(I,M=F*F),J()):_r(M)},R.fitExtent=function(F,Y){return $g(R,F,Y)},R.fitSize=function(F,Y){return _A(R,F,Y)},R.fitWidth=function(F,Y){return yA(R,F,Y)},R.fitHeight=function(F,Y){return vA(R,F,Y)};function A(){var F=Vf(n,0,0,p,m,d).apply(null,t(s,o)),Y=Vf(n,r-F[0],i-F[1],p,m,d);return h=K1(u,l,c),I=Ou(t,Y),w=Ou(h,I),U=Pf(I,M),J()}function J(){return T=S=null,R}return function(){return t=e.apply(this,arguments),R.invert=t.invert&&x,A()}}function qg(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}qg.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(Tt(i)>pt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function xA(){return SA(qg).scale(175.295)}function Ni(e,t,n){this.k=e,this.x=t,this.y=n}Ni.prototype={constructor:Ni,scale:function(e){return e===1?this:new Ni(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ni(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ni.prototype;function CA(e){return e}function PA(e){if(e==null)return CA;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(u,l){l||(t=n=0);var c=2,h=u.length,d=new Array(h);for(d[0]=(t+=u[0])*r+s,d[1]=(n+=u[1])*i+o;c<h;)d[c]=u[c],++c;return d}}function VA(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function Nf(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Df(e,n)})}:Df(e,t)}function Df(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=NA(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function NA(e,t){var n=PA(e.transform),r=e.arcs;function i(h,d){d.length&&d.pop();for(var p=r[h<0?~h:h],m=0,_=p.length;m<_;++m)d.push(n(p[m],m));h<0&&VA(d,_)}function s(h){return n(h)}function o(h){for(var d=[],p=0,m=h.length;p<m;++p)i(h[p],d);return d.length<2&&d.push(d[0]),d}function u(h){for(var d=o(h);d.length<4;)d.push(d[0]);return d}function l(h){return h.map(u)}function c(h){var d=h.type,p;switch(d){case"GeometryCollection":return{type:d,geometries:h.geometries.map(c)};case"Point":p=s(h.coordinates);break;case"MultiPoint":p=h.coordinates.map(s);break;case"LineString":p=o(h.arcs);break;case"MultiLineString":p=h.arcs.map(o);break;case"Polygon":p=l(h.arcs);break;case"MultiPolygon":p=h.arcs.map(l);break;default:return null}return{type:d,coordinates:p}}return c(t)}const DA=()=>{};var kf={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jg=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},kA=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],o=e[n++],u=e[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(l>>10)),t[r++]=String.fromCharCode(56320+(l&1023))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},zg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,u=o?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,h=s>>2,d=(s&3)<<4|u>>4;let p=(u&15)<<2|c>>6,m=c&63;l||(m=64,o||(p=64)),r.push(n[h],n[d],n[p],n[m])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(jg(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):kA(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],u=i<e.length?n[e.charAt(i)]:0;++i;const c=i<e.length?n[e.charAt(i)]:64;++i;const d=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||u==null||c==null||d==null)throw new OA;const p=s<<2|u>>4;if(r.push(p),c!==64){const m=u<<4&240|c>>2;if(r.push(m),d!==64){const _=c<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class OA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MA=function(e){const t=jg(e);return zg.encodeByteArray(t,!0)},Lo=function(e){return MA(e).replace(/\./g,"")},LA=function(e){try{return zg.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA=()=>FA().__FIREBASE_DEFAULTS__,BA=()=>{if(typeof process>"u"||typeof kf>"u")return;const e=kf.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},$A=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&LA(e[1]);return t&&JSON.parse(t)},jl=()=>{try{return DA()||UA()||BA()||$A()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},qA=e=>{var t,n;return(n=(t=jl())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},jA=e=>{const t=qA(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Hg=()=>{var e;return(e=jl())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zl(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HA(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Lo(JSON.stringify(n)),Lo(JSON.stringify(o)),""].join(".")}const Fi={};function WA(){const e={prod:[],emulator:[]};for(const t of Object.keys(Fi))Fi[t]?e.emulator.push(t):e.prod.push(t);return e}function KA(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let Of=!1;function QA(e,t){if(typeof window>"u"||typeof document>"u"||!zl(window.location.host)||Fi[e]===t||Fi[e]||Of)return;Fi[e]=t;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=WA().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function u(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Of=!0,o()},p}function h(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=KA(r),m=n("text"),_=document.getElementById(m)||document.createElement("span"),E=n("learnmore"),v=document.getElementById(E)||document.createElement("a"),C=n("preprendIcon"),b=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;u(N),h(v,E);const P=c();l(b,C),N.append(b,_,v,P),document.body.appendChild(N)}s?(_.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JA(){var e;const t=(e=jl())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YA(){return!JA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ZA(){try{return typeof indexedDB=="object"}catch{return!1}}function tI(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="FirebaseError";class ei extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=eI,Object.setPrototypeOf(this,ei.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gg.prototype.create)}}class Gg{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?nI(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new ei(i,u,r)}}function nI(e,t){return e.replace(rI,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const rI=/\{\$([^}]+)}/g;function Fo(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],o=t[i];if(Mf(s)&&Mf(o)){if(!Fo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Mf(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(e){return e&&e._delegate?e._delegate:e}class es{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new zA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(oI(t))try{this.getOrInitializeService({instanceIdentifier:nr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=nr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=nr){return this.instances.has(t)}getOptions(t=nr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:sI(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=nr){return this.component?this.component.multipleInstances?t:nr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function sI(e){return e===nr?void 0:e}function oI(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new iI(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(st||(st={}));const uI={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},lI=st.INFO,cI={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},hI=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=cI[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Wg{constructor(t){this.name=t,this._logLevel=lI,this._logHandler=hI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in st))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?uI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...t),this._logHandler(this,st.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...t),this._logHandler(this,st.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,st.INFO,...t),this._logHandler(this,st.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,st.WARN,...t),this._logHandler(this,st.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...t),this._logHandler(this,st.ERROR,...t)}}const fI=(e,t)=>t.some(n=>e instanceof n);let Lf,Ff;function dI(){return Lf||(Lf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pI(){return Ff||(Ff=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Kg=new WeakMap,Wu=new WeakMap,Qg=new WeakMap,ou=new WeakMap,Hl=new WeakMap;function gI(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(Dn(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Kg.set(n,e)}).catch(()=>{}),Hl.set(t,e),t}function mI(e){if(Wu.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});Wu.set(e,t)}let Ku={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Wu.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Qg.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Dn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function _I(e){Ku=e(Ku)}function yI(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(au(this),t,...n);return Qg.set(r,t.sort?t.sort():[t]),Dn(r)}:pI().includes(e)?function(...t){return e.apply(au(this),t),Dn(Kg.get(this))}:function(...t){return Dn(e.apply(au(this),t))}}function vI(e){return typeof e=="function"?yI(e):(e instanceof IDBTransaction&&mI(e),fI(e,dI())?new Proxy(e,Ku):e)}function Dn(e){if(e instanceof IDBRequest)return gI(e);if(ou.has(e))return ou.get(e);const t=vI(e);return t!==e&&(ou.set(e,t),Hl.set(t,e)),t}const au=e=>Hl.get(e);function wI(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),u=Dn(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Dn(o.result),l.oldVersion,l.newVersion,Dn(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),u}const EI=["get","getKey","getAll","getAllKeys","count"],TI=["put","add","delete","clear"],uu=new Map;function Uf(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(uu.get(t))return uu.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=TI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||EI.includes(n)))return;const s=async function(o,...u){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(u.shift())),(await Promise.all([c[n](...u),i&&l.done]))[0]};return uu.set(t,s),s}_I(e=>({...e,get:(t,n,r)=>Uf(t,n)||e.get(t,n,r),has:(t,n)=>!!Uf(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(II(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function II(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Qu="@firebase/app",Bf="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new Wg("@firebase/app"),RI="@firebase/app-compat",SI="@firebase/analytics-compat",bI="@firebase/analytics",xI="@firebase/app-check-compat",CI="@firebase/app-check",PI="@firebase/auth",VI="@firebase/auth-compat",NI="@firebase/database",DI="@firebase/data-connect",kI="@firebase/database-compat",OI="@firebase/functions",MI="@firebase/functions-compat",LI="@firebase/installations",FI="@firebase/installations-compat",UI="@firebase/messaging",BI="@firebase/messaging-compat",$I="@firebase/performance",qI="@firebase/performance-compat",jI="@firebase/remote-config",zI="@firebase/remote-config-compat",HI="@firebase/storage",GI="@firebase/storage-compat",WI="@firebase/firestore",KI="@firebase/ai",QI="@firebase/firestore-compat",XI="firebase",JI="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu="[DEFAULT]",YI={[Qu]:"fire-core",[RI]:"fire-core-compat",[bI]:"fire-analytics",[SI]:"fire-analytics-compat",[CI]:"fire-app-check",[xI]:"fire-app-check-compat",[PI]:"fire-auth",[VI]:"fire-auth-compat",[NI]:"fire-rtdb",[DI]:"fire-data-connect",[kI]:"fire-rtdb-compat",[OI]:"fire-fn",[MI]:"fire-fn-compat",[LI]:"fire-iid",[FI]:"fire-iid-compat",[UI]:"fire-fcm",[BI]:"fire-fcm-compat",[$I]:"fire-perf",[qI]:"fire-perf-compat",[jI]:"fire-rc",[zI]:"fire-rc-compat",[HI]:"fire-gcs",[GI]:"fire-gcs-compat",[WI]:"fire-fst",[QI]:"fire-fst-compat",[KI]:"fire-vertex","fire-js":"fire-js",[XI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo=new Map,ZI=new Map,Ju=new Map;function $f(e,t){try{e.container.addComponent(t)}catch(n){wn.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Bo(e){const t=e.name;if(Ju.has(t))return wn.debug(`There were multiple attempts to register component ${t}.`),!1;Ju.set(t,e);for(const n of Uo.values())$f(n,e);for(const n of ZI.values())$f(n,e);return!0}function tR(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function eR(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},kn=new Gg("app","Firebase",nR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw kn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR=JI;function Xg(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Xu,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw kn.create("bad-app-name",{appName:String(i)});if(n||(n=Hg()),!n)throw kn.create("no-options");const s=Uo.get(i);if(s){if(Fo(n,s.options)&&Fo(r,s.config))return s;throw kn.create("duplicate-app",{appName:i})}const o=new aI(i);for(const l of Ju.values())o.addComponent(l);const u=new rR(n,r,o);return Uo.set(i,u),u}function sR(e=Xu){const t=Uo.get(e);if(!t&&e===Xu&&Hg())return Xg();if(!t)throw kn.create("no-app",{appName:e});return t}function Lr(e,t,n){var r;let i=(r=YI[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${t}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),wn.warn(u.join(" "));return}Bo(new es(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR="firebase-heartbeat-database",aR=1,ns="firebase-heartbeat-store";let lu=null;function Jg(){return lu||(lu=wI(oR,aR,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(ns)}catch(n){console.warn(n)}}}}).catch(e=>{throw kn.create("idb-open",{originalErrorMessage:e.message})})),lu}async function uR(e){try{const n=(await Jg()).transaction(ns),r=await n.objectStore(ns).get(Yg(e));return await n.done,r}catch(t){if(t instanceof ei)wn.warn(t.message);else{const n=kn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});wn.warn(n.message)}}}async function qf(e,t){try{const r=(await Jg()).transaction(ns,"readwrite");await r.objectStore(ns).put(t,Yg(e)),await r.done}catch(n){if(n instanceof ei)wn.warn(n.message);else{const r=kn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});wn.warn(r.message)}}}function Yg(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=1024,cR=30;class hR{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new dR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=jf();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>cR){const o=pR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){wn.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=jf(),{heartbeatsToSend:r,unsentEntries:i}=fR(this._heartbeatsCache.heartbeats),s=Lo(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return wn.warn(n),""}}}function jf(){return new Date().toISOString().substring(0,10)}function fR(e,t=lR){const n=[];let r=e.slice();for(const i of e){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),zf(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),zf(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class dR{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ZA()?tI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await uR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return qf(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return qf(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function zf(e){return Lo(JSON.stringify({version:2,heartbeats:e})).length}function pR(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(e){Bo(new es("platform-logger",t=>new AI(t),"PRIVATE")),Bo(new es("heartbeat",t=>new hR(t),"PRIVATE")),Lr(Qu,Bf,e),Lr(Qu,Bf,"esm2017"),Lr("fire-js","")}gR("");var mR="firebase",_R="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lr(mR,_R,"app");var Hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var On,Zg;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,w){function T(){}T.prototype=w.prototype,I.D=w.prototype,I.prototype=new T,I.prototype.constructor=I,I.C=function(S,R,x){for(var A=Array(arguments.length-2),J=2;J<arguments.length;J++)A[J-2]=arguments[J];return w.prototype[R].apply(S,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,w,T){T||(T=0);var S=Array(16);if(typeof w=="string")for(var R=0;16>R;++R)S[R]=w.charCodeAt(T++)|w.charCodeAt(T++)<<8|w.charCodeAt(T++)<<16|w.charCodeAt(T++)<<24;else for(R=0;16>R;++R)S[R]=w[T++]|w[T++]<<8|w[T++]<<16|w[T++]<<24;w=I.g[0],T=I.g[1],R=I.g[2];var x=I.g[3],A=w+(x^T&(R^x))+S[0]+3614090360&4294967295;w=T+(A<<7&4294967295|A>>>25),A=x+(R^w&(T^R))+S[1]+3905402710&4294967295,x=w+(A<<12&4294967295|A>>>20),A=R+(T^x&(w^T))+S[2]+606105819&4294967295,R=x+(A<<17&4294967295|A>>>15),A=T+(w^R&(x^w))+S[3]+3250441966&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(x^T&(R^x))+S[4]+4118548399&4294967295,w=T+(A<<7&4294967295|A>>>25),A=x+(R^w&(T^R))+S[5]+1200080426&4294967295,x=w+(A<<12&4294967295|A>>>20),A=R+(T^x&(w^T))+S[6]+2821735955&4294967295,R=x+(A<<17&4294967295|A>>>15),A=T+(w^R&(x^w))+S[7]+4249261313&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(x^T&(R^x))+S[8]+1770035416&4294967295,w=T+(A<<7&4294967295|A>>>25),A=x+(R^w&(T^R))+S[9]+2336552879&4294967295,x=w+(A<<12&4294967295|A>>>20),A=R+(T^x&(w^T))+S[10]+4294925233&4294967295,R=x+(A<<17&4294967295|A>>>15),A=T+(w^R&(x^w))+S[11]+2304563134&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(x^T&(R^x))+S[12]+1804603682&4294967295,w=T+(A<<7&4294967295|A>>>25),A=x+(R^w&(T^R))+S[13]+4254626195&4294967295,x=w+(A<<12&4294967295|A>>>20),A=R+(T^x&(w^T))+S[14]+2792965006&4294967295,R=x+(A<<17&4294967295|A>>>15),A=T+(w^R&(x^w))+S[15]+1236535329&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(R^x&(T^R))+S[1]+4129170786&4294967295,w=T+(A<<5&4294967295|A>>>27),A=x+(T^R&(w^T))+S[6]+3225465664&4294967295,x=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(x^w))+S[11]+643717713&4294967295,R=x+(A<<14&4294967295|A>>>18),A=T+(x^w&(R^x))+S[0]+3921069994&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^x&(T^R))+S[5]+3593408605&4294967295,w=T+(A<<5&4294967295|A>>>27),A=x+(T^R&(w^T))+S[10]+38016083&4294967295,x=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(x^w))+S[15]+3634488961&4294967295,R=x+(A<<14&4294967295|A>>>18),A=T+(x^w&(R^x))+S[4]+3889429448&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^x&(T^R))+S[9]+568446438&4294967295,w=T+(A<<5&4294967295|A>>>27),A=x+(T^R&(w^T))+S[14]+3275163606&4294967295,x=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(x^w))+S[3]+4107603335&4294967295,R=x+(A<<14&4294967295|A>>>18),A=T+(x^w&(R^x))+S[8]+1163531501&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^x&(T^R))+S[13]+2850285829&4294967295,w=T+(A<<5&4294967295|A>>>27),A=x+(T^R&(w^T))+S[2]+4243563512&4294967295,x=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(x^w))+S[7]+1735328473&4294967295,R=x+(A<<14&4294967295|A>>>18),A=T+(x^w&(R^x))+S[12]+2368359562&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(T^R^x)+S[5]+4294588738&4294967295,w=T+(A<<4&4294967295|A>>>28),A=x+(w^T^R)+S[8]+2272392833&4294967295,x=w+(A<<11&4294967295|A>>>21),A=R+(x^w^T)+S[11]+1839030562&4294967295,R=x+(A<<16&4294967295|A>>>16),A=T+(R^x^w)+S[14]+4259657740&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^x)+S[1]+2763975236&4294967295,w=T+(A<<4&4294967295|A>>>28),A=x+(w^T^R)+S[4]+1272893353&4294967295,x=w+(A<<11&4294967295|A>>>21),A=R+(x^w^T)+S[7]+4139469664&4294967295,R=x+(A<<16&4294967295|A>>>16),A=T+(R^x^w)+S[10]+3200236656&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^x)+S[13]+681279174&4294967295,w=T+(A<<4&4294967295|A>>>28),A=x+(w^T^R)+S[0]+3936430074&4294967295,x=w+(A<<11&4294967295|A>>>21),A=R+(x^w^T)+S[3]+3572445317&4294967295,R=x+(A<<16&4294967295|A>>>16),A=T+(R^x^w)+S[6]+76029189&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^x)+S[9]+3654602809&4294967295,w=T+(A<<4&4294967295|A>>>28),A=x+(w^T^R)+S[12]+3873151461&4294967295,x=w+(A<<11&4294967295|A>>>21),A=R+(x^w^T)+S[15]+530742520&4294967295,R=x+(A<<16&4294967295|A>>>16),A=T+(R^x^w)+S[2]+3299628645&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(R^(T|~x))+S[0]+4096336452&4294967295,w=T+(A<<6&4294967295|A>>>26),A=x+(T^(w|~R))+S[7]+1126891415&4294967295,x=w+(A<<10&4294967295|A>>>22),A=R+(w^(x|~T))+S[14]+2878612391&4294967295,R=x+(A<<15&4294967295|A>>>17),A=T+(x^(R|~w))+S[5]+4237533241&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~x))+S[12]+1700485571&4294967295,w=T+(A<<6&4294967295|A>>>26),A=x+(T^(w|~R))+S[3]+2399980690&4294967295,x=w+(A<<10&4294967295|A>>>22),A=R+(w^(x|~T))+S[10]+4293915773&4294967295,R=x+(A<<15&4294967295|A>>>17),A=T+(x^(R|~w))+S[1]+2240044497&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~x))+S[8]+1873313359&4294967295,w=T+(A<<6&4294967295|A>>>26),A=x+(T^(w|~R))+S[15]+4264355552&4294967295,x=w+(A<<10&4294967295|A>>>22),A=R+(w^(x|~T))+S[6]+2734768916&4294967295,R=x+(A<<15&4294967295|A>>>17),A=T+(x^(R|~w))+S[13]+1309151649&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~x))+S[4]+4149444226&4294967295,w=T+(A<<6&4294967295|A>>>26),A=x+(T^(w|~R))+S[11]+3174756917&4294967295,x=w+(A<<10&4294967295|A>>>22),A=R+(w^(x|~T))+S[2]+718787259&4294967295,R=x+(A<<15&4294967295|A>>>17),A=T+(x^(R|~w))+S[9]+3951481745&4294967295,I.g[0]=I.g[0]+w&4294967295,I.g[1]=I.g[1]+(R+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+x&4294967295}r.prototype.u=function(I,w){w===void 0&&(w=I.length);for(var T=w-this.blockSize,S=this.B,R=this.h,x=0;x<w;){if(R==0)for(;x<=T;)i(this,I,x),x+=this.blockSize;if(typeof I=="string"){for(;x<w;)if(S[R++]=I.charCodeAt(x++),R==this.blockSize){i(this,S),R=0;break}}else for(;x<w;)if(S[R++]=I[x++],R==this.blockSize){i(this,S),R=0;break}}this.h=R,this.o+=w},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var w=1;w<I.length-8;++w)I[w]=0;var T=8*this.o;for(w=I.length-8;w<I.length;++w)I[w]=T&255,T/=256;for(this.u(I),I=Array(16),w=T=0;4>w;++w)for(var S=0;32>S;S+=8)I[T++]=this.g[w]>>>S&255;return I};function s(I,w){var T=u;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=w(I)}function o(I,w){this.h=w;for(var T=[],S=!0,R=I.length-1;0<=R;R--){var x=I[R]|0;S&&x==w||(T[R]=x,S=!1)}this.g=T}var u={};function l(I){return-128<=I&&128>I?s(I,function(w){return new o([w|0],0>w?-1:0)}):new o([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return v(c(-I));for(var w=[],T=1,S=0;I>=T;S++)w[S]=I/T|0,T*=4294967296;return new o(w,0)}function h(I,w){if(I.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(I.charAt(0)=="-")return v(h(I.substring(1),w));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(w,8)),S=d,R=0;R<I.length;R+=8){var x=Math.min(8,I.length-R),A=parseInt(I.substring(R,R+x),w);8>x?(x=c(Math.pow(w,x)),S=S.j(x).add(c(A))):(S=S.j(T),S=S.add(c(A)))}return S}var d=l(0),p=l(1),m=l(16777216);e=o.prototype,e.m=function(){if(E(this))return-v(this).m();for(var I=0,w=1,T=0;T<this.g.length;T++){var S=this.i(T);I+=(0<=S?S:4294967296+S)*w,w*=4294967296}return I},e.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(E(this))return"-"+v(this).toString(I);for(var w=c(Math.pow(I,6)),T=this,S="";;){var R=P(T,w).g;T=C(T,R.j(w));var x=((0<T.g.length?T.g[0]:T.h)>>>0).toString(I);if(T=R,_(T))return x+S;for(;6>x.length;)x="0"+x;S=x+S}},e.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var w=0;w<I.g.length;w++)if(I.g[w]!=0)return!1;return!0}function E(I){return I.h==-1}e.l=function(I){return I=C(this,I),E(I)?-1:_(I)?0:1};function v(I){for(var w=I.g.length,T=[],S=0;S<w;S++)T[S]=~I.g[S];return new o(T,~I.h).add(p)}e.abs=function(){return E(this)?v(this):this},e.add=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0,R=0;R<=w;R++){var x=S+(this.i(R)&65535)+(I.i(R)&65535),A=(x>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);S=A>>>16,x&=65535,A&=65535,T[R]=A<<16|x}return new o(T,T[T.length-1]&-2147483648?-1:0)};function C(I,w){return I.add(v(w))}e.j=function(I){if(_(this)||_(I))return d;if(E(this))return E(I)?v(this).j(v(I)):v(v(this).j(I));if(E(I))return v(this.j(v(I)));if(0>this.l(m)&&0>I.l(m))return c(this.m()*I.m());for(var w=this.g.length+I.g.length,T=[],S=0;S<2*w;S++)T[S]=0;for(S=0;S<this.g.length;S++)for(var R=0;R<I.g.length;R++){var x=this.i(S)>>>16,A=this.i(S)&65535,J=I.i(R)>>>16,F=I.i(R)&65535;T[2*S+2*R]+=A*F,b(T,2*S+2*R),T[2*S+2*R+1]+=x*F,b(T,2*S+2*R+1),T[2*S+2*R+1]+=A*J,b(T,2*S+2*R+1),T[2*S+2*R+2]+=x*J,b(T,2*S+2*R+2)}for(S=0;S<w;S++)T[S]=T[2*S+1]<<16|T[2*S];for(S=w;S<2*w;S++)T[S]=0;return new o(T,0)};function b(I,w){for(;(I[w]&65535)!=I[w];)I[w+1]+=I[w]>>>16,I[w]&=65535,w++}function N(I,w){this.g=I,this.h=w}function P(I,w){if(_(w))throw Error("division by zero");if(_(I))return new N(d,d);if(E(I))return w=P(v(I),w),new N(v(w.g),v(w.h));if(E(w))return w=P(I,v(w)),new N(v(w.g),w.h);if(30<I.g.length){if(E(I)||E(w))throw Error("slowDivide_ only works with positive integers.");for(var T=p,S=w;0>=S.l(I);)T=M(T),S=M(S);var R=U(T,1),x=U(S,1);for(S=U(S,2),T=U(T,2);!_(S);){var A=x.add(S);0>=A.l(I)&&(R=R.add(T),x=A),S=U(S,1),T=U(T,1)}return w=C(I,R.j(w)),new N(R,w)}for(R=d;0<=I.l(w);){for(T=Math.max(1,Math.floor(I.m()/w.m())),S=Math.ceil(Math.log(T)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),x=c(T),A=x.j(w);E(A)||0<A.l(I);)T-=S,x=c(T),A=x.j(w);_(x)&&(x=p),R=R.add(x),I=C(I,A)}return new N(R,I)}e.A=function(I){return P(this,I).h},e.and=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)&I.i(S);return new o(T,this.h&I.h)},e.or=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)|I.i(S);return new o(T,this.h|I.h)},e.xor=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)^I.i(S);return new o(T,this.h^I.h)};function M(I){for(var w=I.g.length+1,T=[],S=0;S<w;S++)T[S]=I.i(S)<<1|I.i(S-1)>>>31;return new o(T,I.h)}function U(I,w){var T=w>>5;w%=32;for(var S=I.g.length-T,R=[],x=0;x<S;x++)R[x]=0<w?I.i(x+T)>>>w|I.i(x+T+1)<<32-w:I.i(x+T);return new o(R,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Zg=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,On=o}).apply(typeof Hf<"u"?Hf:typeof self<"u"?self:typeof window<"u"?window:{});var Ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var tm,Di,em,oo,Yu,nm,rm,im;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,g){return a==Array.prototype||a==Object.prototype||(a[f]=g.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ws=="object"&&Ws];for(var f=0;f<a.length;++f){var g=a[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(a,f){if(f)t:{var g=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var V=a[y];if(!(V in g))break t;g=g[V]}a=a[a.length-1],y=g[a],f=f(y),f!=y&&f!=null&&t(g,a,{configurable:!0,writable:!0,value:f})}}function s(a,f){a instanceof String&&(a+="");var g=0,y=!1,V={next:function(){if(!y&&g<a.length){var k=g++;return{value:f(k,a[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(a){return a||function(){return s(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function l(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function c(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,g){return a.call.apply(a.bind,arguments)}function d(a,f,g){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,y),a.apply(f,V)}}return function(){return a.apply(f,arguments)}}function p(a,f,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function m(a,f){var g=Array.prototype.slice.call(arguments,1);return function(){var y=g.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function _(a,f){function g(){}g.prototype=f.prototype,a.aa=f.prototype,a.prototype=new g,a.prototype.constructor=a,a.Qb=function(y,V,k){for(var B=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)B[dt-2]=arguments[dt];return f.prototype[V].apply(y,B)}}function E(a){const f=a.length;if(0<f){const g=Array(f);for(let y=0;y<f;y++)g[y]=a[y];return g}return[]}function v(a,f){for(let g=1;g<arguments.length;g++){const y=arguments[g];if(l(y)){const V=a.length||0,k=y.length||0;a.length=V+k;for(let B=0;B<k;B++)a[V+B]=y[B]}else a.push(y)}}class C{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function b(a){return/^[\s\xa0]*$/.test(a)}function N(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function P(a){return P[" "](a),a}P[" "]=function(){};var M=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function U(a,f,g){for(const y in a)f.call(g,a[y],y,a)}function I(a,f){for(const g in a)f.call(void 0,a[g],g,a)}function w(a){const f={};for(const g in a)f[g]=a[g];return f}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(a,f){let g,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(g in y)a[g]=y[g];for(let k=0;k<T.length;k++)g=T[k],Object.prototype.hasOwnProperty.call(y,g)&&(a[g]=y[g])}}function R(a){var f=1;a=a.split(":");const g=[];for(;0<f&&a.length;)g.push(a.shift()),f--;return a.length&&g.push(a.join(":")),g}function x(a){u.setTimeout(()=>{throw a},0)}function A(){var a=Lt;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class J{constructor(){this.h=this.g=null}add(f,g){const y=F.get();y.set(f,g),this.h?this.h.next=y:this.g=y,this.h=y}}var F=new C(()=>new Y,a=>a.reset());class Y{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ht,mt=!1,Lt=new J,$e=()=>{const a=u.Promise.resolve(void 0);ht=()=>{a.then(me)}};var me=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(g){x(g)}var f=F;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}mt=!1};function Ft(){this.s=this.s,this.C=this.C}Ft.prototype.s=!1,Ft.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ft.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ft(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}ft.prototype.h=function(){this.defaultPrevented=!0};var Rn=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const g=()=>{};u.addEventListener("test",g,f),u.removeEventListener("test",g,f)}catch{}return a}();function ae(a,f){if(ft.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var g=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(M){t:{try{P(f.nodeName);var V=!0;break t}catch{}V=!1}V||(f=null)}}else g=="mouseover"?f=a.fromElement:g=="mouseout"&&(f=a.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:xa[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ae.aa.h.call(this)}}_(ae,ft);var xa={2:"touch",3:"pen",4:"mouse"};ae.prototype.h=function(){ae.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var wr="closure_listenable_"+(1e6*Math.random()|0),Ts=0;function Ca(a,f,g,y,V){this.listener=a,this.proxy=null,this.src=f,this.type=g,this.capture=!!y,this.ha=V,this.key=++Ts,this.da=this.fa=!1}function Xn(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Er(a){this.src=a,this.g={},this.h=0}Er.prototype.add=function(a,f,g,y,V){var k=a.toString();a=this.g[k],a||(a=this.g[k]=[],this.h++);var B=ui(a,f,y,V);return-1<B?(f=a[B],g||(f.fa=!1)):(f=new Ca(f,this.src,k,!!y,V),f.fa=g,a.push(f)),f};function ai(a,f){var g=f.type;if(g in a.g){var y=a.g[g],V=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=V)&&Array.prototype.splice.call(y,V,1),k&&(Xn(f),a.g[g].length==0&&(delete a.g[g],a.h--))}}function ui(a,f,g,y){for(var V=0;V<a.length;++V){var k=a[V];if(!k.da&&k.listener==f&&k.capture==!!g&&k.ha==y)return V}return-1}var H="closure_lm_"+(1e6*Math.random()|0),j={};function K(a,f,g,y,V){if(Array.isArray(f)){for(var k=0;k<f.length;k++)K(a,f[k],g,y,V);return null}return g=ye(g),a&&a[wr]?a.K(f,g,c(y)?!!y.capture:!1,V):rt(a,f,g,!1,y,V)}function rt(a,f,g,y,V,k){if(!f)throw Error("Invalid event type");var B=c(V)?!!V.capture:!!V,dt=_e(a);if(dt||(a[H]=dt=new Er(a)),g=dt.add(f,g,y,B,k),g.proxy)return g;if(y=at(),g.proxy=y,y.src=a,y.listener=g,a.addEventListener)Rn||(V=B),V===void 0&&(V=!1),a.addEventListener(f.toString(),y,V);else if(a.attachEvent)a.attachEvent(xt(f.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return g}function at(){function a(g){return f.call(a.src,a.listener,g)}const f=ue;return a}function Dt(a,f,g,y,V){if(Array.isArray(f))for(var k=0;k<f.length;k++)Dt(a,f[k],g,y,V);else y=c(y)?!!y.capture:!!y,g=ye(g),a&&a[wr]?(a=a.i,f=String(f).toString(),f in a.g&&(k=a.g[f],g=ui(k,g,y,V),-1<g&&(Xn(k[g]),Array.prototype.splice.call(k,g,1),k.length==0&&(delete a.g[f],a.h--)))):a&&(a=_e(a))&&(f=a.g[f.toString()],a=-1,f&&(a=ui(f,g,y,V)),(g=-1<a?f[a]:null)&&St(g))}function St(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[wr])ai(f.i,a);else{var g=a.type,y=a.proxy;f.removeEventListener?f.removeEventListener(g,y,a.capture):f.detachEvent?f.detachEvent(xt(g),y):f.addListener&&f.removeListener&&f.removeListener(y),(g=_e(f))?(ai(g,a),g.h==0&&(g.src=null,f[H]=null)):Xn(a)}}}function xt(a){return a in j?j[a]:j[a]="on"+a}function ue(a,f){if(a.da)a=!0;else{f=new ae(f,this);var g=a.listener,y=a.ha||a.src;a.fa&&St(a),a=g.call(y,f)}return a}function _e(a){return a=a[H],a instanceof Er?a:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function ye(a){return typeof a=="function"?a:(a[Qt]||(a[Qt]=function(f){return a.handleEvent(f)}),a[Qt])}function At(){Ft.call(this),this.i=new Er(this),this.M=this,this.F=null}_(At,Ft),At.prototype[wr]=!0,At.prototype.removeEventListener=function(a,f,g,y){Dt(this,a,f,g,y)};function It(a,f){var g,y=a.F;if(y)for(g=[];y;y=y.F)g.push(y);if(a=a.M,y=f.type||f,typeof f=="string")f=new ft(f,a);else if(f instanceof ft)f.target=f.target||a;else{var V=f;f=new ft(y,a),S(f,V)}if(V=!0,g)for(var k=g.length-1;0<=k;k--){var B=f.g=g[k];V=qe(B,y,!0,f)&&V}if(B=f.g=a,V=qe(B,y,!0,f)&&V,V=qe(B,y,!1,f)&&V,g)for(k=0;k<g.length;k++)B=f.g=g[k],V=qe(B,y,!1,f)&&V}At.prototype.N=function(){if(At.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var g=a.g[f],y=0;y<g.length;y++)Xn(g[y]);delete a.g[f],a.h--}}this.F=null},At.prototype.K=function(a,f,g,y){return this.i.add(String(a),f,!1,g,y)},At.prototype.L=function(a,f,g,y){return this.i.add(String(a),f,!0,g,y)};function qe(a,f,g,y){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var V=!0,k=0;k<f.length;++k){var B=f[k];if(B&&!B.da&&B.capture==g){var dt=B.listener,zt=B.ha||B.src;B.fa&&ai(a.i,B),V=dt.call(zt,y)!==!1&&V}}return V&&!y.defaultPrevented}function De(a,f,g){if(typeof a=="function")g&&(a=p(a,g));else if(a&&typeof a.handleEvent=="function")a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:u.setTimeout(a,f||0)}function Ie(a){a.g=De(()=>{a.g=null,a.i&&(a.i=!1,Ie(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class ke extends Ft{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Ie(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function je(a){Ft.call(this),this.h=a,this.g={}}_(je,Ft);var Vc=[];function Nc(a){U(a.g,function(f,g){this.g.hasOwnProperty(g)&&St(f)},a),a.g={}}je.prototype.N=function(){je.aa.N.call(this),Nc(this)},je.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pa=u.JSON.stringify,O_=u.JSON.parse,M_=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function Va(){}Va.prototype.h=null;function Dc(a){return a.h||(a.h=a.i())}function kc(){}var li={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Na(){ft.call(this,"d")}_(Na,ft);function Da(){ft.call(this,"c")}_(Da,ft);var Jn={},Oc=null;function As(){return Oc=Oc||new At}Jn.La="serverreachability";function Mc(a){ft.call(this,Jn.La,a)}_(Mc,ft);function ci(a){const f=As();It(f,new Mc(f))}Jn.STAT_EVENT="statevent";function Lc(a,f){ft.call(this,Jn.STAT_EVENT,a),this.stat=f}_(Lc,ft);function re(a){const f=As();It(f,new Lc(f,a))}Jn.Ma="timingevent";function Fc(a,f){ft.call(this,Jn.Ma,a),this.size=f}_(Fc,ft);function hi(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},f)}function fi(){this.g=!0}fi.prototype.xa=function(){this.g=!1};function L_(a,f,g,y,V,k){a.info(function(){if(a.g)if(k)for(var B="",dt=k.split("&"),zt=0;zt<dt.length;zt++){var ut=dt[zt].split("=");if(1<ut.length){var Xt=ut[0];ut=ut[1];var Jt=Xt.split("_");B=2<=Jt.length&&Jt[1]=="type"?B+(Xt+"="+ut+"&"):B+(Xt+"=redacted&")}}else B=null;else B=k;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+f+`
`+g+`
`+B})}function F_(a,f,g,y,V,k,B){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+f+`
`+g+`
`+k+" "+B})}function Tr(a,f,g,y){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+B_(a,g)+(y?" "+y:"")})}function U_(a,f){a.info(function(){return"TIMEOUT: "+f})}fi.prototype.info=function(){};function B_(a,f){if(!a.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(a=0;a<g.length;a++)if(Array.isArray(g[a])){var y=g[a];if(!(2>y.length)){var V=y[1];if(Array.isArray(V)&&!(1>V.length)){var k=V[0];if(k!="noop"&&k!="stop"&&k!="close")for(var B=1;B<V.length;B++)V[B]=""}}}}return Pa(g)}catch{return f}}var Is={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Uc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ka;function Rs(){}_(Rs,Va),Rs.prototype.g=function(){return new XMLHttpRequest},Rs.prototype.i=function(){return{}},ka=new Rs;function Sn(a,f,g,y){this.j=a,this.i=f,this.l=g,this.R=y||1,this.U=new je(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bc}function Bc(){this.i=null,this.g="",this.h=!1}var $c={},Oa={};function Ma(a,f,g){a.L=1,a.v=Cs(an(f)),a.m=g,a.P=!0,qc(a,null)}function qc(a,f){a.F=Date.now(),Ss(a),a.A=an(a.v);var g=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),nh(g.i,"t",y),a.C=0,g=a.j.J,a.h=new Bc,a.g=wh(a.j,g?f:null,!a.m),0<a.O&&(a.M=new ke(p(a.Y,a,a.g),a.O)),f=a.U,g=a.g,y=a.ca;var V="readystatechange";Array.isArray(V)||(V&&(Vc[0]=V.toString()),V=Vc);for(var k=0;k<V.length;k++){var B=K(g,V[k],y||f.handleEvent,!1,f.h||f);if(!B)break;f.g[B.key]=B}f=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),ci(),L_(a.i,a.u,a.A,a.l,a.R,a.m)}Sn.prototype.ca=function(a){a=a.target;const f=this.M;f&&un(a)==3?f.j():this.Y(a)},Sn.prototype.Y=function(a){try{if(a==this.g)t:{const Jt=un(this.g);var f=this.g.Ba();const Rr=this.g.Z();if(!(3>Jt)&&(Jt!=3||this.g&&(this.h.h||this.g.oa()||lh(this.g)))){this.J||Jt!=4||f==7||(f==8||0>=Rr?ci(3):ci(2)),La(this);var g=this.g.Z();this.X=g;e:if(jc(this)){var y=lh(this.g);a="";var V=y.length,k=un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Yn(this),di(this);var B="";break e}this.h.i=new u.TextDecoder}for(f=0;f<V;f++)this.h.h=!0,a+=this.h.i.decode(y[f],{stream:!(k&&f==V-1)});y.length=0,this.h.g+=a,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=g==200,F_(this.i,this.u,this.A,this.l,this.R,Jt,g),this.o){if(this.T&&!this.K){e:{if(this.g){var dt,zt=this.g;if((dt=zt.g?zt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(dt)){var ut=dt;break e}}ut=null}if(g=ut)Tr(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fa(this,g);else{this.o=!1,this.s=3,re(12),Yn(this),di(this);break t}}if(this.P){g=!0;let Oe;for(;!this.J&&this.C<B.length;)if(Oe=$_(this,B),Oe==Oa){Jt==4&&(this.s=4,re(14),g=!1),Tr(this.i,this.l,null,"[Incomplete Response]");break}else if(Oe==$c){this.s=4,re(15),Tr(this.i,this.l,B,"[Invalid Chunk]"),g=!1;break}else Tr(this.i,this.l,Oe,null),Fa(this,Oe);if(jc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jt!=4||B.length!=0||this.h.h||(this.s=1,re(16),g=!1),this.o=this.o&&g,!g)Tr(this.i,this.l,B,"[Invalid Chunked Response]"),Yn(this),di(this);else if(0<B.length&&!this.W){this.W=!0;var Xt=this.j;Xt.g==this&&Xt.ba&&!Xt.M&&(Xt.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),za(Xt),Xt.M=!0,re(11))}}else Tr(this.i,this.l,B,null),Fa(this,B);Jt==4&&Yn(this),this.o&&!this.J&&(Jt==4?mh(this.j,this):(this.o=!1,Ss(this)))}else iy(this.g),g==400&&0<B.indexOf("Unknown SID")?(this.s=3,re(12)):(this.s=0,re(13)),Yn(this),di(this)}}}catch{}finally{}};function jc(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function $_(a,f){var g=a.C,y=f.indexOf(`
`,g);return y==-1?Oa:(g=Number(f.substring(g,y)),isNaN(g)?$c:(y+=1,y+g>f.length?Oa:(f=f.slice(y,y+g),a.C=y+g,f)))}Sn.prototype.cancel=function(){this.J=!0,Yn(this)};function Ss(a){a.S=Date.now()+a.I,zc(a,a.I)}function zc(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=hi(p(a.ba,a),f)}function La(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Sn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(U_(this.i,this.A),this.L!=2&&(ci(),re(17)),Yn(this),this.s=2,di(this)):zc(this,this.S-a)};function di(a){a.j.G==0||a.J||mh(a.j,a)}function Yn(a){La(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,Nc(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function Fa(a,f){try{var g=a.j;if(g.G!=0&&(g.g==a||Ua(g.h,a))){if(!a.K&&Ua(g.h,a)&&g.G==3){try{var y=g.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){t:if(!g.u){if(g.g)if(g.g.F+3e3<a.F)Os(g),Ds(g);else break t;ja(g),re(18)}}else g.za=V[1],0<g.za-g.T&&37500>V[2]&&g.F&&g.v==0&&!g.C&&(g.C=hi(p(g.Za,g),6e3));if(1>=Wc(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else tr(g,11)}else if((a.K||g.g==a)&&Os(g),!b(f))for(V=g.Da.g.parse(f),f=0;f<V.length;f++){let ut=V[f];if(g.T=ut[0],ut=ut[1],g.G==2)if(ut[0]=="c"){g.K=ut[1],g.ia=ut[2];const Xt=ut[3];Xt!=null&&(g.la=Xt,g.j.info("VER="+g.la));const Jt=ut[4];Jt!=null&&(g.Aa=Jt,g.j.info("SVER="+g.Aa));const Rr=ut[5];Rr!=null&&typeof Rr=="number"&&0<Rr&&(y=1.5*Rr,g.L=y,g.j.info("backChannelRequestTimeoutMs_="+y)),y=g;const Oe=a.g;if(Oe){const Ls=Oe.g?Oe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ls){var k=y.h;k.g||Ls.indexOf("spdy")==-1&&Ls.indexOf("quic")==-1&&Ls.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(Ba(k,k.h),k.h=null))}if(y.D){const Ha=Oe.g?Oe.g.getResponseHeader("X-HTTP-Session-Id"):null;Ha&&(y.ya=Ha,yt(y.I,y.D,Ha))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-a.F,g.j.info("Handshake RTT: "+g.R+"ms")),y=g;var B=a;if(y.qa=vh(y,y.J?y.ia:null,y.W),B.K){Kc(y.h,B);var dt=B,zt=y.L;zt&&(dt.I=zt),dt.B&&(La(dt),Ss(dt)),y.g=B}else ph(y);0<g.i.length&&ks(g)}else ut[0]!="stop"&&ut[0]!="close"||tr(g,7);else g.G==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?tr(g,7):qa(g):ut[0]!="noop"&&g.l&&g.l.ta(ut),g.v=0)}}ci(4)}catch{}}var q_=class{constructor(a,f){this.g=a,this.map=f}};function Hc(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gc(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Wc(a){return a.h?1:a.g?a.g.size:0}function Ua(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function Ba(a,f){a.g?a.g.add(f):a.h=f}function Kc(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}Hc.prototype.cancel=function(){if(this.i=Qc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Qc(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const g of a.g.values())f=f.concat(g.D);return f}return E(a.i)}function j_(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var f=[],g=a.length,y=0;y<g;y++)f.push(a[y]);return f}f=[],g=0;for(y in a)f[g++]=a[y];return f}function z_(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var f=[];a=a.length;for(var g=0;g<a;g++)f.push(g);return f}f=[],g=0;for(const y in a)f[g++]=y;return f}}}function Xc(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var g=z_(a),y=j_(a),V=y.length,k=0;k<V;k++)f.call(void 0,y[k],g&&g[k],a)}var Jc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function H_(a,f){if(a){a=a.split("&");for(var g=0;g<a.length;g++){var y=a[g].indexOf("="),V=null;if(0<=y){var k=a[g].substring(0,y);V=a[g].substring(y+1)}else k=a[g];f(k,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Zn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Zn){this.h=a.h,bs(this,a.j),this.o=a.o,this.g=a.g,xs(this,a.s),this.l=a.l;var f=a.i,g=new mi;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),Yc(this,g),this.m=a.m}else a&&(f=String(a).match(Jc))?(this.h=!1,bs(this,f[1]||"",!0),this.o=pi(f[2]||""),this.g=pi(f[3]||"",!0),xs(this,f[4]),this.l=pi(f[5]||"",!0),Yc(this,f[6]||"",!0),this.m=pi(f[7]||"")):(this.h=!1,this.i=new mi(null,this.h))}Zn.prototype.toString=function(){var a=[],f=this.j;f&&a.push(gi(f,Zc,!0),":");var g=this.g;return(g||f=="file")&&(a.push("//"),(f=this.o)&&a.push(gi(f,Zc,!0),"@"),a.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&a.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&a.push("/"),a.push(gi(g,g.charAt(0)=="/"?K_:W_,!0))),(g=this.i.toString())&&a.push("?",g),(g=this.m)&&a.push("#",gi(g,X_)),a.join("")};function an(a){return new Zn(a)}function bs(a,f,g){a.j=g?pi(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function xs(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function Yc(a,f,g){f instanceof mi?(a.i=f,J_(a.i,a.h)):(g||(f=gi(f,Q_)),a.i=new mi(f,a.h))}function yt(a,f,g){a.i.set(f,g)}function Cs(a){return yt(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function pi(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function gi(a,f,g){return typeof a=="string"?(a=encodeURI(a).replace(f,G_),g&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function G_(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Zc=/[#\/\?@]/g,W_=/[#\?:]/g,K_=/[#\?]/g,Q_=/[#\?@]/g,X_=/#/g;function mi(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function bn(a){a.g||(a.g=new Map,a.h=0,a.i&&H_(a.i,function(f,g){a.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}e=mi.prototype,e.add=function(a,f){bn(this),this.i=null,a=Ar(this,a);var g=this.g.get(a);return g||this.g.set(a,g=[]),g.push(f),this.h+=1,this};function th(a,f){bn(a),f=Ar(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function eh(a,f){return bn(a),f=Ar(a,f),a.g.has(f)}e.forEach=function(a,f){bn(this),this.g.forEach(function(g,y){g.forEach(function(V){a.call(f,V,y,this)},this)},this)},e.na=function(){bn(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let y=0;y<f.length;y++){const V=a[y];for(let k=0;k<V.length;k++)g.push(f[y])}return g},e.V=function(a){bn(this);let f=[];if(typeof a=="string")eh(this,a)&&(f=f.concat(this.g.get(Ar(this,a))));else{a=Array.from(this.g.values());for(let g=0;g<a.length;g++)f=f.concat(a[g])}return f},e.set=function(a,f){return bn(this),this.i=null,a=Ar(this,a),eh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},e.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function nh(a,f,g){th(a,f),0<g.length&&(a.i=null,a.g.set(Ar(a,f),E(g)),a.h+=g.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var y=f[g];const k=encodeURIComponent(String(y)),B=this.V(y);for(y=0;y<B.length;y++){var V=k;B[y]!==""&&(V+="="+encodeURIComponent(String(B[y]))),a.push(V)}}return this.i=a.join("&")};function Ar(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function J_(a,f){f&&!a.j&&(bn(a),a.i=null,a.g.forEach(function(g,y){var V=y.toLowerCase();y!=V&&(th(this,y),nh(this,V,g))},a)),a.j=f}function Y_(a,f){const g=new fi;if(u.Image){const y=new Image;y.onload=m(xn,g,"TestLoadImage: loaded",!0,f,y),y.onerror=m(xn,g,"TestLoadImage: error",!1,f,y),y.onabort=m(xn,g,"TestLoadImage: abort",!1,f,y),y.ontimeout=m(xn,g,"TestLoadImage: timeout",!1,f,y),u.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else f(!1)}function Z_(a,f){const g=new fi,y=new AbortController,V=setTimeout(()=>{y.abort(),xn(g,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:y.signal}).then(k=>{clearTimeout(V),k.ok?xn(g,"TestPingServer: ok",!0,f):xn(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),xn(g,"TestPingServer: error",!1,f)})}function xn(a,f,g,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(g)}catch{}}function ty(){this.g=new M_}function ey(a,f,g){const y=g||"";try{Xc(a,function(V,k){let B=V;c(V)&&(B=Pa(V)),f.push(y+k+"="+encodeURIComponent(B))})}catch(V){throw f.push(y+"type="+encodeURIComponent("_badmap")),V}}function Ps(a){this.l=a.Ub||null,this.j=a.eb||!1}_(Ps,Va),Ps.prototype.g=function(){return new Vs(this.l,this.j)},Ps.prototype.i=function(a){return function(){return a}}({});function Vs(a,f){At.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Vs,At),e=Vs.prototype,e.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,yi(this)},e.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||u).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_i(this)),this.readyState=0},e.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,yi(this)),this.g&&(this.readyState=3,yi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rh(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function rh(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}e.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?_i(this):yi(this),this.readyState==3&&rh(this)}},e.Ra=function(a){this.g&&(this.response=this.responseText=a,_i(this))},e.Qa=function(a){this.g&&(this.response=a,_i(this))},e.ga=function(){this.g&&_i(this)};function _i(a){a.readyState=4,a.l=null,a.j=null,a.v=null,yi(a)}e.setRequestHeader=function(a,f){this.u.append(a,f)},e.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,a.push(g[0]+": "+g[1]),g=f.next();return a.join(`\r
`)};function yi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Vs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function ih(a){let f="";return U(a,function(g,y){f+=y,f+=":",f+=g,f+=`\r
`}),f}function $a(a,f,g){t:{for(y in g){var y=!1;break t}y=!0}y||(g=ih(g),typeof a=="string"?g!=null&&encodeURIComponent(String(g)):yt(a,f,g))}function bt(a){At.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(bt,At);var ny=/^https?$/i,ry=["POST","PUT"];e=bt.prototype,e.Ha=function(a){this.J=a},e.ea=function(a,f,g,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ka.g(),this.v=this.o?Dc(this.o):Dc(ka),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(k){sh(this,k);return}if(a=g||"",g=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)g.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const k of y.keys())g.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(g.keys()).find(k=>k.toLowerCase()=="content-type"),V=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(ry,f,void 0))||y||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,B]of g)this.g.setRequestHeader(k,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{uh(this),this.u=!0,this.g.send(a),this.u=!1}catch(k){sh(this,k)}};function sh(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,oh(a),Ns(a)}function oh(a){a.A||(a.A=!0,It(a,"complete"),It(a,"error"))}e.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,It(this,"complete"),It(this,"abort"),Ns(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ns(this,!0)),bt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?ah(this):this.bb())},e.bb=function(){ah(this)};function ah(a){if(a.h&&typeof o<"u"&&(!a.v[1]||un(a)!=4||a.Z()!=2)){if(a.u&&un(a)==4)De(a.Ea,0,a);else if(It(a,"readystatechange"),un(a)==4){a.h=!1;try{const B=a.Z();t:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var g;if(!(g=f)){var y;if(y=B===0){var V=String(a.D).match(Jc)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),y=!ny.test(V?V.toLowerCase():"")}g=y}if(g)It(a,"complete"),It(a,"success");else{a.m=6;try{var k=2<un(a)?a.g.statusText:""}catch{k=""}a.l=k+" ["+a.Z()+"]",oh(a)}}finally{Ns(a)}}}}function Ns(a,f){if(a.g){uh(a);const g=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||It(a,"ready");try{g.onreadystatechange=y}catch{}}}function uh(a){a.I&&(u.clearTimeout(a.I),a.I=null)}e.isActive=function(){return!!this.g};function un(a){return a.g?a.g.readyState:0}e.Z=function(){try{return 2<un(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),O_(f)}};function lh(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function iy(a){const f={};a=(a.g&&2<=un(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(b(a[y]))continue;var g=R(a[y]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const k=f[V]||[];f[V]=k,k.push(g)}I(f,function(y){return y.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function vi(a,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[a]||f}function ch(a){this.Aa=0,this.i=[],this.j=new fi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=vi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=vi("baseRetryDelayMs",5e3,a),this.cb=vi("retryDelaySeedMs",1e4,a),this.Wa=vi("forwardChannelMaxRetries",2,a),this.wa=vi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Hc(a&&a.concurrentRequestLimit),this.Da=new ty,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=ch.prototype,e.la=8,e.G=1,e.connect=function(a,f,g,y){re(0),this.W=a,this.H=f||{},g&&y!==void 0&&(this.H.OSID=g,this.H.OAID=y),this.F=this.X,this.I=vh(this,null,this.W),ks(this)};function qa(a){if(hh(a),a.G==3){var f=a.U++,g=an(a.I);if(yt(g,"SID",a.K),yt(g,"RID",f),yt(g,"TYPE","terminate"),wi(a,g),f=new Sn(a,a.j,f),f.L=2,f.v=Cs(an(g)),g=!1,u.navigator&&u.navigator.sendBeacon)try{g=u.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&u.Image&&(new Image().src=f.v,g=!0),g||(f.g=wh(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Ss(f)}yh(a)}function Ds(a){a.g&&(za(a),a.g.cancel(),a.g=null)}function hh(a){Ds(a),a.u&&(u.clearTimeout(a.u),a.u=null),Os(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function ks(a){if(!Gc(a.h)&&!a.s){a.s=!0;var f=a.Ga;ht||$e(),mt||(ht(),mt=!0),Lt.add(f,a),a.B=0}}function sy(a,f){return Wc(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=hi(p(a.Ga,a,f),_h(a,a.B)),a.B++,!0)}e.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new Sn(this,this.j,a);let k=this.o;if(this.S&&(k?(k=w(k),S(k,this.S)):k=this.S),this.m!==null||this.O||(V.H=k,k=null),this.P)t:{for(var f=0,g=0;g<this.i.length;g++){e:{var y=this.i[g];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break e}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=g;break t}if(f===4096||g===this.i.length-1){f=g+1;break t}}f=1e3}else f=1e3;f=dh(this,V,f),g=an(this.I),yt(g,"RID",a),yt(g,"CVER",22),this.D&&yt(g,"X-HTTP-Session-Id",this.D),wi(this,g),k&&(this.O?f="headers="+encodeURIComponent(String(ih(k)))+"&"+f:this.m&&$a(g,this.m,k)),Ba(this.h,V),this.Ua&&yt(g,"TYPE","init"),this.P?(yt(g,"$req",f),yt(g,"SID","null"),V.T=!0,Ma(V,g,null)):Ma(V,g,f),this.G=2}}else this.G==3&&(a?fh(this,a):this.i.length==0||Gc(this.h)||fh(this))};function fh(a,f){var g;f?g=f.l:g=a.U++;const y=an(a.I);yt(y,"SID",a.K),yt(y,"RID",g),yt(y,"AID",a.T),wi(a,y),a.m&&a.o&&$a(y,a.m,a.o),g=new Sn(a,a.j,g,a.B+1),a.m===null&&(g.H=a.o),f&&(a.i=f.D.concat(a.i)),f=dh(a,g,1e3),g.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ba(a.h,g),Ma(g,y,f)}function wi(a,f){a.H&&U(a.H,function(g,y){yt(f,y,g)}),a.l&&Xc({},function(g,y){yt(f,y,g)})}function dh(a,f,g){g=Math.min(a.i.length,g);var y=a.l?p(a.l.Na,a.l,a):null;t:{var V=a.i;let k=-1;for(;;){const B=["count="+g];k==-1?0<g?(k=V[0].g,B.push("ofs="+k)):k=0:B.push("ofs="+k);let dt=!0;for(let zt=0;zt<g;zt++){let ut=V[zt].g;const Xt=V[zt].map;if(ut-=k,0>ut)k=Math.max(0,V[zt].g-100),dt=!1;else try{ey(Xt,B,"req"+ut+"_")}catch{y&&y(Xt)}}if(dt){y=B.join("&");break t}}}return a=a.i.splice(0,g),f.D=a,y}function ph(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;ht||$e(),mt||(ht(),mt=!0),Lt.add(f,a),a.v=0}}function ja(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=hi(p(a.Fa,a),_h(a,a.v)),a.v++,!0)}e.Fa=function(){if(this.u=null,gh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=hi(p(this.ab,this),a)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,re(10),Ds(this),gh(this))};function za(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function gh(a){a.g=new Sn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=an(a.qa);yt(f,"RID","rpc"),yt(f,"SID",a.K),yt(f,"AID",a.T),yt(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&yt(f,"TO",a.ja),yt(f,"TYPE","xmlhttp"),wi(a,f),a.m&&a.o&&$a(f,a.m,a.o),a.L&&(a.g.I=a.L);var g=a.g;a=a.ia,g.L=1,g.v=Cs(an(f)),g.m=null,g.P=!0,qc(g,a)}e.Za=function(){this.C!=null&&(this.C=null,Ds(this),ja(this),re(19))};function Os(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function mh(a,f){var g=null;if(a.g==f){Os(a),za(a),a.g=null;var y=2}else if(Ua(a.h,f))g=f.D,Kc(a.h,f),y=1;else return;if(a.G!=0){if(f.o)if(y==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var V=a.B;y=As(),It(y,new Fc(y,g)),ks(a)}else ph(a);else if(V=f.s,V==3||V==0&&0<f.X||!(y==1&&sy(a,f)||y==2&&ja(a)))switch(g&&0<g.length&&(f=a.h,f.i=f.i.concat(g)),V){case 1:tr(a,5);break;case 4:tr(a,10);break;case 3:tr(a,6);break;default:tr(a,2)}}}function _h(a,f){let g=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(g*=2),g*f}function tr(a,f){if(a.j.info("Error code "+f),f==2){var g=p(a.fb,a),y=a.Xa;const V=!y;y=new Zn(y||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||bs(y,"https"),Cs(y),V?Y_(y.toString(),g):Z_(y.toString(),g)}else re(2);a.G=0,a.l&&a.l.sa(f),yh(a),hh(a)}e.fb=function(a){a?(this.j.info("Successfully pinged google.com"),re(2)):(this.j.info("Failed to ping google.com"),re(1))};function yh(a){if(a.G=0,a.ka=[],a.l){const f=Qc(a.h);(f.length!=0||a.i.length!=0)&&(v(a.ka,f),v(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function vh(a,f,g){var y=g instanceof Zn?an(g):new Zn(g);if(y.g!="")f&&(y.g=f+"."+y.g),xs(y,y.s);else{var V=u.location;y=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;var k=new Zn(null);y&&bs(k,y),f&&(k.g=f),V&&xs(k,V),g&&(k.l=g),y=k}return g=a.D,f=a.ya,g&&f&&yt(y,g,f),yt(y,"VER",a.la),wi(a,y),y}function wh(a,f,g){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new bt(new Ps({eb:g})):new bt(a.pa),f.Ha(a.J),f}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Eh(){}e=Eh.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Ms(){}Ms.prototype.g=function(a,f){return new ve(a,f)};function ve(a,f){At.call(this),this.g=new ch(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!b(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!b(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Ir(this)}_(ve,At),ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ve.prototype.close=function(){qa(this.g)},ve.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var g={};g.__data__=a,a=g}else this.u&&(g={},g.__data__=Pa(a),a=g);f.i.push(new q_(f.Ya++,a)),f.G==3&&ks(f)},ve.prototype.N=function(){this.g.l=null,delete this.j,qa(this.g),delete this.g,ve.aa.N.call(this)};function Th(a){Na.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){t:{for(const g in f){a=g;break t}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}_(Th,Na);function Ah(){Da.call(this),this.status=1}_(Ah,Da);function Ir(a){this.g=a}_(Ir,Eh),Ir.prototype.ua=function(){It(this.g,"a")},Ir.prototype.ta=function(a){It(this.g,new Th(a))},Ir.prototype.sa=function(a){It(this.g,new Ah)},Ir.prototype.ra=function(){It(this.g,"b")},Ms.prototype.createWebChannel=Ms.prototype.g,ve.prototype.send=ve.prototype.o,ve.prototype.open=ve.prototype.m,ve.prototype.close=ve.prototype.close,im=function(){return new Ms},rm=function(){return As()},nm=Jn,Yu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Is.NO_ERROR=0,Is.TIMEOUT=8,Is.HTTP_ERROR=6,oo=Is,Uc.COMPLETE="complete",em=Uc,kc.EventType=li,li.OPEN="a",li.CLOSE="b",li.ERROR="c",li.MESSAGE="d",At.prototype.listen=At.prototype.K,Di=kc,bt.prototype.listenOnce=bt.prototype.L,bt.prototype.getLastError=bt.prototype.Ka,bt.prototype.getLastErrorCode=bt.prototype.Ba,bt.prototype.getStatus=bt.prototype.Z,bt.prototype.getResponseJson=bt.prototype.Oa,bt.prototype.getResponseText=bt.prototype.oa,bt.prototype.send=bt.prototype.ea,bt.prototype.setWithCredentials=bt.prototype.Ha,tm=bt}).apply(typeof Ws<"u"?Ws:typeof self<"u"?self:typeof window<"u"?window:{});const Gf="@firebase/firestore",Wf="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}te.UNAUTHENTICATED=new te(null),te.GOOGLE_CREDENTIALS=new te("google-credentials-uid"),te.FIRST_PARTY=new te("first-party-uid"),te.MOCK_USER=new te("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ni="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr=new Wg("@firebase/firestore");function Pr(){return pr.logLevel}function z(e,...t){if(pr.logLevel<=st.DEBUG){const n=t.map(Gl);pr.debug(`Firestore (${ni}): ${e}`,...n)}}function En(e,...t){if(pr.logLevel<=st.ERROR){const n=t.map(Gl);pr.error(`Firestore (${ni}): ${e}`,...n)}}function Un(e,...t){if(pr.logLevel<=st.WARN){const n=t.map(Gl);pr.warn(`Firestore (${ni}): ${e}`,...n)}}function Gl(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,sm(e,r,n)}function sm(e,t,n){let r=`FIRESTORE (${ni}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw En(r),new Error(r)}function ct(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||sm(t,i,r)}function X(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends ei{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class yR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(te.UNAUTHENTICATED))}shutdown(){}}class vR{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class wR{constructor(t){this.t=t,this.currentUser=te.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ct(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new mn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mn,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},u=l=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mn)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ct(typeof r.accessToken=="string",31837,{l:r}),new om(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ct(t===null||typeof t=="string",2055,{h:t}),new te(t)}}class ER{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=te.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class TR{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new ER(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(te.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Kf{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class AR{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,eR(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ct(this.o===void 0,3512);const r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Kf(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ct(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Kf(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function am(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=IR(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%62))}return r}}function et(e,t){return e<t?-1:e>t?1:0}function Zu(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return et(r,i);{const s=am(),o=RR(s.encode(Qf(e,n)),s.encode(Qf(t,n)));return o!==0?o:et(r,i)}}n+=r>65535?2:1}return et(e.length,t.length)}function Qf(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function RR(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return et(e[n],t[n]);return et(e.length,t.length)}function Hr(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xf="__name__";class He{constructor(t,n,r){n===void 0?n=0:n>t.length&&W(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&W(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return He.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof He?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const s=He.compareSegments(t.get(i),n.get(i));if(s!==0)return s}return et(t.length,n.length)}static compareSegments(t,n){const r=He.isNumericId(t),i=He.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?He.extractNumericId(t).compare(He.extractNumericId(n)):Zu(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return On.fromString(t.substring(4,t.length-2))}}class _t extends He{construct(t,n,r){return new _t(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new q(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new _t(n)}static emptyPath(){return new _t([])}}const SR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wt extends He{construct(t,n,r){return new Wt(t,n,r)}static isValidIdentifier(t){return SR.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Xf}static keyField(){return new Wt([Xf])}static fromServerFormat(t){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new q(O.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new q(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=l,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new q(O.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wt(n)}static emptyPath(){return new Wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(t){this.path=t}static fromPath(t){return new G(_t.fromString(t))}static fromName(t){return new G(_t.fromString(t).popFirst(5))}static empty(){return new G(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&_t.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return _t.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new G(new _t(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function um(e,t,n){if(!n)throw new q(O.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function bR(e,t,n,r){if(t===!0&&r===!0)throw new q(O.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Jf(e){if(!G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Yf(e){if(G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function lm(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function da(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":W(12329,{type:typeof e})}function Tn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new q(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=da(e);throw new q(O.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function xR(e,t){if(t<=0)throw new q(O.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(e,t){const n={typeString:e};return t&&(n.value=t),n}function gs(e,t){if(!lm(e))throw new q(O.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new q(O.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf=-62135596800,td=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(t){return vt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*td);return new vt(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<Zf)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/td}_compareTo(t){return this.seconds===t.seconds?et(this.nanoseconds,t.nanoseconds):et(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(gs(t,vt._jsonSchema))return new vt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Zf;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Mt("string",vt._jsonSchemaVersion),seconds:Mt("number"),nanoseconds:Mt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{static fromTimestamp(t){return new Q(t)}static min(){return new Q(new vt(0,0))}static max(){return new Q(new vt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=-1;function CR(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Q.fromTimestamp(r===1e9?new vt(n+1,0):new vt(n,r));return new Bn(i,G.empty(),t)}function PR(e){return new Bn(e.readTime,e.key,rs)}class Bn{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new Bn(Q.min(),G.empty(),rs)}static max(){return new Bn(Q.max(),G.empty(),rs)}}function VR(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=G.comparator(e.documentKey,t.documentKey),n!==0?n:et(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ri(e){if(e.code!==O.FAILED_PRECONDITION||e.message!==NR)throw e;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&W(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):L.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):L.reject(n)}static resolve(t){return new L((n,r)=>{n(t)})}static reject(t){return new L((n,r)=>{r(t)})}static waitFor(t){return new L((n,r)=>{let i=0,s=0,o=!1;t.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(t){let n=L.resolve(!1);for(const r of t)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new L((r,i)=>{const s=t.length,o=new Array(s);let u=0;for(let l=0;l<s;l++){const c=l;n(t[c]).next(h=>{o[c]=h,++u,u===s&&r(o)},h=>i(h))}})}static doWhile(t,n){return new L((r,i)=>{const s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}}function kR(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ii(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}pa.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kl=-1;function ga(e){return e==null}function $o(e){return e===0&&1/e==-1/0}function OR(e){return typeof e=="number"&&Number.isInteger(e)&&!$o(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="";function MR(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ed(t)),t=LR(e.get(n),t);return ed(t)}function LR(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const s=e.charAt(i);switch(s){case"\0":n+="";break;case cm:n+="";break;default:n+=s}}return n}function ed(e){return e+cm+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Wn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function hm(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(t,n){this.comparator=t,this.root=n||Gt.EMPTY}insert(t,n){return new Rt(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Gt.BLACK,null,null))}remove(t){return new Rt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Gt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Ks(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Ks(this.root,t,this.comparator,!1)}getReverseIterator(){return new Ks(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Ks(this.root,t,this.comparator,!0)}}class Ks{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Gt{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??Gt.RED,this.left=i??Gt.EMPTY,this.right=s??Gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new Gt(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Gt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return Gt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw W(43730,{key:this.key,value:this.value});if(this.right.isRed())throw W(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw W(27949);return t+(this.isRed()?0:1)}}Gt.EMPTY=null,Gt.RED=!0,Gt.BLACK=!1;Gt.EMPTY=new class{constructor(){this.size=0}get key(){throw W(57766)}get value(){throw W(16141)}get color(){throw W(16727)}get left(){throw W(29726)}get right(){throw W(36894)}copy(t,n,r,i,s){return this}insert(t,n,r){return new Gt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(t){this.comparator=t,this.data=new Rt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new rd(this.data.getIterator())}getIteratorFrom(t){return new rd(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Bt)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Bt(this.comparator);return n.data=t,n}}class rd{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(t){this.fields=t,t.sort(Wt.comparator)}static empty(){return new Te([])}unionWith(t){let n=new Bt(Wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Te(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Hr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new fm("Invalid base64 string: "+s):s}}(t);return new Kt(n)}static fromUint8Array(t){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new Kt(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return et(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Kt.EMPTY_BYTE_STRING=new Kt("");const FR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $n(e){if(ct(!!e,39018),typeof e=="string"){let t=0;const n=FR.exec(e);if(ct(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Ct(e.seconds),nanos:Ct(e.nanos)}}function Ct(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function qn(e){return typeof e=="string"?Kt.fromBase64String(e):Kt.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm="server_timestamp",pm="__type__",gm="__previous_value__",mm="__local_write_time__";function Ql(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[pm])===null||n===void 0?void 0:n.stringValue)===dm}function ma(e){const t=e.mapValue.fields[gm];return Ql(t)?ma(t):t}function is(e){const t=$n(e.mapValue.fields[mm].timestampValue);return new vt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(t,n,r,i,s,o,u,l,c,h){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const qo="(default)";class ss{constructor(t,n){this.projectId=t,this.database=n||qo}static empty(){return new ss("","")}get isDefaultDatabase(){return this.database===qo}isEqual(t){return t instanceof ss&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="__type__",BR="__max__",Qs={mapValue:{}},ym="__vector__",jo="value";function jn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ql(e)?4:qR(e)?9007199254740991:$R(e)?10:11:W(28295,{value:e})}function sn(e,t){if(e===t)return!0;const n=jn(e);if(n!==jn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return is(e).isEqual(is(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=$n(i.timestampValue),u=$n(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return qn(i.bytesValue).isEqual(qn(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return Ct(i.geoPointValue.latitude)===Ct(s.geoPointValue.latitude)&&Ct(i.geoPointValue.longitude)===Ct(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ct(i.integerValue)===Ct(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Ct(i.doubleValue),u=Ct(s.doubleValue);return o===u?$o(o)===$o(u):isNaN(o)&&isNaN(u)}return!1}(e,t);case 9:return Hr(e.arrayValue.values||[],t.arrayValue.values||[],sn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(nd(o)!==nd(u))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(u[l]===void 0||!sn(o[l],u[l])))return!1;return!0}(e,t);default:return W(52216,{left:e})}}function os(e,t){return(e.values||[]).find(n=>sn(n,t))!==void 0}function Gr(e,t){if(e===t)return 0;const n=jn(e),r=jn(t);if(n!==r)return et(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return et(e.booleanValue,t.booleanValue);case 2:return function(s,o){const u=Ct(s.integerValue||s.doubleValue),l=Ct(o.integerValue||o.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(e,t);case 3:return id(e.timestampValue,t.timestampValue);case 4:return id(is(e),is(t));case 5:return Zu(e.stringValue,t.stringValue);case 6:return function(s,o){const u=qn(s),l=qn(o);return u.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const u=s.split("/"),l=o.split("/");for(let c=0;c<u.length&&c<l.length;c++){const h=et(u[c],l[c]);if(h!==0)return h}return et(u.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const u=et(Ct(s.latitude),Ct(o.latitude));return u!==0?u:et(Ct(s.longitude),Ct(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return sd(e.arrayValue,t.arrayValue);case 10:return function(s,o){var u,l,c,h;const d=s.fields||{},p=o.fields||{},m=(u=d[jo])===null||u===void 0?void 0:u.arrayValue,_=(l=p[jo])===null||l===void 0?void 0:l.arrayValue,E=et(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:sd(m,_)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===Qs.mapValue&&o===Qs.mapValue)return 0;if(s===Qs.mapValue)return 1;if(o===Qs.mapValue)return-1;const u=s.fields||{},l=Object.keys(u),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const p=Zu(l[d],h[d]);if(p!==0)return p;const m=Gr(u[l[d]],c[h[d]]);if(m!==0)return m}return et(l.length,h.length)}(e.mapValue,t.mapValue);default:throw W(23264,{le:n})}}function id(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return et(e,t);const n=$n(e),r=$n(t),i=et(n.seconds,r.seconds);return i!==0?i:et(n.nanos,r.nanos)}function sd(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Gr(n[i],r[i]);if(s)return s}return et(n.length,r.length)}function Wr(e){return tl(e)}function tl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=$n(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return qn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return G.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=tl(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${tl(n.fields[o])}`;return i+"}"}(e.mapValue):W(61005,{value:e})}function ao(e){switch(jn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ma(e);return t?16+ao(t):16;case 5:return 2*e.stringValue.length;case 6:return qn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+ao(s),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return Wn(r.fields,(s,o)=>{i+=s.length+ao(o)}),i}(e.mapValue);default:throw W(13486,{value:e})}}function od(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function el(e){return!!e&&"integerValue"in e}function Xl(e){return!!e&&"arrayValue"in e}function ad(e){return!!e&&"nullValue"in e}function ud(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function uo(e){return!!e&&"mapValue"in e}function $R(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[_m])===null||n===void 0?void 0:n.stringValue)===ym}function Ui(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Wn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=Ui(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ui(e.arrayValue.values[n]);return t}return Object.assign({},e)}function qR(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===BR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(t){this.value=t}static empty(){return new he({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!uo(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ui(n)}setAll(t){let n=Wt.emptyPath(),r={},i=[];t.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=Ui(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){const n=this.field(t.popLast());uo(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return sn(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];uo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){Wn(n,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new he(Ui(this.value))}}function vm(e){const t=[];return Wn(e.fields,(n,r)=>{const i=new Wt([n]);if(uo(r)){const s=vm(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new Te(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(t,n,r,i,s,o,u){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(t){return new ee(t,0,Q.min(),Q.min(),Q.min(),he.empty(),0)}static newFoundDocument(t,n,r,i){return new ee(t,1,n,Q.min(),r,i,0)}static newNoDocument(t,n){return new ee(t,2,n,Q.min(),Q.min(),he.empty(),0)}static newUnknownDocument(t,n){return new ee(t,3,n,Q.min(),Q.min(),he.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=he.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=he.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof ee&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ee(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(t,n){this.position=t,this.inclusive=n}}function ld(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=Gr(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function cd(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!sn(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(t,n="asc"){this.field=t,this.dir=n}}function jR(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{}class Ot extends wm{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new HR(t,n,r):n==="array-contains"?new KR(t,r):n==="in"?new QR(t,r):n==="not-in"?new XR(t,r):n==="array-contains-any"?new JR(t,r):new Ot(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new GR(t,r):new WR(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Gr(n,this.value)):n!==null&&jn(this.value)===jn(n)&&this.matchesComparison(Gr(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fe extends wm{constructor(t,n){super(),this.filters=t,this.op=n,this.he=null}static create(t,n){return new Fe(t,n)}matches(t){return Em(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Em(e){return e.op==="and"}function Tm(e){return zR(e)&&Em(e)}function zR(e){for(const t of e.filters)if(t instanceof Fe)return!1;return!0}function nl(e){if(e instanceof Ot)return e.field.canonicalString()+e.op.toString()+Wr(e.value);if(Tm(e))return e.filters.map(t=>nl(t)).join(",");{const t=e.filters.map(n=>nl(n)).join(",");return`${e.op}(${t})`}}function Am(e,t){return e instanceof Ot?function(r,i){return i instanceof Ot&&r.op===i.op&&r.field.isEqual(i.field)&&sn(r.value,i.value)}(e,t):e instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&Am(o,i.filters[u]),!0):!1}(e,t):void W(19439)}function Im(e){return e instanceof Ot?function(n){return`${n.field.canonicalString()} ${n.op} ${Wr(n.value)}`}(e):e instanceof Fe?function(n){return n.op.toString()+" {"+n.getFilters().map(Im).join(" ,")+"}"}(e):"Filter"}class HR extends Ot{constructor(t,n,r){super(t,n,r),this.key=G.fromName(r.referenceValue)}matches(t){const n=G.comparator(t.key,this.key);return this.matchesComparison(n)}}class GR extends Ot{constructor(t,n){super(t,"in",n),this.keys=Rm("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class WR extends Ot{constructor(t,n){super(t,"not-in",n),this.keys=Rm("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function Rm(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class KR extends Ot{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return Xl(n)&&os(n.arrayValue,this.value)}}class QR extends Ot{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&os(this.value.arrayValue,n)}}class XR extends Ot{constructor(t,n){super(t,"not-in",n)}matches(t){if(os(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!os(this.value.arrayValue,n)}}class JR extends Ot{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!Xl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>os(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(t,n=null,r=[],i=[],s=null,o=null,u=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.Pe=null}}function hd(e,t=null,n=[],r=[],i=null,s=null,o=null){return new YR(e,t,n,r,i,s,o)}function Jl(e){const t=X(e);if(t.Pe===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>nl(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ga(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Wr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Wr(r)).join(",")),t.Pe=n}return t.Pe}function Yl(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!jR(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Am(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cd(e.startAt,t.startAt)&&cd(e.endAt,t.endAt)}function rl(e){return G.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(t,n=null,r=[],i=[],s=null,o="F",u=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function ZR(e,t,n,r,i,s,o,u){return new si(e,t,n,r,i,s,o,u)}function Zl(e){return new si(e)}function fd(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Sm(e){return e.collectionGroup!==null}function Bi(e){const t=X(e);if(t.Te===null){t.Te=[];const n=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Bt(Wt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(u=u.add(c.field))})}),u})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Te.push(new as(s,r))}),n.has(Wt.keyField().canonicalString())||t.Te.push(new as(Wt.keyField(),r))}return t.Te}function Je(e){const t=X(e);return t.Ie||(t.Ie=tS(t,Bi(e))),t.Ie}function tS(e,t){if(e.limitType==="F")return hd(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new as(i.field,s)});const n=e.endAt?new zo(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new zo(e.startAt.position,e.startAt.inclusive):null;return hd(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function il(e,t){const n=e.filters.concat([t]);return new si(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Ho(e,t,n){return new si(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function _a(e,t){return Yl(Je(e),Je(t))&&e.limitType===t.limitType}function bm(e){return`${Jl(Je(e))}|lt:${e.limitType}`}function Vr(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Im(i)).join(", ")}]`),ga(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Wr(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Wr(i)).join(",")),`Target(${r})`}(Je(e))}; limitType=${e.limitType})`}function ya(e,t){return t.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(const s of Bi(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,u,l){const c=ld(o,u,l);return o.inclusive?c<=0:c<0}(r.startAt,Bi(r),i)||r.endAt&&!function(o,u,l){const c=ld(o,u,l);return o.inclusive?c>=0:c>0}(r.endAt,Bi(r),i))}(e,t)}function eS(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function xm(e){return(t,n)=>{let r=!1;for(const i of Bi(e)){const s=nS(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function nS(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(s,o,u){const l=o.data.field(s),c=u.data.field(s);return l!==null&&c!==null?Gr(l,c):W(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return W(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Wn(this.inner,(n,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return hm(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=new Rt(G.comparator);function An(){return rS}const Cm=new Rt(G.comparator);function ki(...e){let t=Cm;for(const n of e)t=t.insert(n.key,n);return t}function Pm(e){let t=Cm;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function sr(){return $i()}function Vm(){return $i()}function $i(){return new yr(e=>e.toString(),(e,t)=>e.isEqual(t))}const iS=new Rt(G.comparator),sS=new Bt(G.comparator);function nt(...e){let t=sS;for(const n of e)t=t.add(n);return t}const oS=new Bt(et);function aS(){return oS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$o(t)?"-0":t}}function Nm(e){return{integerValue:""+e}}function uS(e,t){return OR(t)?Nm(t):tc(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(){this._=void 0}}function lS(e,t,n){return e instanceof Go?function(i,s){const o={fields:{[pm]:{stringValue:dm},[mm]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ql(s)&&(s=ma(s)),s&&(o.fields[gm]=s),{mapValue:o}}(n,t):e instanceof us?km(e,t):e instanceof ls?Om(e,t):function(i,s){const o=Dm(i,s),u=dd(o)+dd(i.Ee);return el(o)&&el(i.Ee)?Nm(u):tc(i.serializer,u)}(e,t)}function cS(e,t,n){return e instanceof us?km(e,t):e instanceof ls?Om(e,t):n}function Dm(e,t){return e instanceof Wo?function(r){return el(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}class Go extends va{}class us extends va{constructor(t){super(),this.elements=t}}function km(e,t){const n=Mm(t);for(const r of e.elements)n.some(i=>sn(i,r))||n.push(r);return{arrayValue:{values:n}}}class ls extends va{constructor(t){super(),this.elements=t}}function Om(e,t){let n=Mm(t);for(const r of e.elements)n=n.filter(i=>!sn(i,r));return{arrayValue:{values:n}}}class Wo extends va{constructor(t,n){super(),this.serializer=t,this.Ee=n}}function dd(e){return Ct(e.integerValue||e.doubleValue)}function Mm(e){return Xl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function hS(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof us&&i instanceof us||r instanceof ls&&i instanceof ls?Hr(r.elements,i.elements,sn):r instanceof Wo&&i instanceof Wo?sn(r.Ee,i.Ee):r instanceof Go&&i instanceof Go}(e.transform,t.transform)}class fS{constructor(t,n){this.version=t,this.transformResults=n}}class Ye{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Ye}static exists(t){return new Ye(void 0,t)}static updateTime(t){return new Ye(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function lo(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class wa{}function Lm(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Um(e.key,Ye.none()):new ms(e.key,e.data,Ye.none());{const n=e.data,r=he.empty();let i=new Bt(Wt.comparator);for(let s of t.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Kn(e.key,r,new Te(i.toArray()),Ye.none())}}function dS(e,t,n){e instanceof ms?function(i,s,o){const u=i.value.clone(),l=gd(i.fieldTransforms,s,o.transformResults);u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,n):e instanceof Kn?function(i,s,o){if(!lo(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=gd(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Fm(i)),l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function qi(e,t,n,r){return e instanceof ms?function(s,o,u,l){if(!lo(s.precondition,o))return u;const c=s.value.clone(),h=md(s.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(e,t,n,r):e instanceof Kn?function(s,o,u,l){if(!lo(s.precondition,o))return u;const c=md(s.fieldTransforms,l,o),h=o.data;return h.setAll(Fm(s)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,r):function(s,o,u){return lo(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(e,t,n)}function pS(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),s=Dm(r.transform,i||null);s!=null&&(n===null&&(n=he.empty()),n.set(r.field,s))}return n||null}function pd(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Hr(r,i,(s,o)=>hS(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ms extends wa{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Kn extends wa{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Fm(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function gd(e,t,n){const r=new Map;ct(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,u=t.data.field(s.field);r.set(s.field,cS(o,u,n[i]))}return r}function md(e,t,n){const r=new Map;for(const i of e){const s=i.transform,o=n.data.field(i.field);r.set(i.field,lS(s,o,t))}return r}class Um extends wa{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gS extends wa{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&dS(s,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=qi(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=qi(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=Vm();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const l=Lm(o,u);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),nt())}isEqual(t){return this.batchId===t.batchId&&Hr(this.mutations,t.mutations,(n,r)=>pd(n,r))&&Hr(this.baseMutations,t.baseMutations,(n,r)=>pd(n,r))}}class ec{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){ct(t.mutations.length===r.length,58842,{Ve:t.mutations.length,me:r.length});let i=function(){return iS}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new ec(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt,it;function vS(e){switch(e){case O.OK:return W(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return W(15467,{code:e})}}function Bm(e){if(e===void 0)return En("GRPC error has no .code"),O.UNKNOWN;switch(e){case kt.OK:return O.OK;case kt.CANCELLED:return O.CANCELLED;case kt.UNKNOWN:return O.UNKNOWN;case kt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case kt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case kt.INTERNAL:return O.INTERNAL;case kt.UNAVAILABLE:return O.UNAVAILABLE;case kt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case kt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case kt.NOT_FOUND:return O.NOT_FOUND;case kt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case kt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case kt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case kt.ABORTED:return O.ABORTED;case kt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case kt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case kt.DATA_LOSS:return O.DATA_LOSS;default:return W(39323,{code:e})}}(it=kt||(kt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS=new On([4294967295,4294967295],0);function _d(e){const t=am().encode(e),n=new Zg;return n.update(t),new Uint8Array(n.digest())}function yd(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new On([n,r],0),new On([i,s],0)]}class nc{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Oi(`Invalid padding: ${n}`);if(r<0)throw new Oi(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Oi(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Oi(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*t.length-n,this.ge=On.fromNumber(this.fe)}pe(t,n,r){let i=t.add(n.multiply(On.fromNumber(r)));return i.compare(wS)===1&&(i=new On([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const n=_d(t),[r,i]=yd(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(t,n,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new nc(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(t){if(this.fe===0)return;const n=_d(t),[r,i]=yd(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Oi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const i=new Map;return i.set(t,_s.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new Ea(Q.min(),i,new Rt(et),An(),nt())}}class _s{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new _s(r,n,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(t,n,r,i){this.Se=t,this.removedTargetIds=n,this.key=r,this.be=i}}class $m{constructor(t,n){this.targetId=t,this.De=n}}class qm{constructor(t,n,r=Kt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}}class vd{constructor(){this.ve=0,this.Ce=wd(),this.Fe=Kt.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=nt(),n=nt(),r=nt();return this.Ce.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:W(38017,{changeType:s})}}),new _s(this.Fe,this.Me,t,n,r)}ke(){this.xe=!1,this.Ce=wd()}qe(t,n){this.xe=!0,this.Ce=this.Ce.insert(t,n)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,ct(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class ES{constructor(t){this.We=t,this.Ge=new Map,this.ze=An(),this.je=Xs(),this.Je=Xs(),this.He=new Rt(et)}Ye(t){for(const n of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(n,t.be):this.Xe(n,t.key,t.be);for(const n of t.removedTargetIds)this.Xe(n,t.key,t.be)}et(t){this.forEachTarget(t,n=>{const r=this.tt(n);switch(t.state){case 0:this.nt(n)&&r.Be(t.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(t.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(t.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(t.resumeToken));break;default:W(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(t){const n=t.targetId,r=t.De.count,i=this.st(n);if(i){const s=i.target;if(rl(s))if(r===0){const o=new G(s.path);this.Xe(n,o,ee.newNoDocument(o,Q.min()))}else ct(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const u=this._t(t),l=u?this.ut(u,t,o):1;if(l!==0){this.rt(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,c)}}}}}_t(t){const n=t.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=qn(r).toUint8Array()}catch(l){if(l instanceof fm)return Un("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new nc(o,i,s)}catch(l){return Un(l instanceof Oi?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.fe===0?null:u}ut(t,n,r){return n.De.count===r-this.ht(t,n.targetId)?0:2}ht(t,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(u)||(this.Xe(n,s,null),i++)}),i}Pt(t){const n=new Map;this.Ge.forEach((s,o)=>{const u=this.st(o);if(u){if(s.current&&rl(u.target)){const l=new G(u.target.path);this.Tt(l).has(o)||this.It(o,l)||this.Xe(o,l,ee.newNoDocument(l,t))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=nt();this.Je.forEach((s,o)=>{let u=!0;o.forEachWhile(l=>{const c=this.st(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(t));const i=new Ea(t,n,this.He,this.ze,r);return this.ze=An(),this.je=Xs(),this.Je=Xs(),this.He=new Rt(et),i}Ze(t,n){if(!this.nt(t))return;const r=this.It(t,n.key)?2:0;this.tt(t).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(t)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(t))}Xe(t,n,r){if(!this.nt(t))return;const i=this.tt(t);this.It(t,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(t)),this.Je=this.Je.insert(n,this.dt(n).add(t)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(t){this.Ge.delete(t)}ot(t){const n=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let n=this.Ge.get(t);return n||(n=new vd,this.Ge.set(t,n)),n}dt(t){let n=this.Je.get(t);return n||(n=new Bt(et),this.Je=this.Je.insert(t,n)),n}Tt(t){let n=this.je.get(t);return n||(n=new Bt(et),this.je=this.je.insert(t,n)),n}nt(t){const n=this.st(t)!==null;return n||z("WatchChangeAggregator","Detected inactive target",t),n}st(t){const n=this.Ge.get(t);return n&&n.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new vd),this.We.getRemoteKeysForTarget(t).forEach(n=>{this.Xe(t,n,null)})}It(t,n){return this.We.getRemoteKeysForTarget(t).has(n)}}function Xs(){return new Rt(G.comparator)}function wd(){return new Rt(G.comparator)}const TS={asc:"ASCENDING",desc:"DESCENDING"},AS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IS={and:"AND",or:"OR"};class RS{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function sl(e,t){return e.useProto3Json||ga(t)?t:{value:t}}function Ko(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function jm(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function SS(e,t){return Ko(e,t.toTimestamp())}function Ze(e){return ct(!!e,49232),Q.fromTimestamp(function(n){const r=$n(n);return new vt(r.seconds,r.nanos)}(e))}function rc(e,t){return ol(e,t).canonicalString()}function ol(e,t){const n=function(i){return new _t(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function zm(e){const t=_t.fromString(e);return ct(Qm(t),10190,{key:t.toString()}),t}function al(e,t){return rc(e.databaseId,t.path)}function cu(e,t){const n=zm(t);if(n.get(1)!==e.databaseId.projectId)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new G(Gm(n))}function Hm(e,t){return rc(e.databaseId,t)}function bS(e){const t=zm(e);return t.length===4?_t.emptyPath():Gm(t)}function ul(e){return new _t(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Gm(e){return ct(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Ed(e,t,n){return{name:al(e,t),fields:n.value.mapValue.fields}}function xS(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:W(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(c,h){return c.useProto3Json?(ct(h===void 0||typeof h=="string",58123),Kt.fromBase64String(h||"")):(ct(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Kt.fromUint8Array(h||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(c){const h=c.code===void 0?O.UNKNOWN:Bm(c.code);return new q(h,c.message||"")}(o);n=new qm(r,i,s,u||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=cu(e,r.document.name),s=Ze(r.document.updateTime),o=r.document.createTime?Ze(r.document.createTime):Q.min(),u=new he({mapValue:{fields:r.document.fields}}),l=ee.newFoundDocument(i,s,o,u),c=r.targetIds||[],h=r.removedTargetIds||[];n=new co(c,h,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=cu(e,r.document),s=r.readTime?Ze(r.readTime):Q.min(),o=ee.newNoDocument(i,s),u=r.removedTargetIds||[];n=new co([],u,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=cu(e,r.document),s=r.removedTargetIds||[];n=new co([],s,i,null)}else{if(!("filter"in t))return W(11601,{At:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new yS(i,s),u=r.targetId;n=new $m(u,o)}}return n}function CS(e,t){let n;if(t instanceof ms)n={update:Ed(e,t.key,t.value)};else if(t instanceof Um)n={delete:al(e,t.key)};else if(t instanceof Kn)n={update:Ed(e,t.key,t.data),updateMask:FS(t.fieldMask)};else{if(!(t instanceof gS))return W(16599,{Rt:t.type});n={verify:al(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Go)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof us)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ls)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Wo)return{fieldPath:o.field.canonicalString(),increment:u.Ee};throw W(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:SS(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W(27497)}(e,t.precondition)),n}function PS(e,t){return e&&e.length>0?(ct(t!==void 0,14353),e.map(n=>function(i,s){let o=i.updateTime?Ze(i.updateTime):Ze(s);return o.isEqual(Q.min())&&(o=Ze(s)),new fS(o,i.transformResults||[])}(n,t))):[]}function VS(e,t){return{documents:[Hm(e,t.path)]}}function NS(e,t){const n={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Hm(e,i);const s=function(c){if(c.length!==0)return Km(Fe.create(c,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(h=>function(p){return{field:Nr(p.field),direction:OS(p.dir)}}(h))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const u=sl(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{Vt:n,parent:i}}function DS(e){let t=bS(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ct(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let s=[];n.where&&(s=function(d){const p=Wm(d);return p instanceof Fe&&Tm(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(_){return new as(Dr(_.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(p))}(n.orderBy));let u=null;n.limit&&(u=function(d){let p;return p=typeof d=="object"?d.value:d,ga(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(d){const p=!!d.before,m=d.values||[];return new zo(m,p)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const p=!d.before,m=d.values||[];return new zo(m,p)}(n.endAt)),ZR(t,i,o,s,u,"F",l,c)}function kS(e,t){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W(28987,{purpose:i})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Wm(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Dr(n.unaryFilter.field);return Ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Dr(n.unaryFilter.field);return Ot.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Dr(n.unaryFilter.field);return Ot.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Dr(n.unaryFilter.field);return Ot.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return W(61313);default:return W(60726)}}(e):e.fieldFilter!==void 0?function(n){return Ot.create(Dr(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return W(58110);default:return W(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Fe.create(n.compositeFilter.filters.map(r=>Wm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W(1026)}}(n.compositeFilter.op))}(e):W(30097,{filter:e})}function OS(e){return TS[e]}function MS(e){return AS[e]}function LS(e){return IS[e]}function Nr(e){return{fieldPath:e.canonicalString()}}function Dr(e){return Wt.fromServerFormat(e.fieldPath)}function Km(e){return e instanceof Ot?function(n){if(n.op==="=="){if(ud(n.value))return{unaryFilter:{field:Nr(n.field),op:"IS_NAN"}};if(ad(n.value))return{unaryFilter:{field:Nr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ud(n.value))return{unaryFilter:{field:Nr(n.field),op:"IS_NOT_NAN"}};if(ad(n.value))return{unaryFilter:{field:Nr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nr(n.field),op:MS(n.op),value:n.value}}}(e):e instanceof Fe?function(n){const r=n.getFilters().map(i=>Km(i));return r.length===1?r[0]:{compositeFilter:{op:LS(n.op),filters:r}}}(e):W(54877,{filter:e})}function FS(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Qm(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(t,n,r,i,s=Q.min(),o=Q.min(),u=Kt.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(t){return new Nn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(t){this.gt=t}}function BS(e){const t=DS({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Ho(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(){this.Dn=new qS}addToCollectionParentIndex(t,n){return this.Dn.add(n),L.resolve()}getCollectionParents(t,n){return L.resolve(this.Dn.getEntries(n))}addFieldIndex(t,n){return L.resolve()}deleteFieldIndex(t,n){return L.resolve()}deleteAllFieldIndexes(t){return L.resolve()}createTargetIndexes(t,n){return L.resolve()}getDocumentsMatchingTarget(t,n){return L.resolve(null)}getIndexType(t,n){return L.resolve(0)}getFieldIndexes(t,n){return L.resolve([])}getNextCollectionGroupToUpdate(t){return L.resolve(null)}getMinOffset(t,n){return L.resolve(Bn.min())}getMinOffsetFromCollectionGroup(t,n){return L.resolve(Bn.min())}updateCollectionGroup(t,n,r){return L.resolve()}updateIndexEntries(t,n){return L.resolve()}}class qS{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new Bt(_t.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new Bt(_t.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xm=41943040;class ce{static withCacheSize(t){return new ce(t,ce.DEFAULT_COLLECTION_PERCENTILE,ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ce.DEFAULT_COLLECTION_PERCENTILE=10,ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ce.DEFAULT=new ce(Xm,ce.DEFAULT_COLLECTION_PERCENTILE,ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ce.DISABLED=new ce(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Kr(0)}static ur(){return new Kr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad="LruGarbageCollector",jS=1048576;function Id([e,t],[n,r]){const i=et(e,n);return i===0?et(t,r):i}class zS{constructor(t){this.Tr=t,this.buffer=new Bt(Id),this.Ir=0}dr(){return++this.Ir}Er(t){const n=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Id(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class HS{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){z(Ad,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ii(n)?z(Ad,"Ignoring IndexedDB error during garbage collection: ",n):await ri(n)}await this.Rr(3e5)})}}class GS{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.mr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return L.resolve(pa.ue);const r=new zS(n);return this.Vr.forEachTarget(t,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(t,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.Vr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(Td)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Td):this.pr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,n){let r,i,s,o,u,l,c;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(r=d,u=Date.now(),this.removeTargets(t,r,n))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(t,r))).next(d=>(c=Date.now(),Pr()<=st.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(l-u)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function WS(e,t){return new GS(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(){this.changes=new yr(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,ee.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&qi(r.mutation,i,Te.empty(),vt.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,nt()).next(()=>r))}getLocalViewOfDocuments(t,n,r=nt()){const i=sr();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let o=ki();return s.forEach((u,l)=>{o=o.insert(u,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=sr();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,nt()))}populateOverlays(t,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(t,n,r,i){let s=An();const o=$i(),u=function(){return $i()}();return n.forEach((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof Kn)?s=s.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),qi(h.mutation,c,h.mutation.getFieldMask(),vt.now())):o.set(c.key,Te.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,h)=>o.set(c,h)),n.forEach((c,h)=>{var d;return u.set(c,new QS(h,(d=o.get(c))!==null&&d!==void 0?d:null))}),u))}recalculateAndSaveOverlays(t,n){const r=$i();let i=new Rt((o,u)=>o-u),s=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const u of o)u.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let h=r.get(l)||Te.empty();h=u.applyToLocalView(c,h),r.set(l,h);const d=(i.get(u.batchId)||nt()).add(l);i=i.insert(u.batchId,d)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const l=u.getNext(),c=l.key,h=l.value,d=Vm();h.forEach(p=>{if(!s.has(p)){const m=Lm(n.get(p),r.get(p));m!==null&&d.set(p,m),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,d))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):Sm(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):L.resolve(sr());let u=rs,l=s;return o.next(c=>L.forEach(c,(h,d)=>(u<d.largestBatchId&&(u=d.largestBatchId),s.get(h)?L.resolve():this.remoteDocumentCache.getEntry(t,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,nt())).next(h=>({batchId:u,changes:Pm(h)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new G(n)).next(r=>{let i=ki();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const s=n.collectionGroup;let o=ki();return this.indexManager.getCollectionParents(t,s).next(u=>L.forEach(u,l=>{const c=function(d,p){return new si(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,r,i).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(o=>{s.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,ee.newInvalidDocument(h)))});let u=ki();return o.forEach((l,c)=>{const h=s.get(l);h!==void 0&&qi(h.mutation,c,Te.empty(),vt.now()),ya(n,c)&&(u=u.insert(l,c))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,n){return L.resolve(this.Br.get(n))}saveBundleMetadata(t,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ze(i.createTime)}}(n)),L.resolve()}getNamedQuery(t,n){return L.resolve(this.Lr.get(n))}saveNamedQuery(t,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:BS(i.bundledQuery),readTime:Ze(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(){this.overlays=new Rt(G.comparator),this.kr=new Map}getOverlay(t,n){return L.resolve(this.overlays.get(n))}getOverlays(t,n){const r=sr();return L.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.wt(t,n,s)}),L.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),L.resolve()}getOverlaysForCollection(t,n,r){const i=sr(),s=n.length+1,o=new G(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const l=u.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return L.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new Rt((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=sr(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const u=sr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>u.set(c,h)),!(u.size()>=i)););return L.resolve(u)}wt(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new _S(n,r));let s=this.kr.get(n);s===void 0&&(s=nt(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(){this.sessionToken=Kt.EMPTY_BYTE_STRING}getSessionToken(t){return L.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(){this.qr=new Bt(qt.Qr),this.$r=new Bt(qt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,n){const r=new qt(t,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Wr(new qt(t,n))}Gr(t,n){t.forEach(r=>this.removeReference(r,n))}zr(t){const n=new G(new _t([])),r=new qt(n,t),i=new qt(n,t+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const n=new G(new _t([])),r=new qt(n,t),i=new qt(n,t+1);let s=nt();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new qt(t,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class qt{constructor(t,n){this.key=t,this.Hr=n}static Qr(t,n){return G.comparator(t.key,n.key)||et(t.Hr,n.Hr)}static Ur(t,n){return et(t.Hr,n.Hr)||G.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Bt(qt.Qr)}checkEmpty(t){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new mS(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.Yr=this.Yr.add(new qt(u.key,s)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return L.resolve(o)}lookupMutationBatch(t,n){return L.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?Kl:this.er-1)}getAllMutationBatches(t){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new qt(n,0),i=new qt(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const u=this.Zr(o.Hr);s.push(u)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Bt(et);return n.forEach(i=>{const s=new qt(i,0),o=new qt(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],u=>{r=r.add(u.Hr)})}),L.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new qt(new G(s),0);let u=new Bt(et);return this.Yr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(u=u.add(l.Hr)),!0)},o),L.resolve(this.ei(u))}ei(t){const n=[];return t.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){ct(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return L.forEach(n.mutations,i=>{const s=new qt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Yr=r})}rr(t){}containsKey(t,n){const r=new qt(n,0),i=this.Yr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,L.resolve()}ti(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(t){this.ni=t,this.docs=function(){return new Rt(G.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():ee.newInvalidDocument(n))}getEntries(t,n){let r=An();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ee.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=An();const o=n.path,u=new G(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||VR(PR(h),r)<=0||(i.has(h.key)||ya(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(t,n,r,i){W(9500)}ri(t,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new nb(this)}getSize(t){return L.resolve(this.size)}}class nb extends KS{constructor(t){super(),this.Or=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(t,i)):this.Or.removeEntry(r)}),L.waitFor(n)}getFromCache(t,n){return this.Or.getEntry(t,n)}getAllFromCache(t,n){return this.Or.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(t){this.persistence=t,this.ii=new yr(n=>Jl(n),Yl),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.si=0,this.oi=new ic,this.targetCount=0,this._i=Kr.ar()}forEachTarget(t,n){return this.ii.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(t){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return L.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),L.resolve()}hr(t){this.ii.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this._i=new Kr(n),this.highestTargetId=n),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,n){return this.hr(n),this.targetCount+=1,L.resolve()}updateTargetData(t,n){return this.hr(n),L.resolve()}removeTargetData(t,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(t,n,r){let i=0;const s=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(t){return L.resolve(this.targetCount)}getTargetData(t,n){const r=this.ii.get(n)||null;return L.resolve(r)}addMatchingKeys(t,n,r){return this.oi.Kr(n,r),L.resolve()}removeMatchingKeys(t,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.oi.zr(n),L.resolve()}getMatchingKeysForTargetId(t,n){const r=this.oi.Jr(n);return L.resolve(r)}containsKey(t,n){return L.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(t,n){this.ai={},this.overlays={},this.ui=new pa(0),this.ci=!1,this.ci=!0,this.li=new ZS,this.referenceDelegate=t(this),this.hi=new rb(this),this.indexManager=new $S,this.remoteDocumentCache=function(i){return new eb(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new US(n),this.Ti=new JS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new YS,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ai[t.toKey()];return r||(r=new tb(n,this.referenceDelegate),this.ai[t.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,n,r){z("MemoryPersistence","Starting transaction:",t);const i=new ib(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(t,n){return L.or(Object.values(this.ai).map(r=>()=>r.containsKey(t,n)))}}class ib extends DR{constructor(t){super(),this.currentSequenceNumber=t}}class sc{constructor(t){this.persistence=t,this.Ai=new ic,this.Ri=null}static Vi(t){return new sc(t)}get mi(){if(this.Ri)return this.Ri;throw W(60996)}addReference(t,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),L.resolve()}removeReference(t,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(t,n){return this.mi.add(n.toString()),L.resolve()}removeTarget(t,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ii(){this.Ri=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.mi,r=>{const i=G.fromPath(r);return this.fi(t,i).next(s=>{s||n.removeEntry(i,Q.min())})}).next(()=>(this.Ri=null,n.apply(t)))}updateLimboDocument(t,n){return this.fi(t,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(t){return 0}fi(t,n){return L.or([()=>L.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class Qo{constructor(t,n){this.persistence=t,this.gi=new yr(r=>MR(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=WS(this,n)}static Vi(t,n){return new Qo(t,n)}Ii(){}di(t){return L.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}mr(t){const n=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}yr(t){let n=0;return this.gr(t,r=>{n++}).next(()=>n)}gr(t,n){return L.forEach(this.gi,(r,i)=>this.Sr(t,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(t,o=>this.Sr(t,o,n).next(u=>{u||(r++,s.removeEntry(o,Q.min()))})).next(()=>s.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}removeReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}updateLimboDocument(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}Pi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=ao(t.data.value)),n}Sr(t,n,r){return L.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.gi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.Is=r,this.ds=i}static Es(t,n){let r=nt(),i=nt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new oc(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return YA()?8:kR(XA())>0?6:4}()}initialize(t,n){this.gs=t,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(t,n,r,i){const s={result:null};return this.ps(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(t,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new sb;return this.ws(t,n,o).next(u=>{if(s.result=u,this.Rs)return this.Ss(t,n,o,u.size)})}).next(()=>s.result)}Ss(t,n,r,i){return r.documentReadCount<this.Vs?(Pr()<=st.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",Vr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),L.resolve()):(Pr()<=st.DEBUG&&z("QueryEngine","Query:",Vr(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Pr()<=st.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",Vr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Je(n))):L.resolve())}ps(t,n){if(fd(n))return L.resolve(null);let r=Je(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ho(n,null,"F"),r=Je(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const o=nt(...s);return this.gs.getDocuments(t,o).next(u=>this.indexManager.getMinOffset(t,r).next(l=>{const c=this.bs(n,u);return this.Ds(n,c,o,l.readTime)?this.ps(t,Ho(n,null,"F")):this.vs(t,c,n,l)}))})))}ys(t,n,r,i){return fd(n)||i.isEqual(Q.min())?L.resolve(null):this.gs.getDocuments(t,r).next(s=>{const o=this.bs(n,s);return this.Ds(n,o,r,i)?L.resolve(null):(Pr()<=st.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Vr(n)),this.vs(t,o,n,CR(i,rs)).next(u=>u))})}bs(t,n){let r=new Bt(xm(t));return n.forEach((i,s)=>{ya(t,s)&&(r=r.add(s))}),r}Ds(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(t,n,r){return Pr()<=st.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",Vr(n)),this.gs.getDocumentsMatchingQuery(t,n,Bn.min(),r)}vs(t,n,r,i){return this.gs.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac="LocalStore",ab=3e8;class ub{constructor(t,n,r,i){this.persistence=t,this.Cs=n,this.serializer=i,this.Fs=new Rt(et),this.Ms=new yr(s=>Jl(s),Yl),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(r)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new XS(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Fs))}}function lb(e,t,n,r){return new ub(e,t,n,r)}async function Ym(e,t){const n=X(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let l=nt();for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){u.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Bs:c,removedBatchIds:o,addedBatchIds:u}))})})}function cb(e,t){const n=X(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,l,c,h){const d=c.batch,p=d.keys();let m=L.resolve();return p.forEach(_=>{m=m.next(()=>h.getEntry(l,_)).next(E=>{const v=c.docVersions.get(_);ct(v!==null,48541),E.version.compareTo(v)<0&&(d.applyToRemoteDocument(E,c),E.isValidDocument()&&(E.setReadTime(c.commitVersion),h.addEntry(E)))})}),m.next(()=>u.mutationQueue.removeMutationBatch(l,d))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=nt();for(let c=0;c<u.mutationResults.length;++c)u.mutationResults[c].transformResults.length>0&&(l=l.add(u.batch.mutations[c].key));return l}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function Zm(e){const t=X(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.hi.getLastRemoteSnapshotVersion(n))}function hb(e,t){const n=X(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const u=[];t.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;u.push(n.hi.removeMatchingKeys(s,h.removedDocuments,d).next(()=>n.hi.addMatchingKeys(s,h.addedDocuments,d)));let m=p.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(Kt.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,r)),i=i.insert(d,m),function(E,v,C){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=ab?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(p,m,h)&&u.push(n.hi.updateTargetData(s,m))});let l=An(),c=nt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),u.push(fb(s,o,t.documentUpdates).next(h=>{l=h.Ls,c=h.ks})),!r.isEqual(Q.min())){const h=n.hi.getLastRemoteSnapshotVersion(s).next(d=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(h)}return L.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.Fs=i,s))}function fb(e,t,n){let r=nt(),i=nt();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let o=An();return n.forEach((u,l)=>{const c=s.get(u);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(Q.min())?(t.removeEntry(u,l.readTime),o=o.insert(u,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(u,l)):z(ac,"Ignoring outdated watch update for ",u,". Current version:",c.version," Watch version:",l.version)}),{Ls:o,ks:i}})}function db(e,t){const n=X(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=Kl),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function pb(e,t){const n=X(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,t).next(s=>s?(i=s,L.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new Nn(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(t,r.targetId)),r})}async function ll(e,t,n){const r=X(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ii(o))throw o;z(ac,`Failed to update sequence numbers for target ${t}: ${o}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function Rd(e,t,n){const r=X(e);let i=Q.min(),s=nt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=X(l),p=d.Ms.get(h);return p!==void 0?L.resolve(d.Fs.get(p)):d.hi.getTargetData(c,h)}(r,o,Je(t)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,t,n?i:Q.min(),n?s:nt())).next(u=>(gb(r,eS(t),u),{documents:u,qs:s})))}function gb(e,t,n){let r=e.xs.get(t)||Q.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.xs.set(t,r)}class Sd{constructor(){this.activeTargetIds=aS()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class mb{constructor(){this.Fo=new Sd,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,n,r){this.Mo[t]=n}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new Sd,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd="ConnectivityMonitor";class xd{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){z(bd,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){z(bd,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Js=null;function cl(){return Js===null?Js=function(){return 268435456+Math.round(2147483648*Math.random())}():Js++,"0x"+Js.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="RestConnection",yb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vb{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===qo?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,n,r,i,s){const o=cl(),u=this.Go(t,n.toUriEncodedString());z(hu,`Sending RPC '${t}' ${o}:`,u,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,i,s);const{host:c}=new URL(u),h=zl(c);return this.jo(t,u,l,r,h).then(d=>(z(hu,`Received RPC '${t}' ${o}: `,d),d),d=>{throw Un(hu,`RPC '${t}' ${o} failed with error: `,d,"url: ",u,"request:",r),d})}Jo(t,n,r,i,s,o){return this.Wo(t,n,r,i,s)}zo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ni}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}Go(t,n){const r=yb[t];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class Eb extends vb{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,n,r,i,s){const o=cl();return new Promise((u,l)=>{const c=new tm;c.setWithCredentials(!0),c.listenOnce(em.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case oo.NO_ERROR:const d=c.getResponseJson();z(Zt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),u(d);break;case oo.TIMEOUT:z(Zt,`RPC '${t}' ${o} timed out`),l(new q(O.DEADLINE_EXCEEDED,"Request time out"));break;case oo.HTTP_ERROR:const p=c.getStatus();if(z(Zt,`RPC '${t}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const E=function(C){const b=C.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(b)>=0?b:O.UNKNOWN}(_.status);l(new q(E,_.message))}else l(new q(O.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new q(O.UNAVAILABLE,"Connection failed."));break;default:W(9055,{c_:t,streamId:o,l_:c.getLastErrorCode(),h_:c.getLastError()})}}finally{z(Zt,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);z(Zt,`RPC '${t}' ${o} sending request:`,i),c.send(n,"POST",h,r,15)})}P_(t,n,r){const i=cl(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=im(),u=rm(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=s.join("");z(Zt,`Creating RPC '${t}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);this.T_(d);let p=!1,m=!1;const _=new wb({Ho:v=>{m?z(Zt,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(p||(z(Zt,`Opening RPC '${t}' stream ${i} transport.`),d.open(),p=!0),z(Zt,`RPC '${t}' stream ${i} sending:`,v),d.send(v))},Yo:()=>d.close()}),E=(v,C,b)=>{v.listen(C,N=>{try{b(N)}catch(P){setTimeout(()=>{throw P},0)}})};return E(d,Di.EventType.OPEN,()=>{m||(z(Zt,`RPC '${t}' stream ${i} transport opened.`),_.s_())}),E(d,Di.EventType.CLOSE,()=>{m||(m=!0,z(Zt,`RPC '${t}' stream ${i} transport closed`),_.__(),this.I_(d))}),E(d,Di.EventType.ERROR,v=>{m||(m=!0,Un(Zt,`RPC '${t}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),_.__(new q(O.UNAVAILABLE,"The operation could not be completed")))}),E(d,Di.EventType.MESSAGE,v=>{var C;if(!m){const b=v.data[0];ct(!!b,16349);const N=b,P=(N==null?void 0:N.error)||((C=N[0])===null||C===void 0?void 0:C.error);if(P){z(Zt,`RPC '${t}' stream ${i} received error:`,P);const M=P.status;let U=function(T){const S=kt[T];if(S!==void 0)return Bm(S)}(M),I=P.message;U===void 0&&(U=O.INTERNAL,I="Unknown error status: "+M+" with message "+P.message),m=!0,_.__(new q(U,I)),d.close()}else z(Zt,`RPC '${t}' stream ${i} received:`,b),_.a_(b)}}),E(u,nm.STAT_EVENT,v=>{v.stat===Yu.PROXY?z(Zt,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===Yu.NOPROXY&&z(Zt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.o_()},0),_}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(n=>n===t)}}function fu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ta(e){return new RS(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(t,n,r=1e3,i=1.5,s=6e4){this.Fi=t,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="PersistentStream";class e_{constructor(t,n,r,i,s,o,u,l){this.Fi=t,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new t_(t,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():n&&n.code===O.RESOURCE_EXHAUSTED?(En(n.toString()),En("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(n)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{t(()=>{const i=new q(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(t,n){const r=this.K_(this.b_);this.stream=this.z_(t,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return z(Cd,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return n=>{this.Fi.enqueueAndForget(()=>this.b_===t?n():(z(Cd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Tb extends e_{constructor(t,n,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(t,n){return this.connection.P_("Listen",t,n)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const n=xS(this.serializer,t),r=function(s){if(!("targetChange"in s))return Q.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Q.min():o.readTime?Ze(o.readTime):Q.min()}(t);return this.listener.J_(n,r)}H_(t){const n={};n.database=ul(this.serializer),n.addTarget=function(s,o){let u;const l=o.target;if(u=rl(l)?{documents:VS(s,l)}:{query:NS(s,l).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=jm(s,o.resumeToken);const c=sl(s,o.expectedCount);c!==null&&(u.expectedCount=c)}else if(o.snapshotVersion.compareTo(Q.min())>0){u.readTime=Ko(s,o.snapshotVersion.toTimestamp());const c=sl(s,o.expectedCount);c!==null&&(u.expectedCount=c)}return u}(this.serializer,t);const r=kS(this.serializer,t);r&&(n.labels=r),this.k_(n)}Y_(t){const n={};n.database=ul(this.serializer),n.removeTarget=t,this.k_(n)}}class Ab extends e_{constructor(t,n,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,n){return this.connection.P_("Write",t,n)}j_(t){return ct(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ct(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){ct(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const n=PS(t.writeResults,t.commitTime),r=Ze(t.commitTime);return this.listener.ta(r,n)}na(){const t={};t.database=ul(this.serializer),this.k_(t)}X_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>CS(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{}class Rb extends Ib{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,ol(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(O.UNKNOWN,s.toString())})}Jo(t,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(t,ol(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(O.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Sb{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(En(n),this._a=!1):z("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr="RemoteStore";class bb{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{vr(this)&&(z(gr,"Restarting streams for network reachability change."),await async function(l){const c=X(l);c.Ia.add(4),await ys(c),c.Aa.set("Unknown"),c.Ia.delete(4),await Aa(c)}(this))})}),this.Aa=new Sb(r,i)}}async function Aa(e){if(vr(e))for(const t of e.da)await t(!0)}async function ys(e){for(const t of e.da)await t(!1)}function n_(e,t){const n=X(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),hc(n)?cc(n):oi(n).x_()&&lc(n,t))}function uc(e,t){const n=X(e),r=oi(n);n.Ta.delete(t),r.x_()&&r_(n,t),n.Ta.size===0&&(r.x_()?r.B_():vr(n)&&n.Aa.set("Unknown"))}function lc(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Q.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}oi(e).H_(t)}function r_(e,t){e.Ra.$e(t),oi(e).Y_(t)}function cc(e){e.Ra=new ES({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),oi(e).start(),e.Aa.aa()}function hc(e){return vr(e)&&!oi(e).M_()&&e.Ta.size>0}function vr(e){return X(e).Ia.size===0}function i_(e){e.Ra=void 0}async function xb(e){e.Aa.set("Online")}async function Cb(e){e.Ta.forEach((t,n)=>{lc(e,t)})}async function Pb(e,t){i_(e),hc(e)?(e.Aa.la(t),cc(e)):e.Aa.set("Unknown")}async function Vb(e,t,n){if(e.Aa.set("Online"),t instanceof qm&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.Ta.delete(u),i.Ra.removeTarget(u))}(e,t)}catch(r){z(gr,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Xo(e,r)}else if(t instanceof co?e.Ra.Ye(t):t instanceof $m?e.Ra.it(t):e.Ra.et(t),!n.isEqual(Q.min()))try{const r=await Zm(e.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Ra.Pt(o);return u.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ta.get(c);h&&s.Ta.set(c,h.withResumeToken(l.resumeToken,o))}}),u.targetMismatches.forEach((l,c)=>{const h=s.Ta.get(l);if(!h)return;s.Ta.set(l,h.withResumeToken(Kt.EMPTY_BYTE_STRING,h.snapshotVersion)),r_(s,l);const d=new Nn(h.target,l,c,h.sequenceNumber);lc(s,d)}),s.remoteSyncer.applyRemoteEvent(u)}(e,n)}catch(r){z(gr,"Failed to raise snapshot:",r),await Xo(e,r)}}async function Xo(e,t,n){if(!ii(t))throw t;e.Ia.add(1),await ys(e),e.Aa.set("Offline"),n||(n=()=>Zm(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{z(gr,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await Aa(e)})}function s_(e,t){return t().catch(n=>Xo(e,n,t))}async function Ia(e){const t=X(e),n=zn(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Kl;for(;Nb(t);)try{const i=await db(t.localStore,r);if(i===null){t.Pa.length===0&&n.B_();break}r=i.batchId,Db(t,i)}catch(i){await Xo(t,i)}o_(t)&&a_(t)}function Nb(e){return vr(e)&&e.Pa.length<10}function Db(e,t){e.Pa.push(t);const n=zn(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function o_(e){return vr(e)&&!zn(e).M_()&&e.Pa.length>0}function a_(e){zn(e).start()}async function kb(e){zn(e).na()}async function Ob(e){const t=zn(e);for(const n of e.Pa)t.X_(n.mutations)}async function Mb(e,t,n){const r=e.Pa.shift(),i=ec.from(r,t,n);await s_(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Ia(e)}async function Lb(e,t){t&&zn(e).Z_&&await async function(r,i){if(function(o){return vS(o)&&o!==O.ABORTED}(i.code)){const s=r.Pa.shift();zn(r).N_(),await s_(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ia(r)}}(e,t),o_(e)&&a_(e)}async function Pd(e,t){const n=X(e);n.asyncQueue.verifyOperationInProgress(),z(gr,"RemoteStore received new credentials");const r=vr(n);n.Ia.add(3),await ys(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await Aa(n)}async function Fb(e,t){const n=X(e);t?(n.Ia.delete(2),await Aa(n)):t||(n.Ia.add(2),await ys(n),n.Aa.set("Unknown"))}function oi(e){return e.Va||(e.Va=function(n,r,i){const s=X(n);return s.ia(),new Tb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:xb.bind(null,e),e_:Cb.bind(null,e),n_:Pb.bind(null,e),J_:Vb.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),hc(e)?cc(e):e.Aa.set("Unknown")):(await e.Va.stop(),i_(e))})),e.Va}function zn(e){return e.ma||(e.ma=function(n,r,i){const s=X(n);return s.ia(),new Ab(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:kb.bind(null,e),n_:Lb.bind(null,e),ea:Ob.bind(null,e),ta:Mb.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await Ia(e)):(await e.ma.stop(),e.Pa.length>0&&(z(gr,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){const o=Date.now()+r,u=new fc(t,n,o,i,s);return u.start(r),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(O.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dc(e,t){if(En("AsyncQueue",`${t}: ${e}`),ii(e))return new q(O.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{static emptySet(t){return new Fr(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=ki(),this.sortedSet=new Rt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Fr)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new Fr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(){this.fa=new Rt(G.comparator)}track(t){const n=t.doc.key,r=this.fa.get(n);r?t.type!==0&&r.type===3?this.fa=this.fa.insert(n,t):t.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.fa=this.fa.remove(n):t.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):W(63341,{At:t,ga:r}):this.fa=this.fa.insert(n,t)}pa(){const t=[];return this.fa.inorderTraversal((n,r)=>{t.push(r)}),t}}class Qr{constructor(t,n,r,i,s,o,u,l,c){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new Qr(t,n,Fr.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&_a(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class Bb{constructor(){this.queries=Nd(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=X(n),s=i.queries;i.queries=Nd(),s.forEach((o,u)=>{for(const l of u.wa)l.onError(r)})})(this,new q(O.ABORTED,"Firestore shutting down"))}}function Nd(){return new yr(e=>bm(e),_a)}async function u_(e,t){const n=X(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new Ub,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=dc(o,`Initialization of query '${Vr(t.query)}' failed`);return void t.onError(u)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&pc(n)}async function l_(e,t){const n=X(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const o=s.wa.indexOf(t);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function $b(e,t){const n=X(e);let r=!1;for(const i of t){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.wa)u.Ca(i)&&(r=!0);o.ya=i}}r&&pc(n)}function qb(e,t,n){const r=X(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function pc(e){e.Da.forEach(t=>{t.next()})}var hl,Dd;(Dd=hl||(hl={})).Fa="default",Dd.Cache="cache";class c_{constructor(t,n,r){this.query=t,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new Qr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),n=!0):this.Ba(t,this.onlineState)&&(this.La(t),n=!0),this.Oa=t,n}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),n=!0),n}Ba(t,n){if(!t.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(t){t=Qr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==hl.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(t){this.key=t}}class f_{constructor(t){this.key=t}}class jb{constructor(t,n){this.query=t,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=nt(),this.mutatedKeys=nt(),this.Xa=xm(t),this.eu=new Fr(this.Xa)}get tu(){return this.Ha}nu(t,n){const r=n?n.ru:new Vd,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const p=i.get(h),m=ya(this.query,d)?d:null,_=!!p&&this.mutatedKeys.has(p.key),E=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let v=!1;p&&m?p.data.isEqual(m.data)?_!==E&&(r.track({type:3,doc:m}),v=!0):this.iu(p,m)||(r.track({type:2,doc:m}),v=!0,(l&&this.Xa(m,l)>0||c&&this.Xa(m,c)<0)&&(u=!0)):!p&&m?(r.track({type:0,doc:m}),v=!0):p&&!m&&(r.track({type:1,doc:p}),v=!0,(l||c)&&(u=!0)),v&&(m?(o=o.add(m),s=E?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:u,mutatedKeys:s}}iu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const o=t.ru.pa();o.sort((h,d)=>function(m,_){const E=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W(20277,{At:v})}};return E(m)-E(_)}(h.type,d.type)||this.Xa(h.doc,d.doc)),this.su(r),i=i!=null&&i;const u=n&&!i?this.ou():[],l=this.Za.size===0&&this.current&&!i?1:0,c=l!==this.Ya;return this.Ya=l,o.length!==0||c?{snapshot:new Qr(this.query,t.eu,s,o,t.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Vd,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=nt(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return t.forEach(r=>{this.Za.has(r)||n.push(new f_(r))}),this.Za.forEach(r=>{t.has(r)||n.push(new h_(r))}),n}uu(t){this.Ha=t.qs,this.Za=nt();const n=this.nu(t.documents);return this.applyChanges(n,!0)}cu(){return Qr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const gc="SyncEngine";class zb{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class Hb{constructor(t){this.key=t,this.lu=!1}}class Gb{constructor(t,n,r,i,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new yr(u=>bm(u),_a),this.Tu=new Map,this.Iu=new Set,this.du=new Rt(G.comparator),this.Eu=new Map,this.Au=new ic,this.Ru={},this.Vu=new Map,this.mu=Kr.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function Wb(e,t,n=!0){const r=y_(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await d_(r,t,n,!0),i}async function Kb(e,t){const n=y_(e);await d_(n,t,!0,!1)}async function d_(e,t,n,r){const i=await pb(e.localStore,Je(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await Qb(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&n&&n_(e.remoteStore,i),u}async function Qb(e,t,n,r,i){e.gu=(d,p,m)=>async function(E,v,C,b){let N=v.view.nu(C);N.Ds&&(N=await Rd(E.localStore,v.query,!1).then(({documents:I})=>v.view.nu(I,N)));const P=b&&b.targetChanges.get(v.targetId),M=b&&b.targetMismatches.get(v.targetId)!=null,U=v.view.applyChanges(N,E.isPrimaryClient,P,M);return Od(E,v.targetId,U._u),U.snapshot}(e,d,p,m);const s=await Rd(e.localStore,t,!0),o=new jb(t,s.qs),u=o.nu(s.documents),l=_s.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),c=o.applyChanges(u,e.isPrimaryClient,l);Od(e,n,c._u);const h=new zb(t,n,o);return e.Pu.set(t,h),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function Xb(e,t,n){const r=X(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!_a(o,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ll(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&uc(r.remoteStore,i.targetId),fl(r,i.targetId)}).catch(ri)):(fl(r,i.targetId),await ll(r.localStore,i.targetId,!0))}async function Jb(e,t){const n=X(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),uc(n.remoteStore,r.targetId))}async function Yb(e,t,n){const r=sx(e);try{const i=await function(o,u){const l=X(o),c=vt.now(),h=u.reduce((m,_)=>m.add(_.key),nt());let d,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let _=An(),E=nt();return l.Os.getEntries(m,h).next(v=>{_=v,_.forEach((C,b)=>{b.isValidDocument()||(E=E.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,_)).next(v=>{d=v;const C=[];for(const b of u){const N=pS(b,d.get(b.key).overlayedDocument);N!=null&&C.push(new Kn(b.key,N,vm(N.value.mapValue),Ye.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,C,u)}).next(v=>{p=v;const C=v.applyToLocalDocumentSet(d,E);return l.documentOverlayCache.saveOverlays(m,v.batchId,C)})}).then(()=>({batchId:p.batchId,changes:Pm(d)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,l){let c=o.Ru[o.currentUser.toKey()];c||(c=new Rt(et)),c=c.insert(u,l),o.Ru[o.currentUser.toKey()]=c}(r,i.batchId,n),await vs(r,i.changes),await Ia(r.remoteStore)}catch(i){const s=dc(i,"Failed to persist write");n.reject(s)}}async function p_(e,t){const n=X(e);try{const r=await hb(n.localStore,t);t.targetChanges.forEach((i,s)=>{const o=n.Eu.get(s);o&&(ct(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?ct(o.lu,14607):i.removedDocuments.size>0&&(ct(o.lu,42227),o.lu=!1))}),await vs(n,r,t)}catch(r){await ri(r)}}function kd(e,t,n){const r=X(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,o)=>{const u=o.view.va(t);u.snapshot&&i.push(u.snapshot)}),function(o,u){const l=X(o);l.onlineState=u;let c=!1;l.queries.forEach((h,d)=>{for(const p of d.wa)p.va(u)&&(c=!0)}),c&&pc(l)}(r.eventManager,t),i.length&&r.hu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Zb(e,t,n){const r=X(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let o=new Rt(G.comparator);o=o.insert(s,ee.newNoDocument(s,Q.min()));const u=nt().add(s),l=new Ea(Q.min(),new Map,new Rt(et),o,u);await p_(r,l),r.du=r.du.remove(s),r.Eu.delete(t),mc(r)}else await ll(r.localStore,t,!1).then(()=>fl(r,t,n)).catch(ri)}async function tx(e,t){const n=X(e),r=t.batch.batchId;try{const i=await cb(n.localStore,t);m_(n,r,null),g_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await vs(n,i)}catch(i){await ri(i)}}async function ex(e,t,n){const r=X(e);try{const i=await function(o,u){const l=X(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,u).next(d=>(ct(d!==null,37113),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(r.localStore,t);m_(r,t,n),g_(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await vs(r,i)}catch(i){await ri(i)}}function g_(e,t){(e.Vu.get(t)||[]).forEach(n=>{n.resolve()}),e.Vu.delete(t)}function m_(e,t,n){const r=X(e);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function fl(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(r=>{e.Au.containsKey(r)||__(e,r)})}function __(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(uc(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),mc(e))}function Od(e,t,n){for(const r of n)r instanceof h_?(e.Au.addReference(r.key,t),nx(e,r)):r instanceof f_?(z(gc,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||__(e,r.key)):W(19791,{yu:r})}function nx(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(z(gc,"New document in limbo: "+n),e.Iu.add(r),mc(e))}function mc(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new G(_t.fromString(t)),r=e.mu.next();e.Eu.set(r,new Hb(n)),e.du=e.du.insert(n,r),n_(e.remoteStore,new Nn(Je(Zl(n.path)),r,"TargetPurposeLimboResolution",pa.ue))}}async function vs(e,t,n){const r=X(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,l)=>{o.push(r.gu(l,t,n).then(c=>{var h;if((c||n)&&r.isPrimaryClient){const d=c?!c.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){i.push(c);const d=oc.Es(l.targetId,c);s.push(d)}}))}),await Promise.all(o),r.hu.J_(i),await async function(l,c){const h=X(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>L.forEach(c,p=>L.forEach(p.Is,m=>h.persistence.referenceDelegate.addReference(d,p.targetId,m)).next(()=>L.forEach(p.ds,m=>h.persistence.referenceDelegate.removeReference(d,p.targetId,m)))))}catch(d){if(!ii(d))throw d;z(ac,"Failed to update sequence numbers: "+d)}for(const d of c){const p=d.targetId;if(!d.fromCache){const m=h.Fs.get(p),_=m.snapshotVersion,E=m.withLastLimboFreeSnapshotVersion(_);h.Fs=h.Fs.insert(p,E)}}}(r.localStore,s))}async function rx(e,t){const n=X(e);if(!n.currentUser.isEqual(t)){z(gc,"User change. New user:",t.toKey());const r=await Ym(n.localStore,t);n.currentUser=t,function(s,o){s.Vu.forEach(u=>{u.forEach(l=>{l.reject(new q(O.CANCELLED,o))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await vs(n,r.Bs)}}function ix(e,t){const n=X(e),r=n.Eu.get(t);if(r&&r.lu)return nt().add(r.key);{let i=nt();const s=n.Tu.get(t);if(!s)return i;for(const o of s){const u=n.Pu.get(o);i=i.unionWith(u.view.tu)}return i}}function y_(e){const t=X(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=p_.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ix.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Zb.bind(null,t),t.hu.J_=$b.bind(null,t.eventManager),t.hu.pu=qb.bind(null,t.eventManager),t}function sx(e){const t=X(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=tx.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ex.bind(null,t),t}class Jo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Ta(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,n){return null}Fu(t,n){return null}vu(t){return lb(this.persistence,new ob,t.initialUser,this.serializer)}Du(t){return new Jm(sc.Vi,this.serializer)}bu(t){return new mb}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jo.provider={build:()=>new Jo};class ox extends Jo{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,n){ct(this.persistence.referenceDelegate instanceof Qo,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new HS(r,t.asyncQueue,n)}Du(t){const n=this.cacheSizeBytes!==void 0?ce.withCacheSize(this.cacheSizeBytes):ce.DEFAULT;return new Jm(r=>Qo.Vi(r,n),this.serializer)}}class dl{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kd(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=rx.bind(null,this.syncEngine),await Fb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new Bb}()}createDatastore(t){const n=Ta(t.databaseInfo.databaseId),r=function(s){return new Eb(s)}(t.databaseInfo);return function(s,o,u,l){return new Rb(s,o,u,l)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,o,u){return new bb(r,i,s,o,u)}(this.localStore,this.datastore,t.asyncQueue,n=>kd(this.syncEngine,n,0),function(){return xd.C()?new xd:new _b}())}createSyncEngine(t,n){return function(i,s,o,u,l,c,h){const d=new Gb(i,s,o,u,l,c);return h&&(d.fu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const s=X(i);z(gr,"RemoteStore shutting down."),s.Ia.add(5),await ys(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}dl.provider={build:()=>new dl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):En("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="FirestoreClient";class ax{constructor(t,n,r,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=te.UNAUTHENTICATED,this.clientId=Wl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{z(Hn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z(Hn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new mn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=dc(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function du(e,t){e.asyncQueue.verifyOperationInProgress(),z(Hn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Ym(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>{Un("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{z("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Un("Terminating Firestore due to IndexedDb database deletion failed",i)})}),e._offlineComponents=t}async function Md(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ux(e);z(Hn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>Pd(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>Pd(t.remoteStore,i)),e._onlineComponents=t}async function ux(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){z(Hn,"Using user provided OfflineComponentProvider");try{await du(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===O.FAILED_PRECONDITION||i.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Un("Error using user provided cache. Falling back to memory cache: "+n),await du(e,new Jo)}}else z(Hn,"Using default OfflineComponentProvider"),await du(e,new ox(void 0));return e._offlineComponents}async function w_(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(z(Hn,"Using user provided OnlineComponentProvider"),await Md(e,e._uninitializedComponentsProvider._online)):(z(Hn,"Using default OnlineComponentProvider"),await Md(e,new dl))),e._onlineComponents}function lx(e){return w_(e).then(t=>t.syncEngine)}async function E_(e){const t=await w_(e),n=t.eventManager;return n.onListen=Wb.bind(null,t.syncEngine),n.onUnlisten=Xb.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Kb.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Jb.bind(null,t.syncEngine),n}function cx(e,t,n={}){const r=new mn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,l,c){const h=new v_({next:p=>{h.Ou(),o.enqueueAndForget(()=>l_(s,d));const m=p.docs.has(u);!m&&p.fromCache?c.reject(new q(O.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new q(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new c_(Zl(u.path),h,{includeMetadataChanges:!0,ka:!0});return u_(s,d)}(await E_(e),e.asyncQueue,t,n,r)),r.promise}function hx(e,t,n={}){const r=new mn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,l,c){const h=new v_({next:p=>{h.Ou(),o.enqueueAndForget(()=>l_(s,d)),p.fromCache&&l.source==="server"?c.reject(new q(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),d=new c_(u,h,{includeMetadataChanges:!0,ka:!0});return u_(s,d)}(await E_(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="firestore.googleapis.com",Fd=!0;class Ud{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new q(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=A_,this.ssl=Fd}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Fd;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Xm;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<jS)throw new q(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}bR("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=T_((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Ra{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ud({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new q(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ud(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new yR;switch(r.type){case"firstParty":return new TR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Ld.get(n);r&&(z("ComponentProvider","Removing Datastore"),Ld.delete(n),r.terminate())}(this),Promise.resolve()}}function fx(e,t,n,r={}){var i;e=Tn(e,Ra);const s=zl(t),o=e._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;s&&(HA(`https://${l}`),QA("Firestore",!0)),o.host!==A_&&o.host!==l&&Un("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:r});if(!Fo(c,u)&&(e._setSettings(c),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=te.MOCK_USER;else{h=GA(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new q(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new te(p)}e._authCredentials=new vR(new om(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Qn(this.firestore,t,this._query)}}class Nt{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Nt(this.firestore,t,this._key)}toJSON(){return{type:Nt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(gs(n,Nt._jsonSchema))return new Nt(t,r||null,new G(_t.fromString(n.referencePath)))}}Nt._jsonSchemaVersion="firestore/documentReference/1.0",Nt._jsonSchema={type:Mt("string",Nt._jsonSchemaVersion),referencePath:Mt("string")};class Mn extends Qn{constructor(t,n,r){super(t,n,Zl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Nt(this.firestore,null,new G(t))}withConverter(t){return new Mn(this.firestore,t,this._path)}}function I_(e,t,...n){if(e=vn(e),um("collection","path",t),e instanceof Ra){const r=_t.fromString(t,...n);return Yf(r),new Mn(e,null,r)}{if(!(e instanceof Nt||e instanceof Mn))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_t.fromString(t,...n));return Yf(r),new Mn(e.firestore,null,r)}}function dx(e,t,...n){if(e=vn(e),arguments.length===1&&(t=Wl.newId()),um("doc","path",t),e instanceof Ra){const r=_t.fromString(t,...n);return Jf(r),new Nt(e,null,new G(r))}{if(!(e instanceof Nt||e instanceof Mn))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_t.fromString(t,...n));return Jf(r),new Nt(e.firestore,e instanceof Mn?e.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd="AsyncQueue";class $d{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new t_(this,"async_queue_retry"),this.oc=()=>{const r=fu();r&&z(Bd,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=t;const n=fu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const n=fu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new mn;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!ii(t))throw t;z(Bd,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const n=this._c.then(()=>(this.nc=!0,t().catch(r=>{throw this.tc=r,this.nc=!1,En("INTERNAL UNHANDLED ERROR: ",qd(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(t,n,r){this.ac(),this.sc.indexOf(t)>-1&&(n=0);const i=fc.createAndSchedule(this,t,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&W(47125,{hc:qd(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const n of this.ec)if(n.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const n=this.ec.indexOf(t);this.ec.splice(n,1)}}function qd(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class ws extends Ra{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new $d,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new $d(t),this._firestoreClient=void 0,await t}}}function px(e,t){const n=typeof e=="object"?e:sR(),r=typeof e=="string"?e:qo,i=tR(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=jA("firestore");s&&fx(i,...s)}return i}function _c(e){if(e._terminated)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||gx(e),e._firestoreClient}function gx(e){var t,n,r;const i=e._freezeSettings(),s=function(u,l,c,h){return new UR(u,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,T_(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new ax(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(u){const l=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(t){this._byteString=t}static fromBase64String(t){try{return new be(Kt.fromBase64String(t))}catch(n){throw new q(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new be(Kt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:be._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(gs(t,be._jsonSchema))return be.fromBase64String(t.bytes)}}be._jsonSchemaVersion="firestore/bytes/1.0",be._jsonSchema={type:Mt("string",be._jsonSchemaVersion),bytes:Mt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new q(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new q(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new q(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return et(this._lat,t._lat)||et(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:tn._jsonSchemaVersion}}static fromJSON(t){if(gs(t,tn._jsonSchema))return new tn(t.latitude,t.longitude)}}tn._jsonSchemaVersion="firestore/geoPoint/1.0",tn._jsonSchema={type:Mt("string",tn._jsonSchemaVersion),latitude:Mt("number"),longitude:Mt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:en._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(gs(t,en._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new en(t.vectorValues);throw new q(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}en._jsonSchemaVersion="firestore/vectorValue/1.0",en._jsonSchema={type:Mt("string",en._jsonSchemaVersion),vectorValues:Mt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx=/^__.*__$/;class _x{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Kn(t,this.data,this.fieldMask,n,this.fieldTransforms):new ms(t,this.data,n,this.fieldTransforms)}}class R_{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Kn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function S_(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W(40011,{Ec:e})}}class vc{constructor(t,n,r,i,s,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new vc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.fc(t),i}gc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return Yo(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(S_(this.Ec)&&mx.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class yx{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Ta(t)}Dc(t,n,r,i=!1){return new vc({Ec:t,methodName:n,bc:r,path:Wt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wc(e){const t=e._freezeSettings(),n=Ta(e._databaseId);return new yx(e._databaseId,!!t.ignoreUndefinedProperties,n)}function vx(e,t,n,r,i,s={}){const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);Ec("Data must be an object, but it was:",o,r);const u=b_(r,o);let l,c;if(s.merge)l=new Te(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=pl(t,d,n);if(!o.contains(p))throw new q(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);C_(h,p)||h.push(p)}l=new Te(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new _x(new he(u),l,c)}class ba extends yc{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ba}}function wx(e,t,n,r){const i=e.Dc(1,t,n);Ec("Data must be an object, but it was:",i,r);const s=[],o=he.empty();Wn(r,(l,c)=>{const h=Tc(t,l,n);c=vn(c);const d=i.gc(h);if(c instanceof ba)s.push(h);else{const p=Es(c,d);p!=null&&(s.push(h),o.set(h,p))}});const u=new Te(s);return new R_(o,u,i.fieldTransforms)}function Ex(e,t,n,r,i,s){const o=e.Dc(1,t,n),u=[pl(t,r,n)],l=[i];if(s.length%2!=0)throw new q(O.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)u.push(pl(t,s[p])),l.push(s[p+1]);const c=[],h=he.empty();for(let p=u.length-1;p>=0;--p)if(!C_(c,u[p])){const m=u[p];let _=l[p];_=vn(_);const E=o.gc(m);if(_ instanceof ba)c.push(m);else{const v=Es(_,E);v!=null&&(c.push(m),h.set(m,v))}}const d=new Te(c);return new R_(h,d,o.fieldTransforms)}function Tx(e,t,n,r=!1){return Es(n,e.Dc(r?4:3,t))}function Es(e,t){if(x_(e=vn(e)))return Ec("Unsupported field value:",t,e),b_(e,t);if(e instanceof yc)return function(r,i){if(!S_(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let l=Es(u,i.yc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=vn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return uS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=vt.fromDate(r);return{timestampValue:Ko(i.serializer,s)}}if(r instanceof vt){const s=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ko(i.serializer,s)}}if(r instanceof tn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof be)return{bytesValue:jm(i.serializer,r._byteString)};if(r instanceof Nt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:rc(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof en)return function(o,u){return{mapValue:{fields:{[_m]:{stringValue:ym},[jo]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw u.wc("VectorValues must only contain numeric values.");return tc(u.serializer,c)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${da(r)}`)}(e,t)}function b_(e,t){const n={};return hm(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Wn(e,(r,i)=>{const s=Es(i,t.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function x_(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof vt||e instanceof tn||e instanceof be||e instanceof Nt||e instanceof yc||e instanceof en)}function Ec(e,t,n){if(!x_(n)||!lm(n)){const r=da(n);throw r==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function pl(e,t,n){if((t=vn(t))instanceof Sa)return t._internalPath;if(typeof t=="string")return Tc(e,t);throw Yo("Field path arguments must be of type string or ",e,!1,void 0,n)}const Ax=new RegExp("[~\\*/\\[\\]]");function Tc(e,t,n){if(t.search(Ax)>=0)throw Yo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Sa(...t.split("."))._internalPath}catch{throw Yo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Yo(e,t,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${t}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new q(O.INVALID_ARGUMENT,u+e+l)}function C_(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Ix(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Ac("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Ix extends P_{data(){return super.data()}}function Ac(e,t){return typeof t=="string"?Tc(e,t):t instanceof Sa?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new q(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ic{}class Rc extends Ic{}function Sx(e,t,...n){let r=[];t instanceof Ic&&r.push(t),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof bc).length,u=s.filter(l=>l instanceof Sc).length;if(o>1||o>0&&u>0)throw new q(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class Sc extends Rc{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new Sc(t,n,r)}_apply(t){const n=this._parse(t);return V_(t._query,n),new Qn(t.firestore,t.converter,il(t._query,n))}_parse(t){const n=wc(t.firestore);return function(s,o,u,l,c,h,d){let p;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){zd(d,h);const _=[];for(const E of d)_.push(jd(l,s,E));p={arrayValue:{values:_}}}else p=jd(l,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||zd(d,h),p=Tx(u,o,d,h==="in"||h==="not-in");return Ot.create(c,h,p)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class bc extends Ic{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new bc(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Fe.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const l of u)V_(o,l),o=il(o,l)}(t._query,n),new Qn(t.firestore,t.converter,il(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class xc extends Rc{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new xc(t,n)}_apply(t){const n=function(i,s,o){if(i.startAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new as(s,o)}(t._query,this._field,this._direction);return new Qn(t.firestore,t.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new si(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function bx(e,t="asc"){const n=t,r=Ac("orderBy",e);return xc._create(r,n)}class Cc extends Rc{constructor(t,n,r){super(),this.type=t,this._limit=n,this._limitType=r}static _create(t,n,r){return new Cc(t,n,r)}_apply(t){return new Qn(t.firestore,t.converter,Ho(t._query,this._limit,this._limitType))}}function xx(e){return xR("limit",e),Cc._create("limit",e,"F")}function jd(e,t,n){if(typeof(n=vn(n))=="string"){if(n==="")throw new q(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sm(t)&&n.indexOf("/")!==-1)throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(_t.fromString(n));if(!G.isDocumentKey(r))throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return od(e,new G(r))}if(n instanceof Nt)return od(e,n._key);throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${da(n)}.`)}function zd(e,t){if(!Array.isArray(e)||e.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function V_(e,t){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Cx{convertValue(t,n="none"){switch(jn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ct(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(qn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw W(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Wn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(t){var n,r,i;const s=(i=(r=(n=t.fields)===null||n===void 0?void 0:n[jo].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ct(o.doubleValue));return new en(s)}convertGeoPoint(t){return new tn(Ct(t.latitude),Ct(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=ma(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(is(t));default:return null}}convertTimestamp(t){const n=$n(t);return new vt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=_t.fromString(t);ct(Qm(r),9688,{name:t});const i=new ss(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||En(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class Mi{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class lr extends P_{constructor(t,n,r,i,s,o){super(t,n,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new ho(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(Ac("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=lr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}lr._jsonSchemaVersion="firestore/documentSnapshot/1.0",lr._jsonSchema={type:Mt("string",lr._jsonSchemaVersion),bundleSource:Mt("string","DocumentSnapshot"),bundleName:Mt("string"),bundle:Mt("string")};class ho extends lr{data(t={}){return super.data(t)}}class Ur{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Mi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new ho(this._firestore,this._userDataWriter,r.key,r,new Mi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const l=new ho(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Mi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const l=new ho(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Mi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return u.type!==0&&(c=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),h=o.indexOf(u.doc.key)),{type:Vx(u.type),doc:l,oldIndex:c,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Ur._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Wl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function Vx(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(e){e=Tn(e,Nt);const t=Tn(e.firestore,ws);return cx(_c(t),e._key).then(n=>Ox(t,e,n))}Ur._jsonSchemaVersion="firestore/querySnapshot/1.0",Ur._jsonSchema={type:Mt("string",Ur._jsonSchemaVersion),bundleSource:Mt("string","QuerySnapshot"),bundleName:Mt("string"),bundle:Mt("string")};class N_ extends Cx{constructor(t){super(),this.firestore=t}convertBytes(t){return new be(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Nt(this.firestore,null,n)}}function D_(e){e=Tn(e,Qn);const t=Tn(e.firestore,ws),n=_c(t),r=new N_(t);return Rx(e._query),hx(n,e._query).then(i=>new Ur(t,r,e,i))}function Dx(e,t,n){e=Tn(e,Nt);const r=Tn(e.firestore,ws),i=Px(e.converter,t);return k_(r,[vx(wc(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,Ye.none())])}function kx(e,t,n,...r){e=Tn(e,Nt);const i=Tn(e.firestore,ws),s=wc(i);let o;return o=typeof(t=vn(t))=="string"||t instanceof Sa?Ex(s,"updateDoc",e._key,t,n,r):wx(s,"updateDoc",e._key,t),k_(i,[o.toMutation(e._key,Ye.exists(!0))])}function k_(e,t){return function(r,i){const s=new mn;return r.asyncQueue.enqueueAndForget(async()=>Yb(await lx(r),i,s)),s.promise}(_c(e),t)}function Ox(e,t,n){const r=n.docs.get(t._key),i=new N_(e);return new lr(e,i,t._key,r,new Mi(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){ni=i})(iR),Bo(new es("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new ws(new wR(r.getProvider("auth-internal")),new AR(o,r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new q(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ss(c.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Lr(Gf,Wf,t),Lr(Gf,Wf,"esm2017")})();const Mx={apiKey:"AIzaSyAZsdXZU6WbM33SaKP5PoYm7G0V2ABYUSU",authDomain:"great-wave-everywhere.firebaseapp.com",projectId:"great-wave-everywhere",storageBucket:"great-wave-everywhere.firebasestorage.app",messagingSenderId:"636756607685",appId:"1:636756607685:web:2199075bc12821f89466ac",measurementId:"G-XRVYGKFWJ8"},Lx=Xg(Mx),Pc=px(Lx);async function Fx(e){const t=dx(Pc,"words",e.toLowerCase()),n=await Nx(t);n.exists()?await kx(t,{count:n.data().count+1}):await Dx(t,{count:1})}async function Hd(){return(await D_(I_(Pc,"words"))).docs.map(t=>({id:t.id,count:t.data().count}))}async function Gd(e=5){const t=Sx(I_(Pc,"words"),bx("count","desc"),xx(e));return(await D_(t)).docs.map(r=>({id:r.id,count:r.data().count}))}var Ux=Gn('<div class="loading-indicator svelte-xpt74o">Loading...</div>'),Bx=Gn('<img alt="Header image"/>'),$x=(e,t)=>{e.key==="Enter"&&t()},qx=cs('<path fill="#ADC2CE" stroke="#377293" stroke-width="0.5"></path>'),jx=(e,t,n,r)=>{tt(t,$(n).domain,!0),tt(r,$(n).domain||"Unknown domain",!0)},zx=(e,t,n)=>{tt(t,null),tt(n,"")},Hx=cs('<g class="location-pin svelte-xpt74o"><circle class="pin svelte-xpt74o" style="pointer-events: none;"></circle></g>'),Gx=cs('<svg width="200" height="125" viewBox="0 0 200 125" class="world-map svelte-xpt74o"><!><!></svg>'),Wx=Gn('<span style="color: #377293; font-weight: bold; font-size: 0.95rem;"> </span>'),Kx=(e,t,n,r,i,s)=>{const o=t($(n).image.link);tt(r,o,!0);const u=$(i).find(l=>l.domain===o);tt(s,u?u.domain||"Unknown domain":o||"Unknown domain",!0)},Qx=(e,t,n)=>{tt(t,null),tt(n,"")},Xx=Gn('<div class="image-with-title svelte-xpt74o"><a target="_blank" rel="noopener noreferrer"><img class="svelte-xpt74o"/></a> <div class="image-title-box svelte-xpt74o"><div style="font-size: 0.9rem; margin-top: 0.2rem;"> </div></div></div>'),Jx=Gn('<div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;"><span style="color: #377293; font-weight: bold; font-size: 0.95rem;">Hover for image locations:</span> <!></div> <div class="image-container grid-2x4 svelte-xpt74o"></div>',1),Yx=Gn(`<div class="no-images-placeholder svelte-xpt74o"><p class="svelte-xpt74o">Enter a search term above to query Google Images for "Great Wave off
            Kanagawa + [your search term]." Your search results will appear
            here.</p></div>`),Zx=cs('<line stroke="#fff" stroke-opacity="0.6" stroke-width="2" class="svelte-xpt74o"></line>'),tC=(e,t,n)=>t($(n).id),eC=cs('<text fill="#377293" text-anchor="middle" alignment-baseline="middle" filter="url(#dropshadow)" style="cursor: pointer;" class="svelte-xpt74o"> </text>'),nC=(e,t,n)=>t($(n).id),rC=Gn('<li style="cursor:pointer;" class="svelte-xpt74o"> <span class="count svelte-xpt74o"> </span></li>'),iC=Gn(`<main class="svelte-xpt74o"><!>  <div class="header svelte-xpt74o"><div class="header-image-crossfade svelte-xpt74o"></div> <div><div class="title svelte-xpt74o">GREAT WAVE <span style="color: #F0BF91;">REMIX</span></div> <p class="subtitle svelte-xpt74o">Discover Hokusai's "Great Wave off Kanagawa" in unexpected contexts
        worldwide. Search Google Images for any term you associate with this
        iconic Japanese artwork to see how it has been reimagined in formats
        spanning diverse topics and cultures.</p></div></div> <div class="header-piping svelte-xpt74o"></div> <h1 style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;" class="svelte-xpt74o">HOKUSAI'S <em class="italic svelte-xpt74o">GREAT WAVE</em> CAN BE <input type="text" placeholder="ANYTHING" style="margin-left: 0.5rem;" class="svelte-xpt74o"/></h1> <div class="search-container search-container-below-h1 svelte-xpt74o"><div class="button-wrapper svelte-xpt74o"><button class="svelte-xpt74o">Search</button></div> <div class="call-to-action svelte-xpt74o">No images yet â enter a search term above!</div></div> <div class="main-grid svelte-xpt74o"><div class="left-column svelte-xpt74o"><div class="map-container svelte-xpt74o"><!></div> <!> <!></div> <div class="right-column svelte-xpt74o"><div class="word-cloud-container svelte-xpt74o"><div class="call-to-action svelte-xpt74o">Or click on a trending topic!</div> <svg width="120%" height="400" viewBox="0 0 480 400" class="svelte-xpt74o"><defs><filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.3"></feDropShadow></filter></defs><g style="transform: translate(0, -100px)"><!><!></g></svg> <div class="trending-panel svelte-xpt74o"><ul class="svelte-xpt74o"></ul></div></div></div></div> <div style="text-align: left; color: #377293; padding-top: 5rem;"><h2 class="svelte-xpt74o">Why remix the "Great Wave?"</h2> This project explores the impact of Hokusai's iconic artwork, allowing users
    to see for themselves how it continues to reverberate worldwide. Two centuries
    since its creation around 1831, scholars say Hokusaiâs print is possibly the
    most reproduced image in the history of art, with global recognition far beyond
    its original Japanese audience.</div> <div class="bottom-panel"><div class="chart-container svelte-xpt74o"><div><p class="svelte-xpt74o">The exponential-like rise in frequency of the phrase âGreat Wave off
          Kanagawaâ in millions of Google Books shows references to the artwork
          appearing more frequently over time, reflecting Japan's rise as a
          cultural superpower.</p> <p class="svelte-xpt74o">The print helped spark Japonisme in the West (influencing Monet, van
          Gogh, and others), and that early cultural exchange laid the
          foundation for global fame. European artists and critics rediscovered
          Japanese woodblocks after Japan opened to trade in the 19th century,
          elevating Hokusaiâs work in Western art circles.</p> <p class="svelte-xpt74o">"Great Wave" now appears everywhere â from high fashion and novelty
          goods to digital art, emojis, and even LEGO sets. It was chosen for
          the 2024 Japanese 1,000-yen note â a highly public national symbol.</p></div> <div><p class="chart-title svelte-xpt74o">Mentions of "Great Wave off Kanagawa" over time</p> <img src="/great-wave-everywhere/ngram_chart_great_wave_off_kanagawa.png" alt="Google Ngram Viewer chart for 'Great Wave off Kanagawa'" class="ngram-chart svelte-xpt74o"/> <p class="source svelte-xpt74o">Source: Google Books Ngram Viewer, English corpus, 1900â2022</p></div></div></div></main>`);function sC(e,t){rp(t,!0);let n=Ut(0),r;const i=["/great-wave-everywhere/main-image.jpeg","/great-wave-everywhere/Hokusai-Great_Wave_off_Kanagawa-cat-end.jpg","/great-wave-everywhere/tomoko_nagao_hokusai-the_great_wave_of_kanagawa_with_mc_cupnoodle_kewpie_kikkoman_and_kitty_2012_digital_art_50_x_70_cm-_70_x_100_cm.jpe_3.jpg","/great-wave-everywhere/135e9cb8ff232a9c7e1f1be108eb670f.jpg","/great-wave-everywhere/2372ef58832305.5a0b25df284b7.jpg.webp","/great-wave-everywhere/image_BT0qjFvT31.png.jpeg"];yu(()=>{r=setInterval(()=>{tt(n,($(n)+1)%i.length)},5e3)}),Ev(()=>{clearInterval(r)});async function s(H){if(H){tt(m,!0);try{const j=await Et.get(`https://great-wave-api-1muq.onrender.com/api/images/multilang?q=${encodeURIComponent(H)}`);tt(l,j.data.filter(at=>at.image&&at.image.link),!0);const K=$(l).map(at=>at.image.link).filter(Boolean);let rt=[];if(K.length>0)try{rt=(await Et.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:K})).data}catch{}tt(_,rt.filter(at=>{if(at==null)return!1;const Dt=Number(at.lat),St=Number(at.lng);return!(isNaN(Dt)||isNaN(St)||Dt===0&&St===0)}),!0),tt(c,"")}catch(j){console.error("Error fetching images for word",j)}finally{tt(m,!1)}}}function o(H){if(!H)return null;try{const j=H.startsWith("http")?H:`https://${H}`;return new URL(j).hostname}catch{return H}}let u=Ut(null),l=Ut(Ge([])),c=Ut(""),h=Ut(Ge([])),d=Ut(Ge([])),p=Ut(Ge([])),m=Ut(!1),_=Ut(Ge([])),E=Ut(null),v=Ut("");async function C(){try{const H=await fetch("/great-wave-everywhere/ne_110m_admin_0_countries.json");if(!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const j=await H.json(),K=Object.keys(j.objects)[0];tt(E,Nf(j,j.objects[K]),!0)}catch{try{const j=await fetch("/ne_110m_admin_0_countries.json");if(j.ok){const K=await j.json(),rt=Object.keys(K.objects)[0];tt(E,Nf(K,K.objects[rt]),!0)}}catch{}}}yu(async()=>{tt(m,!0);try{try{tt(h,await Hd(),!0),tt(p,await Gd(5),!0),N(),P()}catch(H){console.warn("Firebase connection failed:",H),tt(h,[],!0),tt(p,[],!0)}await C()}finally{tt(m,!1)}});async function b(){if($(c)){tt(m,!0);try{const H=await Et.get(`https://great-wave-api-1muq.onrender.com/api/images/multilang?q=${encodeURIComponent($(c))}`);tt(l,H.data.filter(rt=>rt.image&&rt.image.link),!0);const j=$(l).map(rt=>rt.image.link).filter(Boolean);let K=[];if(j.length>0)try{K=(await Et.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:j})).data}catch{}tt(_,K.filter(rt=>{if(rt==null)return!1;const at=Number(rt.lat),Dt=Number(rt.lng);return!(isNaN(at)||isNaN(Dt)||at===0&&Dt===0)}),!0);try{await Fx($(c)),tt(h,await Hd(),!0),tt(p,await Gd(5),!0),N(),P()}catch(rt){console.warn("Firebase update failed:",rt)}tt(c,"")}catch(H){console.error("Error fetching images",H)}finally{tt(m,!1)}}}function N(){tt(d,[],!0);for(let H=1;H<$(h).length;H++)$(d).push({source:$(h)[H-1].id,target:$(h)[H].id})}function P(){const H=Math.max(...$(h).map(j=>j.count));q1($(h)).force("link",k1($(d)).id(j=>j.id).distance(25)).force("charge",j1().strength(-100)).force("center",m1(200,300)).force("gravity",z1(j=>150*(1-j.count/H),200,300).strength(.5)).force("boundary",()=>{$(h).forEach(j=>{j.x=Math.max(20,Math.min(380,j.x||0)),j.y=Math.max(20,Math.min(580,j.y||0))})}).on("tick",()=>{tt(h,[...$(h)],!0)})}function M(H){return $(h).find(j=>j.id===H)}function U(H){const j=M(H.source),K=M(H.target);return{x1:(j==null?void 0:j.x)||0,y1:(j==null?void 0:j.y)||0,x2:(K==null?void 0:K.x)||0,y2:(K==null?void 0:K.y)||0}}var I=iC(),w=wt(I);{var T=H=>{var j=Ux();$t(H,j)};cn(w,H=>{$(m)&&H(T)})}var S=Ht(w,2),R=wt(S);er(R,21,()=>i,xr,(H,j,K)=>{var rt=Bx();let at;ln(Dt=>{Yt(rt,"src",$(j)),at=gv(rt,1,"svelte-xpt74o",null,at,Dt)},[()=>({visible:$(n)===K,hidden:$(n)!==K})]),$t(H,rt)});var x=Ht(S,4),A=Ht(wt(x),3);A.__keydown=[$x,b];var J=Ht(x,2),F=wt(J),Y=wt(F);Y.__click=b;var ht=Ht(J,2),mt=wt(ht),Lt=wt(mt),$e=wt(Lt);{var me=H=>{var j=Gx();const K=Fs(()=>xA().scale(40).translate([100,62.5])),rt=Fs(()=>mA().projection($(K)));var at=wt(j);er(at,17,()=>$(E).features,xr,(xt,ue,_e)=>{var Qt=Us();const ye=Fs(()=>$(rt)($(ue)));var At=Ei(Qt);{var It=De=>{var Ie=qx();ln(()=>Yt(Ie,"d",$(ye))),$t(De,Ie)},qe=De=>{var Ie=ov();ln(ke=>Sr(Ie,ke),[()=>{var ke;return console.log(`No path data for country ${_e}:`,(ke=$(ue).geometry)==null?void 0:ke.type)}]),$t(De,Ie)};cn(At,De=>{$(ye)?De(It):De(qe,!1)})}$t(xt,Qt)});var Dt=Ht(at);{var St=xt=>{var ue=Us(),_e=Ei(ue);er(_e,17,()=>$(_),xr,(Qt,ye)=>{var At=Us();const It=Fs(()=>$(K)([$(ye).lng,$(ye).lat]));var qe=Ei(At);{var De=Ie=>{var ke=Hx();ke.__mouseover=[jx,u,ye,v],ke.__mouseout=[zx,u,v];var je=wt(ke);ln(()=>{Yt(je,"cx",$(It)[0]),Yt(je,"cy",$(It)[1]),Yt(je,"r",$(u)===$(ye).domain?7:4),Yt(je,"fill",$(u)===$(ye).domain?"#ff4500":"#ff6b35")}),$t(Ie,ke)};cn(qe,Ie=>{$(It)&&Ie(De)})}$t(Qt,At)}),$t(xt,ue)};cn(Dt,xt=>{$(_).length>0&&xt(St)})}$t(H,j)};cn($e,H=>{$(l).length>0&&$(E)&&H(me)})}var Ft=Ht(Lt,2);{var ft=H=>{var j=Jx(),K=Ei(j),rt=Ht(wt(K),2);{var at=St=>{var xt=Wx(),ue=wt(xt);ln(()=>Sr(ue,$(v))),$t(St,xt)};cn(rt,St=>{$(v)&&St(at)})}var Dt=Ht(K,2);er(Dt,23,()=>$(l).slice(0,8),(St,xt)=>`${St.image.link||"no-link"}-${xt}`,(St,xt)=>{var ue=Xx(),_e=wt(ue),Qt=wt(_e);Qt.__mouseover=[Kx,o,xt,u,_,v],Qt.__mouseout=[Qx,u,v];var ye=Ht(_e,2),At=wt(ye),It=wt(At);ln(()=>{Yt(_e,"href",$(xt).image.link),Yt(Qt,"src",$(xt).image.link),Yt(Qt,"alt",$(xt).image.title),Sr(It,$(xt).image.title)}),rv("error",Qt,qe=>{qe.target.src=""}),$t(St,ue)}),$t(H,j)};cn(Ft,H=>{$(l).length>0&&H(ft)})}var Rn=Ht(Ft,2);{var ae=H=>{var j=Yx();$t(H,j)};cn(Rn,H=>{$(l).length===0&&H(ae)})}var xa=Ht(mt,2),wr=wt(xa),Ts=Ht(wt(wr),2),Ca=Ht(wt(Ts)),Xn=wt(Ca);er(Xn,17,()=>$(d),xr,(H,j)=>{var K=Us(),rt=Ei(K);{var at=Dt=>{var St=Zx();ln((xt,ue,_e,Qt)=>{Yt(St,"x1",xt),Yt(St,"y1",ue),Yt(St,"x2",_e),Yt(St,"y2",Qt)},[()=>U($(j)).x1,()=>U($(j)).y1,()=>U($(j)).x2,()=>U($(j)).y2]),$t(Dt,St)};cn(rt,Dt=>{M($(j).source)&&M($(j).target)&&Dt(at)})}$t(H,K)});var Er=Ht(Xn);er(Er,17,()=>$(h),xr,(H,j)=>{var K=eC();K.__click=[tC,s,j],K.__mouseover=at=>{at.target.style.fill="#ff6b35",at.target.style.cursor="pointer"},K.__mouseout=at=>{at.target.style.fill="#377293"};var rt=wt(K);ln(()=>{Yt(K,"x",$(j).x),Yt(K,"y",$(j).y),Yt(K,"font-size",`${8+$(j).count}px`),Sr(rt,$(j).id)}),$t(H,K)});var ai=Ht(Ts,2),ui=wt(ai);er(ui,21,()=>$(p),xr,(H,j)=>{var K=rC();K.__click=[nC,s,j];var rt=wt(K),at=Ht(rt),Dt=wt(at);ln(()=>{Sr(rt,`${$(j).id??""} `),Sr(Dt,`(${$(j).count??""})`)}),$t(H,K)}),wv(A,()=>$(c),H=>tt(c,H)),$t(e,I),ip()}iv(["keydown","click","mouseover","mouseout"]);av(sC,{target:document.getElementById("app")});
