var uy=Object.defineProperty;var ly=(e,t,n)=>t in e?uy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Xa=(e,t,n)=>ly(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const bh=!1;var wl=Array.isArray,cy=Array.prototype.indexOf,El=Array.from,hy=Object.defineProperty,zi=Object.getOwnPropertyDescriptor,fy=Object.getOwnPropertyDescriptors,dy=Object.prototype,py=Array.prototype,Jd=Object.getPrototypeOf,Ch=Object.isExtensible;function my(e){for(var t=0;t<e.length;t++)e[t]()}const Ce=2,Zd=4,ia=8,Tl=16,Tn=32,ni=64,Al=128,ve=256,yo=512,Pe=1024,mn=2048,Er=4096,dn=8192,Il=16384,tp=32768,Rl=65536,Ph=1<<17,gy=1<<18,ep=1<<19,vu=1<<20,Ya=Symbol("$state"),_y=Symbol(""),np=new class extends Error{constructor(){super(...arguments);Xa(this,"name","StaleReactionError");Xa(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function rp(e){return e===this.v}function yy(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ip(e){return!yy(e,this.v)}function vy(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function wy(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ey(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Ty(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ay(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Iy(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ry(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Sy=!1;const Sl=1,bl=2,sp=4,by=8,Cy=16,op=1,Py=2,oe=Symbol(),xy="http://www.w3.org/1999/xhtml";function ap(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ce=null;function xh(e){ce=e}function up(e,t=!1,n){var r=ce={p:ce,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};Uy(()=>{r.d=!0})}function lp(e){const t=ce;if(t!==null){const o=t.e;if(o!==null){var n=ht,r=ot;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];Bn(s.effect),tn(s.reaction),yp(s.fn)}}finally{Bn(n),tn(r)}}ce=t.p,t.m=!0}return{}}function cp(){return!0}function ze(e){if(typeof e!="object"||e===null||Ya in e)return e;const t=Jd(e);if(t!==dy&&t!==py)return e;var n=new Map,r=wl(e),i=Lt(0),s=ot,o=u=>{var c=ot;tn(s);var l=u();return tn(c),l};return r&&n.set("length",Lt(e.length)),new Proxy(e,{defineProperty(u,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&Ay();var h=n.get(c);return h===void 0?h=o(()=>{var d=Lt(l.value);return n.set(c,d),d}):at(h,l.value,!0),!0},deleteProperty(u,c){var l=n.get(c);if(l===void 0){if(c in u){const p=o(()=>Lt(oe));n.set(c,p),Ja(i)}}else{if(r&&typeof c=="string"){var h=n.get("length"),d=Number(c);Number.isInteger(d)&&d<h.v&&at(h,d)}at(l,oe),Ja(i)}return!0},get(u,c,l){var g;if(c===Ya)return e;var h=n.get(c),d=c in u;if(h===void 0&&(!d||(g=zi(u,c))!=null&&g.writable)&&(h=o(()=>{var _=ze(d?u[c]:oe),E=Lt(_);return E}),n.set(c,h)),h!==void 0){var p=$(h);return p===oe?void 0:p}return Reflect.get(u,c,l)},getOwnPropertyDescriptor(u,c){var l=Reflect.getOwnPropertyDescriptor(u,c);if(l&&"value"in l){var h=n.get(c);h&&(l.value=$(h))}else if(l===void 0){var d=n.get(c),p=d==null?void 0:d.v;if(d!==void 0&&p!==oe)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return l},has(u,c){var p;if(c===Ya)return!0;var l=n.get(c),h=l!==void 0&&l.v!==oe||Reflect.has(u,c);if(l!==void 0||ht!==null&&(!h||(p=zi(u,c))!=null&&p.writable)){l===void 0&&(l=o(()=>{var g=h?ze(u[c]):oe,_=Lt(g);return _}),n.set(c,l));var d=$(l);if(d===oe)return!1}return h},set(u,c,l,h){var N;var d=n.get(c),p=c in u;if(r&&c==="length")for(var g=l;g<d.v;g+=1){var _=n.get(g+"");_!==void 0?at(_,oe):g in u&&(_=o(()=>Lt(oe)),n.set(g+"",_))}if(d===void 0)(!p||(N=zi(u,c))!=null&&N.writable)&&(d=o(()=>Lt(void 0)),at(d,ze(l)),n.set(c,d));else{p=d.v!==oe;var E=o(()=>ze(l));at(d,E)}var v=Reflect.getOwnPropertyDescriptor(u,c);if(v!=null&&v.set&&v.set.call(h,l),!p){if(r&&typeof c=="string"){var P=n.get("length"),b=Number(c);Number.isInteger(b)&&b>=P.v&&at(P,b+1)}Ja(i)}return!0},ownKeys(u){$(i);var c=Reflect.ownKeys(u).filter(d=>{var p=n.get(d);return p===void 0||p.v!==oe});for(var[l,h]of n)h.v!==oe&&!(l in u)&&c.push(l);return c},setPrototypeOf(){Iy()}})}function Ja(e,t=1){at(e,e.v+t)}function Cl(e){var t=Ce|mn,n=ot!==null&&(ot.f&Ce)!==0?ot:null;return ht===null||n!==null&&(n.f&ve)!==0?t|=ve:ht.f|=ep,{ctx:ce,deps:null,effects:null,equals:rp,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??ht,ac:null}}function js(e){const t=Cl(e);return Sp(t),t}function Vy(e){const t=Cl(e);return t.equals=ip,t}function hp(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Un(t[n])}}function Ny(e){for(var t=e.parent;t!==null;){if((t.f&Ce)===0)return t;t=t.parent}return null}function fp(e){var t,n=ht;Bn(Ny(e));try{hp(e),t=xp(e)}finally{Bn(n)}return t}function dp(e){var t=fp(e);if(e.equals(t)||(e.v=t,e.wv=Cp()),!ii){var n=(Dn||(e.f&ve)!==0)&&e.deps!==null?Er:Pe;en(e,n)}}const Xi=new Map;function vo(e,t){var n={f:0,v:e,reactions:null,equals:rp,rv:0,wv:0};return n}function Lt(e,t){const n=vo(e);return Sp(n),n}function Dy(e,t=!1,n=!0){const r=vo(e);return t||(r.equals=ip),r}function at(e,t,n=!1){ot!==null&&(!He||(ot.f&Ph)!==0)&&cp()&&(ot.f&(Ce|Tl|Ph))!==0&&!(Ut!=null&&Ut[1].includes(e)&&Ut[0]===ot)&&Ry();let r=n?ze(t):t;return wu(e,r)}function wu(e,t){if(!e.equals(t)){var n=e.v;ii?Xi.set(e,t):Xi.set(e,n),e.v=t,(e.f&Ce)!==0&&((e.f&mn)!==0&&fp(e),en(e,(e.f&ve)===0?Pe:Er)),e.wv=Cp(),pp(e,mn),ht!==null&&(ht.f&Pe)!==0&&(ht.f&(Tn|ni))===0&&(Ae===null?Wy([e]):Ae.push(e))}return t}function pp(e,t){var n=e.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i],o=s.f;(o&mn)===0&&(en(s,t),(o&(Pe|ve))!==0&&((o&Ce)!==0?pp(s,Er):Nl(s)))}}let ky=!1;var Vh,mp,gp,_p;function Oy(){if(Vh===void 0){Vh=window,mp=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;gp=zi(t,"firstChild").get,_p=zi(t,"nextSibling").get,Ch(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Ch(n)&&(n.__t=void 0)}}function sa(e=""){return document.createTextNode(e)}function _e(e){return gp.call(e)}function oa(e){return _p.call(e)}function wt(e,t){return _e(e)}function Ci(e,t){{var n=_e(e);return n instanceof Comment&&n.data===""?oa(n):n}}function $t(e,t=1,n=!1){let r=e;for(;t--;)r=oa(r);return r}function My(e){e.textContent=""}function Ly(e){ht===null&&ot===null&&Ey(),ot!==null&&(ot.f&ve)!==0&&ht===null&&wy(),ii&&vy()}function Fy(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ri(e,t,n,r=!0){var i=ht,s={ctx:ce,deps:null,nodes_start:null,nodes_end:null,f:e|mn,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Vl(s),s.f|=tp}catch(c){throw Un(s),c}else t!==null&&Nl(s);var o=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(ep|Al))===0;if(!o&&r&&(i!==null&&Fy(s,i),ot!==null&&(ot.f&Ce)!==0)){var u=ot;(u.effects??(u.effects=[])).push(s)}return s}function Uy(e){const t=ri(ia,null,!1);return en(t,Pe),t.teardown=e,t}function By(e){Ly();var t=ht!==null&&(ht.f&Tn)!==0&&ce!==null&&!ce.m;if(t){var n=ce;(n.e??(n.e=[])).push({fn:e,effect:ht,reaction:ot})}else{var r=yp(e);return r}}function $y(e){const t=ri(ni,e,!0);return(n={})=>new Promise(r=>{n.outro?wo(t,()=>{Un(t),r(void 0)}):(Un(t),r(void 0))})}function yp(e){return ri(Zd,e,!1)}function qy(e){return ri(ia,e,!0)}function qe(e,t=[],n=Cl){const r=t.map(n);return Pl(()=>e(...r.map($)))}function Pl(e,t=0){var n=ri(ia|Tl|t,e,!0);return n}function Yi(e,t=!0){return ri(ia|Tn,e,!0,t)}function vp(e){var t=e.teardown;if(t!==null){const n=ii,r=ot;Nh(!0),tn(null);try{t.call(null)}finally{Nh(n),tn(r)}}}function wp(e,t=!1){var i;var n=e.first;for(e.first=e.last=null;n!==null;){(i=n.ac)==null||i.abort(np);var r=n.next;(n.f&ni)!==0?n.parent=null:Un(n,t),n=r}}function jy(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Tn)===0&&Un(t),t=n}}function Un(e,t=!0){var n=!1;(t||(e.f&gy)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Ep(e.nodes_start,e.nodes_end),n=!0),wp(e,t&&!n),Ro(e,0),en(e,Il);var r=e.transitions;if(r!==null)for(const s of r)s.stop();vp(e);var i=e.parent;i!==null&&i.first!==null&&Tp(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Ep(e,t){for(;e!==null;){var n=e===t?null:oa(e);e.remove(),e=n}}function Tp(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function wo(e,t){var n=[];xl(e,n,!0),Ap(n,()=>{Un(e),t&&t()})}function Ap(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function xl(e,t,n){if((e.f&dn)===0){if(e.f^=dn,e.transitions!==null)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&Rl)!==0||(r.f&Tn)!==0;xl(r,t,s?n:!1),r=i}}}function Eo(e){Ip(e,!0)}function Ip(e,t){if((e.f&dn)!==0){e.f^=dn;for(var n=e.first;n!==null;){var r=n.next,i=(n.f&Rl)!==0||(n.f&Tn)!==0;Ip(n,i?t:!1),n=r}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let To=[];function zy(){var e=To;To=[],my(e)}function Hy(e){To.length===0&&queueMicrotask(zy),To.push(e)}function Gy(e){var t=ht;if((t.f&tp)===0){if((t.f&Al)===0)throw e;t.fn(e)}else Rp(e,t)}function Rp(e,t){for(;t!==null;){if((t.f&Al)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let Eu=!1,Ao=null,cr=!1,ii=!1;function Nh(e){ii=e}let ro=[];let ot=null,He=!1;function tn(e){ot=e}let ht=null;function Bn(e){ht=e}let Ut=null;function Sp(e){ot!==null&&ot.f&vu&&(Ut===null?Ut=[ot,[e]]:Ut[1].push(e))}let te=null,me=0,Ae=null;function Wy(e){Ae=e}let bp=1,Io=0,Dn=!1;function Cp(){return++bp}function aa(e){var d;var t=e.f;if((t&mn)!==0)return!0;if((t&Er)!==0){var n=e.deps,r=(t&ve)!==0;if(n!==null){var i,s,o=(t&yo)!==0,u=r&&ht!==null&&!Dn,c=n.length;if(o||u){var l=e,h=l.parent;for(i=0;i<c;i++)s=n[i],(o||!((d=s==null?void 0:s.reactions)!=null&&d.includes(l)))&&(s.reactions??(s.reactions=[])).push(l);o&&(l.f^=yo),u&&h!==null&&(h.f&ve)===0&&(l.f^=ve)}for(i=0;i<c;i++)if(s=n[i],aa(s)&&dp(s),s.wv>e.wv)return!0}(!r||ht!==null&&!Dn)&&en(e,Pe)}return!1}function Pp(e,t,n=!0){var r=e.reactions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];Ut!=null&&Ut[1].includes(e)&&Ut[0]===ot||((s.f&Ce)!==0?Pp(s,t,!1):t===s&&(n?en(s,mn):(s.f&Pe)!==0&&en(s,Er),Nl(s)))}}function xp(e){var g;var t=te,n=me,r=Ae,i=ot,s=Dn,o=Ut,u=ce,c=He,l=e.f;te=null,me=0,Ae=null,Dn=(l&ve)!==0&&(He||!cr||ot===null),ot=(l&(Tn|ni))===0?e:null,Ut=null,xh(e.ctx),He=!1,Io++,e.f|=vu,e.ac!==null&&(e.ac.abort(np),e.ac=null);try{var h=(0,e.fn)(),d=e.deps;if(te!==null){var p;if(Ro(e,me),d!==null&&me>0)for(d.length=me+te.length,p=0;p<te.length;p++)d[me+p]=te[p];else e.deps=d=te;if(!Dn||(l&Ce)!==0&&e.reactions!==null)for(p=me;p<d.length;p++)((g=d[p]).reactions??(g.reactions=[])).push(e)}else d!==null&&me<d.length&&(Ro(e,me),d.length=me);if(cp()&&Ae!==null&&!He&&d!==null&&(e.f&(Ce|Er|mn))===0)for(p=0;p<Ae.length;p++)Pp(Ae[p],e);return i!==null&&i!==e&&(Io++,Ae!==null&&(r===null?r=Ae:r.push(...Ae))),h}catch(_){Gy(_)}finally{te=t,me=n,Ae=r,ot=i,Dn=s,Ut=o,xh(u),He=c,e.f^=vu}}function Ky(e,t){let n=t.reactions;if(n!==null){var r=cy.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&Ce)!==0&&(te===null||!te.includes(t))&&(en(t,Er),(t.f&(ve|yo))===0&&(t.f^=yo),hp(t),Ro(t,0))}function Ro(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Ky(e,n[r])}function Vl(e){var t=e.f;if((t&Il)===0){en(e,Pe);var n=ht,r=cr;ht=e,cr=!0;try{(t&Tl)!==0?jy(e):wp(e),vp(e);var i=xp(e);e.teardown=typeof i=="function"?i:null,e.wv=bp;var s;bh&&Sy&&(e.f&mn)!==0&&e.deps}finally{cr=r,ht=n}}}function Qy(){try{Ty()}catch(e){if(Ao!==null)Rp(e,Ao);else throw e}}function Xy(){var e=cr;try{var t=0;for(cr=!0;ro.length>0;){t++>1e3&&Qy();var n=ro,r=n.length;ro=[];for(var i=0;i<r;i++){var s=Jy(n[i]);Yy(s)}Xi.clear()}}finally{Eu=!1,cr=e,Ao=null}}function Yy(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(Il|dn))===0&&aa(r)&&(Vl(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Tp(r):r.fn=null))}}function Nl(e){Eu||(Eu=!0,queueMicrotask(Xy));for(var t=Ao=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(ni|Tn))!==0){if((n&Pe)===0)return;t.f^=Pe}}ro.push(t)}function Jy(e){for(var t=[],n=e;n!==null;){var r=n.f,i=(r&(Tn|ni))!==0,s=i&&(r&Pe)!==0;if(!s&&(r&dn)===0){(r&Zd)!==0?t.push(n):i?n.f^=Pe:aa(n)&&Vl(n);var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return t}function $(e){var t=e.f,n=(t&Ce)!==0;if(ot!==null&&!He){if(!(Ut!=null&&Ut[1].includes(e))||Ut[0]!==ot){var r=ot.deps;e.rv<Io&&(e.rv=Io,te===null&&r!==null&&r[me]===e?me++:te===null?te=[e]:(!Dn||!te.includes(e))&&te.push(e))}}else if(n&&e.deps===null&&e.effects===null){var i=e,s=i.parent;s!==null&&(s.f&ve)===0&&(i.f^=ve)}return n&&(i=e,aa(i)&&dp(i)),ii&&Xi.has(e)?Xi.get(e):e.v}function Dl(e){var t=He;try{return He=!0,e()}finally{He=t}}const Zy=-7169;function en(e,t){e.f=e.f&Zy|t}const tv=["touchstart","touchmove"];function ev(e){return tv.includes(e)}let Dh=!1;function nv(){Dh||(Dh=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function rv(e){var t=ot,n=ht;tn(null),Bn(null);try{return e()}finally{tn(t),Bn(n)}}function iv(e,t,n,r=n){e.addEventListener(t,()=>rv(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),nv()}const Vp=new Set,Tu=new Set;function sv(e){for(var t=0;t<e.length;t++)Vp.add(e[t]);for(var n of Tu)n(e)}function zs(e){var b;var t=this,n=t.ownerDocument,r=e.type,i=((b=e.composedPath)==null?void 0:b.call(e))||[],s=i[0]||e.target,o=0,u=e.__root;if(u){var c=i.indexOf(u);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var l=i.indexOf(t);if(l===-1)return;c<=l&&(o=c)}if(s=i[o]||e.target,s!==t){hy(e,"currentTarget",{configurable:!0,get(){return s||n}});var h=ot,d=ht;tn(null),Bn(null);try{for(var p,g=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+r];if(E!=null&&(!s.disabled||e.target===s))if(wl(E)){var[v,...P]=E;v.apply(s,[e,...P])}else E.call(s,e)}catch(N){p?g.push(N):p=N}if(e.cancelBubble||_===t||_===null)break;s=_}if(p){for(let N of g)queueMicrotask(()=>{throw N});throw p}}finally{e.__root=t,delete e.currentTarget,tn(h),Bn(d)}}}function kl(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function pr(e,t){var n=ht;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function Kn(e,t){var n=(t&op)!==0,r=(t&Py)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=kl(s?e:"<!>"+e),n||(i=_e(i)));var o=r||mp?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=_e(o),c=o.lastChild;pr(u,c)}else pr(o,o);return o}}function ov(e,t,n="svg"){var r=!e.startsWith("<!>"),i=(t&op)!==0,s=`<${n}>${r?e:"<!>"+e}</${n}>`,o;return()=>{if(!o){var u=kl(s),c=_e(u);if(i)for(o=document.createDocumentFragment();_e(c);)o.appendChild(_e(c));else o=_e(c)}var l=o.cloneNode(!0);if(i){var h=_e(l),d=l.lastChild;pr(h,d)}else pr(l,l);return l}}function gs(e,t){return ov(e,t,"svg")}function kh(e=""){{var t=sa(e+"");return pr(t,t),t}}function Za(){var e=document.createDocumentFragment(),t=document.createComment(""),n=sa();return e.append(t,n),pr(t,n),e}function Mt(e,t){e!==null&&e.before(t)}function Pi(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function av(e,t){return uv(e,t)}const Dr=new Map;function uv(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:o=!0}){Oy();var u=new Set,c=d=>{for(var p=0;p<d.length;p++){var g=d[p];if(!u.has(g)){u.add(g);var _=ev(g);t.addEventListener(g,zs,{passive:_});var E=Dr.get(g);E===void 0?(document.addEventListener(g,zs,{passive:_}),Dr.set(g,1)):Dr.set(g,E+1)}}};c(El(Vp)),Tu.add(c);var l=void 0,h=$y(()=>{var d=n??t.appendChild(sa());return Yi(()=>{if(s){up({});var p=ce;p.c=s}i&&(r.$$events=i),l=e(d,r)||{},s&&lp()}),()=>{var _;for(var p of u){t.removeEventListener(p,zs);var g=Dr.get(p);--g===0?(document.removeEventListener(p,zs),Dr.delete(p)):Dr.set(p,g)}Tu.delete(c),d!==n&&((_=d.parentNode)==null||_.removeChild(d))}});return lv.set(l,h),l}let lv=new WeakMap;function xn(e,t,[n,r]=[0,0]){var i=e,s=null,o=null,u=oe,c=n>0?Rl:0,l=!1;const h=(p,g=!0)=>{l=!0,d(g,p)},d=(p,g)=>{u!==(u=p)&&(u?(s?Eo(s):g&&(s=Yi(()=>g(i))),o&&wo(o,()=>{o=null})):(o?Eo(o):g&&(o=Yi(()=>g(i,[n+1,r]))),s&&wo(s,()=>{s=null})))};Pl(()=>{l=!1,t(h),l||d(null,null)},c)}function kr(e,t){return t}function cv(e,t,n,r){for(var i=[],s=t.length,o=0;o<s;o++)xl(t[o].e,i,!0);var u=s>0&&i.length===0&&n!==null;if(u){var c=n.parentNode;My(c),c.append(n),r.clear(),Vn(e,t[0].prev,t[s-1].next)}Ap(i,()=>{for(var l=0;l<s;l++){var h=t[l];u||(r.delete(h.k),Vn(e,h.prev,h.next)),Un(h.e,!u)}})}function Or(e,t,n,r,i,s=null){var o=e,u={flags:t,items:new Map,first:null},c=(t&sp)!==0;if(c){var l=e;o=l.appendChild(sa())}var h=null,d=!1,p=Vy(()=>{var g=n();return wl(g)?g:g==null?[]:El(g)});Pl(()=>{var g=$(p),_=g.length;d&&_===0||(d=_===0,hv(g,u,o,i,t,r,n),s!==null&&(_===0?h?Eo(h):h=Yi(()=>s(o)):h!==null&&wo(h,()=>{h=null})),$(p))})}function hv(e,t,n,r,i,s,o){var X,F,Y,lt;var u=(i&by)!==0,c=(i&(Sl|bl))!==0,l=e.length,h=t.items,d=t.first,p=d,g,_=null,E,v=[],P=[],b,N,x,M;if(u)for(M=0;M<l;M+=1)b=e[M],N=s(b,M),x=h.get(N),x!==void 0&&((X=x.a)==null||X.measure(),(E??(E=new Set)).add(x));for(M=0;M<l;M+=1){if(b=e[M],N=s(b,M),x=h.get(N),x===void 0){var U=p?p.e.nodes_start:n;_=dv(U,t,_,_===null?t.first:_.next,b,N,M,r,i,o),h.set(N,_),v=[],P=[],p=_.next;continue}if(c&&fv(x,b,M,i),(x.e.f&dn)!==0&&(Eo(x.e),u&&((F=x.a)==null||F.unfix(),(E??(E=new Set)).delete(x))),x!==p){if(g!==void 0&&g.has(x)){if(v.length<P.length){var I=P[0],w;_=I.prev;var T=v[0],S=v[v.length-1];for(w=0;w<v.length;w+=1)Oh(v[w],I,n);for(w=0;w<P.length;w+=1)g.delete(P[w]);Vn(t,T.prev,S.next),Vn(t,_,T),Vn(t,S,I),p=I,_=S,M-=1,v=[],P=[]}else g.delete(x),Oh(x,p,n),Vn(t,x.prev,x.next),Vn(t,x,_===null?t.first:_.next),Vn(t,_,x),_=x;continue}for(v=[],P=[];p!==null&&p.k!==N;)(p.e.f&dn)===0&&(g??(g=new Set)).add(p),P.push(p),p=p.next;if(p===null)continue;x=p}v.push(x),_=x,p=x.next}if(p!==null||g!==void 0){for(var R=g===void 0?[]:El(g);p!==null;)(p.e.f&dn)===0&&R.push(p),p=p.next;var C=R.length;if(C>0){var A=(i&sp)!==0&&l===0?n:null;if(u){for(M=0;M<C;M+=1)(Y=R[M].a)==null||Y.measure();for(M=0;M<C;M+=1)(lt=R[M].a)==null||lt.fix()}cv(t,R,A,h)}}u&&Hy(()=>{var mt;if(E!==void 0)for(x of E)(mt=x.a)==null||mt.apply()}),ht.first=t.first&&t.first.e,ht.last=_&&_.e}function fv(e,t,n,r){(r&Sl)!==0&&wu(e.v,t),(r&bl)!==0?wu(e.i,n):e.i=n}function dv(e,t,n,r,i,s,o,u,c,l){var h=(c&Sl)!==0,d=(c&Cy)===0,p=h?d?Dy(i,!1,!1):vo(i):i,g=(c&bl)===0?o:vo(o),_={i:g,v:p,k:s,a:null,e:null,prev:n,next:r};try{return _.e=Yi(()=>u(e,p,g,l),ky),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function Oh(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var o=oa(s);i.before(s),s=o}}function Vn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function pv(e,t,n=!1,r=!1,i=!1){var s=e,o="";qe(()=>{var u=ht;if(o!==(o=t()??"")&&(u.nodes_start!==null&&(Ep(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),o!=="")){var c=o+"";n?c=`<svg>${c}</svg>`:r&&(c=`<math>${c}</math>`);var l=kl(c);if((n||r)&&(l=_e(l)),pr(_e(l),l.lastChild),n||r)for(;_e(l);)s.before(_e(l));else s.before(l)}})}const Mh=[...` 	
\r\fÂ \v\uFEFF`];function mv(e,t,n){var r=""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,o=0;(o=r.indexOf(i,o))>=0;){var u=o+s;(o===0||Mh.includes(r[o-1]))&&(u===r.length||Mh.includes(r[u]))?r=(o===0?"":r.substring(0,o))+r.substring(u+1):o=u}}return r===""?null:r}function gv(e,t){return e==null?null:String(e)}function Lh(e,t,n,r,i,s){var o=e.__className;if(o!==n||o===void 0){var u=mv(n,r,s);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(s&&i!==s)for(var c in s){var l=!!s[c];(i==null||l!==!!i[c])&&e.classList.toggle(c,l)}return s}function Fh(e,t,n,r){var i=e.__style;if(i!==t){var s=gv(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return r}const _v=Symbol("is custom element"),yv=Symbol("is html");function Wt(e,t,n,r){var i=vv(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[_y]=n),n==null?e.removeAttribute(t):typeof n!="string"&&wv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function vv(e){return e.__attributes??(e.__attributes={[_v]:e.nodeName.includes("-"),[yv]:e.namespaceURI===xy})}var Uh=new Map;function wv(e){var t=Uh.get(e.nodeName);if(t)return t;Uh.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=fy(r);for(var s in n)n[s].set&&t.push(s);r=Jd(r)}return t}function Ev(e,t,n=t){iv(e,"input",r=>{var i=r?e.defaultValue:e.value;if(i=tu(e)?eu(i):i,n(i),i!==(i=t())){var s=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(o,e.value.length))}}),Dl(t)==null&&e.value&&n(tu(e)?eu(e.value):e.value),qy(()=>{var r=t();tu(e)&&r===eu(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function tu(e){var t=e.type;return t==="number"||t==="range"}function eu(e){return e===""?null:+e}function Au(e){ce===null&&ap(),By(()=>{const t=Dl(e);if(typeof t=="function")return t})}function Tv(e){ce===null&&ap(),Au(()=>()=>Dl(e))}const Av="5";var Yd;typeof window<"u"&&((Yd=window.__svelte??(window.__svelte={})).v??(Yd.v=new Set)).add(Av);const Iv=()=>{};var Bh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},Rv=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],o=e[n++],u=e[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},Dp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,u=o?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,h=s>>2,d=(s&3)<<4|u>>4;let p=(u&15)<<2|l>>6,g=l&63;c||(g=64,o||(p=64)),r.push(n[h],n[d],n[p],n[g])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Np(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Rv(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],u=i<e.length?n[e.charAt(i)]:0;++i;const l=i<e.length?n[e.charAt(i)]:64;++i;const d=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||u==null||l==null||d==null)throw new Sv;const p=s<<2|u>>4;if(r.push(p),l!==64){const g=u<<4&240|l>>2;if(r.push(g),d!==64){const _=l<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Sv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bv=function(e){const t=Np(e);return Dp.encodeByteArray(t,!0)},So=function(e){return bv(e).replace(/\./g,"")},Cv=function(e){try{return Dp.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv=()=>Pv().__FIREBASE_DEFAULTS__,Vv=()=>{if(typeof process>"u"||typeof Bh>"u")return;const e=Bh.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Nv=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Cv(e[1]);return t&&JSON.parse(t)},Ol=()=>{try{return Iv()||xv()||Vv()||Nv()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Dv=e=>{var t,n;return(n=(t=Ol())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},kv=e=>{const t=Dv(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},kp=()=>{var e;return(e=Ol())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Mv(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[So(JSON.stringify(n)),So(JSON.stringify(o)),""].join(".")}const Hi={};function Fv(){const e={prod:[],emulator:[]};for(const t of Object.keys(Hi))Hi[t]?e.emulator.push(t):e.prod.push(t);return e}function Uv(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let $h=!1;function Bv(e,t){if(typeof window>"u"||typeof document>"u"||!Ml(window.location.host)||Hi[e]===t||Hi[e]||$h)return;Hi[e]=t;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=Fv().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function u(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function l(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{$h=!0,o()},p}function h(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=Uv(r),g=n("text"),_=document.getElementById(g)||document.createElement("span"),E=n("learnmore"),v=document.getElementById(E)||document.createElement("a"),P=n("preprendIcon"),b=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;u(N),h(v,E);const x=l();c(b,P),N.append(b,_,v,x),document.body.appendChild(N)}s?(_.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qv(){var e;const t=(e=Ol())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jv(){return!qv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zv(){try{return typeof indexedDB=="object"}catch{return!1}}function Hv(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="FirebaseError";class si extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Gv,Object.setPrototypeOf(this,si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Op.prototype.create)}}class Op{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?Wv(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new si(i,u,r)}}function Wv(e,t){return e.replace(Kv,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const Kv=/\{\$([^}]+)}/g;function bo(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],o=t[i];if(qh(s)&&qh(o)){if(!bo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function qh(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(e){return e&&e._delegate?e._delegate:e}class Ji{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const or="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new Ov;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Yv(t))try{this.getOrInitializeService({instanceIdentifier:or})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=or){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=or){return this.instances.has(t)}getOptions(t=or){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Xv(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=or){return this.component?this.component.multipleInstances?t:or:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Xv(e){return e===or?void 0:e}function Yv(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Qv(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(nt||(nt={}));const Zv={debug:nt.DEBUG,verbose:nt.VERBOSE,info:nt.INFO,warn:nt.WARN,error:nt.ERROR,silent:nt.SILENT},t0=nt.INFO,e0={[nt.DEBUG]:"log",[nt.VERBOSE]:"log",[nt.INFO]:"info",[nt.WARN]:"warn",[nt.ERROR]:"error"},n0=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=e0[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Mp{constructor(t){this.name=t,this._logLevel=t0,this._logHandler=n0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in nt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Zv[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,nt.DEBUG,...t),this._logHandler(this,nt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,nt.VERBOSE,...t),this._logHandler(this,nt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,nt.INFO,...t),this._logHandler(this,nt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,nt.WARN,...t),this._logHandler(this,nt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,nt.ERROR,...t),this._logHandler(this,nt.ERROR,...t)}}const r0=(e,t)=>t.some(n=>e instanceof n);let jh,zh;function i0(){return jh||(jh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s0(){return zh||(zh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lp=new WeakMap,Iu=new WeakMap,Fp=new WeakMap,nu=new WeakMap,Ll=new WeakMap;function o0(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(On(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Lp.set(n,e)}).catch(()=>{}),Ll.set(t,e),t}function a0(e){if(Iu.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});Iu.set(e,t)}let Ru={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Iu.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Fp.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return On(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function u0(e){Ru=e(Ru)}function l0(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(ru(this),t,...n);return Fp.set(r,t.sort?t.sort():[t]),On(r)}:s0().includes(e)?function(...t){return e.apply(ru(this),t),On(Lp.get(this))}:function(...t){return On(e.apply(ru(this),t))}}function c0(e){return typeof e=="function"?l0(e):(e instanceof IDBTransaction&&a0(e),r0(e,i0())?new Proxy(e,Ru):e)}function On(e){if(e instanceof IDBRequest)return o0(e);if(nu.has(e))return nu.get(e);const t=c0(e);return t!==e&&(nu.set(e,t),Ll.set(t,e)),t}const ru=e=>Ll.get(e);function h0(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),u=On(o);return r&&o.addEventListener("upgradeneeded",c=>{r(On(o.result),c.oldVersion,c.newVersion,On(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),u}const f0=["get","getKey","getAll","getAllKeys","count"],d0=["put","add","delete","clear"],iu=new Map;function Hh(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(iu.get(t))return iu.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=d0.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||f0.includes(n)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(u.shift())),(await Promise.all([l[n](...u),i&&c.done]))[0]};return iu.set(t,s),s}u0(e=>({...e,get:(t,n,r)=>Hh(t,n)||e.get(t,n,r),has:(t,n)=>!!Hh(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(m0(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function m0(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Su="@firebase/app",Gh="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n=new Mp("@firebase/app"),g0="@firebase/app-compat",_0="@firebase/analytics-compat",y0="@firebase/analytics",v0="@firebase/app-check-compat",w0="@firebase/app-check",E0="@firebase/auth",T0="@firebase/auth-compat",A0="@firebase/database",I0="@firebase/data-connect",R0="@firebase/database-compat",S0="@firebase/functions",b0="@firebase/functions-compat",C0="@firebase/installations",P0="@firebase/installations-compat",x0="@firebase/messaging",V0="@firebase/messaging-compat",N0="@firebase/performance",D0="@firebase/performance-compat",k0="@firebase/remote-config",O0="@firebase/remote-config-compat",M0="@firebase/storage",L0="@firebase/storage-compat",F0="@firebase/firestore",U0="@firebase/ai",B0="@firebase/firestore-compat",$0="firebase",q0="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu="[DEFAULT]",j0={[Su]:"fire-core",[g0]:"fire-core-compat",[y0]:"fire-analytics",[_0]:"fire-analytics-compat",[w0]:"fire-app-check",[v0]:"fire-app-check-compat",[E0]:"fire-auth",[T0]:"fire-auth-compat",[A0]:"fire-rtdb",[I0]:"fire-data-connect",[R0]:"fire-rtdb-compat",[S0]:"fire-fn",[b0]:"fire-fn-compat",[C0]:"fire-iid",[P0]:"fire-iid-compat",[x0]:"fire-fcm",[V0]:"fire-fcm-compat",[N0]:"fire-perf",[D0]:"fire-perf-compat",[k0]:"fire-rc",[O0]:"fire-rc-compat",[M0]:"fire-gcs",[L0]:"fire-gcs-compat",[F0]:"fire-fst",[B0]:"fire-fst-compat",[U0]:"fire-vertex","fire-js":"fire-js",[$0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=new Map,z0=new Map,Cu=new Map;function Wh(e,t){try{e.container.addComponent(t)}catch(n){_n.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Po(e){const t=e.name;if(Cu.has(t))return _n.debug(`There were multiple attempts to register component ${t}.`),!1;Cu.set(t,e);for(const n of Co.values())Wh(n,e);for(const n of z0.values())Wh(n,e);return!0}function H0(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function G0(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mn=new Op("app","Firebase",W0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ji("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Mn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=q0;function Up(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:bu,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw Mn.create("bad-app-name",{appName:String(i)});if(n||(n=kp()),!n)throw Mn.create("no-options");const s=Co.get(i);if(s){if(bo(n,s.options)&&bo(r,s.config))return s;throw Mn.create("duplicate-app",{appName:i})}const o=new Jv(i);for(const c of Cu.values())o.addComponent(c);const u=new K0(n,r,o);return Co.set(i,u),u}function X0(e=bu){const t=Co.get(e);if(!t&&e===bu&&kp())return Up();if(!t)throw Mn.create("no-app",{appName:e});return t}function jr(e,t,n){var r;let i=(r=j0[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${t}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),_n.warn(u.join(" "));return}Po(new Ji(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="firebase-heartbeat-database",J0=1,Zi="firebase-heartbeat-store";let su=null;function Bp(){return su||(su=h0(Y0,J0,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Zi)}catch(n){console.warn(n)}}}}).catch(e=>{throw Mn.create("idb-open",{originalErrorMessage:e.message})})),su}async function Z0(e){try{const n=(await Bp()).transaction(Zi),r=await n.objectStore(Zi).get($p(e));return await n.done,r}catch(t){if(t instanceof si)_n.warn(t.message);else{const n=Mn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});_n.warn(n.message)}}}async function Kh(e,t){try{const r=(await Bp()).transaction(Zi,"readwrite");await r.objectStore(Zi).put(t,$p(e)),await r.done}catch(n){if(n instanceof si)_n.warn(n.message);else{const r=Mn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});_n.warn(r.message)}}}function $p(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=1024,ew=30;class nw{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new iw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Qh();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>ew){const o=sw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){_n.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Qh(),{heartbeatsToSend:r,unsentEntries:i}=rw(this._heartbeatsCache.heartbeats),s=So(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return _n.warn(n),""}}}function Qh(){return new Date().toISOString().substring(0,10)}function rw(e,t=tw){const n=[];let r=e.slice();for(const i of e){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Xh(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Xh(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class iw{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zv()?Hv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Z0(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Kh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Kh(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Xh(e){return So(JSON.stringify({version:2,heartbeats:e})).length}function sw(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(e){Po(new Ji("platform-logger",t=>new p0(t),"PRIVATE")),Po(new Ji("heartbeat",t=>new nw(t),"PRIVATE")),jr(Su,Gh,e),jr(Su,Gh,"esm2017"),jr("fire-js","")}ow("");var aw="firebase",uw="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jr(aw,uw,"app");var Yh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ln,qp;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,w){function T(){}T.prototype=w.prototype,I.D=w.prototype,I.prototype=new T,I.prototype.constructor=I,I.C=function(S,R,C){for(var A=Array(arguments.length-2),X=2;X<arguments.length;X++)A[X-2]=arguments[X];return w.prototype[R].apply(S,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,w,T){T||(T=0);var S=Array(16);if(typeof w=="string")for(var R=0;16>R;++R)S[R]=w.charCodeAt(T++)|w.charCodeAt(T++)<<8|w.charCodeAt(T++)<<16|w.charCodeAt(T++)<<24;else for(R=0;16>R;++R)S[R]=w[T++]|w[T++]<<8|w[T++]<<16|w[T++]<<24;w=I.g[0],T=I.g[1],R=I.g[2];var C=I.g[3],A=w+(C^T&(R^C))+S[0]+3614090360&4294967295;w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[1]+3905402710&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[2]+606105819&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[3]+3250441966&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[4]+4118548399&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[5]+1200080426&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[6]+2821735955&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[7]+4249261313&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[8]+1770035416&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[9]+2336552879&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[10]+4294925233&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[11]+2304563134&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(C^T&(R^C))+S[12]+1804603682&4294967295,w=T+(A<<7&4294967295|A>>>25),A=C+(R^w&(T^R))+S[13]+4254626195&4294967295,C=w+(A<<12&4294967295|A>>>20),A=R+(T^C&(w^T))+S[14]+2792965006&4294967295,R=C+(A<<17&4294967295|A>>>15),A=T+(w^R&(C^w))+S[15]+1236535329&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(R^C&(T^R))+S[1]+4129170786&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[6]+3225465664&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[11]+643717713&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[0]+3921069994&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[5]+3593408605&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[10]+38016083&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[15]+3634488961&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[4]+3889429448&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[9]+568446438&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[14]+3275163606&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[3]+4107603335&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[8]+1163531501&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^C&(T^R))+S[13]+2850285829&4294967295,w=T+(A<<5&4294967295|A>>>27),A=C+(T^R&(w^T))+S[2]+4243563512&4294967295,C=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(C^w))+S[7]+1735328473&4294967295,R=C+(A<<14&4294967295|A>>>18),A=T+(C^w&(R^C))+S[12]+2368359562&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(T^R^C)+S[5]+4294588738&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[8]+2272392833&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[11]+1839030562&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[14]+4259657740&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[1]+2763975236&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[4]+1272893353&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[7]+4139469664&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[10]+3200236656&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[13]+681279174&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[0]+3936430074&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[3]+3572445317&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[6]+76029189&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^C)+S[9]+3654602809&4294967295,w=T+(A<<4&4294967295|A>>>28),A=C+(w^T^R)+S[12]+3873151461&4294967295,C=w+(A<<11&4294967295|A>>>21),A=R+(C^w^T)+S[15]+530742520&4294967295,R=C+(A<<16&4294967295|A>>>16),A=T+(R^C^w)+S[2]+3299628645&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(R^(T|~C))+S[0]+4096336452&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[7]+1126891415&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[14]+2878612391&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[5]+4237533241&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[12]+1700485571&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[3]+2399980690&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[10]+4293915773&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[1]+2240044497&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[8]+1873313359&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[15]+4264355552&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[6]+2734768916&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[13]+1309151649&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~C))+S[4]+4149444226&4294967295,w=T+(A<<6&4294967295|A>>>26),A=C+(T^(w|~R))+S[11]+3174756917&4294967295,C=w+(A<<10&4294967295|A>>>22),A=R+(w^(C|~T))+S[2]+718787259&4294967295,R=C+(A<<15&4294967295|A>>>17),A=T+(C^(R|~w))+S[9]+3951481745&4294967295,I.g[0]=I.g[0]+w&4294967295,I.g[1]=I.g[1]+(R+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+C&4294967295}r.prototype.u=function(I,w){w===void 0&&(w=I.length);for(var T=w-this.blockSize,S=this.B,R=this.h,C=0;C<w;){if(R==0)for(;C<=T;)i(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<w;)if(S[R++]=I.charCodeAt(C++),R==this.blockSize){i(this,S),R=0;break}}else for(;C<w;)if(S[R++]=I[C++],R==this.blockSize){i(this,S),R=0;break}}this.h=R,this.o+=w},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var w=1;w<I.length-8;++w)I[w]=0;var T=8*this.o;for(w=I.length-8;w<I.length;++w)I[w]=T&255,T/=256;for(this.u(I),I=Array(16),w=T=0;4>w;++w)for(var S=0;32>S;S+=8)I[T++]=this.g[w]>>>S&255;return I};function s(I,w){var T=u;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=w(I)}function o(I,w){this.h=w;for(var T=[],S=!0,R=I.length-1;0<=R;R--){var C=I[R]|0;S&&C==w||(T[R]=C,S=!1)}this.g=T}var u={};function c(I){return-128<=I&&128>I?s(I,function(w){return new o([w|0],0>w?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return v(l(-I));for(var w=[],T=1,S=0;I>=T;S++)w[S]=I/T|0,T*=4294967296;return new o(w,0)}function h(I,w){if(I.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(I.charAt(0)=="-")return v(h(I.substring(1),w));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=l(Math.pow(w,8)),S=d,R=0;R<I.length;R+=8){var C=Math.min(8,I.length-R),A=parseInt(I.substring(R,R+C),w);8>C?(C=l(Math.pow(w,C)),S=S.j(C).add(l(A))):(S=S.j(T),S=S.add(l(A)))}return S}var d=c(0),p=c(1),g=c(16777216);e=o.prototype,e.m=function(){if(E(this))return-v(this).m();for(var I=0,w=1,T=0;T<this.g.length;T++){var S=this.i(T);I+=(0<=S?S:4294967296+S)*w,w*=4294967296}return I},e.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(E(this))return"-"+v(this).toString(I);for(var w=l(Math.pow(I,6)),T=this,S="";;){var R=x(T,w).g;T=P(T,R.j(w));var C=((0<T.g.length?T.g[0]:T.h)>>>0).toString(I);if(T=R,_(T))return C+S;for(;6>C.length;)C="0"+C;S=C+S}},e.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var w=0;w<I.g.length;w++)if(I.g[w]!=0)return!1;return!0}function E(I){return I.h==-1}e.l=function(I){return I=P(this,I),E(I)?-1:_(I)?0:1};function v(I){for(var w=I.g.length,T=[],S=0;S<w;S++)T[S]=~I.g[S];return new o(T,~I.h).add(p)}e.abs=function(){return E(this)?v(this):this},e.add=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0,R=0;R<=w;R++){var C=S+(this.i(R)&65535)+(I.i(R)&65535),A=(C>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);S=A>>>16,C&=65535,A&=65535,T[R]=A<<16|C}return new o(T,T[T.length-1]&-2147483648?-1:0)};function P(I,w){return I.add(v(w))}e.j=function(I){if(_(this)||_(I))return d;if(E(this))return E(I)?v(this).j(v(I)):v(v(this).j(I));if(E(I))return v(this.j(v(I)));if(0>this.l(g)&&0>I.l(g))return l(this.m()*I.m());for(var w=this.g.length+I.g.length,T=[],S=0;S<2*w;S++)T[S]=0;for(S=0;S<this.g.length;S++)for(var R=0;R<I.g.length;R++){var C=this.i(S)>>>16,A=this.i(S)&65535,X=I.i(R)>>>16,F=I.i(R)&65535;T[2*S+2*R]+=A*F,b(T,2*S+2*R),T[2*S+2*R+1]+=C*F,b(T,2*S+2*R+1),T[2*S+2*R+1]+=A*X,b(T,2*S+2*R+1),T[2*S+2*R+2]+=C*X,b(T,2*S+2*R+2)}for(S=0;S<w;S++)T[S]=T[2*S+1]<<16|T[2*S];for(S=w;S<2*w;S++)T[S]=0;return new o(T,0)};function b(I,w){for(;(I[w]&65535)!=I[w];)I[w+1]+=I[w]>>>16,I[w]&=65535,w++}function N(I,w){this.g=I,this.h=w}function x(I,w){if(_(w))throw Error("division by zero");if(_(I))return new N(d,d);if(E(I))return w=x(v(I),w),new N(v(w.g),v(w.h));if(E(w))return w=x(I,v(w)),new N(v(w.g),w.h);if(30<I.g.length){if(E(I)||E(w))throw Error("slowDivide_ only works with positive integers.");for(var T=p,S=w;0>=S.l(I);)T=M(T),S=M(S);var R=U(T,1),C=U(S,1);for(S=U(S,2),T=U(T,2);!_(S);){var A=C.add(S);0>=A.l(I)&&(R=R.add(T),C=A),S=U(S,1),T=U(T,1)}return w=P(I,R.j(w)),new N(R,w)}for(R=d;0<=I.l(w);){for(T=Math.max(1,Math.floor(I.m()/w.m())),S=Math.ceil(Math.log(T)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),C=l(T),A=C.j(w);E(A)||0<A.l(I);)T-=S,C=l(T),A=C.j(w);_(C)&&(C=p),R=R.add(C),I=P(I,A)}return new N(R,I)}e.A=function(I){return x(this,I).h},e.and=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)&I.i(S);return new o(T,this.h&I.h)},e.or=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)|I.i(S);return new o(T,this.h|I.h)},e.xor=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)^I.i(S);return new o(T,this.h^I.h)};function M(I){for(var w=I.g.length+1,T=[],S=0;S<w;S++)T[S]=I.i(S)<<1|I.i(S-1)>>>31;return new o(T,I.h)}function U(I,w){var T=w>>5;w%=32;for(var S=I.g.length-T,R=[],C=0;C<S;C++)R[C]=0<w?I.i(C+T)>>>w|I.i(C+T+1)<<32-w:I.i(C+T);return new o(R,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qp=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=h,Ln=o}).apply(typeof Yh<"u"?Yh:typeof self<"u"?self:typeof window<"u"?window:{});var Hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jp,Ni,zp,io,Pu,Hp,Gp,Wp;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,m){return a==Array.prototype||a==Object.prototype||(a[f]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hs=="object"&&Hs];for(var f=0;f<a.length;++f){var m=a[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function i(a,f){if(f)t:{var m=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var V=a[y];if(!(V in m))break t;m=m[V]}a=a[a.length-1],y=m[a],f=f(y),f!=y&&f!=null&&t(m,a,{configurable:!0,writable:!0,value:f})}}function s(a,f){a instanceof String&&(a+="");var m=0,y=!1,V={next:function(){if(!y&&m<a.length){var k=m++;return{value:f(k,a[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(a){return a||function(){return s(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function l(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,m){return a.call.apply(a.bind,arguments)}function d(a,f,m){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,y),a.apply(f,V)}}return function(){return a.apply(f,arguments)}}function p(a,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function g(a,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function _(a,f){function m(){}m.prototype=f.prototype,a.aa=f.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(y,V,k){for(var B=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)B[ft-2]=arguments[ft];return f.prototype[V].apply(y,B)}}function E(a){const f=a.length;if(0<f){const m=Array(f);for(let y=0;y<f;y++)m[y]=a[y];return m}return[]}function v(a,f){for(let m=1;m<arguments.length;m++){const y=arguments[m];if(c(y)){const V=a.length||0,k=y.length||0;a.length=V+k;for(let B=0;B<k;B++)a[V+B]=y[B]}else a.push(y)}}class P{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function b(a){return/^[\s\xa0]*$/.test(a)}function N(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function x(a){return x[" "](a),a}x[" "]=function(){};var M=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function U(a,f,m){for(const y in a)f.call(m,a[y],y,a)}function I(a,f){for(const m in a)f.call(void 0,a[m],m,a)}function w(a){const f={};for(const m in a)f[m]=a[m];return f}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(a,f){let m,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(m in y)a[m]=y[m];for(let k=0;k<T.length;k++)m=T[k],Object.prototype.hasOwnProperty.call(y,m)&&(a[m]=y[m])}}function R(a){var f=1;a=a.split(":");const m=[];for(;0<f&&a.length;)m.push(a.shift()),f--;return a.length&&m.push(a.join(":")),m}function C(a){u.setTimeout(()=>{throw a},0)}function A(){var a=kt;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class X{constructor(){this.h=this.g=null}add(f,m){const y=F.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var F=new P(()=>new Y,a=>a.reset());class Y{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let lt,mt=!1,kt=new X,Ve=()=>{const a=u.Promise.resolve(void 0);lt=()=>{a.then(re)}};var re=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(m){C(m)}var f=F;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}mt=!1};function Ot(){this.s=this.s,this.C=this.C}Ot.prototype.s=!1,Ot.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ot.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ct(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}ct.prototype.h=function(){this.defaultPrevented=!0};var An=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};u.addEventListener("test",m,f),u.removeEventListener("test",m,f)}catch{}return a}();function ie(a,f){if(ct.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(M){t:{try{x(f.nodeName);var V=!0;break t}catch{}V=!1}V||(f=null)}}else m=="mouseover"?f=a.fromElement:m=="mouseout"&&(f=a.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Da[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ie.aa.h.call(this)}}_(ie,ct);var Da={2:"touch",3:"pen",4:"mouse"};ie.prototype.h=function(){ie.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Rr="closure_listenable_"+(1e6*Math.random()|0),ka=0;function Oa(a,f,m,y,V){this.listener=a,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=V,this.key=++ka,this.da=this.fa=!1}function Jn(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Sr(a){this.src=a,this.g={},this.h=0}Sr.prototype.add=function(a,f,m,y,V){var k=a.toString();a=this.g[k],a||(a=this.g[k]=[],this.h++);var B=di(a,f,y,V);return-1<B?(f=a[B],m||(f.fa=!1)):(f=new Oa(f,this.src,k,!!y,V),f.fa=m,a.push(f)),f};function br(a,f){var m=f.type;if(m in a.g){var y=a.g[m],V=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=V)&&Array.prototype.splice.call(y,V,1),k&&(Jn(f),a.g[m].length==0&&(delete a.g[m],a.h--))}}function di(a,f,m,y){for(var V=0;V<a.length;++V){var k=a[V];if(!k.da&&k.listener==f&&k.capture==!!m&&k.ha==y)return V}return-1}var pi="closure_lm_"+(1e6*Math.random()|0),mi={};function H(a,f,m,y,V){if(Array.isArray(f)){for(var k=0;k<f.length;k++)H(a,f[k],m,y,V);return null}return m=In(m),a&&a[Rr]?a.K(f,m,l(y)?!!y.capture:!1,V):z(a,f,m,!1,y,V)}function z(a,f,m,y,V,k){if(!f)throw Error("Invalid event type");var B=l(V)?!!V.capture:!!V,ft=Ue(a);if(ft||(a[pi]=ft=new Sr(a)),m=ft.add(f,m,y,B,k),m.proxy)return m;if(y=rt(),m.proxy=y,y.src=a,y.listener=m,a.addEventListener)An||(V=B),V===void 0&&(V=!1),a.addEventListener(f.toString(),y,V);else if(a.attachEvent)a.attachEvent(Jt(f.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function rt(){function a(m){return f.call(a.src,a.listener,m)}const f=se;return a}function Pt(a,f,m,y,V){if(Array.isArray(f))for(var k=0;k<f.length;k++)Pt(a,f[k],m,y,V);else y=l(y)?!!y.capture:!!y,m=In(m),a&&a[Rr]?(a=a.i,f=String(f).toString(),f in a.g&&(k=a.g[f],m=di(k,m,y,V),-1<m&&(Jn(k[m]),Array.prototype.splice.call(k,m,1),k.length==0&&(delete a.g[f],a.h--)))):a&&(a=Ue(a))&&(f=a.g[f.toString()],a=-1,f&&(a=di(f,m,y,V)),(m=-1<a?f[a]:null)&&de(m))}function de(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[Rr])br(f.i,a);else{var m=a.type,y=a.proxy;f.removeEventListener?f.removeEventListener(m,y,a.capture):f.detachEvent?f.detachEvent(Jt(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=Ue(f))?(br(m,a),m.h==0&&(m.src=null,f[pi]=null)):Jn(a)}}}function Jt(a){return a in mi?mi[a]:mi[a]="on"+a}function se(a,f){if(a.da)a=!0;else{f=new ie(f,this);var m=a.listener,y=a.ha||a.src;a.fa&&de(a),a=m.call(y,f)}return a}function Ue(a){return a=a[pi],a instanceof Sr?a:null}var sn="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(a){return typeof a=="function"?a:(a[sn]||(a[sn]=function(f){return a.handleEvent(f)}),a[sn])}function Tt(){Ot.call(this),this.i=new Sr(this),this.M=this,this.F=null}_(Tt,Ot),Tt.prototype[Rr]=!0,Tt.prototype.removeEventListener=function(a,f,m,y){Pt(this,a,f,m,y)};function gt(a,f){var m,y=a.F;if(y)for(m=[];y;y=y.F)m.push(y);if(a=a.M,y=f.type||f,typeof f=="string")f=new ct(f,a);else if(f instanceof ct)f.target=f.target||a;else{var V=f;f=new ct(y,a),S(f,V)}if(V=!0,m)for(var k=m.length-1;0<=k;k--){var B=f.g=m[k];V=we(B,y,!0,f)&&V}if(B=f.g=a,V=we(B,y,!0,f)&&V,V=we(B,y,!1,f)&&V,m)for(k=0;k<m.length;k++)B=f.g=m[k],V=we(B,y,!1,f)&&V}Tt.prototype.N=function(){if(Tt.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var m=a.g[f],y=0;y<m.length;y++)Jn(m[y]);delete a.g[f],a.h--}}this.F=null},Tt.prototype.K=function(a,f,m,y){return this.i.add(String(a),f,!1,m,y)},Tt.prototype.L=function(a,f,m,y){return this.i.add(String(a),f,!0,m,y)};function we(a,f,m,y){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var V=!0,k=0;k<f.length;++k){var B=f[k];if(B&&!B.da&&B.capture==m){var ft=B.listener,Bt=B.ha||B.src;B.fa&&br(a.i,B),V=ft.call(Bt,y)!==!1&&V}}return V&&!y.defaultPrevented}function Cr(a,f,m){if(typeof a=="function")m&&(a=p(a,m));else if(a&&typeof a.handleEvent=="function")a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:u.setTimeout(a,f||0)}function Zn(a){a.g=Cr(()=>{a.g=null,a.i&&(a.i=!1,Zn(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class Ne extends Ot{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Zn(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Be(a){Ot.call(this),this.h=a,this.g={}}_(Be,Ot);var Rn=[];function tr(a){U(a.g,function(f,m){this.g.hasOwnProperty(m)&&de(f)},a),a.g={}}Be.prototype.N=function(){Be.aa.N.call(this),tr(this)},Be.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ee=u.JSON.stringify,on=u.JSON.parse,Te=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function Sn(){}Sn.prototype.h=null;function er(a){return a.h||(a.h=a.i())}function Lc(){}var gi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ma(){ct.call(this,"d")}_(Ma,ct);function La(){ct.call(this,"c")}_(La,ct);var nr={},Fc=null;function Cs(){return Fc=Fc||new Tt}nr.La="serverreachability";function Uc(a){ct.call(this,nr.La,a)}_(Uc,ct);function _i(a){const f=Cs();gt(f,new Uc(f))}nr.STAT_EVENT="statevent";function Bc(a,f){ct.call(this,nr.STAT_EVENT,a),this.stat=f}_(Bc,ct);function Zt(a){const f=Cs();gt(f,new Bc(f,a))}nr.Ma="timingevent";function $c(a,f){ct.call(this,nr.Ma,a),this.size=f}_($c,ct);function yi(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},f)}function vi(){this.g=!0}vi.prototype.xa=function(){this.g=!1};function U_(a,f,m,y,V,k){a.info(function(){if(a.g)if(k)for(var B="",ft=k.split("&"),Bt=0;Bt<ft.length;Bt++){var st=ft[Bt].split("=");if(1<st.length){var Ht=st[0];st=st[1];var Gt=Ht.split("_");B=2<=Gt.length&&Gt[1]=="type"?B+(Ht+"="+st+"&"):B+(Ht+"=redacted&")}}else B=null;else B=k;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+f+`
`+m+`
`+B})}function B_(a,f,m,y,V,k,B){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+f+`
`+m+`
`+k+" "+B})}function Pr(a,f,m,y){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+q_(a,m)+(y?" "+y:"")})}function $_(a,f){a.info(function(){return"TIMEOUT: "+f})}vi.prototype.info=function(){};function q_(a,f){if(!a.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var y=m[a];if(!(2>y.length)){var V=y[1];if(Array.isArray(V)&&!(1>V.length)){var k=V[0];if(k!="noop"&&k!="stop"&&k!="close")for(var B=1;B<V.length;B++)V[B]=""}}}}return Ee(m)}catch{return f}}var Ps={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Fa;function xs(){}_(xs,Sn),xs.prototype.g=function(){return new XMLHttpRequest},xs.prototype.i=function(){return{}},Fa=new xs;function bn(a,f,m,y){this.j=a,this.i=f,this.l=m,this.R=y||1,this.U=new Be(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jc}function jc(){this.i=null,this.g="",this.h=!1}var zc={},Ua={};function Ba(a,f,m){a.L=1,a.v=ks(an(f)),a.m=m,a.P=!0,Hc(a,null)}function Hc(a,f){a.F=Date.now(),Vs(a),a.A=an(a.v);var m=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),sh(m.i,"t",y),a.C=0,m=a.j.J,a.h=new jc,a.g=Ah(a.j,m?f:null,!a.m),0<a.O&&(a.M=new Ne(p(a.Y,a,a.g),a.O)),f=a.U,m=a.g,y=a.ca;var V="readystatechange";Array.isArray(V)||(V&&(Rn[0]=V.toString()),V=Rn);for(var k=0;k<V.length;k++){var B=H(m,V[k],y||f.handleEvent,!1,f.h||f);if(!B)break;f.g[B.key]=B}f=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),_i(),U_(a.i,a.u,a.A,a.l,a.R,a.m)}bn.prototype.ca=function(a){a=a.target;const f=this.M;f&&un(a)==3?f.j():this.Y(a)},bn.prototype.Y=function(a){try{if(a==this.g)t:{const Gt=un(this.g);var f=this.g.Ba();const Nr=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||fh(this.g)))){this.J||Gt!=4||f==7||(f==8||0>=Nr?_i(3):_i(2)),$a(this);var m=this.g.Z();this.X=m;e:if(Gc(this)){var y=fh(this.g);a="";var V=y.length,k=un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){rr(this),wi(this);var B="";break e}this.h.i=new u.TextDecoder}for(f=0;f<V;f++)this.h.h=!0,a+=this.h.i.decode(y[f],{stream:!(k&&f==V-1)});y.length=0,this.h.g+=a,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,B_(this.i,this.u,this.A,this.l,this.R,Gt,m),this.o){if(this.T&&!this.K){e:{if(this.g){var ft,Bt=this.g;if((ft=Bt.g?Bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(ft)){var st=ft;break e}}st=null}if(m=st)Pr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qa(this,m);else{this.o=!1,this.s=3,Zt(12),rr(this),wi(this);break t}}if(this.P){m=!0;let De;for(;!this.J&&this.C<B.length;)if(De=j_(this,B),De==Ua){Gt==4&&(this.s=4,Zt(14),m=!1),Pr(this.i,this.l,null,"[Incomplete Response]");break}else if(De==zc){this.s=4,Zt(15),Pr(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else Pr(this.i,this.l,De,null),qa(this,De);if(Gc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||B.length!=0||this.h.h||(this.s=1,Zt(16),m=!1),this.o=this.o&&m,!m)Pr(this.i,this.l,B,"[Invalid Chunked Response]"),rr(this),wi(this);else if(0<B.length&&!this.W){this.W=!0;var Ht=this.j;Ht.g==this&&Ht.ba&&!Ht.M&&(Ht.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Ka(Ht),Ht.M=!0,Zt(11))}}else Pr(this.i,this.l,B,null),qa(this,B);Gt==4&&rr(this),this.o&&!this.J&&(Gt==4?vh(this.j,this):(this.o=!1,Vs(this)))}else oy(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),rr(this),wi(this)}}}catch{}finally{}};function Gc(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function j_(a,f){var m=a.C,y=f.indexOf(`
`,m);return y==-1?Ua:(m=Number(f.substring(m,y)),isNaN(m)?zc:(y+=1,y+m>f.length?Ua:(f=f.slice(y,y+m),a.C=y+m,f)))}bn.prototype.cancel=function(){this.J=!0,rr(this)};function Vs(a){a.S=Date.now()+a.I,Wc(a,a.I)}function Wc(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=yi(p(a.ba,a),f)}function $a(a){a.B&&(u.clearTimeout(a.B),a.B=null)}bn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?($_(this.i,this.A),this.L!=2&&(_i(),Zt(17)),rr(this),this.s=2,wi(this)):Wc(this,this.S-a)};function wi(a){a.j.G==0||a.J||vh(a.j,a)}function rr(a){$a(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,tr(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function qa(a,f){try{var m=a.j;if(m.G!=0&&(m.g==a||ja(m.h,a))){if(!a.K&&ja(m.h,a)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)Bs(m),Fs(m);else break t;Wa(m),Zt(18)}}else m.za=V[1],0<m.za-m.T&&37500>V[2]&&m.F&&m.v==0&&!m.C&&(m.C=yi(p(m.Za,m),6e3));if(1>=Xc(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else sr(m,11)}else if((a.K||m.g==a)&&Bs(m),!b(f))for(V=m.Da.g.parse(f),f=0;f<V.length;f++){let st=V[f];if(m.T=st[0],st=st[1],m.G==2)if(st[0]=="c"){m.K=st[1],m.ia=st[2];const Ht=st[3];Ht!=null&&(m.la=Ht,m.j.info("VER="+m.la));const Gt=st[4];Gt!=null&&(m.Aa=Gt,m.j.info("SVER="+m.Aa));const Nr=st[5];Nr!=null&&typeof Nr=="number"&&0<Nr&&(y=1.5*Nr,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;const De=a.g;if(De){const qs=De.g?De.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qs){var k=y.h;k.g||qs.indexOf("spdy")==-1&&qs.indexOf("quic")==-1&&qs.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(za(k,k.h),k.h=null))}if(y.D){const Qa=De.g?De.g.getResponseHeader("X-HTTP-Session-Id"):null;Qa&&(y.ya=Qa,_t(y.I,y.D,Qa))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var B=a;if(y.qa=Th(y,y.J?y.ia:null,y.W),B.K){Yc(y.h,B);var ft=B,Bt=y.L;Bt&&(ft.I=Bt),ft.B&&($a(ft),Vs(ft)),y.g=B}else _h(y);0<m.i.length&&Us(m)}else st[0]!="stop"&&st[0]!="close"||sr(m,7);else m.G==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?sr(m,7):Ga(m):st[0]!="noop"&&m.l&&m.l.ta(st),m.v=0)}}_i(4)}catch{}}var z_=class{constructor(a,f){this.g=a,this.map=f}};function Kc(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qc(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Xc(a){return a.h?1:a.g?a.g.size:0}function ja(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function za(a,f){a.g?a.g.add(f):a.h=f}function Yc(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}Kc.prototype.cancel=function(){if(this.i=Jc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Jc(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const m of a.g.values())f=f.concat(m.D);return f}return E(a.i)}function H_(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var f=[],m=a.length,y=0;y<m;y++)f.push(a[y]);return f}f=[],m=0;for(y in a)f[m++]=a[y];return f}function G_(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var f=[];a=a.length;for(var m=0;m<a;m++)f.push(m);return f}f=[],m=0;for(const y in a)f[m++]=y;return f}}}function Zc(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var m=G_(a),y=H_(a),V=y.length,k=0;k<V;k++)f.call(void 0,y[k],m&&m[k],a)}var th=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function W_(a,f){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var y=a[m].indexOf("="),V=null;if(0<=y){var k=a[m].substring(0,y);V=a[m].substring(y+1)}else k=a[m];f(k,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function ir(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ir){this.h=a.h,Ns(this,a.j),this.o=a.o,this.g=a.g,Ds(this,a.s),this.l=a.l;var f=a.i,m=new Ai;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),eh(this,m),this.m=a.m}else a&&(f=String(a).match(th))?(this.h=!1,Ns(this,f[1]||"",!0),this.o=Ei(f[2]||""),this.g=Ei(f[3]||"",!0),Ds(this,f[4]),this.l=Ei(f[5]||"",!0),eh(this,f[6]||"",!0),this.m=Ei(f[7]||"")):(this.h=!1,this.i=new Ai(null,this.h))}ir.prototype.toString=function(){var a=[],f=this.j;f&&a.push(Ti(f,nh,!0),":");var m=this.g;return(m||f=="file")&&(a.push("//"),(f=this.o)&&a.push(Ti(f,nh,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(Ti(m,m.charAt(0)=="/"?X_:Q_,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",Ti(m,J_)),a.join("")};function an(a){return new ir(a)}function Ns(a,f,m){a.j=m?Ei(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function Ds(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function eh(a,f,m){f instanceof Ai?(a.i=f,Z_(a.i,a.h)):(m||(f=Ti(f,Y_)),a.i=new Ai(f,a.h))}function _t(a,f,m){a.i.set(f,m)}function ks(a){return _t(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Ei(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Ti(a,f,m){return typeof a=="string"?(a=encodeURI(a).replace(f,K_),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function K_(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var nh=/[#\/\?@]/g,Q_=/[#\?:]/g,X_=/[#\?]/g,Y_=/[#\?@]/g,J_=/#/g;function Ai(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function Cn(a){a.g||(a.g=new Map,a.h=0,a.i&&W_(a.i,function(f,m){a.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}e=Ai.prototype,e.add=function(a,f){Cn(this),this.i=null,a=xr(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(f),this.h+=1,this};function rh(a,f){Cn(a),f=xr(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function ih(a,f){return Cn(a),f=xr(a,f),a.g.has(f)}e.forEach=function(a,f){Cn(this),this.g.forEach(function(m,y){m.forEach(function(V){a.call(f,V,y,this)},this)},this)},e.na=function(){Cn(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){const V=a[y];for(let k=0;k<V.length;k++)m.push(f[y])}return m},e.V=function(a){Cn(this);let f=[];if(typeof a=="string")ih(this,a)&&(f=f.concat(this.g.get(xr(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)f=f.concat(a[m])}return f},e.set=function(a,f){return Cn(this),this.i=null,a=xr(this,a),ih(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},e.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function sh(a,f,m){rh(a,f),0<m.length&&(a.i=null,a.g.set(xr(a,f),E(m)),a.h+=m.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];const k=encodeURIComponent(String(y)),B=this.V(y);for(y=0;y<B.length;y++){var V=k;B[y]!==""&&(V+="="+encodeURIComponent(String(B[y]))),a.push(V)}}return this.i=a.join("&")};function xr(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function Z_(a,f){f&&!a.j&&(Cn(a),a.i=null,a.g.forEach(function(m,y){var V=y.toLowerCase();y!=V&&(rh(this,y),sh(this,V,m))},a)),a.j=f}function ty(a,f){const m=new vi;if(u.Image){const y=new Image;y.onload=g(Pn,m,"TestLoadImage: loaded",!0,f,y),y.onerror=g(Pn,m,"TestLoadImage: error",!1,f,y),y.onabort=g(Pn,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=g(Pn,m,"TestLoadImage: timeout",!1,f,y),u.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else f(!1)}function ey(a,f){const m=new vi,y=new AbortController,V=setTimeout(()=>{y.abort(),Pn(m,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:y.signal}).then(k=>{clearTimeout(V),k.ok?Pn(m,"TestPingServer: ok",!0,f):Pn(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),Pn(m,"TestPingServer: error",!1,f)})}function Pn(a,f,m,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(m)}catch{}}function ny(){this.g=new Te}function ry(a,f,m){const y=m||"";try{Zc(a,function(V,k){let B=V;l(V)&&(B=Ee(V)),f.push(y+k+"="+encodeURIComponent(B))})}catch(V){throw f.push(y+"type="+encodeURIComponent("_badmap")),V}}function Os(a){this.l=a.Ub||null,this.j=a.eb||!1}_(Os,Sn),Os.prototype.g=function(){return new Ms(this.l,this.j)},Os.prototype.i=function(a){return function(){return a}}({});function Ms(a,f){Tt.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Ms,Tt),e=Ms.prototype,e.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,Ri(this)},e.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||u).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=0},e.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ri(this)),this.g&&(this.readyState=3,Ri(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;oh(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function oh(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}e.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?Ii(this):Ri(this),this.readyState==3&&oh(this)}},e.Ra=function(a){this.g&&(this.response=this.responseText=a,Ii(this))},e.Qa=function(a){this.g&&(this.response=a,Ii(this))},e.ga=function(){this.g&&Ii(this)};function Ii(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ri(a)}e.setRequestHeader=function(a,f){this.u.append(a,f)},e.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=f.next();return a.join(`\r
`)};function Ri(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ms.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function ah(a){let f="";return U(a,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function Ha(a,f,m){t:{for(y in m){var y=!1;break t}y=!0}y||(m=ah(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):_t(a,f,m))}function At(a){Tt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(At,Tt);var iy=/^https?$/i,sy=["POST","PUT"];e=At.prototype,e.Ha=function(a){this.J=a},e.ea=function(a,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Fa.g(),this.v=this.o?er(this.o):er(Fa),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(k){uh(this,k);return}if(a=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)m.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const k of y.keys())m.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(k=>k.toLowerCase()=="content-type"),V=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(sy,f,void 0))||y||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,B]of m)this.g.setRequestHeader(k,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{hh(this),this.u=!0,this.g.send(a),this.u=!1}catch(k){uh(this,k)}};function uh(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,lh(a),Ls(a)}function lh(a){a.A||(a.A=!0,gt(a,"complete"),gt(a,"error"))}e.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,gt(this,"complete"),gt(this,"abort"),Ls(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ls(this,!0)),At.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?ch(this):this.bb())},e.bb=function(){ch(this)};function ch(a){if(a.h&&typeof o<"u"&&(!a.v[1]||un(a)!=4||a.Z()!=2)){if(a.u&&un(a)==4)Cr(a.Ea,0,a);else if(gt(a,"readystatechange"),un(a)==4){a.h=!1;try{const B=a.Z();t:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var m;if(!(m=f)){var y;if(y=B===0){var V=String(a.D).match(th)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),y=!iy.test(V?V.toLowerCase():"")}m=y}if(m)gt(a,"complete"),gt(a,"success");else{a.m=6;try{var k=2<un(a)?a.g.statusText:""}catch{k=""}a.l=k+" ["+a.Z()+"]",lh(a)}}finally{Ls(a)}}}}function Ls(a,f){if(a.g){hh(a);const m=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||gt(a,"ready");try{m.onreadystatechange=y}catch{}}}function hh(a){a.I&&(u.clearTimeout(a.I),a.I=null)}e.isActive=function(){return!!this.g};function un(a){return a.g?a.g.readyState:0}e.Z=function(){try{return 2<un(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),on(f)}};function fh(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function oy(a){const f={};a=(a.g&&2<=un(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(b(a[y]))continue;var m=R(a[y]);const V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const k=f[V]||[];f[V]=k,k.push(m)}I(f,function(y){return y.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Si(a,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||f}function dh(a){this.Aa=0,this.i=[],this.j=new vi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Si("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Si("baseRetryDelayMs",5e3,a),this.cb=Si("retryDelaySeedMs",1e4,a),this.Wa=Si("forwardChannelMaxRetries",2,a),this.wa=Si("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Kc(a&&a.concurrentRequestLimit),this.Da=new ny,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=dh.prototype,e.la=8,e.G=1,e.connect=function(a,f,m,y){Zt(0),this.W=a,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=Th(this,null,this.W),Us(this)};function Ga(a){if(ph(a),a.G==3){var f=a.U++,m=an(a.I);if(_t(m,"SID",a.K),_t(m,"RID",f),_t(m,"TYPE","terminate"),bi(a,m),f=new bn(a,a.j,f),f.L=2,f.v=ks(an(m)),m=!1,u.navigator&&u.navigator.sendBeacon)try{m=u.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&u.Image&&(new Image().src=f.v,m=!0),m||(f.g=Ah(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Vs(f)}Eh(a)}function Fs(a){a.g&&(Ka(a),a.g.cancel(),a.g=null)}function ph(a){Fs(a),a.u&&(u.clearTimeout(a.u),a.u=null),Bs(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Us(a){if(!Qc(a.h)&&!a.s){a.s=!0;var f=a.Ga;lt||Ve(),mt||(lt(),mt=!0),kt.add(f,a),a.B=0}}function ay(a,f){return Xc(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=yi(p(a.Ga,a,f),wh(a,a.B)),a.B++,!0)}e.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new bn(this,this.j,a);let k=this.o;if(this.S&&(k?(k=w(k),S(k,this.S)):k=this.S),this.m!==null||this.O||(V.H=k,k=null),this.P)t:{for(var f=0,m=0;m<this.i.length;m++){e:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break e}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break t}if(f===4096||m===this.i.length-1){f=m+1;break t}}f=1e3}else f=1e3;f=gh(this,V,f),m=an(this.I),_t(m,"RID",a),_t(m,"CVER",22),this.D&&_t(m,"X-HTTP-Session-Id",this.D),bi(this,m),k&&(this.O?f="headers="+encodeURIComponent(String(ah(k)))+"&"+f:this.m&&Ha(m,this.m,k)),za(this.h,V),this.Ua&&_t(m,"TYPE","init"),this.P?(_t(m,"$req",f),_t(m,"SID","null"),V.T=!0,Ba(V,m,null)):Ba(V,m,f),this.G=2}}else this.G==3&&(a?mh(this,a):this.i.length==0||Qc(this.h)||mh(this))};function mh(a,f){var m;f?m=f.l:m=a.U++;const y=an(a.I);_t(y,"SID",a.K),_t(y,"RID",m),_t(y,"AID",a.T),bi(a,y),a.m&&a.o&&Ha(y,a.m,a.o),m=new bn(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),f&&(a.i=f.D.concat(a.i)),f=gh(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),za(a.h,m),Ba(m,y,f)}function bi(a,f){a.H&&U(a.H,function(m,y){_t(f,y,m)}),a.l&&Zc({},function(m,y){_t(f,y,m)})}function gh(a,f,m){m=Math.min(a.i.length,m);var y=a.l?p(a.l.Na,a.l,a):null;t:{var V=a.i;let k=-1;for(;;){const B=["count="+m];k==-1?0<m?(k=V[0].g,B.push("ofs="+k)):k=0:B.push("ofs="+k);let ft=!0;for(let Bt=0;Bt<m;Bt++){let st=V[Bt].g;const Ht=V[Bt].map;if(st-=k,0>st)k=Math.max(0,V[Bt].g-100),ft=!1;else try{ry(Ht,B,"req"+st+"_")}catch{y&&y(Ht)}}if(ft){y=B.join("&");break t}}}return a=a.i.splice(0,m),f.D=a,y}function _h(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;lt||Ve(),mt||(lt(),mt=!0),kt.add(f,a),a.v=0}}function Wa(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=yi(p(a.Fa,a),wh(a,a.v)),a.v++,!0)}e.Fa=function(){if(this.u=null,yh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=yi(p(this.ab,this),a)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Zt(10),Fs(this),yh(this))};function Ka(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function yh(a){a.g=new bn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=an(a.qa);_t(f,"RID","rpc"),_t(f,"SID",a.K),_t(f,"AID",a.T),_t(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&_t(f,"TO",a.ja),_t(f,"TYPE","xmlhttp"),bi(a,f),a.m&&a.o&&Ha(f,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=ks(an(f)),m.m=null,m.P=!0,Hc(m,a)}e.Za=function(){this.C!=null&&(this.C=null,Fs(this),Wa(this),Zt(19))};function Bs(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function vh(a,f){var m=null;if(a.g==f){Bs(a),Ka(a),a.g=null;var y=2}else if(ja(a.h,f))m=f.D,Yc(a.h,f),y=1;else return;if(a.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var V=a.B;y=Cs(),gt(y,new $c(y,m)),Us(a)}else _h(a);else if(V=f.s,V==3||V==0&&0<f.X||!(y==1&&ay(a,f)||y==2&&Wa(a)))switch(m&&0<m.length&&(f=a.h,f.i=f.i.concat(m)),V){case 1:sr(a,5);break;case 4:sr(a,10);break;case 3:sr(a,6);break;default:sr(a,2)}}}function wh(a,f){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*f}function sr(a,f){if(a.j.info("Error code "+f),f==2){var m=p(a.fb,a),y=a.Xa;const V=!y;y=new ir(y||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ns(y,"https"),ks(y),V?ty(y.toString(),m):ey(y.toString(),m)}else Zt(2);a.G=0,a.l&&a.l.sa(f),Eh(a),ph(a)}e.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function Eh(a){if(a.G=0,a.ka=[],a.l){const f=Jc(a.h);(f.length!=0||a.i.length!=0)&&(v(a.ka,f),v(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function Th(a,f,m){var y=m instanceof ir?an(m):new ir(m);if(y.g!="")f&&(y.g=f+"."+y.g),Ds(y,y.s);else{var V=u.location;y=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;var k=new ir(null);y&&Ns(k,y),f&&(k.g=f),V&&Ds(k,V),m&&(k.l=m),y=k}return m=a.D,f=a.ya,m&&f&&_t(y,m,f),_t(y,"VER",a.la),bi(a,y),y}function Ah(a,f,m){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new At(new Os({eb:m})):new At(a.pa),f.Ha(a.J),f}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ih(){}e=Ih.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function $s(){}$s.prototype.g=function(a,f){return new pe(a,f)};function pe(a,f){Tt.call(this),this.g=new dh(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!b(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!b(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Vr(this)}_(pe,Tt),pe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pe.prototype.close=function(){Ga(this.g)},pe.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=Ee(a),a=m);f.i.push(new z_(f.Ya++,a)),f.G==3&&Us(f)},pe.prototype.N=function(){this.g.l=null,delete this.j,Ga(this.g),delete this.g,pe.aa.N.call(this)};function Rh(a){Ma.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){t:{for(const m in f){a=m;break t}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}_(Rh,Ma);function Sh(){La.call(this),this.status=1}_(Sh,La);function Vr(a){this.g=a}_(Vr,Ih),Vr.prototype.ua=function(){gt(this.g,"a")},Vr.prototype.ta=function(a){gt(this.g,new Rh(a))},Vr.prototype.sa=function(a){gt(this.g,new Sh)},Vr.prototype.ra=function(){gt(this.g,"b")},$s.prototype.createWebChannel=$s.prototype.g,pe.prototype.send=pe.prototype.o,pe.prototype.open=pe.prototype.m,pe.prototype.close=pe.prototype.close,Wp=function(){return new $s},Gp=function(){return Cs()},Hp=nr,Pu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ps.NO_ERROR=0,Ps.TIMEOUT=8,Ps.HTTP_ERROR=6,io=Ps,qc.COMPLETE="complete",zp=qc,Lc.EventType=gi,gi.OPEN="a",gi.CLOSE="b",gi.ERROR="c",gi.MESSAGE="d",Tt.prototype.listen=Tt.prototype.K,Ni=Lc,At.prototype.listenOnce=At.prototype.L,At.prototype.getLastError=At.prototype.Ka,At.prototype.getLastErrorCode=At.prototype.Ba,At.prototype.getStatus=At.prototype.Z,At.prototype.getResponseJson=At.prototype.Oa,At.prototype.getResponseText=At.prototype.oa,At.prototype.send=At.prototype.ea,At.prototype.setWithCredentials=At.prototype.Ha,jp=At}).apply(typeof Hs<"u"?Hs:typeof self<"u"?self:typeof window<"u"?window:{});const Jh="@firebase/firestore",Zh="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oi="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr=new Mp("@firebase/firestore");function Mr(){return mr.logLevel}function j(e,...t){if(mr.logLevel<=nt.DEBUG){const n=t.map(Fl);mr.debug(`Firestore (${oi}): ${e}`,...n)}}function yn(e,...t){if(mr.logLevel<=nt.ERROR){const n=t.map(Fl);mr.error(`Firestore (${oi}): ${e}`,...n)}}function $n(e,...t){if(mr.logLevel<=nt.WARN){const n=t.map(Fl);mr.warn(`Firestore (${oi}): ${e}`,...n)}}function Fl(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,Kp(e,r,n)}function Kp(e,t,n){let r=`FIRESTORE (${oi}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw yn(r),new Error(r)}function ut(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||Kp(t,i,r)}function Q(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends si{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class lw{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Qt.UNAUTHENTICATED))}shutdown(){}}class cw{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class hw{constructor(t){this.t=t,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ut(this.o===void 0,42304);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new pn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pn,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;t.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pn)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ut(typeof r.accessToken=="string",31837,{l:r}),new Qp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ut(t===null||typeof t=="string",2055,{h:t}),new Qt(t)}}class fw{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class dw{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new fw(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(Qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tf{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pw{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,G0(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ut(this.o===void 0,3512);const r=s=>{s.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tf(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ut(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new tf(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=mw(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%62))}return r}}function Z(e,t){return e<t?-1:e>t?1:0}function xu(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return Z(r,i);{const s=Xp(),o=gw(s.encode(ef(e,n)),s.encode(ef(t,n)));return o!==0?o:Z(r,i)}}n+=r>65535?2:1}return Z(e.length,t.length)}function ef(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function gw(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Z(e[n],t[n]);return Z(e.length,t.length)}function Wr(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf="__name__";class je{constructor(t,n,r){n===void 0?n=0:n>t.length&&W(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&W(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return je.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof je?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const s=je.compareSegments(t.get(i),n.get(i));if(s!==0)return s}return Z(t.length,n.length)}static compareSegments(t,n){const r=je.isNumericId(t),i=je.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?je.extractNumericId(t).compare(je.extractNumericId(n)):xu(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ln.fromString(t.substring(4,t.length-2))}}class pt extends je{construct(t,n,r){return new pt(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new q(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new pt(n)}static emptyPath(){return new pt([])}}const _w=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jt extends je{construct(t,n,r){return new jt(t,n,r)}static isValidIdentifier(t){return _w.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nf}static keyField(){return new jt([nf])}static fromServerFormat(t){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new q(O.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new q(O.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new jt(n)}static emptyPath(){return new jt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(t){this.path=t}static fromPath(t){return new G(pt.fromString(t))}static fromName(t){return new G(pt.fromString(t).popFirst(5))}static empty(){return new G(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&pt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return pt.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new G(new pt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(e,t,n){if(!n)throw new q(O.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function yw(e,t,n,r){if(t===!0&&r===!0)throw new q(O.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function rf(e){if(!G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function sf(e){if(G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Jp(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function ua(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":W(12329,{type:typeof e})}function vn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new q(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ua(e);throw new q(O.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function vw(e,t){if(t<=0)throw new q(O.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(e,t){const n={typeString:e};return t&&(n.value=t),n}function _s(e,t){if(!Jp(e))throw new q(O.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new q(O.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of=-62135596800,af=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(t){return yt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*af);return new yt(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<of)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/af}_compareTo(t){return this.seconds===t.seconds?Z(this.nanoseconds,t.nanoseconds):Z(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(_s(t,yt._jsonSchema))return new yt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-of;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:Nt("string",yt._jsonSchemaVersion),seconds:Nt("number"),nanoseconds:Nt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{static fromTimestamp(t){return new K(t)}static min(){return new K(new yt(0,0))}static max(){return new K(new yt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=-1;function ww(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new yt(n+1,0):new yt(n,r));return new qn(i,G.empty(),t)}function Ew(e){return new qn(e.readTime,e.key,ts)}class qn{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new qn(K.min(),G.empty(),ts)}static max(){return new qn(K.max(),G.empty(),ts)}}function Tw(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=G.comparator(e.documentKey,t.documentKey),n!==0?n:Z(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Iw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ai(e){if(e.code!==O.FAILED_PRECONDITION||e.message!==Aw)throw e;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&W(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):L.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):L.reject(n)}static resolve(t){return new L((n,r)=>{n(t)})}static reject(t){return new L((n,r)=>{r(t)})}static waitFor(t){return new L((n,r)=>{let i=0,s=0,o=!1;t.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(t){let n=L.resolve(!1);for(const r of t)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new L((r,i)=>{const s=t.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const l=c;n(t[l]).next(h=>{o[l]=h,++u,u===s&&r(o)},h=>i(h))}})}static doWhile(t,n){return new L((r,i)=>{const s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}}function Rw(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ui(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}la.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl=-1;function ca(e){return e==null}function xo(e){return e===0&&1/e==-1/0}function Sw(e){return typeof e=="number"&&Number.isInteger(e)&&!xo(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="";function bw(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=uf(t)),t=Cw(e.get(n),t);return uf(t)}function Cw(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const s=e.charAt(i);switch(s){case"\0":n+="";break;case Zp:n+="";break;default:n+=s}}return n}function uf(e){return e+Zp+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Qn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function tm(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(t,n){this.comparator=t,this.root=n||qt.EMPTY}insert(t,n){return new Et(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,qt.BLACK,null,null))}remove(t){return new Et(this.comparator,this.root.remove(t,this.comparator).copy(null,null,qt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Gs(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Gs(this.root,t,this.comparator,!1)}getReverseIterator(){return new Gs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Gs(this.root,t,this.comparator,!0)}}class Gs{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class qt{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??qt.RED,this.left=i??qt.EMPTY,this.right=s??qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new qt(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return qt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw W(43730,{key:this.key,value:this.value});if(this.right.isRed())throw W(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw W(27949);return t+(this.isRed()?0:1)}}qt.EMPTY=null,qt.RED=!0,qt.BLACK=!1;qt.EMPTY=new class{constructor(){this.size=0}get key(){throw W(57766)}get value(){throw W(16141)}get color(){throw W(16727)}get left(){throw W(29726)}get right(){throw W(36894)}copy(t,n,r,i,s){return this}insert(t,n,r){return new qt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(t){this.comparator=t,this.data=new Et(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new cf(this.data.getIterator())}getIteratorFrom(t){return new cf(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Dt)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Dt(this.comparator);return n.data=t,n}}class cf{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(t){this.fields=t,t.sort(jt.comparator)}static empty(){return new ye([])}unionWith(t){let n=new Dt(jt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new ye(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Wr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new em("Invalid base64 string: "+s):s}}(t);return new zt(n)}static fromUint8Array(t){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new zt(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Z(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}zt.EMPTY_BYTE_STRING=new zt("");const Pw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jn(e){if(ut(!!e,39018),typeof e=="string"){let t=0;const n=Pw.exec(e);if(ut(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Rt(e.seconds),nanos:Rt(e.nanos)}}function Rt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function zn(e){return typeof e=="string"?zt.fromBase64String(e):zt.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm="server_timestamp",rm="__type__",im="__previous_value__",sm="__local_write_time__";function $l(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[rm])===null||n===void 0?void 0:n.stringValue)===nm}function ha(e){const t=e.mapValue.fields[im];return $l(t)?ha(t):t}function es(e){const t=jn(e.mapValue.fields[sm].timestampValue);return new yt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(t,n,r,i,s,o,u,c,l,h){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=h}}const Vo="(default)";class ns{constructor(t,n){this.projectId=t,this.database=n||Vo}static empty(){return new ns("","")}get isDefaultDatabase(){return this.database===Vo}isEqual(t){return t instanceof ns&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="__type__",Vw="__max__",Ws={mapValue:{}},am="__vector__",No="value";function Hn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?$l(e)?4:Dw(e)?9007199254740991:Nw(e)?10:11:W(28295,{value:e})}function nn(e,t){if(e===t)return!0;const n=Hn(e);if(n!==Hn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return es(e).isEqual(es(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=jn(i.timestampValue),u=jn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return zn(i.bytesValue).isEqual(zn(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return Rt(i.geoPointValue.latitude)===Rt(s.geoPointValue.latitude)&&Rt(i.geoPointValue.longitude)===Rt(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Rt(i.integerValue)===Rt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Rt(i.doubleValue),u=Rt(s.doubleValue);return o===u?xo(o)===xo(u):isNaN(o)&&isNaN(u)}return!1}(e,t);case 9:return Wr(e.arrayValue.values||[],t.arrayValue.values||[],nn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(lf(o)!==lf(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!nn(o[c],u[c])))return!1;return!0}(e,t);default:return W(52216,{left:e})}}function rs(e,t){return(e.values||[]).find(n=>nn(n,t))!==void 0}function Kr(e,t){if(e===t)return 0;const n=Hn(e),r=Hn(t);if(n!==r)return Z(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Z(e.booleanValue,t.booleanValue);case 2:return function(s,o){const u=Rt(s.integerValue||s.doubleValue),c=Rt(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(e,t);case 3:return hf(e.timestampValue,t.timestampValue);case 4:return hf(es(e),es(t));case 5:return xu(e.stringValue,t.stringValue);case 6:return function(s,o){const u=zn(s),c=zn(o);return u.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let l=0;l<u.length&&l<c.length;l++){const h=Z(u[l],c[l]);if(h!==0)return h}return Z(u.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const u=Z(Rt(s.latitude),Rt(o.latitude));return u!==0?u:Z(Rt(s.longitude),Rt(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ff(e.arrayValue,t.arrayValue);case 10:return function(s,o){var u,c,l,h;const d=s.fields||{},p=o.fields||{},g=(u=d[No])===null||u===void 0?void 0:u.arrayValue,_=(c=p[No])===null||c===void 0?void 0:c.arrayValue,E=Z(((l=g==null?void 0:g.values)===null||l===void 0?void 0:l.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:ff(g,_)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===Ws.mapValue&&o===Ws.mapValue)return 0;if(s===Ws.mapValue)return 1;if(o===Ws.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),l=o.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const p=xu(c[d],h[d]);if(p!==0)return p;const g=Kr(u[c[d]],l[h[d]]);if(g!==0)return g}return Z(c.length,h.length)}(e.mapValue,t.mapValue);default:throw W(23264,{le:n})}}function hf(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Z(e,t);const n=jn(e),r=jn(t),i=Z(n.seconds,r.seconds);return i!==0?i:Z(n.nanos,r.nanos)}function ff(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Kr(n[i],r[i]);if(s)return s}return Z(n.length,r.length)}function Qr(e){return Vu(e)}function Vu(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=jn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return zn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return G.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Vu(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Vu(n.fields[o])}`;return i+"}"}(e.mapValue):W(61005,{value:e})}function so(e){switch(Hn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ha(e);return t?16+so(t):16;case 5:return 2*e.stringValue.length;case 6:return zn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+so(s),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return Qn(r.fields,(s,o)=>{i+=s.length+so(o)}),i}(e.mapValue);default:throw W(13486,{value:e})}}function df(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Nu(e){return!!e&&"integerValue"in e}function ql(e){return!!e&&"arrayValue"in e}function pf(e){return!!e&&"nullValue"in e}function mf(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function oo(e){return!!e&&"mapValue"in e}function Nw(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[om])===null||n===void 0?void 0:n.stringValue)===am}function Gi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Qn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=Gi(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Gi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Dw(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Vw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(t){this.value=t}static empty(){return new ue({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!oo(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Gi(n)}setAll(t){let n=jt.emptyPath(),r={},i=[];t.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=Gi(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){const n=this.field(t.popLast());oo(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return nn(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];oo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){Qn(n,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new ue(Gi(this.value))}}function um(e){const t=[];return Qn(e.fields,(n,r)=>{const i=new jt([n]);if(oo(r)){const s=um(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new ye(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(t,n,r,i,s,o,u){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(t){return new Xt(t,0,K.min(),K.min(),K.min(),ue.empty(),0)}static newFoundDocument(t,n,r,i){return new Xt(t,1,n,K.min(),r,i,0)}static newNoDocument(t,n){return new Xt(t,2,n,K.min(),K.min(),ue.empty(),0)}static newUnknownDocument(t,n){return new Xt(t,3,n,K.min(),K.min(),ue.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ue.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Xt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(t,n){this.position=t,this.inclusive=n}}function gf(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=Kr(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function _f(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!nn(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(t,n="asc"){this.field=t,this.dir=n}}function kw(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{}class Vt extends lm{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new Mw(t,n,r):n==="array-contains"?new Uw(t,r):n==="in"?new Bw(t,r):n==="not-in"?new $w(t,r):n==="array-contains-any"?new qw(t,r):new Vt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new Lw(t,r):new Fw(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Kr(n,this.value)):n!==null&&Hn(this.value)===Hn(n)&&this.matchesComparison(Kr(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Oe extends lm{constructor(t,n){super(),this.filters=t,this.op=n,this.he=null}static create(t,n){return new Oe(t,n)}matches(t){return cm(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function cm(e){return e.op==="and"}function hm(e){return Ow(e)&&cm(e)}function Ow(e){for(const t of e.filters)if(t instanceof Oe)return!1;return!0}function Du(e){if(e instanceof Vt)return e.field.canonicalString()+e.op.toString()+Qr(e.value);if(hm(e))return e.filters.map(t=>Du(t)).join(",");{const t=e.filters.map(n=>Du(n)).join(",");return`${e.op}(${t})`}}function fm(e,t){return e instanceof Vt?function(r,i){return i instanceof Vt&&r.op===i.op&&r.field.isEqual(i.field)&&nn(r.value,i.value)}(e,t):e instanceof Oe?function(r,i){return i instanceof Oe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&fm(o,i.filters[u]),!0):!1}(e,t):void W(19439)}function dm(e){return e instanceof Vt?function(n){return`${n.field.canonicalString()} ${n.op} ${Qr(n.value)}`}(e):e instanceof Oe?function(n){return n.op.toString()+" {"+n.getFilters().map(dm).join(" ,")+"}"}(e):"Filter"}class Mw extends Vt{constructor(t,n,r){super(t,n,r),this.key=G.fromName(r.referenceValue)}matches(t){const n=G.comparator(t.key,this.key);return this.matchesComparison(n)}}class Lw extends Vt{constructor(t,n){super(t,"in",n),this.keys=pm("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class Fw extends Vt{constructor(t,n){super(t,"not-in",n),this.keys=pm("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function pm(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class Uw extends Vt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return ql(n)&&rs(n.arrayValue,this.value)}}class Bw extends Vt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&rs(this.value.arrayValue,n)}}class $w extends Vt{constructor(t,n){super(t,"not-in",n)}matches(t){if(rs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!rs(this.value.arrayValue,n)}}class qw extends Vt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!ql(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>rs(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(t,n=null,r=[],i=[],s=null,o=null,u=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.Pe=null}}function yf(e,t=null,n=[],r=[],i=null,s=null,o=null){return new jw(e,t,n,r,i,s,o)}function jl(e){const t=Q(e);if(t.Pe===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>Du(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ca(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Qr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Qr(r)).join(",")),t.Pe=n}return t.Pe}function zl(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!kw(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!fm(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!_f(e.startAt,t.startAt)&&_f(e.endAt,t.endAt)}function ku(e){return G.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(t,n=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function zw(e,t,n,r,i,s,o,u){return new li(e,t,n,r,i,s,o,u)}function Hl(e){return new li(e)}function vf(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function mm(e){return e.collectionGroup!==null}function Wi(e){const t=Q(e);if(t.Te===null){t.Te=[];const n=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Dt(jt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(u=u.add(l.field))})}),u})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Te.push(new is(s,r))}),n.has(jt.keyField().canonicalString())||t.Te.push(new is(jt.keyField(),r))}return t.Te}function Ke(e){const t=Q(e);return t.Ie||(t.Ie=Hw(t,Wi(e))),t.Ie}function Hw(e,t){if(e.limitType==="F")return yf(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new is(i.field,s)});const n=e.endAt?new Do(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Do(e.startAt.position,e.startAt.inclusive):null;return yf(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Ou(e,t){const n=e.filters.concat([t]);return new li(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function ko(e,t,n){return new li(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function fa(e,t){return zl(Ke(e),Ke(t))&&e.limitType===t.limitType}function gm(e){return`${jl(Ke(e))}|lt:${e.limitType}`}function Lr(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>dm(i)).join(", ")}]`),ca(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Qr(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Qr(i)).join(",")),`Target(${r})`}(Ke(e))}; limitType=${e.limitType})`}function da(e,t){return t.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(const s of Wi(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,u,c){const l=gf(o,u,c);return o.inclusive?l<=0:l<0}(r.startAt,Wi(r),i)||r.endAt&&!function(o,u,c){const l=gf(o,u,c);return o.inclusive?l>=0:l>0}(r.endAt,Wi(r),i))}(e,t)}function Gw(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function _m(e){return(t,n)=>{let r=!1;for(const i of Wi(e)){const s=Ww(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Ww(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(s,o,u){const c=o.data.field(s),l=u.data.field(s);return c!==null&&l!==null?Kr(c,l):W(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return W(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Qn(this.inner,(n,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return tm(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=new Et(G.comparator);function wn(){return Kw}const ym=new Et(G.comparator);function Di(...e){let t=ym;for(const n of e)t=t.insert(n.key,n);return t}function vm(e){let t=ym;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function ar(){return Ki()}function wm(){return Ki()}function Ki(){return new Tr(e=>e.toString(),(e,t)=>e.isEqual(t))}const Qw=new Et(G.comparator),Xw=new Dt(G.comparator);function tt(...e){let t=Xw;for(const n of e)t=t.add(n);return t}const Yw=new Dt(Z);function Jw(){return Yw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xo(t)?"-0":t}}function Em(e){return{integerValue:""+e}}function Zw(e,t){return Sw(t)?Em(t):Gl(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(){this._=void 0}}function tE(e,t,n){return e instanceof Oo?function(i,s){const o={fields:{[rm]:{stringValue:nm},[sm]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&$l(s)&&(s=ha(s)),s&&(o.fields[im]=s),{mapValue:o}}(n,t):e instanceof ss?Am(e,t):e instanceof os?Im(e,t):function(i,s){const o=Tm(i,s),u=wf(o)+wf(i.Ee);return Nu(o)&&Nu(i.Ee)?Em(u):Gl(i.serializer,u)}(e,t)}function eE(e,t,n){return e instanceof ss?Am(e,t):e instanceof os?Im(e,t):n}function Tm(e,t){return e instanceof Mo?function(r){return Nu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}class Oo extends pa{}class ss extends pa{constructor(t){super(),this.elements=t}}function Am(e,t){const n=Rm(t);for(const r of e.elements)n.some(i=>nn(i,r))||n.push(r);return{arrayValue:{values:n}}}class os extends pa{constructor(t){super(),this.elements=t}}function Im(e,t){let n=Rm(t);for(const r of e.elements)n=n.filter(i=>!nn(i,r));return{arrayValue:{values:n}}}class Mo extends pa{constructor(t,n){super(),this.serializer=t,this.Ee=n}}function wf(e){return Rt(e.integerValue||e.doubleValue)}function Rm(e){return ql(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function nE(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof ss&&i instanceof ss||r instanceof os&&i instanceof os?Wr(r.elements,i.elements,nn):r instanceof Mo&&i instanceof Mo?nn(r.Ee,i.Ee):r instanceof Oo&&i instanceof Oo}(e.transform,t.transform)}class rE{constructor(t,n){this.version=t,this.transformResults=n}}class Qe{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Qe}static exists(t){return new Qe(void 0,t)}static updateTime(t){return new Qe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ao(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class ma{}function Sm(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Cm(e.key,Qe.none()):new ys(e.key,e.data,Qe.none());{const n=e.data,r=ue.empty();let i=new Dt(jt.comparator);for(let s of t.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Xn(e.key,r,new ye(i.toArray()),Qe.none())}}function iE(e,t,n){e instanceof ys?function(i,s,o){const u=i.value.clone(),c=Tf(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,n):e instanceof Xn?function(i,s,o){if(!ao(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=Tf(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(bm(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Qi(e,t,n,r){return e instanceof ys?function(s,o,u,c){if(!ao(s.precondition,o))return u;const l=s.value.clone(),h=Af(s.fieldTransforms,c,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(e,t,n,r):e instanceof Xn?function(s,o,u,c){if(!ao(s.precondition,o))return u;const l=Af(s.fieldTransforms,c,o),h=o.data;return h.setAll(bm(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,r):function(s,o,u){return ao(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(e,t,n)}function sE(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),s=Tm(r.transform,i||null);s!=null&&(n===null&&(n=ue.empty()),n.set(r.field,s))}return n||null}function Ef(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Wr(r,i,(s,o)=>nE(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ys extends ma{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xn extends ma{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function bm(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Tf(e,t,n){const r=new Map;ut(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,u=t.data.field(s.field);r.set(s.field,eE(o,u,n[i]))}return r}function Af(e,t,n){const r=new Map;for(const i of e){const s=i.transform,o=n.data.field(i.field);r.set(i.field,tE(s,o,t))}return r}class Cm extends ma{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oE extends ma{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&iE(s,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Qi(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Qi(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=wm();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const c=Sm(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),tt())}isEqual(t){return this.batchId===t.batchId&&Wr(this.mutations,t.mutations,(n,r)=>Ef(n,r))&&Wr(this.baseMutations,t.baseMutations,(n,r)=>Ef(n,r))}}class Wl{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){ut(t.mutations.length===r.length,58842,{Ve:t.mutations.length,me:r.length});let i=function(){return Qw}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Wl(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt,et;function cE(e){switch(e){case O.OK:return W(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return W(15467,{code:e})}}function Pm(e){if(e===void 0)return yn("GRPC error has no .code"),O.UNKNOWN;switch(e){case xt.OK:return O.OK;case xt.CANCELLED:return O.CANCELLED;case xt.UNKNOWN:return O.UNKNOWN;case xt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case xt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case xt.INTERNAL:return O.INTERNAL;case xt.UNAVAILABLE:return O.UNAVAILABLE;case xt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case xt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case xt.NOT_FOUND:return O.NOT_FOUND;case xt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case xt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case xt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case xt.ABORTED:return O.ABORTED;case xt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case xt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case xt.DATA_LOSS:return O.DATA_LOSS;default:return W(39323,{code:e})}}(et=xt||(xt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE=new Ln([4294967295,4294967295],0);function If(e){const t=Xp().encode(e),n=new qp;return n.update(t),new Uint8Array(n.digest())}function Rf(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Ln([n,r],0),new Ln([i,s],0)]}class Kl{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ki(`Invalid padding: ${n}`);if(r<0)throw new ki(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new ki(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new ki(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*t.length-n,this.ge=Ln.fromNumber(this.fe)}pe(t,n,r){let i=t.add(n.multiply(Ln.fromNumber(r)));return i.compare(hE)===1&&(i=new Ln([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const n=If(t),[r,i]=Rf(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(t,n,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new Kl(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(t){if(this.fe===0)return;const n=If(t),[r,i]=Rf(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class ki extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const i=new Map;return i.set(t,vs.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new ga(K.min(),i,new Et(Z),wn(),tt())}}class vs{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new vs(r,n,tt(),tt(),tt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(t,n,r,i){this.Se=t,this.removedTargetIds=n,this.key=r,this.be=i}}class xm{constructor(t,n){this.targetId=t,this.De=n}}class Vm{constructor(t,n,r=zt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Sf{constructor(){this.ve=0,this.Ce=bf(),this.Fe=zt.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=tt(),n=tt(),r=tt();return this.Ce.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:W(38017,{changeType:s})}}),new vs(this.Fe,this.Me,t,n,r)}ke(){this.xe=!1,this.Ce=bf()}qe(t,n){this.xe=!0,this.Ce=this.Ce.insert(t,n)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,ut(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class fE{constructor(t){this.We=t,this.Ge=new Map,this.ze=wn(),this.je=Ks(),this.Je=Ks(),this.He=new Et(Z)}Ye(t){for(const n of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(n,t.be):this.Xe(n,t.key,t.be);for(const n of t.removedTargetIds)this.Xe(n,t.key,t.be)}et(t){this.forEachTarget(t,n=>{const r=this.tt(n);switch(t.state){case 0:this.nt(n)&&r.Be(t.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(t.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(t.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(t.resumeToken));break;default:W(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(t){const n=t.targetId,r=t.De.count,i=this.st(n);if(i){const s=i.target;if(ku(s))if(r===0){const o=new G(s.path);this.Xe(n,o,Xt.newNoDocument(o,K.min()))}else ut(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const u=this._t(t),c=u?this.ut(u,t,o):1;if(c!==0){this.rt(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,l)}}}}}_t(t){const n=t.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=zn(r).toUint8Array()}catch(c){if(c instanceof em)return $n("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new Kl(o,i,s)}catch(c){return $n(c instanceof ki?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.fe===0?null:u}ut(t,n,r){return n.De.count===r-this.ht(t,n.targetId)?0:2}ht(t,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(u)||(this.Xe(n,s,null),i++)}),i}Pt(t){const n=new Map;this.Ge.forEach((s,o)=>{const u=this.st(o);if(u){if(s.current&&ku(u.target)){const c=new G(u.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,Xt.newNoDocument(c,t))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=tt();this.Je.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const l=this.st(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(t));const i=new ga(t,n,this.He,this.ze,r);return this.ze=wn(),this.je=Ks(),this.Je=Ks(),this.He=new Et(Z),i}Ze(t,n){if(!this.nt(t))return;const r=this.It(t,n.key)?2:0;this.tt(t).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(t)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(t))}Xe(t,n,r){if(!this.nt(t))return;const i=this.tt(t);this.It(t,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(t)),this.Je=this.Je.insert(n,this.dt(n).add(t)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(t){this.Ge.delete(t)}ot(t){const n=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let n=this.Ge.get(t);return n||(n=new Sf,this.Ge.set(t,n)),n}dt(t){let n=this.Je.get(t);return n||(n=new Dt(Z),this.Je=this.Je.insert(t,n)),n}Tt(t){let n=this.je.get(t);return n||(n=new Dt(Z),this.je=this.je.insert(t,n)),n}nt(t){const n=this.st(t)!==null;return n||j("WatchChangeAggregator","Detected inactive target",t),n}st(t){const n=this.Ge.get(t);return n&&n.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new Sf),this.We.getRemoteKeysForTarget(t).forEach(n=>{this.Xe(t,n,null)})}It(t,n){return this.We.getRemoteKeysForTarget(t).has(n)}}function Ks(){return new Et(G.comparator)}function bf(){return new Et(G.comparator)}const dE={asc:"ASCENDING",desc:"DESCENDING"},pE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mE={and:"AND",or:"OR"};class gE{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function Mu(e,t){return e.useProto3Json||ca(t)?t:{value:t}}function Lo(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Nm(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function _E(e,t){return Lo(e,t.toTimestamp())}function Xe(e){return ut(!!e,49232),K.fromTimestamp(function(n){const r=jn(n);return new yt(r.seconds,r.nanos)}(e))}function Ql(e,t){return Lu(e,t).canonicalString()}function Lu(e,t){const n=function(i){return new pt(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Dm(e){const t=pt.fromString(e);return ut(Fm(t),10190,{key:t.toString()}),t}function Fu(e,t){return Ql(e.databaseId,t.path)}function ou(e,t){const n=Dm(t);if(n.get(1)!==e.databaseId.projectId)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new G(Om(n))}function km(e,t){return Ql(e.databaseId,t)}function yE(e){const t=Dm(e);return t.length===4?pt.emptyPath():Om(t)}function Uu(e){return new pt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Om(e){return ut(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Cf(e,t,n){return{name:Fu(e,t),fields:n.value.mapValue.fields}}function vE(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:W(39313,{state:l})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(l,h){return l.useProto3Json?(ut(h===void 0||typeof h=="string",58123),zt.fromBase64String(h||"")):(ut(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),zt.fromUint8Array(h||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(l){const h=l.code===void 0?O.UNKNOWN:Pm(l.code);return new q(h,l.message||"")}(o);n=new Vm(r,i,s,u||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=ou(e,r.document.name),s=Xe(r.document.updateTime),o=r.document.createTime?Xe(r.document.createTime):K.min(),u=new ue({mapValue:{fields:r.document.fields}}),c=Xt.newFoundDocument(i,s,o,u),l=r.targetIds||[],h=r.removedTargetIds||[];n=new uo(l,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=ou(e,r.document),s=r.readTime?Xe(r.readTime):K.min(),o=Xt.newNoDocument(i,s),u=r.removedTargetIds||[];n=new uo([],u,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=ou(e,r.document),s=r.removedTargetIds||[];n=new uo([],s,i,null)}else{if(!("filter"in t))return W(11601,{At:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new lE(i,s),u=r.targetId;n=new xm(u,o)}}return n}function wE(e,t){let n;if(t instanceof ys)n={update:Cf(e,t.key,t.value)};else if(t instanceof Cm)n={delete:Fu(e,t.key)};else if(t instanceof Xn)n={update:Cf(e,t.key,t.data),updateMask:PE(t.fieldMask)};else{if(!(t instanceof oE))return W(16599,{Rt:t.type});n={verify:Fu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Oo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ss)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof os)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Mo)return{fieldPath:o.field.canonicalString(),increment:u.Ee};throw W(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_E(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W(27497)}(e,t.precondition)),n}function EE(e,t){return e&&e.length>0?(ut(t!==void 0,14353),e.map(n=>function(i,s){let o=i.updateTime?Xe(i.updateTime):Xe(s);return o.isEqual(K.min())&&(o=Xe(s)),new rE(o,i.transformResults||[])}(n,t))):[]}function TE(e,t){return{documents:[km(e,t.path)]}}function AE(e,t){const n={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=km(e,i);const s=function(l){if(l.length!==0)return Lm(Oe.create(l,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(l){if(l.length!==0)return l.map(h=>function(p){return{field:Fr(p.field),direction:SE(p.dir)}}(h))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const u=Mu(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{Vt:n,parent:i}}function IE(e){let t=yE(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ut(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let s=[];n.where&&(s=function(d){const p=Mm(d);return p instanceof Oe&&hm(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(_){return new is(Ur(_.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(p))}(n.orderBy));let u=null;n.limit&&(u=function(d){let p;return p=typeof d=="object"?d.value:d,ca(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(d){const p=!!d.before,g=d.values||[];return new Do(g,p)}(n.startAt));let l=null;return n.endAt&&(l=function(d){const p=!d.before,g=d.values||[];return new Do(g,p)}(n.endAt)),zw(t,i,o,s,u,"F",c,l)}function RE(e,t){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W(28987,{purpose:i})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Mm(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ur(n.unaryFilter.field);return Vt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ur(n.unaryFilter.field);return Vt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ur(n.unaryFilter.field);return Vt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ur(n.unaryFilter.field);return Vt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return W(61313);default:return W(60726)}}(e):e.fieldFilter!==void 0?function(n){return Vt.create(Ur(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return W(58110);default:return W(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Oe.create(n.compositeFilter.filters.map(r=>Mm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W(1026)}}(n.compositeFilter.op))}(e):W(30097,{filter:e})}function SE(e){return dE[e]}function bE(e){return pE[e]}function CE(e){return mE[e]}function Fr(e){return{fieldPath:e.canonicalString()}}function Ur(e){return jt.fromServerFormat(e.fieldPath)}function Lm(e){return e instanceof Vt?function(n){if(n.op==="=="){if(mf(n.value))return{unaryFilter:{field:Fr(n.field),op:"IS_NAN"}};if(pf(n.value))return{unaryFilter:{field:Fr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(mf(n.value))return{unaryFilter:{field:Fr(n.field),op:"IS_NOT_NAN"}};if(pf(n.value))return{unaryFilter:{field:Fr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fr(n.field),op:bE(n.op),value:n.value}}}(e):e instanceof Oe?function(n){const r=n.getFilters().map(i=>Lm(i));return r.length===1?r[0]:{compositeFilter:{op:CE(n.op),filters:r}}}(e):W(54877,{filter:e})}function PE(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Fm(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(t,n,r,i,s=K.min(),o=K.min(),u=zt.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(t){return new kn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(t){this.gt=t}}function VE(e){const t=IE({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?ko(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this.Dn=new DE}addToCollectionParentIndex(t,n){return this.Dn.add(n),L.resolve()}getCollectionParents(t,n){return L.resolve(this.Dn.getEntries(n))}addFieldIndex(t,n){return L.resolve()}deleteFieldIndex(t,n){return L.resolve()}deleteAllFieldIndexes(t){return L.resolve()}createTargetIndexes(t,n){return L.resolve()}getDocumentsMatchingTarget(t,n){return L.resolve(null)}getIndexType(t,n){return L.resolve(0)}getFieldIndexes(t,n){return L.resolve([])}getNextCollectionGroupToUpdate(t){return L.resolve(null)}getMinOffset(t,n){return L.resolve(qn.min())}getMinOffsetFromCollectionGroup(t,n){return L.resolve(qn.min())}updateCollectionGroup(t,n,r){return L.resolve()}updateIndexEntries(t,n){return L.resolve()}}class DE{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new Dt(pt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new Dt(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Um=41943040;class ae{static withCacheSize(t){return new ae(t,ae.DEFAULT_COLLECTION_PERCENTILE,ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ae.DEFAULT_COLLECTION_PERCENTILE=10,ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ae.DEFAULT=new ae(Um,ae.DEFAULT_COLLECTION_PERCENTILE,ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ae.DISABLED=new ae(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Xr(0)}static ur(){return new Xr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xf="LruGarbageCollector",kE=1048576;function Vf([e,t],[n,r]){const i=Z(e,n);return i===0?Z(t,r):i}class OE{constructor(t){this.Tr=t,this.buffer=new Dt(Vf),this.Ir=0}dr(){return++this.Ir}Er(t){const n=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Vf(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ME{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){j(xf,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ui(n)?j(xf,"Ignoring IndexedDB error during garbage collection: ",n):await ai(n)}await this.Rr(3e5)})}}class LE{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.mr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return L.resolve(la.ue);const r=new OE(n);return this.Vr.forEachTarget(t,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(t,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.Vr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(Pf)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Pf):this.pr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,n){let r,i,s,o,u,c,l;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(r=d,u=Date.now(),this.removeTargets(t,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(t,r))).next(d=>(l=Date.now(),Mr()<=nt.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function FE(e,t){return new LE(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this.changes=new Tr(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Xt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&Qi(r.mutation,i,ye.empty(),yt.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,tt()).next(()=>r))}getLocalViewOfDocuments(t,n,r=tt()){const i=ar();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let o=Di();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=ar();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,tt()))}populateOverlays(t,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(t,n,r,i){let s=wn();const o=Ki(),u=function(){return Ki()}();return n.forEach((c,l)=>{const h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof Xn)?s=s.insert(l.key,l):h!==void 0?(o.set(l.key,h.mutation.getFieldMask()),Qi(h.mutation,l,h.mutation.getFieldMask(),yt.now())):o.set(l.key,ye.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((l,h)=>o.set(l,h)),n.forEach((l,h)=>{var d;return u.set(l,new BE(h,(d=o.get(l))!==null&&d!==void 0?d:null))}),u))}recalculateAndSaveOverlays(t,n){const r=Ki();let i=new Et((o,u)=>o-u),s=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let h=r.get(c)||ye.empty();h=u.applyToLocalView(l,h),r.set(c,h);const d=(i.get(u.batchId)||tt()).add(c);i=i.insert(u.batchId,d)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),l=c.key,h=c.value,d=wm();h.forEach(p=>{if(!s.has(p)){const g=Sm(n.get(p),r.get(p));g!==null&&d.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,d))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):mm(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):L.resolve(ar());let u=ts,c=s;return o.next(l=>L.forEach(l,(h,d)=>(u<d.largestBatchId&&(u=d.largestBatchId),s.get(h)?L.resolve():this.remoteDocumentCache.getEntry(t,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(t,l,s)).next(()=>this.computeViews(t,c,l,tt())).next(h=>({batchId:u,changes:vm(h)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new G(n)).next(r=>{let i=Di();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const s=n.collectionGroup;let o=Di();return this.indexManager.getCollectionParents(t,s).next(u=>L.forEach(u,c=>{const l=function(d,p){return new li(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,r,i).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(o=>{s.forEach((c,l)=>{const h=l.getKey();o.get(h)===null&&(o=o.insert(h,Xt.newInvalidDocument(h)))});let u=Di();return o.forEach((c,l)=>{const h=s.get(c);h!==void 0&&Qi(h.mutation,l,ye.empty(),yt.now()),da(n,l)&&(u=u.insert(c,l))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,n){return L.resolve(this.Br.get(n))}saveBundleMetadata(t,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Xe(i.createTime)}}(n)),L.resolve()}getNamedQuery(t,n){return L.resolve(this.Lr.get(n))}saveNamedQuery(t,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:VE(i.bundledQuery),readTime:Xe(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.overlays=new Et(G.comparator),this.kr=new Map}getOverlay(t,n){return L.resolve(this.overlays.get(n))}getOverlays(t,n){const r=ar();return L.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.wt(t,n,s)}),L.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),L.resolve()}getOverlaysForCollection(t,n,r){const i=ar(),s=n.length+1,o=new G(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new Et((l,h)=>l-h);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let h=s.get(l.largestBatchId);h===null&&(h=ar(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const u=ar(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>u.set(l,h)),!(u.size()>=i)););return L.resolve(u)}wt(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new uE(n,r));let s=this.kr.get(n);s===void 0&&(s=tt(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.sessionToken=zt.EMPTY_BYTE_STRING}getSessionToken(t){return L.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(){this.qr=new Dt(Ft.Qr),this.$r=new Dt(Ft.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,n){const r=new Ft(t,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Wr(new Ft(t,n))}Gr(t,n){t.forEach(r=>this.removeReference(r,n))}zr(t){const n=new G(new pt([])),r=new Ft(n,t),i=new Ft(n,t+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const n=new G(new pt([])),r=new Ft(n,t),i=new Ft(n,t+1);let s=tt();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new Ft(t,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class Ft{constructor(t,n){this.key=t,this.Hr=n}static Qr(t,n){return G.comparator(t.key,n.key)||Z(t.Hr,n.Hr)}static Ur(t,n){return Z(t.Hr,n.Hr)||G.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Dt(Ft.Qr)}checkEmpty(t){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new aE(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.Yr=this.Yr.add(new Ft(u.key,s)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return L.resolve(o)}lookupMutationBatch(t,n){return L.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?Bl:this.er-1)}getAllMutationBatches(t){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new Ft(n,0),i=new Ft(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const u=this.Zr(o.Hr);s.push(u)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Dt(Z);return n.forEach(i=>{const s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],u=>{r=r.add(u.Hr)})}),L.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new Ft(new G(s),0);let u=new Dt(Z);return this.Yr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(u=u.add(c.Hr)),!0)},o),L.resolve(this.ei(u))}ei(t){const n=[];return t.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){ut(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return L.forEach(n.mutations,i=>{const s=new Ft(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Yr=r})}rr(t){}containsKey(t,n){const r=new Ft(n,0),i=this.Yr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,L.resolve()}ti(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(t){this.ni=t,this.docs=function(){return new Et(G.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():Xt.newInvalidDocument(n))}getEntries(t,n){let r=wn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Xt.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=wn();const o=n.path,u=new G(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:l,value:{document:h}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Tw(Ew(h),r)<=0||(i.has(h.key)||da(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(t,n,r,i){W(9500)}ri(t,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new WE(this)}getSize(t){return L.resolve(this.size)}}class WE extends UE{constructor(t){super(),this.Or=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(t,i)):this.Or.removeEntry(r)}),L.waitFor(n)}getFromCache(t,n){return this.Or.getEntry(t,n)}getAllFromCache(t,n){return this.Or.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(t){this.persistence=t,this.ii=new Tr(n=>jl(n),zl),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.si=0,this.oi=new Xl,this.targetCount=0,this._i=Xr.ar()}forEachTarget(t,n){return this.ii.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(t){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return L.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),L.resolve()}hr(t){this.ii.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this._i=new Xr(n),this.highestTargetId=n),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,n){return this.hr(n),this.targetCount+=1,L.resolve()}updateTargetData(t,n){return this.hr(n),L.resolve()}removeTargetData(t,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(t,n,r){let i=0;const s=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(t){return L.resolve(this.targetCount)}getTargetData(t,n){const r=this.ii.get(n)||null;return L.resolve(r)}addMatchingKeys(t,n,r){return this.oi.Kr(n,r),L.resolve()}removeMatchingKeys(t,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.oi.zr(n),L.resolve()}getMatchingKeysForTargetId(t,n){const r=this.oi.Jr(n);return L.resolve(r)}containsKey(t,n){return L.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(t,n){this.ai={},this.overlays={},this.ui=new la(0),this.ci=!1,this.ci=!0,this.li=new zE,this.referenceDelegate=t(this),this.hi=new KE(this),this.indexManager=new NE,this.remoteDocumentCache=function(i){return new GE(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new xE(n),this.Ti=new qE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new jE,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ai[t.toKey()];return r||(r=new HE(n,this.referenceDelegate),this.ai[t.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,n,r){j("MemoryPersistence","Starting transaction:",t);const i=new QE(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(t,n){return L.or(Object.values(this.ai).map(r=>()=>r.containsKey(t,n)))}}class QE extends Iw{constructor(t){super(),this.currentSequenceNumber=t}}class Yl{constructor(t){this.persistence=t,this.Ai=new Xl,this.Ri=null}static Vi(t){return new Yl(t)}get mi(){if(this.Ri)return this.Ri;throw W(60996)}addReference(t,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),L.resolve()}removeReference(t,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(t,n){return this.mi.add(n.toString()),L.resolve()}removeTarget(t,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ii(){this.Ri=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.mi,r=>{const i=G.fromPath(r);return this.fi(t,i).next(s=>{s||n.removeEntry(i,K.min())})}).next(()=>(this.Ri=null,n.apply(t)))}updateLimboDocument(t,n){return this.fi(t,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(t){return 0}fi(t,n){return L.or([()=>L.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class Fo{constructor(t,n){this.persistence=t,this.gi=new Tr(r=>bw(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=FE(this,n)}static Vi(t,n){return new Fo(t,n)}Ii(){}di(t){return L.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}mr(t){const n=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}yr(t){let n=0;return this.gr(t,r=>{n++}).next(()=>n)}gr(t,n){return L.forEach(this.gi,(r,i)=>this.Sr(t,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(t,o=>this.Sr(t,o,n).next(u=>{u||(r++,s.removeEntry(o,K.min()))})).next(()=>s.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}removeReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),L.resolve()}updateLimboDocument(t,n){return this.gi.set(n,t.currentSequenceNumber),L.resolve()}Pi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=so(t.data.value)),n}Sr(t,n,r){return L.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.gi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.Is=r,this.ds=i}static Es(t,n){let r=tt(),i=tt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Jl(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return jv()?8:Rw($v())>0?6:4}()}initialize(t,n){this.gs=t,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(t,n,r,i){const s={result:null};return this.ps(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(t,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new XE;return this.ws(t,n,o).next(u=>{if(s.result=u,this.Rs)return this.Ss(t,n,o,u.size)})}).next(()=>s.result)}Ss(t,n,r,i){return r.documentReadCount<this.Vs?(Mr()<=nt.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",Lr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),L.resolve()):(Mr()<=nt.DEBUG&&j("QueryEngine","Query:",Lr(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Mr()<=nt.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",Lr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ke(n))):L.resolve())}ps(t,n){if(vf(n))return L.resolve(null);let r=Ke(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=ko(n,null,"F"),r=Ke(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const o=tt(...s);return this.gs.getDocuments(t,o).next(u=>this.indexManager.getMinOffset(t,r).next(c=>{const l=this.bs(n,u);return this.Ds(n,l,o,c.readTime)?this.ps(t,ko(n,null,"F")):this.vs(t,l,n,c)}))})))}ys(t,n,r,i){return vf(n)||i.isEqual(K.min())?L.resolve(null):this.gs.getDocuments(t,r).next(s=>{const o=this.bs(n,s);return this.Ds(n,o,r,i)?L.resolve(null):(Mr()<=nt.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Lr(n)),this.vs(t,o,n,ww(i,ts)).next(u=>u))})}bs(t,n){let r=new Dt(_m(t));return n.forEach((i,s)=>{da(t,s)&&(r=r.add(s))}),r}Ds(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(t,n,r){return Mr()<=nt.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Lr(n)),this.gs.getDocumentsMatchingQuery(t,n,qn.min(),r)}vs(t,n,r,i){return this.gs.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl="LocalStore",JE=3e8;class ZE{constructor(t,n,r,i){this.persistence=t,this.Cs=n,this.serializer=i,this.Fs=new Et(Z),this.Ms=new Tr(s=>jl(s),zl),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(r)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new $E(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Fs))}}function tT(e,t,n,r){return new ZE(e,t,n,r)}async function $m(e,t){const n=Q(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=tt();for(const l of i){o.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}for(const l of s){u.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Bs:l,removedBatchIds:o,addedBatchIds:u}))})})}function eT(e,t){const n=Q(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,c,l,h){const d=l.batch,p=d.keys();let g=L.resolve();return p.forEach(_=>{g=g.next(()=>h.getEntry(c,_)).next(E=>{const v=l.docVersions.get(_);ut(v!==null,48541),E.version.compareTo(v)<0&&(d.applyToRemoteDocument(E,l),E.isValidDocument()&&(E.setReadTime(l.commitVersion),h.addEntry(E)))})}),g.next(()=>u.mutationQueue.removeMutationBatch(c,d))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=tt();for(let l=0;l<u.mutationResults.length;++l)u.mutationResults[l].transformResults.length>0&&(c=c.add(u.batch.mutations[l].key));return c}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function qm(e){const t=Q(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.hi.getLastRemoteSnapshotVersion(n))}function nT(e,t){const n=Q(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const u=[];t.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;u.push(n.hi.removeMatchingKeys(s,h.removedDocuments,d).next(()=>n.hi.addMatchingKeys(s,h.addedDocuments,d)));let g=p.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?g=g.withResumeToken(zt.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(d,g),function(E,v,P){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=JE?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(p,g,h)&&u.push(n.hi.updateTargetData(s,g))});let c=wn(),l=tt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),u.push(rT(s,o,t.documentUpdates).next(h=>{c=h.Ls,l=h.ks})),!r.isEqual(K.min())){const h=n.hi.getLastRemoteSnapshotVersion(s).next(d=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(h)}return L.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.Fs=i,s))}function rT(e,t,n){let r=tt(),i=tt();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let o=wn();return n.forEach((u,c)=>{const l=s.get(u);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(K.min())?(t.removeEntry(u,c.readTime),o=o.insert(u,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(u,c)):j(Zl,"Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function iT(e,t){const n=Q(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=Bl),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function sT(e,t){const n=Q(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,t).next(s=>s?(i=s,L.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new kn(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(t,r.targetId)),r})}async function Bu(e,t,n){const r=Q(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ui(o))throw o;j(Zl,`Failed to update sequence numbers for target ${t}: ${o}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function Nf(e,t,n){const r=Q(e);let i=K.min(),s=tt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,h){const d=Q(c),p=d.Ms.get(h);return p!==void 0?L.resolve(d.Fs.get(p)):d.hi.getTargetData(l,h)}(r,o,Ke(t)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,t,n?i:K.min(),n?s:tt())).next(u=>(oT(r,Gw(t),u),{documents:u,qs:s})))}function oT(e,t,n){let r=e.xs.get(t)||K.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.xs.set(t,r)}class Df{constructor(){this.activeTargetIds=Jw()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class aT{constructor(){this.Fo=new Df,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,n,r){this.Mo[t]=n}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new Df,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf="ConnectivityMonitor";class Of{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){j(kf,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){j(kf,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qs=null;function $u(){return Qs===null?Qs=function(){return 268435456+Math.round(2147483648*Math.random())}():Qs++,"0x"+Qs.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au="RestConnection",lT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cT{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Vo?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,n,r,i,s){const o=$u(),u=this.Go(t,n.toUriEncodedString());j(au,`Sending RPC '${t}' ${o}:`,u,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);const{host:l}=new URL(u),h=Ml(l);return this.jo(t,u,c,r,h).then(d=>(j(au,`Received RPC '${t}' ${o}: `,d),d),d=>{throw $n(au,`RPC '${t}' ${o} failed with error: `,d,"url: ",u,"request:",r),d})}Jo(t,n,r,i,s,o){return this.Wo(t,n,r,i,s)}zo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+oi}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}Go(t,n){const r=lT[t];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kt="WebChannelConnection";class fT extends cT{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,n,r,i,s){const o=$u();return new Promise((u,c)=>{const l=new jp;l.setWithCredentials(!0),l.listenOnce(zp.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case io.NO_ERROR:const d=l.getResponseJson();j(Kt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),u(d);break;case io.TIMEOUT:j(Kt,`RPC '${t}' ${o} timed out`),c(new q(O.DEADLINE_EXCEEDED,"Request time out"));break;case io.HTTP_ERROR:const p=l.getStatus();if(j(Kt,`RPC '${t}' ${o} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const E=function(P){const b=P.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(b)>=0?b:O.UNKNOWN}(_.status);c(new q(E,_.message))}else c(new q(O.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new q(O.UNAVAILABLE,"Connection failed."));break;default:W(9055,{c_:t,streamId:o,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{j(Kt,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);j(Kt,`RPC '${t}' ${o} sending request:`,i),l.send(n,"POST",h,r,15)})}P_(t,n,r){const i=$u(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Wp(),u=Gp(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=s.join("");j(Kt,`Creating RPC '${t}' stream ${i}: ${h}`,c);const d=o.createWebChannel(h,c);this.T_(d);let p=!1,g=!1;const _=new hT({Ho:v=>{g?j(Kt,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(p||(j(Kt,`Opening RPC '${t}' stream ${i} transport.`),d.open(),p=!0),j(Kt,`RPC '${t}' stream ${i} sending:`,v),d.send(v))},Yo:()=>d.close()}),E=(v,P,b)=>{v.listen(P,N=>{try{b(N)}catch(x){setTimeout(()=>{throw x},0)}})};return E(d,Ni.EventType.OPEN,()=>{g||(j(Kt,`RPC '${t}' stream ${i} transport opened.`),_.s_())}),E(d,Ni.EventType.CLOSE,()=>{g||(g=!0,j(Kt,`RPC '${t}' stream ${i} transport closed`),_.__(),this.I_(d))}),E(d,Ni.EventType.ERROR,v=>{g||(g=!0,$n(Kt,`RPC '${t}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),_.__(new q(O.UNAVAILABLE,"The operation could not be completed")))}),E(d,Ni.EventType.MESSAGE,v=>{var P;if(!g){const b=v.data[0];ut(!!b,16349);const N=b,x=(N==null?void 0:N.error)||((P=N[0])===null||P===void 0?void 0:P.error);if(x){j(Kt,`RPC '${t}' stream ${i} received error:`,x);const M=x.status;let U=function(T){const S=xt[T];if(S!==void 0)return Pm(S)}(M),I=x.message;U===void 0&&(U=O.INTERNAL,I="Unknown error status: "+M+" with message "+x.message),g=!0,_.__(new q(U,I)),d.close()}else j(Kt,`RPC '${t}' stream ${i} received:`,b),_.a_(b)}}),E(u,Hp.STAT_EVENT,v=>{v.stat===Pu.PROXY?j(Kt,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===Pu.NOPROXY&&j(Kt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.o_()},0),_}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(n=>n===t)}}function uu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(e){return new gE(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(t,n,r=1e3,i=1.5,s=6e4){this.Fi=t,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&j("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf="PersistentStream";class zm{constructor(t,n,r,i,s,o,u,c){this.Fi=t,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new jm(t,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():n&&n.code===O.RESOURCE_EXHAUSTED?(yn(n.toString()),yn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(n)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{t(()=>{const i=new q(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(t,n){const r=this.K_(this.b_);this.stream=this.z_(t,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return j(Mf,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return n=>{this.Fi.enqueueAndForget(()=>this.b_===t?n():(j(Mf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dT extends zm{constructor(t,n,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(t,n){return this.connection.P_("Listen",t,n)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const n=vE(this.serializer,t),r=function(s){if(!("targetChange"in s))return K.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?K.min():o.readTime?Xe(o.readTime):K.min()}(t);return this.listener.J_(n,r)}H_(t){const n={};n.database=Uu(this.serializer),n.addTarget=function(s,o){let u;const c=o.target;if(u=ku(c)?{documents:TE(s,c)}:{query:AE(s,c).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=Nm(s,o.resumeToken);const l=Mu(s,o.expectedCount);l!==null&&(u.expectedCount=l)}else if(o.snapshotVersion.compareTo(K.min())>0){u.readTime=Lo(s,o.snapshotVersion.toTimestamp());const l=Mu(s,o.expectedCount);l!==null&&(u.expectedCount=l)}return u}(this.serializer,t);const r=RE(this.serializer,t);r&&(n.labels=r),this.k_(n)}Y_(t){const n={};n.database=Uu(this.serializer),n.removeTarget=t,this.k_(n)}}class pT extends zm{constructor(t,n,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,n){return this.connection.P_("Write",t,n)}j_(t){return ut(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ut(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){ut(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const n=EE(t.writeResults,t.commitTime),r=Xe(t.commitTime);return this.listener.ta(r,n)}na(){const t={};t.database=Uu(this.serializer),this.k_(t)}X_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>wE(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{}class gT extends mT{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,Lu(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(O.UNKNOWN,s.toString())})}Jo(t,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(t,Lu(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(O.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class _T{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(yn(n),this._a=!1):j("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr="RemoteStore";class yT{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Ar(this)&&(j(gr,"Restarting streams for network reachability change."),await async function(c){const l=Q(c);l.Ia.add(4),await ws(l),l.Aa.set("Unknown"),l.Ia.delete(4),await ya(l)}(this))})}),this.Aa=new _T(r,i)}}async function ya(e){if(Ar(e))for(const t of e.da)await t(!0)}async function ws(e){for(const t of e.da)await t(!1)}function Hm(e,t){const n=Q(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),rc(n)?nc(n):ci(n).x_()&&ec(n,t))}function tc(e,t){const n=Q(e),r=ci(n);n.Ta.delete(t),r.x_()&&Gm(n,t),n.Ta.size===0&&(r.x_()?r.B_():Ar(n)&&n.Aa.set("Unknown"))}function ec(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(K.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ci(e).H_(t)}function Gm(e,t){e.Ra.$e(t),ci(e).Y_(t)}function nc(e){e.Ra=new fE({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),ci(e).start(),e.Aa.aa()}function rc(e){return Ar(e)&&!ci(e).M_()&&e.Ta.size>0}function Ar(e){return Q(e).Ia.size===0}function Wm(e){e.Ra=void 0}async function vT(e){e.Aa.set("Online")}async function wT(e){e.Ta.forEach((t,n)=>{ec(e,t)})}async function ET(e,t){Wm(e),rc(e)?(e.Aa.la(t),nc(e)):e.Aa.set("Unknown")}async function TT(e,t,n){if(e.Aa.set("Online"),t instanceof Vm&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.Ta.delete(u),i.Ra.removeTarget(u))}(e,t)}catch(r){j(gr,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Uo(e,r)}else if(t instanceof uo?e.Ra.Ye(t):t instanceof xm?e.Ra.it(t):e.Ra.et(t),!n.isEqual(K.min()))try{const r=await qm(e.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Ra.Pt(o);return u.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.Ta.get(l);h&&s.Ta.set(l,h.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,l)=>{const h=s.Ta.get(c);if(!h)return;s.Ta.set(c,h.withResumeToken(zt.EMPTY_BYTE_STRING,h.snapshotVersion)),Gm(s,c);const d=new kn(h.target,c,l,h.sequenceNumber);ec(s,d)}),s.remoteSyncer.applyRemoteEvent(u)}(e,n)}catch(r){j(gr,"Failed to raise snapshot:",r),await Uo(e,r)}}async function Uo(e,t,n){if(!ui(t))throw t;e.Ia.add(1),await ws(e),e.Aa.set("Offline"),n||(n=()=>qm(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{j(gr,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await ya(e)})}function Km(e,t){return t().catch(n=>Uo(e,n,t))}async function va(e){const t=Q(e),n=Gn(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Bl;for(;AT(t);)try{const i=await iT(t.localStore,r);if(i===null){t.Pa.length===0&&n.B_();break}r=i.batchId,IT(t,i)}catch(i){await Uo(t,i)}Qm(t)&&Xm(t)}function AT(e){return Ar(e)&&e.Pa.length<10}function IT(e,t){e.Pa.push(t);const n=Gn(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function Qm(e){return Ar(e)&&!Gn(e).M_()&&e.Pa.length>0}function Xm(e){Gn(e).start()}async function RT(e){Gn(e).na()}async function ST(e){const t=Gn(e);for(const n of e.Pa)t.X_(n.mutations)}async function bT(e,t,n){const r=e.Pa.shift(),i=Wl.from(r,t,n);await Km(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await va(e)}async function CT(e,t){t&&Gn(e).Z_&&await async function(r,i){if(function(o){return cE(o)&&o!==O.ABORTED}(i.code)){const s=r.Pa.shift();Gn(r).N_(),await Km(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await va(r)}}(e,t),Qm(e)&&Xm(e)}async function Lf(e,t){const n=Q(e);n.asyncQueue.verifyOperationInProgress(),j(gr,"RemoteStore received new credentials");const r=Ar(n);n.Ia.add(3),await ws(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await ya(n)}async function PT(e,t){const n=Q(e);t?(n.Ia.delete(2),await ya(n)):t||(n.Ia.add(2),await ws(n),n.Aa.set("Unknown"))}function ci(e){return e.Va||(e.Va=function(n,r,i){const s=Q(n);return s.ia(),new dT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:vT.bind(null,e),e_:wT.bind(null,e),n_:ET.bind(null,e),J_:TT.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),rc(e)?nc(e):e.Aa.set("Unknown")):(await e.Va.stop(),Wm(e))})),e.Va}function Gn(e){return e.ma||(e.ma=function(n,r,i){const s=Q(n);return s.ia(),new pT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:RT.bind(null,e),n_:CT.bind(null,e),ea:ST.bind(null,e),ta:bT.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await va(e)):(await e.ma.stop(),e.Pa.length>0&&(j(gr,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new pn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){const o=Date.now()+r,u=new ic(t,n,o,i,s);return u.start(r),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(O.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sc(e,t){if(yn("AsyncQueue",`${t}: ${e}`),ui(e))return new q(O.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{static emptySet(t){return new zr(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=Di(),this.sortedSet=new Et(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof zr)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new zr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(){this.fa=new Et(G.comparator)}track(t){const n=t.doc.key,r=this.fa.get(n);r?t.type!==0&&r.type===3?this.fa=this.fa.insert(n,t):t.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.fa=this.fa.remove(n):t.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):W(63341,{At:t,ga:r}):this.fa=this.fa.insert(n,t)}pa(){const t=[];return this.fa.inorderTraversal((n,r)=>{t.push(r)}),t}}class Yr{constructor(t,n,r,i,s,o,u,c,l){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new Yr(t,n,zr.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&fa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class VT{constructor(){this.queries=Uf(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=Q(n),s=i.queries;i.queries=Uf(),s.forEach((o,u)=>{for(const c of u.wa)c.onError(r)})})(this,new q(O.ABORTED,"Firestore shutting down"))}}function Uf(){return new Tr(e=>gm(e),fa)}async function Ym(e,t){const n=Q(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new xT,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=sc(o,`Initialization of query '${Lr(t.query)}' failed`);return void t.onError(u)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&oc(n)}async function Jm(e,t){const n=Q(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const o=s.wa.indexOf(t);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function NT(e,t){const n=Q(e);let r=!1;for(const i of t){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.wa)u.Ca(i)&&(r=!0);o.ya=i}}r&&oc(n)}function DT(e,t,n){const r=Q(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function oc(e){e.Da.forEach(t=>{t.next()})}var qu,Bf;(Bf=qu||(qu={})).Fa="default",Bf.Cache="cache";class Zm{constructor(t,n,r){this.query=t,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new Yr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),n=!0):this.Ba(t,this.onlineState)&&(this.La(t),n=!0),this.Oa=t,n}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),n=!0),n}Ba(t,n){if(!t.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(t){t=Yr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==qu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(t){this.key=t}}class eg{constructor(t){this.key=t}}class kT{constructor(t,n){this.query=t,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=tt(),this.mutatedKeys=tt(),this.Xa=_m(t),this.eu=new zr(this.Xa)}get tu(){return this.Ha}nu(t,n){const r=n?n.ru:new Ff,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const p=i.get(h),g=da(this.query,d)?d:null,_=!!p&&this.mutatedKeys.has(p.key),E=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;p&&g?p.data.isEqual(g.data)?_!==E&&(r.track({type:3,doc:g}),v=!0):this.iu(p,g)||(r.track({type:2,doc:g}),v=!0,(c&&this.Xa(g,c)>0||l&&this.Xa(g,l)<0)&&(u=!0)):!p&&g?(r.track({type:0,doc:g}),v=!0):p&&!g&&(r.track({type:1,doc:p}),v=!0,(c||l)&&(u=!0)),v&&(g?(o=o.add(g),s=E?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:u,mutatedKeys:s}}iu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const o=t.ru.pa();o.sort((h,d)=>function(g,_){const E=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W(20277,{At:v})}};return E(g)-E(_)}(h.type,d.type)||this.Xa(h.doc,d.doc)),this.su(r),i=i!=null&&i;const u=n&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,l=c!==this.Ya;return this.Ya=c,o.length!==0||l?{snapshot:new Yr(this.query,t.eu,s,o,t.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Ff,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=tt(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return t.forEach(r=>{this.Za.has(r)||n.push(new eg(r))}),this.Za.forEach(r=>{t.has(r)||n.push(new tg(r))}),n}uu(t){this.Ha=t.qs,this.Za=tt();const n=this.nu(t.documents);return this.applyChanges(n,!0)}cu(){return Yr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const ac="SyncEngine";class OT{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class MT{constructor(t){this.key=t,this.lu=!1}}class LT{constructor(t,n,r,i,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Tr(u=>gm(u),fa),this.Tu=new Map,this.Iu=new Set,this.du=new Et(G.comparator),this.Eu=new Map,this.Au=new Xl,this.Ru={},this.Vu=new Map,this.mu=Xr.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function FT(e,t,n=!0){const r=ag(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await ng(r,t,n,!0),i}async function UT(e,t){const n=ag(e);await ng(n,t,!0,!1)}async function ng(e,t,n,r){const i=await sT(e.localStore,Ke(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await BT(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&n&&Hm(e.remoteStore,i),u}async function BT(e,t,n,r,i){e.gu=(d,p,g)=>async function(E,v,P,b){let N=v.view.nu(P);N.Ds&&(N=await Nf(E.localStore,v.query,!1).then(({documents:I})=>v.view.nu(I,N)));const x=b&&b.targetChanges.get(v.targetId),M=b&&b.targetMismatches.get(v.targetId)!=null,U=v.view.applyChanges(N,E.isPrimaryClient,x,M);return qf(E,v.targetId,U._u),U.snapshot}(e,d,p,g);const s=await Nf(e.localStore,t,!0),o=new kT(t,s.qs),u=o.nu(s.documents),c=vs.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),l=o.applyChanges(u,e.isPrimaryClient,c);qf(e,n,l._u);const h=new OT(t,n,o);return e.Pu.set(t,h),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),l.snapshot}async function $T(e,t,n){const r=Q(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!fa(o,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Bu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&tc(r.remoteStore,i.targetId),ju(r,i.targetId)}).catch(ai)):(ju(r,i.targetId),await Bu(r.localStore,i.targetId,!0))}async function qT(e,t){const n=Q(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),tc(n.remoteStore,r.targetId))}async function jT(e,t,n){const r=XT(e);try{const i=await function(o,u){const c=Q(o),l=yt.now(),h=u.reduce((g,_)=>g.add(_.key),tt());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=wn(),E=tt();return c.Os.getEntries(g,h).next(v=>{_=v,_.forEach((P,b)=>{b.isValidDocument()||(E=E.add(P))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,_)).next(v=>{d=v;const P=[];for(const b of u){const N=sE(b,d.get(b.key).overlayedDocument);N!=null&&P.push(new Xn(b.key,N,um(N.value.mapValue),Qe.exists(!0)))}return c.mutationQueue.addMutationBatch(g,l,P,u)}).next(v=>{p=v;const P=v.applyToLocalDocumentSet(d,E);return c.documentOverlayCache.saveOverlays(g,v.batchId,P)})}).then(()=>({batchId:p.batchId,changes:vm(d)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let l=o.Ru[o.currentUser.toKey()];l||(l=new Et(Z)),l=l.insert(u,c),o.Ru[o.currentUser.toKey()]=l}(r,i.batchId,n),await Es(r,i.changes),await va(r.remoteStore)}catch(i){const s=sc(i,"Failed to persist write");n.reject(s)}}async function rg(e,t){const n=Q(e);try{const r=await nT(n.localStore,t);t.targetChanges.forEach((i,s)=>{const o=n.Eu.get(s);o&&(ut(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?ut(o.lu,14607):i.removedDocuments.size>0&&(ut(o.lu,42227),o.lu=!1))}),await Es(n,r,t)}catch(r){await ai(r)}}function $f(e,t,n){const r=Q(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,o)=>{const u=o.view.va(t);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=Q(o);c.onlineState=u;let l=!1;c.queries.forEach((h,d)=>{for(const p of d.wa)p.va(u)&&(l=!0)}),l&&oc(c)}(r.eventManager,t),i.length&&r.hu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function zT(e,t,n){const r=Q(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let o=new Et(G.comparator);o=o.insert(s,Xt.newNoDocument(s,K.min()));const u=tt().add(s),c=new ga(K.min(),new Map,new Et(Z),o,u);await rg(r,c),r.du=r.du.remove(s),r.Eu.delete(t),uc(r)}else await Bu(r.localStore,t,!1).then(()=>ju(r,t,n)).catch(ai)}async function HT(e,t){const n=Q(e),r=t.batch.batchId;try{const i=await eT(n.localStore,t);sg(n,r,null),ig(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Es(n,i)}catch(i){await ai(i)}}async function GT(e,t,n){const r=Q(e);try{const i=await function(o,u){const c=Q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,u).next(d=>(ut(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,t);sg(r,t,n),ig(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Es(r,i)}catch(i){await ai(i)}}function ig(e,t){(e.Vu.get(t)||[]).forEach(n=>{n.resolve()}),e.Vu.delete(t)}function sg(e,t,n){const r=Q(e);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function ju(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(r=>{e.Au.containsKey(r)||og(e,r)})}function og(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(tc(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),uc(e))}function qf(e,t,n){for(const r of n)r instanceof tg?(e.Au.addReference(r.key,t),WT(e,r)):r instanceof eg?(j(ac,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||og(e,r.key)):W(19791,{yu:r})}function WT(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(j(ac,"New document in limbo: "+n),e.Iu.add(r),uc(e))}function uc(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new G(pt.fromString(t)),r=e.mu.next();e.Eu.set(r,new MT(n)),e.du=e.du.insert(n,r),Hm(e.remoteStore,new kn(Ke(Hl(n.path)),r,"TargetPurposeLimboResolution",la.ue))}}async function Es(e,t,n){const r=Q(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,c)=>{o.push(r.gu(c,t,n).then(l=>{var h;if((l||n)&&r.isPrimaryClient){const d=l?!l.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);const d=Jl.Es(c.targetId,l);s.push(d)}}))}),await Promise.all(o),r.hu.J_(i),await async function(c,l){const h=Q(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>L.forEach(l,p=>L.forEach(p.Is,g=>h.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>L.forEach(p.ds,g=>h.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!ui(d))throw d;j(Zl,"Failed to update sequence numbers: "+d)}for(const d of l){const p=d.targetId;if(!d.fromCache){const g=h.Fs.get(p),_=g.snapshotVersion,E=g.withLastLimboFreeSnapshotVersion(_);h.Fs=h.Fs.insert(p,E)}}}(r.localStore,s))}async function KT(e,t){const n=Q(e);if(!n.currentUser.isEqual(t)){j(ac,"User change. New user:",t.toKey());const r=await $m(n.localStore,t);n.currentUser=t,function(s,o){s.Vu.forEach(u=>{u.forEach(c=>{c.reject(new q(O.CANCELLED,o))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await Es(n,r.Bs)}}function QT(e,t){const n=Q(e),r=n.Eu.get(t);if(r&&r.lu)return tt().add(r.key);{let i=tt();const s=n.Tu.get(t);if(!s)return i;for(const o of s){const u=n.Pu.get(o);i=i.unionWith(u.view.tu)}return i}}function ag(e){const t=Q(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=rg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=QT.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=zT.bind(null,t),t.hu.J_=NT.bind(null,t.eventManager),t.hu.pu=DT.bind(null,t.eventManager),t}function XT(e){const t=Q(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=HT.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=GT.bind(null,t),t}class Bo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=_a(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,n){return null}Fu(t,n){return null}vu(t){return tT(this.persistence,new YE,t.initialUser,this.serializer)}Du(t){return new Bm(Yl.Vi,this.serializer)}bu(t){return new aT}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bo.provider={build:()=>new Bo};class YT extends Bo{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,n){ut(this.persistence.referenceDelegate instanceof Fo,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ME(r,t.asyncQueue,n)}Du(t){const n=this.cacheSizeBytes!==void 0?ae.withCacheSize(this.cacheSizeBytes):ae.DEFAULT;return new Bm(r=>Fo.Vi(r,n),this.serializer)}}class zu{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>$f(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=KT.bind(null,this.syncEngine),await PT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new VT}()}createDatastore(t){const n=_a(t.databaseInfo.databaseId),r=function(s){return new fT(s)}(t.databaseInfo);return function(s,o,u,c){return new gT(s,o,u,c)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,o,u){return new yT(r,i,s,o,u)}(this.localStore,this.datastore,t.asyncQueue,n=>$f(this.syncEngine,n,0),function(){return Of.C()?new Of:new uT}())}createSyncEngine(t,n){return function(i,s,o,u,c,l,h){const d=new LT(i,s,o,u,c,l);return h&&(d.fu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const s=Q(i);j(gr,"RemoteStore shutting down."),s.Ia.add(5),await ws(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}zu.provider={build:()=>new zu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):yn("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="FirestoreClient";class JT{constructor(t,n,r,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Qt.UNAUTHENTICATED,this.clientId=Ul.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{j(Wn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(j(Wn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new pn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=sc(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function lu(e,t){e.asyncQueue.verifyOperationInProgress(),j(Wn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await $m(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>{$n("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{j("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{$n("Terminating Firestore due to IndexedDb database deletion failed",i)})}),e._offlineComponents=t}async function jf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ZT(e);j(Wn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>Lf(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>Lf(t.remoteStore,i)),e._onlineComponents=t}async function ZT(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){j(Wn,"Using user provided OfflineComponentProvider");try{await lu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===O.FAILED_PRECONDITION||i.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;$n("Error using user provided cache. Falling back to memory cache: "+n),await lu(e,new Bo)}}else j(Wn,"Using default OfflineComponentProvider"),await lu(e,new YT(void 0));return e._offlineComponents}async function lg(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(j(Wn,"Using user provided OnlineComponentProvider"),await jf(e,e._uninitializedComponentsProvider._online)):(j(Wn,"Using default OnlineComponentProvider"),await jf(e,new zu))),e._onlineComponents}function t1(e){return lg(e).then(t=>t.syncEngine)}async function cg(e){const t=await lg(e),n=t.eventManager;return n.onListen=FT.bind(null,t.syncEngine),n.onUnlisten=$T.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=UT.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=qT.bind(null,t.syncEngine),n}function e1(e,t,n={}){const r=new pn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new ug({next:p=>{h.Ou(),o.enqueueAndForget(()=>Jm(s,d));const g=p.docs.has(u);!g&&p.fromCache?l.reject(new q(O.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new Zm(Hl(u.path),h,{includeMetadataChanges:!0,ka:!0});return Ym(s,d)}(await cg(e),e.asyncQueue,t,n,r)),r.promise}function n1(e,t,n={}){const r=new pn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new ug({next:p=>{h.Ou(),o.enqueueAndForget(()=>Jm(s,d)),p.fromCache&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new Zm(u,h,{includeMetadataChanges:!0,ka:!0});return Ym(s,d)}(await cg(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg="firestore.googleapis.com",Hf=!0;class Gf{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new q(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fg,this.ssl=Hf}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Hf;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Um;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<kE)throw new q(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}yw("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hg((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class wa{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new q(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gf(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lw;switch(r.type){case"firstParty":return new dw(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=zf.get(n);r&&(j("ComponentProvider","Removing Datastore"),zf.delete(n),r.terminate())}(this),Promise.resolve()}}function r1(e,t,n,r={}){var i;e=vn(e,wa);const s=Ml(t),o=e._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),c=`${t}:${n}`;s&&(Mv(`https://${c}`),Bv("Firestore",!0)),o.host!==fg&&o.host!==c&&$n("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!bo(l,u)&&(e._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Qt.MOCK_USER;else{h=Lv(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new q(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Qt(p)}e._authCredentials=new cw(new Qp(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Yn(this.firestore,t,this._query)}}class Ct{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ct(this.firestore,t,this._key)}toJSON(){return{type:Ct._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(_s(n,Ct._jsonSchema))return new Ct(t,r||null,new G(pt.fromString(n.referencePath)))}}Ct._jsonSchemaVersion="firestore/documentReference/1.0",Ct._jsonSchema={type:Nt("string",Ct._jsonSchemaVersion),referencePath:Nt("string")};class Fn extends Yn{constructor(t,n,r){super(t,n,Hl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ct(this.firestore,null,new G(t))}withConverter(t){return new Fn(this.firestore,t,this._path)}}function dg(e,t,...n){if(e=gn(e),Yp("collection","path",t),e instanceof wa){const r=pt.fromString(t,...n);return sf(r),new Fn(e,null,r)}{if(!(e instanceof Ct||e instanceof Fn))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(pt.fromString(t,...n));return sf(r),new Fn(e.firestore,null,r)}}function i1(e,t,...n){if(e=gn(e),arguments.length===1&&(t=Ul.newId()),Yp("doc","path",t),e instanceof wa){const r=pt.fromString(t,...n);return rf(r),new Ct(e,null,new G(r))}{if(!(e instanceof Ct||e instanceof Fn))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(pt.fromString(t,...n));return rf(r),new Ct(e.firestore,e instanceof Fn?e.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf="AsyncQueue";class Kf{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new jm(this,"async_queue_retry"),this.oc=()=>{const r=uu();r&&j(Wf,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=t;const n=uu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const n=uu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new pn;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!ui(t))throw t;j(Wf,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const n=this._c.then(()=>(this.nc=!0,t().catch(r=>{throw this.tc=r,this.nc=!1,yn("INTERNAL UNHANDLED ERROR: ",Qf(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(t,n,r){this.ac(),this.sc.indexOf(t)>-1&&(n=0);const i=ic.createAndSchedule(this,t,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&W(47125,{hc:Qf(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const n of this.ec)if(n.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const n=this.ec.indexOf(t);this.ec.splice(n,1)}}function Qf(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class Ts extends wa{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new Kf,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Kf(t),this._firestoreClient=void 0,await t}}}function s1(e,t){const n=typeof e=="object"?e:X0(),r=typeof e=="string"?e:Vo,i=H0(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=kv("firestore");s&&r1(i,...s)}return i}function lc(e){if(e._terminated)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||o1(e),e._firestoreClient}function o1(e){var t,n,r;const i=e._freezeSettings(),s=function(u,c,l,h){return new xw(u,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,hg(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new JT(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ie(zt.fromBase64String(t))}catch(n){throw new q(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Ie(zt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Ie._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(_s(t,Ie._jsonSchema))return Ie.fromBase64String(t.bytes)}}Ie._jsonSchemaVersion="firestore/bytes/1.0",Ie._jsonSchema={type:Nt("string",Ie._jsonSchemaVersion),bytes:Nt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new q(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new q(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new q(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Z(this._lat,t._lat)||Z(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ye._jsonSchemaVersion}}static fromJSON(t){if(_s(t,Ye._jsonSchema))return new Ye(t.latitude,t.longitude)}}Ye._jsonSchemaVersion="firestore/geoPoint/1.0",Ye._jsonSchema={type:Nt("string",Ye._jsonSchemaVersion),latitude:Nt("number"),longitude:Nt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Je._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(_s(t,Je._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new Je(t.vectorValues);throw new q(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Je._jsonSchemaVersion="firestore/vectorValue/1.0",Je._jsonSchema={type:Nt("string",Je._jsonSchemaVersion),vectorValues:Nt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=/^__.*__$/;class u1{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Xn(t,this.data,this.fieldMask,n,this.fieldTransforms):new ys(t,this.data,n,this.fieldTransforms)}}class pg{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Xn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function mg(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W(40011,{Ec:e})}}class hc{constructor(t,n,r,i,s,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new hc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.fc(t),i}gc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return $o(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(mg(this.Ec)&&a1.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class l1{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||_a(t)}Dc(t,n,r,i=!1){return new hc({Ec:t,methodName:n,bc:r,path:jt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fc(e){const t=e._freezeSettings(),n=_a(e._databaseId);return new l1(e._databaseId,!!t.ignoreUndefinedProperties,n)}function c1(e,t,n,r,i,s={}){const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);dc("Data must be an object, but it was:",o,r);const u=gg(r,o);let c,l;if(s.merge)c=new ye(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=Hu(t,d,n);if(!o.contains(p))throw new q(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);yg(h,p)||h.push(p)}c=new ye(h),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new u1(new ue(u),c,l)}class Ta extends cc{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Ta}}function h1(e,t,n,r){const i=e.Dc(1,t,n);dc("Data must be an object, but it was:",i,r);const s=[],o=ue.empty();Qn(r,(c,l)=>{const h=pc(t,c,n);l=gn(l);const d=i.gc(h);if(l instanceof Ta)s.push(h);else{const p=As(l,d);p!=null&&(s.push(h),o.set(h,p))}});const u=new ye(s);return new pg(o,u,i.fieldTransforms)}function f1(e,t,n,r,i,s){const o=e.Dc(1,t,n),u=[Hu(t,r,n)],c=[i];if(s.length%2!=0)throw new q(O.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)u.push(Hu(t,s[p])),c.push(s[p+1]);const l=[],h=ue.empty();for(let p=u.length-1;p>=0;--p)if(!yg(l,u[p])){const g=u[p];let _=c[p];_=gn(_);const E=o.gc(g);if(_ instanceof Ta)l.push(g);else{const v=As(_,E);v!=null&&(l.push(g),h.set(g,v))}}const d=new ye(l);return new pg(h,d,o.fieldTransforms)}function d1(e,t,n,r=!1){return As(n,e.Dc(r?4:3,t))}function As(e,t){if(_g(e=gn(e)))return dc("Unsupported field value:",t,e),gg(e,t);if(e instanceof cc)return function(r,i){if(!mg(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=As(u,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=gn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Zw(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=yt.fromDate(r);return{timestampValue:Lo(i.serializer,s)}}if(r instanceof yt){const s=new yt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Lo(i.serializer,s)}}if(r instanceof Ye)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ie)return{bytesValue:Nm(i.serializer,r._byteString)};if(r instanceof Ct){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ql(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Je)return function(o,u){return{mapValue:{fields:{[om]:{stringValue:am},[No]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw u.wc("VectorValues must only contain numeric values.");return Gl(u.serializer,l)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${ua(r)}`)}(e,t)}function gg(e,t){const n={};return tm(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Qn(e,(r,i)=>{const s=As(i,t.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function _g(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof yt||e instanceof Ye||e instanceof Ie||e instanceof Ct||e instanceof cc||e instanceof Je)}function dc(e,t,n){if(!_g(n)||!Jp(n)){const r=ua(n);throw r==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function Hu(e,t,n){if((t=gn(t))instanceof Ea)return t._internalPath;if(typeof t=="string")return pc(e,t);throw $o("Field path arguments must be of type string or ",e,!1,void 0,n)}const p1=new RegExp("[~\\*/\\[\\]]");function pc(e,t,n){if(t.search(p1)>=0)throw $o(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ea(...t.split("."))._internalPath}catch{throw $o(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function $o(e,t,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${t}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new q(O.INVALID_ARGUMENT,u+e+c)}function yg(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new m1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(mc("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class m1 extends vg{data(){return super.data()}}function mc(e,t){return typeof t=="string"?pc(e,t):t instanceof Ea?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g1(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new q(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gc{}class _c extends gc{}function _1(e,t,...n){let r=[];t instanceof gc&&r.push(t),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof vc).length,u=s.filter(c=>c instanceof yc).length;if(o>1||o>0&&u>0)throw new q(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class yc extends _c{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new yc(t,n,r)}_apply(t){const n=this._parse(t);return wg(t._query,n),new Yn(t.firestore,t.converter,Ou(t._query,n))}_parse(t){const n=fc(t.firestore);return function(s,o,u,c,l,h,d){let p;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Yf(d,h);const _=[];for(const E of d)_.push(Xf(c,s,E));p={arrayValue:{values:_}}}else p=Xf(c,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Yf(d,h),p=d1(u,o,d,h==="in"||h==="not-in");return Vt.create(l,h,p)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class vc extends gc{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new vc(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Oe.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)wg(o,c),o=Ou(o,c)}(t._query,n),new Yn(t.firestore,t.converter,Ou(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class wc extends _c{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new wc(t,n)}_apply(t){const n=function(i,s,o){if(i.startAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new is(s,o)}(t._query,this._field,this._direction);return new Yn(t.firestore,t.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new li(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function y1(e,t="asc"){const n=t,r=mc("orderBy",e);return wc._create(r,n)}class Ec extends _c{constructor(t,n,r){super(),this.type=t,this._limit=n,this._limitType=r}static _create(t,n,r){return new Ec(t,n,r)}_apply(t){return new Yn(t.firestore,t.converter,ko(t._query,this._limit,this._limitType))}}function v1(e){return vw("limit",e),Ec._create("limit",e,"F")}function Xf(e,t,n){if(typeof(n=gn(n))=="string"){if(n==="")throw new q(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mm(t)&&n.indexOf("/")!==-1)throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(pt.fromString(n));if(!G.isDocumentKey(r))throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return df(e,new G(r))}if(n instanceof Ct)return df(e,n._key);throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ua(n)}.`)}function Yf(e,t){if(!Array.isArray(e)||e.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function wg(e,t){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class w1{convertValue(t,n="none"){switch(Hn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Rt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(zn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw W(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Qn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(t){var n,r,i;const s=(i=(r=(n=t.fields)===null||n===void 0?void 0:n[No].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Rt(o.doubleValue));return new Je(s)}convertGeoPoint(t){return new Ye(Rt(t.latitude),Rt(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=ha(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(es(t));default:return null}}convertTimestamp(t){const n=jn(t);return new yt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=pt.fromString(t);ut(Fm(r),9688,{name:t});const i=new ns(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||yn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class Oi{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class hr extends vg{constructor(t,n,r,i,s,o){super(t,n,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new lo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(mc("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=hr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}hr._jsonSchemaVersion="firestore/documentSnapshot/1.0",hr._jsonSchema={type:Nt("string",hr._jsonSchemaVersion),bundleSource:Nt("string","DocumentSnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class lo extends hr{data(t={}){return super.data(t)}}class Hr{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Oi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new lo(this._firestore,this._userDataWriter,r.key,r,new Oi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new lo(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Oi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new lo(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Oi(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return u.type!==0&&(l=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),h=o.indexOf(u.doc.key)),{type:T1(u.type),doc:c,oldIndex:l,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Hr._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Ul.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function T1(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(e){e=vn(e,Ct);const t=vn(e.firestore,Ts);return e1(lc(t),e._key).then(n=>S1(t,e,n))}Hr._jsonSchemaVersion="firestore/querySnapshot/1.0",Hr._jsonSchema={type:Nt("string",Hr._jsonSchemaVersion),bundleSource:Nt("string","QuerySnapshot"),bundleName:Nt("string"),bundle:Nt("string")};class Eg extends w1{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ie(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Ct(this.firestore,null,n)}}function Tg(e){e=vn(e,Yn);const t=vn(e.firestore,Ts),n=lc(t),r=new Eg(t);return g1(e._query),n1(n,e._query).then(i=>new Hr(t,r,e,i))}function I1(e,t,n){e=vn(e,Ct);const r=vn(e.firestore,Ts),i=E1(e.converter,t);return Ag(r,[c1(fc(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,Qe.none())])}function R1(e,t,n,...r){e=vn(e,Ct);const i=vn(e.firestore,Ts),s=fc(i);let o;return o=typeof(t=gn(t))=="string"||t instanceof Ea?f1(s,"updateDoc",e._key,t,n,r):h1(s,"updateDoc",e._key,t),Ag(i,[o.toMutation(e._key,Qe.exists(!0))])}function Ag(e,t){return function(r,i){const s=new pn;return r.asyncQueue.enqueueAndForget(async()=>jT(await t1(r),i,s)),s.promise}(lc(e),t)}function S1(e,t,n){const r=n.docs.get(t._key),i=new Eg(e);return new hr(e,i,t._key,r,new Oi(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){oi=i})(Q0),Po(new Ji("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new Ts(new hw(r.getProvider("auth-internal")),new pw(o,r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new q(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ns(l.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),jr(Jh,Zh,t),jr(Jh,Zh,"esm2017")})();const b1={apiKey:"AIzaSyAZsdXZU6WbM33SaKP5PoYm7G0V2ABYUSU",authDomain:"great-wave-everywhere.firebaseapp.com",projectId:"great-wave-everywhere",storageBucket:"great-wave-everywhere.firebasestorage.app",messagingSenderId:"636756607685",appId:"1:636756607685:web:2199075bc12821f89466ac",measurementId:"G-XRVYGKFWJ8"},C1=Up(b1),Tc=s1(C1);async function P1(e){const t=i1(Tc,"words",e.toLowerCase()),n=await A1(t);n.exists()?await R1(t,{count:n.data().count+1}):await I1(t,{count:1})}async function Ig(){return(await Tg(dg(Tc,"words"))).docs.map(t=>({id:t.id,count:t.data().count}))}async function Rg(e=5){const t=_1(dg(Tc,"words"),y1("count","desc"),v1(e));return(await Tg(t)).docs.map(r=>({id:r.id,count:r.data().count}))}function Sg(e,t){return function(){return e.apply(t,arguments)}}const{toString:x1}=Object.prototype,{getPrototypeOf:Ac}=Object,{iterator:Aa,toStringTag:bg}=Symbol,Ia=(e=>t=>{const n=x1.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Le=e=>(e=e.toLowerCase(),t=>Ia(t)===e),Ra=e=>t=>typeof t===e,{isArray:hi}=Array,as=Ra("undefined");function V1(e){return e!==null&&!as(e)&&e.constructor!==null&&!as(e.constructor)&&he(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Cg=Le("ArrayBuffer");function N1(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Cg(e.buffer),t}const D1=Ra("string"),he=Ra("function"),Pg=Ra("number"),Sa=e=>e!==null&&typeof e=="object",k1=e=>e===!0||e===!1,co=e=>{if(Ia(e)!=="object")return!1;const t=Ac(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(bg in e)&&!(Aa in e)},O1=Le("Date"),M1=Le("File"),L1=Le("Blob"),F1=Le("FileList"),U1=e=>Sa(e)&&he(e.pipe),B1=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||he(e.append)&&((t=Ia(e))==="formdata"||t==="object"&&he(e.toString)&&e.toString()==="[object FormData]"))},$1=Le("URLSearchParams"),[q1,j1,z1,H1]=["ReadableStream","Request","Response","Headers"].map(Le),G1=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Is(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),hi(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],t.call(null,e[u],u,e)}}function xg(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const ur=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Vg=e=>!as(e)&&e!==ur;function Gu(){const{caseless:e}=Vg(this)&&this||{},t={},n=(r,i)=>{const s=e&&xg(t,i)||i;co(t[s])&&co(r)?t[s]=Gu(t[s],r):co(r)?t[s]=Gu({},r):hi(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Is(arguments[r],n);return t}const W1=(e,t,n,{allOwnKeys:r}={})=>(Is(t,(i,s)=>{n&&he(i)?e[s]=Sg(i,n):e[s]=i},{allOwnKeys:r}),e),K1=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Q1=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},X1=(e,t,n,r)=>{let i,s,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&Ac(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Y1=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},J1=e=>{if(!e)return null;if(hi(e))return e;let t=e.length;if(!Pg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Z1=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ac(Uint8Array)),tA=(e,t)=>{const r=(e&&e[Aa]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},eA=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},nA=Le("HTMLFormElement"),rA=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Jf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),iA=Le("RegExp"),Ng=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Is(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},sA=e=>{Ng(e,(t,n)=>{if(he(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(he(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},oA=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return hi(e)?r(e):r(String(e).split(t)),n},aA=()=>{},uA=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function lA(e){return!!(e&&he(e.append)&&e[bg]==="FormData"&&e[Aa])}const cA=e=>{const t=new Array(10),n=(r,i)=>{if(Sa(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=hi(r)?[]:{};return Is(r,(o,u)=>{const c=n(o,i+1);!as(c)&&(s[u]=c)}),t[i]=void 0,s}}return r};return n(e,0)},hA=Le("AsyncFunction"),fA=e=>e&&(Sa(e)||he(e))&&he(e.then)&&he(e.catch),Dg=((e,t)=>e?setImmediate:t?((n,r)=>(ur.addEventListener("message",({source:i,data:s})=>{i===ur&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),ur.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",he(ur.postMessage)),dA=typeof queueMicrotask<"u"?queueMicrotask.bind(ur):typeof process<"u"&&process.nextTick||Dg,pA=e=>e!=null&&he(e[Aa]),D={isArray:hi,isArrayBuffer:Cg,isBuffer:V1,isFormData:B1,isArrayBufferView:N1,isString:D1,isNumber:Pg,isBoolean:k1,isObject:Sa,isPlainObject:co,isReadableStream:q1,isRequest:j1,isResponse:z1,isHeaders:H1,isUndefined:as,isDate:O1,isFile:M1,isBlob:L1,isRegExp:iA,isFunction:he,isStream:U1,isURLSearchParams:$1,isTypedArray:Z1,isFileList:F1,forEach:Is,merge:Gu,extend:W1,trim:G1,stripBOM:K1,inherits:Q1,toFlatObject:X1,kindOf:Ia,kindOfTest:Le,endsWith:Y1,toArray:J1,forEachEntry:tA,matchAll:eA,isHTMLForm:nA,hasOwnProperty:Jf,hasOwnProp:Jf,reduceDescriptors:Ng,freezeMethods:sA,toObjectSet:oA,toCamelCase:rA,noop:aA,toFiniteNumber:uA,findKey:xg,global:ur,isContextDefined:Vg,isSpecCompliantForm:lA,toJSONObject:cA,isAsyncFn:hA,isThenable:fA,setImmediate:Dg,asap:dA,isIterable:pA};function J(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}D.inherits(J,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const kg=J.prototype,Og={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Og[e]={value:e}});Object.defineProperties(J,Og);Object.defineProperty(kg,"isAxiosError",{value:!0});J.from=(e,t,n,r,i,s)=>{const o=Object.create(kg);return D.toFlatObject(e,o,function(c){return c!==Error.prototype},u=>u!=="isAxiosError"),J.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const mA=null;function Wu(e){return D.isPlainObject(e)||D.isArray(e)}function Mg(e){return D.endsWith(e,"[]")?e.slice(0,-2):e}function Zf(e,t,n){return e?e.concat(t).map(function(i,s){return i=Mg(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function gA(e){return D.isArray(e)&&!e.some(Wu)}const _A=D.toFlatObject(D,{},null,function(t){return/^is[A-Z]/.test(t)});function ba(e,t,n){if(!D.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=D.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,v){return!D.isUndefined(v[E])});const r=n.metaTokens,i=n.visitor||h,s=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(i))throw new TypeError("visitor must be a function");function l(_){if(_===null)return"";if(D.isDate(_))return _.toISOString();if(D.isBoolean(_))return _.toString();if(!c&&D.isBlob(_))throw new J("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(_)||D.isTypedArray(_)?c&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,E,v){let P=_;if(_&&!v&&typeof _=="object"){if(D.endsWith(E,"{}"))E=r?E:E.slice(0,-2),_=JSON.stringify(_);else if(D.isArray(_)&&gA(_)||(D.isFileList(_)||D.endsWith(E,"[]"))&&(P=D.toArray(_)))return E=Mg(E),P.forEach(function(N,x){!(D.isUndefined(N)||N===null)&&t.append(o===!0?Zf([E],x,s):o===null?E:E+"[]",l(N))}),!1}return Wu(_)?!0:(t.append(Zf(v,E,s),l(_)),!1)}const d=[],p=Object.assign(_A,{defaultVisitor:h,convertValue:l,isVisitable:Wu});function g(_,E){if(!D.isUndefined(_)){if(d.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));d.push(_),D.forEach(_,function(P,b){(!(D.isUndefined(P)||P===null)&&i.call(t,P,D.isString(b)?b.trim():b,E,p))===!0&&g(P,E?E.concat(b):[b])}),d.pop()}}if(!D.isObject(e))throw new TypeError("data must be an object");return g(e),t}function td(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Ic(e,t){this._pairs=[],e&&ba(e,this,t)}const Lg=Ic.prototype;Lg.append=function(t,n){this._pairs.push([t,n])};Lg.toString=function(t){const n=t?function(r){return t.call(this,r,td)}:td;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function yA(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Fg(e,t,n){if(!t)return e;const r=n&&n.encode||yA;D.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=D.isURLSearchParams(t)?t.toString():new Ic(t,n).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class ed{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){D.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Ug={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vA=typeof URLSearchParams<"u"?URLSearchParams:Ic,wA=typeof FormData<"u"?FormData:null,EA=typeof Blob<"u"?Blob:null,TA={isBrowser:!0,classes:{URLSearchParams:vA,FormData:wA,Blob:EA},protocols:["http","https","file","blob","url","data"]},Rc=typeof window<"u"&&typeof document<"u",Ku=typeof navigator=="object"&&navigator||void 0,AA=Rc&&(!Ku||["ReactNative","NativeScript","NS"].indexOf(Ku.product)<0),IA=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",RA=Rc&&window.location.href||"http://localhost",SA=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rc,hasStandardBrowserEnv:AA,hasStandardBrowserWebWorkerEnv:IA,navigator:Ku,origin:RA},Symbol.toStringTag,{value:"Module"})),Yt={...SA,...TA};function bA(e,t){return ba(e,new Yt.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Yt.isNode&&D.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function CA(e){return D.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function PA(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function Bg(e){function t(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),c=s>=n.length;return o=!o&&D.isArray(i)?i.length:o,c?(D.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!D.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],s)&&D.isArray(i[o])&&(i[o]=PA(i[o])),!u)}if(D.isFormData(e)&&D.isFunction(e.entries)){const n={};return D.forEachEntry(e,(r,i)=>{t(CA(r),i,n,0)}),n}return null}function xA(e,t,n){if(D.isString(e))try{return(t||JSON.parse)(e),D.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Rs={transitional:Ug,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=D.isObject(t);if(s&&D.isHTMLForm(t)&&(t=new FormData(t)),D.isFormData(t))return i?JSON.stringify(Bg(t)):t;if(D.isArrayBuffer(t)||D.isBuffer(t)||D.isStream(t)||D.isFile(t)||D.isBlob(t)||D.isReadableStream(t))return t;if(D.isArrayBufferView(t))return t.buffer;if(D.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return bA(t,this.formSerializer).toString();if((u=D.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return ba(u?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),xA(t)):t}],transformResponse:[function(t){const n=this.transitional||Rs.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(D.isResponse(t)||D.isReadableStream(t))return t;if(t&&D.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?J.from(u,J.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Yt.classes.FormData,Blob:Yt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],e=>{Rs.headers[e]={}});const VA=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NA=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&VA[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},nd=Symbol("internals");function xi(e){return e&&String(e).trim().toLowerCase()}function ho(e){return e===!1||e==null?e:D.isArray(e)?e.map(ho):String(e)}function DA(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const kA=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function cu(e,t,n,r,i){if(D.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!D.isString(t)){if(D.isString(r))return t.indexOf(r)!==-1;if(D.isRegExp(r))return r.test(t)}}function OA(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function MA(e,t){const n=D.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,o){return this[r].call(this,t,i,s,o)},configurable:!0})})}let fe=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,c,l){const h=xi(c);if(!h)throw new Error("header name must be a non-empty string");const d=D.findKey(i,h);(!d||i[d]===void 0||l===!0||l===void 0&&i[d]!==!1)&&(i[d||c]=ho(u))}const o=(u,c)=>D.forEach(u,(l,h)=>s(l,h,c));if(D.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(D.isString(t)&&(t=t.trim())&&!kA(t))o(NA(t),n);else if(D.isObject(t)&&D.isIterable(t)){let u={},c,l;for(const h of t){if(!D.isArray(h))throw TypeError("Object iterator must return a key-value pair");u[l=h[0]]=(c=u[l])?D.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(u,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=xi(t),t){const r=D.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return DA(i);if(D.isFunction(n))return n.call(this,i,r);if(D.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=xi(t),t){const r=D.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||cu(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(o){if(o=xi(o),o){const u=D.findKey(r,o);u&&(!n||cu(r,r[u],u,n))&&(delete r[u],i=!0)}}return D.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||cu(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return D.forEach(this,(i,s)=>{const o=D.findKey(r,s);if(o){n[o]=ho(i),delete n[s];return}const u=t?OA(s):String(s).trim();u!==s&&delete n[s],n[u]=ho(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return D.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&D.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[nd]=this[nd]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=xi(o);r[u]||(MA(i,o),r[u]=!0)}return D.isArray(t)?t.forEach(s):s(t),this}};fe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(fe.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});D.freezeMethods(fe);function hu(e,t){const n=this||Rs,r=t||n,i=fe.from(r.headers);let s=r.data;return D.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function $g(e){return!!(e&&e.__CANCEL__)}function fi(e,t,n){J.call(this,e??"canceled",J.ERR_CANCELED,t,n),this.name="CanceledError"}D.inherits(fi,J,{__CANCEL__:!0});function qg(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new J("Request failed with status code "+n.status,[J.ERR_BAD_REQUEST,J.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function LA(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function FA(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),h=r[s];o||(o=l),n[i]=c,r[i]=l;let d=s,p=0;for(;d!==i;)p+=n[d++],d=d%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),l-o<t)return;const g=h&&l-h;return g?Math.round(p*1e3/g):void 0}}function UA(e,t){let n=0,r=1e3/t,i,s;const o=(l,h=Date.now())=>{n=h,i=null,s&&(clearTimeout(s),s=null),e.apply(null,l)};return[(...l)=>{const h=Date.now(),d=h-n;d>=r?o(l,h):(i=l,s||(s=setTimeout(()=>{s=null,o(i)},r-d)))},()=>i&&o(i)]}const qo=(e,t,n=3)=>{let r=0;const i=FA(50,250);return UA(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,c=o-r,l=i(c),h=o<=u;r=o;const d={loaded:o,total:u,progress:u?o/u:void 0,bytes:c,rate:l||void 0,estimated:l&&u&&h?(u-o)/l:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(d)},n)},rd=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},id=e=>(...t)=>D.asap(()=>e(...t)),BA=Yt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Yt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Yt.origin),Yt.navigator&&/(msie|trident)/i.test(Yt.navigator.userAgent)):()=>!0,$A=Yt.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];D.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),D.isString(r)&&o.push("path="+r),D.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function qA(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function jA(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function jg(e,t,n){let r=!qA(t);return e&&(r||n==!1)?jA(e,t):t}const sd=e=>e instanceof fe?{...e}:e;function _r(e,t){t=t||{};const n={};function r(l,h,d,p){return D.isPlainObject(l)&&D.isPlainObject(h)?D.merge.call({caseless:p},l,h):D.isPlainObject(h)?D.merge({},h):D.isArray(h)?h.slice():h}function i(l,h,d,p){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l,d,p)}else return r(l,h,d,p)}function s(l,h){if(!D.isUndefined(h))return r(void 0,h)}function o(l,h){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l)}else return r(void 0,h)}function u(l,h,d){if(d in t)return r(l,h);if(d in e)return r(void 0,l)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(l,h,d)=>i(sd(l),sd(h),d,!0)};return D.forEach(Object.keys(Object.assign({},e,t)),function(h){const d=c[h]||i,p=d(e[h],t[h],h);D.isUndefined(p)&&d!==u||(n[h]=p)}),n}const zg=e=>{const t=_r({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=t;t.headers=o=fe.from(o),t.url=Fg(jg(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let c;if(D.isFormData(n)){if(Yt.hasStandardBrowserEnv||Yt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[l,...h]=c?c.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([l||"multipart/form-data",...h].join("; "))}}if(Yt.hasStandardBrowserEnv&&(r&&D.isFunction(r)&&(r=r(t)),r||r!==!1&&BA(t.url))){const l=i&&s&&$A.read(s);l&&o.set(i,l)}return t},zA=typeof XMLHttpRequest<"u",HA=zA&&function(e){return new Promise(function(n,r){const i=zg(e);let s=i.data;const o=fe.from(i.headers).normalize();let{responseType:u,onUploadProgress:c,onDownloadProgress:l}=i,h,d,p,g,_;function E(){g&&g(),_&&_(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(i.method.toUpperCase(),i.url,!0),v.timeout=i.timeout;function P(){if(!v)return;const N=fe.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),M={data:!u||u==="text"||u==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:N,config:e,request:v};qg(function(I){n(I),E()},function(I){r(I),E()},M),v=null}"onloadend"in v?v.onloadend=P:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(P)},v.onabort=function(){v&&(r(new J("Request aborted",J.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new J("Network Error",J.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let x=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const M=i.transitional||Ug;i.timeoutErrorMessage&&(x=i.timeoutErrorMessage),r(new J(x,M.clarifyTimeoutError?J.ETIMEDOUT:J.ECONNABORTED,e,v)),v=null},s===void 0&&o.setContentType(null),"setRequestHeader"in v&&D.forEach(o.toJSON(),function(x,M){v.setRequestHeader(M,x)}),D.isUndefined(i.withCredentials)||(v.withCredentials=!!i.withCredentials),u&&u!=="json"&&(v.responseType=i.responseType),l&&([p,_]=qo(l,!0),v.addEventListener("progress",p)),c&&v.upload&&([d,g]=qo(c),v.upload.addEventListener("progress",d),v.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(h=N=>{v&&(r(!N||N.type?new fi(null,e,v):N),v.abort(),v=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const b=LA(i.url);if(b&&Yt.protocols.indexOf(b)===-1){r(new J("Unsupported protocol "+b+":",J.ERR_BAD_REQUEST,e));return}v.send(s||null)})},GA=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(l){if(!i){i=!0,u();const h=l instanceof Error?l:this.reason;r.abort(h instanceof J?h:new fi(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new J(`timeout ${t} of ms exceeded`,J.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(s):l.removeEventListener("abort",s)}),e=null)};e.forEach(l=>l.addEventListener("abort",s));const{signal:c}=r;return c.unsubscribe=()=>D.asap(u),c}},WA=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},KA=async function*(e,t){for await(const n of QA(e))yield*WA(n,t)},QA=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},od=(e,t,n,r)=>{const i=KA(e,t);let s=0,o,u=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:l,value:h}=await i.next();if(l){u(),c.close();return}let d=h.byteLength;if(n){let p=s+=d;n(p)}c.enqueue(new Uint8Array(h))}catch(l){throw u(l),l}},cancel(c){return u(c),i.return()}},{highWaterMark:2})},Ca=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Hg=Ca&&typeof ReadableStream=="function",XA=Ca&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Gg=(e,...t)=>{try{return!!e(...t)}catch{return!1}},YA=Hg&&Gg(()=>{let e=!1;const t=new Request(Yt.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),ad=64*1024,Qu=Hg&&Gg(()=>D.isReadableStream(new Response("").body)),jo={stream:Qu&&(e=>e.body)};Ca&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!jo[t]&&(jo[t]=D.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new J(`Response type '${t}' is not supported`,J.ERR_NOT_SUPPORT,r)})})})(new Response);const JA=async e=>{if(e==null)return 0;if(D.isBlob(e))return e.size;if(D.isSpecCompliantForm(e))return(await new Request(Yt.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(D.isArrayBufferView(e)||D.isArrayBuffer(e))return e.byteLength;if(D.isURLSearchParams(e)&&(e=e+""),D.isString(e))return(await XA(e)).byteLength},ZA=async(e,t)=>{const n=D.toFiniteNumber(e.getContentLength());return n??JA(t)},tI=Ca&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:c,responseType:l,headers:h,withCredentials:d="same-origin",fetchOptions:p}=zg(e);l=l?(l+"").toLowerCase():"text";let g=GA([i,s&&s.toAbortSignal()],o),_;const E=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&YA&&n!=="get"&&n!=="head"&&(v=await ZA(h,r))!==0){let M=new Request(t,{method:"POST",body:r,duplex:"half"}),U;if(D.isFormData(r)&&(U=M.headers.get("content-type"))&&h.setContentType(U),M.body){const[I,w]=rd(v,qo(id(c)));r=od(M.body,ad,I,w)}}D.isString(d)||(d=d?"include":"omit");const P="credentials"in Request.prototype;_=new Request(t,{...p,signal:g,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:P?d:void 0});let b=await fetch(_,p);const N=Qu&&(l==="stream"||l==="response");if(Qu&&(u||N&&E)){const M={};["status","statusText","headers"].forEach(T=>{M[T]=b[T]});const U=D.toFiniteNumber(b.headers.get("content-length")),[I,w]=u&&rd(U,qo(id(u),!0))||[];b=new Response(od(b.body,ad,I,()=>{w&&w(),E&&E()}),M)}l=l||"text";let x=await jo[D.findKey(jo,l)||"text"](b,e);return!N&&E&&E(),await new Promise((M,U)=>{qg(M,U,{data:x,headers:fe.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:_})})}catch(P){throw E&&E(),P&&P.name==="TypeError"&&/Load failed|fetch/i.test(P.message)?Object.assign(new J("Network Error",J.ERR_NETWORK,e,_),{cause:P.cause||P}):J.from(P,P&&P.code,e,_)}}),Xu={http:mA,xhr:HA,fetch:tI};D.forEach(Xu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ud=e=>`- ${e}`,eI=e=>D.isFunction(e)||e===null||e===!1,Wg={getAdapter:e=>{e=D.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let o;if(r=n,!eI(n)&&(r=Xu[(o=String(n)).toLowerCase()],r===void 0))throw new J(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,c])=>`adapter ${u} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(ud).join(`
`):" "+ud(s[0]):"as no adapter specified";throw new J("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Xu};function fu(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new fi(null,e)}function ld(e){return fu(e),e.headers=fe.from(e.headers),e.data=hu.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Wg.getAdapter(e.adapter||Rs.adapter)(e).then(function(r){return fu(e),r.data=hu.call(e,e.transformResponse,r),r.headers=fe.from(r.headers),r},function(r){return $g(r)||(fu(e),r&&r.response&&(r.response.data=hu.call(e,e.transformResponse,r.response),r.response.headers=fe.from(r.response.headers))),Promise.reject(r)})}const Kg="1.10.0",Pa={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Pa[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const cd={};Pa.transitional=function(t,n,r){function i(s,o){return"[Axios v"+Kg+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(t===!1)throw new J(i(o," has been removed"+(n?" in "+n:"")),J.ERR_DEPRECATED);return n&&!cd[o]&&(cd[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,u):!0}};Pa.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function nI(e,t,n){if(typeof e!="object")throw new J("options must be an object",J.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const u=e[s],c=u===void 0||o(u,s,e);if(c!==!0)throw new J("option "+s+" must be "+c,J.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new J("Unknown option "+s,J.ERR_BAD_OPTION)}}const fo={assertOptions:nI,validators:Pa},$e=fo.validators;let fr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ed,response:new ed}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=_r(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&fo.assertOptions(r,{silentJSONParsing:$e.transitional($e.boolean),forcedJSONParsing:$e.transitional($e.boolean),clarifyTimeoutError:$e.transitional($e.boolean)},!1),i!=null&&(D.isFunction(i)?n.paramsSerializer={serialize:i}:fo.assertOptions(i,{encode:$e.function,serialize:$e.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),fo.assertOptions(n,{baseUrl:$e.spelling("baseURL"),withXsrfToken:$e.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&D.merge(s.common,s[n.method]);s&&D.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),n.headers=fe.concat(o,s);const u=[];let c=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(n)===!1||(c=c&&E.synchronous,u.unshift(E.fulfilled,E.rejected))});const l=[];this.interceptors.response.forEach(function(E){l.push(E.fulfilled,E.rejected)});let h,d=0,p;if(!c){const _=[ld.bind(this),void 0];for(_.unshift.apply(_,u),_.push.apply(_,l),p=_.length,h=Promise.resolve(n);d<p;)h=h.then(_[d++],_[d++]);return h}p=u.length;let g=n;for(d=0;d<p;){const _=u[d++],E=u[d++];try{g=_(g)}catch(v){E.call(this,v);break}}try{h=ld.call(this,g)}catch(_){return Promise.reject(_)}for(d=0,p=l.length;d<p;)h=h.then(l[d++],l[d++]);return h}getUri(t){t=_r(this.defaults,t);const n=jg(t.baseURL,t.url,t.allowAbsoluteUrls);return Fg(n,t.params,t.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(t){fr.prototype[t]=function(n,r){return this.request(_r(r||{},{method:t,url:n,data:(r||{}).data}))}});D.forEach(["post","put","patch"],function(t){function n(r){return function(s,o,u){return this.request(_r(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}fr.prototype[t]=n(),fr.prototype[t+"Form"]=n(!0)});let rI=class Qg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},t(function(s,o,u){r.reason||(r.reason=new fi(s,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Qg(function(i){t=i}),cancel:t}}};function iI(e){return function(n){return e.apply(null,n)}}function sI(e){return D.isObject(e)&&e.isAxiosError===!0}const Yu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Yu).forEach(([e,t])=>{Yu[t]=e});function Xg(e){const t=new fr(e),n=Sg(fr.prototype.request,t);return D.extend(n,fr.prototype,t,{allOwnKeys:!0}),D.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return Xg(_r(e,i))},n}const It=Xg(Rs);It.Axios=fr;It.CanceledError=fi;It.CancelToken=rI;It.isCancel=$g;It.VERSION=Kg;It.toFormData=ba;It.AxiosError=J;It.Cancel=It.CanceledError;It.all=function(t){return Promise.all(t)};It.spread=iI;It.isAxiosError=sI;It.mergeConfig=_r;It.AxiosHeaders=fe;It.formToJSON=e=>Bg(D.isHTMLForm(e)?new FormData(e):e);It.getAdapter=Wg.getAdapter;It.HttpStatusCode=Yu;It.default=It;const{Axios:hP,AxiosError:fP,CanceledError:dP,isCancel:pP,CancelToken:mP,VERSION:gP,all:_P,Cancel:yP,isAxiosError:vP,spread:wP,toFormData:EP,AxiosHeaders:TP,HttpStatusCode:AP,formToJSON:IP,getAdapter:RP,mergeConfig:SP}=It;class yr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,u=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);u&&(n[r++]=u),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function*oI(e){for(const t of e)yield*t}function Yg(e){return Array.from(oI(e))}var aI={value:()=>{}};function Sc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new po(n)}function po(e){this._=e}function uI(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}po.prototype=Sc.prototype={constructor:po,on:function(e,t){var n=this._,r=uI(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=lI(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=hd(n[i],e.name,t);else if(t==null)for(i in n)n[i]=hd(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new po(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function lI(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function hd(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=aI,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ju="http://www.w3.org/1999/xhtml";const fd={svg:"http://www.w3.org/2000/svg",xhtml:Ju,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function xa(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),fd.hasOwnProperty(t)?{space:fd[t],local:e}:e}function cI(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ju&&t.documentElement.namespaceURI===Ju?t.createElement(e):t.createElementNS(n,e)}}function hI(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Jg(e){var t=xa(e);return(t.local?hI:cI)(t)}function fI(){}function bc(e){return e==null?fI:function(){return this.querySelector(e)}}function dI(e){typeof e!="function"&&(e=bc(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=new Array(o),c,l,h=0;h<o;++h)(c=s[h])&&(l=e.call(c,c.__data__,h,s))&&("__data__"in c&&(l.__data__=c.__data__),u[h]=l);return new Me(r,this._parents)}function pI(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function mI(){return[]}function Zg(e){return e==null?mI:function(){return this.querySelectorAll(e)}}function gI(e){return function(){return pI(e.apply(this,arguments))}}function _I(e){typeof e=="function"?e=gI(e):e=Zg(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new Me(r,i)}function t_(e){return function(){return this.matches(e)}}function e_(e){return function(t){return t.matches(e)}}var yI=Array.prototype.find;function vI(e){return function(){return yI.call(this.children,e)}}function wI(){return this.firstElementChild}function EI(e){return this.select(e==null?wI:vI(typeof e=="function"?e:e_(e)))}var TI=Array.prototype.filter;function AI(){return Array.from(this.children)}function II(e){return function(){return TI.call(this.children,e)}}function RI(e){return this.selectAll(e==null?AI:II(typeof e=="function"?e:e_(e)))}function SI(e){typeof e!="function"&&(e=t_(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new Me(r,this._parents)}function n_(e){return new Array(e.length)}function bI(){return new Me(this._enter||this._groups.map(n_),this._parents)}function zo(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zo.prototype={constructor:zo,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function CI(e){return function(){return e}}function PI(e,t,n,r,i,s){for(var o=0,u,c=t.length,l=s.length;o<l;++o)(u=t[o])?(u.__data__=s[o],r[o]=u):n[o]=new zo(e,s[o]);for(;o<c;++o)(u=t[o])&&(i[o]=u)}function xI(e,t,n,r,i,s,o){var u,c,l=new Map,h=t.length,d=s.length,p=new Array(h),g;for(u=0;u<h;++u)(c=t[u])&&(p[u]=g=o.call(c,c.__data__,u,t)+"",l.has(g)?i[u]=c:l.set(g,c));for(u=0;u<d;++u)g=o.call(e,s[u],u,s)+"",(c=l.get(g))?(r[u]=c,c.__data__=s[u],l.delete(g)):n[u]=new zo(e,s[u]);for(u=0;u<h;++u)(c=t[u])&&l.get(p[u])===c&&(i[u]=c)}function VI(e){return e.__data__}function NI(e,t){if(!arguments.length)return Array.from(this,VI);var n=t?xI:PI,r=this._parents,i=this._groups;typeof e!="function"&&(e=CI(e));for(var s=i.length,o=new Array(s),u=new Array(s),c=new Array(s),l=0;l<s;++l){var h=r[l],d=i[l],p=d.length,g=DI(e.call(h,h&&h.__data__,l,r)),_=g.length,E=u[l]=new Array(_),v=o[l]=new Array(_),P=c[l]=new Array(p);n(h,d,E,v,P,g,t);for(var b=0,N=0,x,M;b<_;++b)if(x=E[b]){for(b>=N&&(N=b+1);!(M=v[N])&&++N<_;);x._next=M||null}}return o=new Me(o,r),o._enter=u,o._exit=c,o}function DI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kI(){return new Me(this._exit||this._groups.map(n_),this._parents)}function OI(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function MI(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),u=new Array(i),c=0;c<o;++c)for(var l=n[c],h=r[c],d=l.length,p=u[c]=new Array(d),g,_=0;_<d;++_)(g=l[_]||h[_])&&(p[_]=g);for(;c<i;++c)u[c]=n[c];return new Me(u,this._parents)}function LI(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function FI(e){e||(e=UI);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],u=o.length,c=i[s]=new Array(u),l,h=0;h<u;++h)(l=o[h])&&(c[h]=l);c.sort(t)}return new Me(i,this._parents).order()}function UI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function BI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $I(){return Array.from(this)}function qI(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function jI(){let e=0;for(const t of this)++e;return e}function zI(){return!this.node()}function HI(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,u;s<o;++s)(u=i[s])&&e.call(u,u.__data__,s,i);return this}function GI(e){return function(){this.removeAttribute(e)}}function WI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function KI(e,t){return function(){this.setAttribute(e,t)}}function QI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function XI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function YI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function JI(e,t){var n=xa(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?WI:GI:typeof t=="function"?n.local?YI:XI:n.local?QI:KI)(n,t))}function r_(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ZI(e){return function(){this.style.removeProperty(e)}}function tR(e,t,n){return function(){this.style.setProperty(e,t,n)}}function eR(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function nR(e,t,n){return arguments.length>1?this.each((t==null?ZI:typeof t=="function"?eR:tR)(e,t,n??"")):Jr(this.node(),e)}function Jr(e,t){return e.style.getPropertyValue(t)||r_(e).getComputedStyle(e,null).getPropertyValue(t)}function rR(e){return function(){delete this[e]}}function iR(e,t){return function(){this[e]=t}}function sR(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function oR(e,t){return arguments.length>1?this.each((t==null?rR:typeof t=="function"?sR:iR)(e,t)):this.node()[e]}function i_(e){return e.trim().split(/^|\s+/)}function Cc(e){return e.classList||new s_(e)}function s_(e){this._node=e,this._names=i_(e.getAttribute("class")||"")}s_.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function o_(e,t){for(var n=Cc(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function a_(e,t){for(var n=Cc(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function aR(e){return function(){o_(this,e)}}function uR(e){return function(){a_(this,e)}}function lR(e,t){return function(){(t.apply(this,arguments)?o_:a_)(this,e)}}function cR(e,t){var n=i_(e+"");if(arguments.length<2){for(var r=Cc(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?lR:t?aR:uR)(n,t))}function hR(){this.textContent=""}function fR(e){return function(){this.textContent=e}}function dR(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function pR(e){return arguments.length?this.each(e==null?hR:(typeof e=="function"?dR:fR)(e)):this.node().textContent}function mR(){this.innerHTML=""}function gR(e){return function(){this.innerHTML=e}}function _R(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function yR(e){return arguments.length?this.each(e==null?mR:(typeof e=="function"?_R:gR)(e)):this.node().innerHTML}function vR(){this.nextSibling&&this.parentNode.appendChild(this)}function wR(){return this.each(vR)}function ER(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function TR(){return this.each(ER)}function AR(e){var t=typeof e=="function"?e:Jg(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function IR(){return null}function RR(e,t){var n=typeof e=="function"?e:Jg(e),r=t==null?IR:typeof t=="function"?t:bc(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function SR(){var e=this.parentNode;e&&e.removeChild(this)}function bR(){return this.each(SR)}function CR(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function PR(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xR(e){return this.select(e?PR:CR)}function VR(e){return arguments.length?this.property("__data__",e):this.node().__data__}function NR(e){return function(t){e.call(this,t,this.__data__)}}function DR(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function kR(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function OR(e,t,n){return function(){var r=this.__on,i,s=NR(t);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function MR(e,t,n){var r=DR(e+""),i,s=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,l=u.length,h;c<l;++c)for(i=0,h=u[c];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(u=t?OR:kR,i=0;i<s;++i)this.each(u(r[i],t,n));return this}function u_(e,t,n){var r=r_(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function LR(e,t){return function(){return u_(this,e,t)}}function FR(e,t){return function(){return u_(this,e,t.apply(this,arguments))}}function UR(e,t){return this.each((typeof t=="function"?FR:LR)(e,t))}function*BR(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var $R=[null];function Me(e,t){this._groups=e,this._parents=t}function Ss(){return new Me([[document.documentElement]],$R)}function qR(){return this}Me.prototype=Ss.prototype={constructor:Me,select:dI,selectAll:_I,selectChild:EI,selectChildren:RI,filter:SI,data:NI,enter:bI,exit:kI,join:OI,merge:MI,selection:qR,order:LI,sort:FI,call:BI,nodes:$I,node:qI,size:jI,empty:zI,each:HI,attr:JI,style:nR,property:oR,classed:cR,text:pR,html:yR,raise:wR,lower:TR,append:AR,insert:RR,remove:bR,clone:xR,datum:VR,on:MR,dispatch:UR,[Symbol.iterator]:BR};function Pc(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function l_(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function bs(){}var us=.7,Ho=1/us,Gr="\\s*([+-]?\\d+)\\s*",ls="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ze="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jR=/^#([0-9a-f]{3,8})$/,zR=new RegExp(`^rgb\\(${Gr},${Gr},${Gr}\\)$`),HR=new RegExp(`^rgb\\(${Ze},${Ze},${Ze}\\)$`),GR=new RegExp(`^rgba\\(${Gr},${Gr},${Gr},${ls}\\)$`),WR=new RegExp(`^rgba\\(${Ze},${Ze},${Ze},${ls}\\)$`),KR=new RegExp(`^hsl\\(${ls},${Ze},${Ze}\\)$`),QR=new RegExp(`^hsla\\(${ls},${Ze},${Ze},${ls}\\)$`),dd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Pc(bs,cs,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:pd,formatHex:pd,formatHex8:XR,formatHsl:YR,formatRgb:md,toString:md});function pd(){return this.rgb().formatHex()}function XR(){return this.rgb().formatHex8()}function YR(){return c_(this).formatHsl()}function md(){return this.rgb().formatRgb()}function cs(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=jR.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?gd(t):n===3?new le(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Xs(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Xs(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=zR.exec(e))?new le(t[1],t[2],t[3],1):(t=HR.exec(e))?new le(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=GR.exec(e))?Xs(t[1],t[2],t[3],t[4]):(t=WR.exec(e))?Xs(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=KR.exec(e))?vd(t[1],t[2]/100,t[3]/100,1):(t=QR.exec(e))?vd(t[1],t[2]/100,t[3]/100,t[4]):dd.hasOwnProperty(e)?gd(dd[e]):e==="transparent"?new le(NaN,NaN,NaN,0):null}function gd(e){return new le(e>>16&255,e>>8&255,e&255,1)}function Xs(e,t,n,r){return r<=0&&(e=t=n=NaN),new le(e,t,n,r)}function JR(e){return e instanceof bs||(e=cs(e)),e?(e=e.rgb(),new le(e.r,e.g,e.b,e.opacity)):new le}function Zu(e,t,n,r){return arguments.length===1?JR(e):new le(e,t,n,r??1)}function le(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Pc(le,Zu,l_(bs,{brighter(e){return e=e==null?Ho:Math.pow(Ho,e),new le(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?us:Math.pow(us,e),new le(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new le(dr(this.r),dr(this.g),dr(this.b),Go(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_d,formatHex:_d,formatHex8:ZR,formatRgb:yd,toString:yd}));function _d(){return`#${lr(this.r)}${lr(this.g)}${lr(this.b)}`}function ZR(){return`#${lr(this.r)}${lr(this.g)}${lr(this.b)}${lr((isNaN(this.opacity)?1:this.opacity)*255)}`}function yd(){const e=Go(this.opacity);return`${e===1?"rgb(":"rgba("}${dr(this.r)}, ${dr(this.g)}, ${dr(this.b)}${e===1?")":`, ${e})`}`}function Go(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function dr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function lr(e){return e=dr(e),(e<16?"0":"")+e.toString(16)}function vd(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ke(e,t,n,r)}function c_(e){if(e instanceof ke)return new ke(e.h,e.s,e.l,e.opacity);if(e instanceof bs||(e=cs(e)),!e)return new ke;if(e instanceof ke)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,u=s-i,c=(s+i)/2;return u?(t===s?o=(n-r)/u+(n<r)*6:n===s?o=(r-t)/u+2:o=(t-n)/u+4,u/=c<.5?s+i:2-s-i,o*=60):u=c>0&&c<1?0:o,new ke(o,u,c,e.opacity)}function tS(e,t,n,r){return arguments.length===1?c_(e):new ke(e,t,n,r??1)}function ke(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Pc(ke,tS,l_(bs,{brighter(e){return e=e==null?Ho:Math.pow(Ho,e),new ke(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?us:Math.pow(us,e),new ke(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new le(du(e>=240?e-240:e+120,i,r),du(e,i,r),du(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ke(wd(this.h),Ys(this.s),Ys(this.l),Go(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Go(this.opacity);return`${e===1?"hsl(":"hsla("}${wd(this.h)}, ${Ys(this.s)*100}%, ${Ys(this.l)*100}%${e===1?")":`, ${e})`}`}}));function wd(e){return e=(e||0)%360,e<0?e+360:e}function Ys(e){return Math.max(0,Math.min(1,e||0))}function du(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const h_=e=>()=>e;function eS(e,t){return function(n){return e+n*t}}function nS(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function rS(e){return(e=+e)==1?f_:function(t,n){return n-t?nS(t,n,e):h_(isNaN(t)?n:t)}}function f_(e,t){var n=t-e;return n?eS(e,n):h_(isNaN(e)?t:e)}const Ed=function e(t){var n=rS(t);function r(i,s){var o=n((i=Zu(i)).r,(s=Zu(s)).r),u=n(i.g,s.g),c=n(i.b,s.b),l=f_(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=u(h),i.b=c(h),i.opacity=l(h),i+""}}return r.gamma=e,r}(1);function Nn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var tl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pu=new RegExp(tl.source,"g");function iS(e){return function(){return e}}function sS(e){return function(t){return e(t)+""}}function oS(e,t){var n=tl.lastIndex=pu.lastIndex=0,r,i,s,o=-1,u=[],c=[];for(e=e+"",t=t+"";(r=tl.exec(e))&&(i=pu.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),u[o]?u[o]+=s:u[++o]=s),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,c.push({i:o,x:Nn(r,i)})),n=pu.lastIndex;return n<t.length&&(s=t.slice(n),u[o]?u[o]+=s:u[++o]=s),u.length<2?c[0]?sS(c[0].x):iS(t):(t=c.length,function(l){for(var h=0,d;h<t;++h)u[(d=c[h]).i]=d.x(l);return u.join("")})}var Td=180/Math.PI,el={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function d_(e,t,n,r,i,s){var o,u,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,c/=u),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Td,skewX:Math.atan(c)*Td,scaleX:o,scaleY:u}}var Js;function aS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?el:d_(t.a,t.b,t.c,t.d,t.e,t.f)}function uS(e){return e==null||(Js||(Js=document.createElementNS("http://www.w3.org/2000/svg","g")),Js.setAttribute("transform",e),!(e=Js.transform.baseVal.consolidate()))?el:(e=e.matrix,d_(e.a,e.b,e.c,e.d,e.e,e.f))}function p_(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,h,d,p,g,_){if(l!==d||h!==p){var E=g.push("translate(",null,t,null,n);_.push({i:E-4,x:Nn(l,d)},{i:E-2,x:Nn(h,p)})}else(d||p)&&g.push("translate("+d+t+p+n)}function o(l,h,d,p){l!==h?(l-h>180?h+=360:h-l>180&&(l+=360),p.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Nn(l,h)})):h&&d.push(i(d)+"rotate("+h+r)}function u(l,h,d,p){l!==h?p.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Nn(l,h)}):h&&d.push(i(d)+"skewX("+h+r)}function c(l,h,d,p,g,_){if(l!==d||h!==p){var E=g.push(i(g)+"scale(",null,",",null,")");_.push({i:E-4,x:Nn(l,d)},{i:E-2,x:Nn(h,p)})}else(d!==1||p!==1)&&g.push(i(g)+"scale("+d+","+p+")")}return function(l,h){var d=[],p=[];return l=e(l),h=e(h),s(l.translateX,l.translateY,h.translateX,h.translateY,d,p),o(l.rotate,h.rotate,d,p),u(l.skewX,h.skewX,d,p),c(l.scaleX,l.scaleY,h.scaleX,h.scaleY,d,p),l=h=null,function(g){for(var _=-1,E=p.length,v;++_<E;)d[(v=p[_]).i]=v.x(g);return d.join("")}}}var lS=p_(aS,"px, ","px)","deg)"),cS=p_(uS,", ",")",")"),Zr=0,Mi=0,Vi=0,m_=1e3,Wo,Li,Ko=0,vr=0,Va=0,hs=typeof performance=="object"&&performance.now?performance:Date,g_=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function xc(){return vr||(g_(hS),vr=hs.now()+Va)}function hS(){vr=0}function Qo(){this._call=this._time=this._next=null}Qo.prototype=Vc.prototype={constructor:Qo,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?xc():+n)+(t==null?0:+t),!this._next&&Li!==this&&(Li?Li._next=this:Wo=this,Li=this),this._call=e,this._time=n,nl()},stop:function(){this._call&&(this._call=null,this._time=1/0,nl())}};function Vc(e,t,n){var r=new Qo;return r.restart(e,t,n),r}function fS(){xc(),++Zr;for(var e=Wo,t;e;)(t=vr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Zr}function Ad(){vr=(Ko=hs.now())+Va,Zr=Mi=0;try{fS()}finally{Zr=0,pS(),vr=0}}function dS(){var e=hs.now(),t=e-Ko;t>m_&&(Va-=t,Ko=e)}function pS(){for(var e,t=Wo,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Wo=n);Li=e,nl(r)}function nl(e){if(!Zr){Mi&&(Mi=clearTimeout(Mi));var t=e-vr;t>24?(e<1/0&&(Mi=setTimeout(Ad,e-hs.now()-Va)),Vi&&(Vi=clearInterval(Vi))):(Vi||(Ko=hs.now(),Vi=setInterval(dS,m_)),Zr=1,g_(Ad))}}function Id(e,t,n){var r=new Qo;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var mS=Sc("start","end","cancel","interrupt"),gS=[],__=0,Rd=1,rl=2,mo=3,Sd=4,il=5,go=6;function Na(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;_S(e,n,{name:t,index:r,group:i,on:mS,tween:gS,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:__})}function Nc(e,t){var n=Fe(e,t);if(n.state>__)throw new Error("too late; already scheduled");return n}function rn(e,t){var n=Fe(e,t);if(n.state>mo)throw new Error("too late; already running");return n}function Fe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _S(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Vc(s,0,n.time);function s(l){n.state=Rd,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var h,d,p,g;if(n.state!==Rd)return c();for(h in r)if(g=r[h],g.name===n.name){if(g.state===mo)return Id(o);g.state===Sd?(g.state=go,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[h]):+h<t&&(g.state=go,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[h])}if(Id(function(){n.state===mo&&(n.state=Sd,n.timer.restart(u,n.delay,n.time),u(l))}),n.state=rl,n.on.call("start",e,e.__data__,n.index,n.group),n.state===rl){for(n.state=mo,i=new Array(p=n.tween.length),h=0,d=-1;h<p;++h)(g=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=g);i.length=d+1}}function u(l){for(var h=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=il,1),d=-1,p=i.length;++d<p;)i[d].call(e,h);n.state===il&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=go,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function yS(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>rl&&r.state<il,r.state=go,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function vS(e){return this.each(function(){yS(this,e)})}function wS(e,t){var n,r;return function(){var i=rn(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,u=r.length;o<u;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function ES(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=rn(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var u={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=u;break}c===l&&i.push(u)}s.tween=i}}function TS(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Fe(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?wS:ES)(n,e,t))}function Dc(e,t,n){var r=e._id;return e.each(function(){var i=rn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Fe(i,r).value[t]}}function y_(e,t){var n;return(typeof t=="number"?Nn:t instanceof cs?Ed:(n=cs(t))?(t=n,Ed):oS)(e,t)}function AS(e){return function(){this.removeAttribute(e)}}function IS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function RS(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function SS(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function bS(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function CS(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function PS(e,t){var n=xa(e),r=n==="transform"?cS:y_;return this.attrTween(e,typeof t=="function"?(n.local?CS:bS)(n,r,Dc(this,"attr."+e,t)):t==null?(n.local?IS:AS)(n):(n.local?SS:RS)(n,r,t))}function xS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function VS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function NS(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&VS(e,s)),n}return i._value=t,i}function DS(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&xS(e,s)),n}return i._value=t,i}function kS(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=xa(e);return this.tween(n,(r.local?NS:DS)(r,t))}function OS(e,t){return function(){Nc(this,e).delay=+t.apply(this,arguments)}}function MS(e,t){return t=+t,function(){Nc(this,e).delay=t}}function LS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?OS:MS)(t,e)):Fe(this.node(),t).delay}function FS(e,t){return function(){rn(this,e).duration=+t.apply(this,arguments)}}function US(e,t){return t=+t,function(){rn(this,e).duration=t}}function BS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?FS:US)(t,e)):Fe(this.node(),t).duration}function $S(e,t){if(typeof t!="function")throw new Error;return function(){rn(this,e).ease=t}}function qS(e){var t=this._id;return arguments.length?this.each($S(t,e)):Fe(this.node(),t).ease}function jS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;rn(this,e).ease=n}}function zS(e){if(typeof e!="function")throw new Error;return this.each(jS(this._id,e))}function HS(e){typeof e!="function"&&(e=t_(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new En(r,this._parents,this._name,this._id)}function GS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),u=0;u<s;++u)for(var c=t[u],l=n[u],h=c.length,d=o[u]=new Array(h),p,g=0;g<h;++g)(p=c[g]||l[g])&&(d[g]=p);for(;u<r;++u)o[u]=t[u];return new En(o,this._parents,this._name,this._id)}function WS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function KS(e,t,n){var r,i,s=WS(t)?Nc:rn;return function(){var o=s(this,e),u=o.on;u!==r&&(i=(r=u).copy()).on(t,n),o.on=i}}function QS(e,t){var n=this._id;return arguments.length<2?Fe(this.node(),n).on.on(e):this.each(KS(n,e,t))}function XS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function YS(){return this.on("end.remove",XS(this._id))}function JS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=bc(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var u=r[o],c=u.length,l=s[o]=new Array(c),h,d,p=0;p<c;++p)(h=u[p])&&(d=e.call(h,h.__data__,p,u))&&("__data__"in h&&(d.__data__=h.__data__),l[p]=d,Na(l[p],t,n,p,l,Fe(h,n)));return new En(s,this._parents,t,n)}function ZS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Zg(e));for(var r=this._groups,i=r.length,s=[],o=[],u=0;u<i;++u)for(var c=r[u],l=c.length,h,d=0;d<l;++d)if(h=c[d]){for(var p=e.call(h,h.__data__,d,c),g,_=Fe(h,n),E=0,v=p.length;E<v;++E)(g=p[E])&&Na(g,t,n,E,p,_);s.push(p),o.push(h)}return new En(s,o,t,n)}var tb=Ss.prototype.constructor;function eb(){return new tb(this._groups,this._parents)}function nb(e,t){var n,r,i;return function(){var s=Jr(this,e),o=(this.style.removeProperty(e),Jr(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function v_(e){return function(){this.style.removeProperty(e)}}function rb(e,t,n){var r,i=n+"",s;return function(){var o=Jr(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function ib(e,t,n){var r,i,s;return function(){var o=Jr(this,e),u=n(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(e),Jr(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u))}}function sb(e,t){var n,r,i,s="style."+t,o="end."+s,u;return function(){var c=rn(this,e),l=c.on,h=c.value[s]==null?u||(u=v_(t)):void 0;(l!==n||i!==h)&&(r=(n=l).copy()).on(o,i=h),c.on=r}}function ob(e,t,n){var r=(e+="")=="transform"?lS:y_;return t==null?this.styleTween(e,nb(e,r)).on("end.style."+e,v_(e)):typeof t=="function"?this.styleTween(e,ib(e,r,Dc(this,"style."+e,t))).each(sb(this._id,e)):this.styleTween(e,rb(e,r,t),n).on("end.style."+e,null)}function ab(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function ub(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&ab(e,o,n)),r}return s._value=t,s}function lb(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,ub(e,t,n??""))}function cb(e){return function(){this.textContent=e}}function hb(e){return function(){var t=e(this);this.textContent=t??""}}function fb(e){return this.tween("text",typeof e=="function"?hb(Dc(this,"text",e)):cb(e==null?"":e+""))}function db(e){return function(t){this.textContent=e.call(this,t)}}function pb(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&db(i)),t}return r._value=e,r}function mb(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,pb(e))}function gb(){for(var e=this._name,t=this._id,n=w_(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)if(c=o[l]){var h=Fe(c,t);Na(c,e,n,l,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new En(r,this._parents,e,n)}function _b(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var u={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var l=rn(this,r),h=l.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(c)),l.on=t}),i===0&&s()})}var yb=0;function En(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function w_(){return++yb}var ln=Ss.prototype;En.prototype={constructor:En,select:JS,selectAll:ZS,selectChild:ln.selectChild,selectChildren:ln.selectChildren,filter:HS,merge:GS,selection:eb,transition:gb,call:ln.call,nodes:ln.nodes,node:ln.node,size:ln.size,empty:ln.empty,each:ln.each,on:QS,attr:PS,attrTween:kS,style:ob,styleTween:lb,text:fb,textTween:mb,remove:YS,tween:TS,delay:LS,duration:BS,ease:qS,easeVarying:zS,end:_b,[Symbol.iterator]:ln[Symbol.iterator]};function vb(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var wb={time:null,delay:0,duration:250,ease:vb};function Eb(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Tb(e){var t,n;e instanceof En?(t=e._id,e=e._name):(t=w_(),(n=wb).time=xc(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&Na(c,e,t,l,o,n||Eb(c,t));return new En(r,this._parents,e,t)}Ss.prototype.interrupt=vS;Ss.prototype.transition=Tb;function Ab(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,o=n.length,u,c=0,l=0;for(s=0;s<o;++s)u=n[s],c+=u.x,l+=u.y;for(c=(c/o-e)*r,l=(l/o-t)*r,s=0;s<o;++s)u=n[s],u.x-=c,u.y-=l}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function Ib(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return E_(this.cover(t,n),t,n,e)}function E_(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},u=e._x0,c=e._y0,l=e._x1,h=e._y1,d,p,g,_,E,v,P,b;if(!s)return e._root=o,e;for(;s.length;)if((E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p,i=s,!(s=s[P=v<<1|E]))return i[P]=o,e;if(g=+e._x.call(null,s.data),_=+e._y.call(null,s.data),t===g&&n===_)return o.next=s,i?i[P]=o:e._root=o,e;do i=i?i[P]=new Array(4):e._root=new Array(4),(E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p;while((P=v<<1|E)===(b=(_>=p)<<1|g>=d));return i[b]=s,i[P]=o,e}function Rb(e){var t,n,r=e.length,i,s,o=new Array(r),u=new Array(r),c=1/0,l=1/0,h=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,u[n]=s,i<c&&(c=i),i>h&&(h=i),s<l&&(l=s),s>d&&(d=s));if(c>h||l>d)return this;for(this.cover(c,l).cover(h,d),n=0;n<r;++n)E_(this,o[n],u[n],e[n]);return this}function Sb(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n||1,u=this._root,c,l;n>e||e>=i||r>t||t>=s;)switch(l=(t<r)<<1|e<n,c=new Array(4),c[l]=u,u=c,o*=2,l){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function bb(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Cb(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ee(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Pb(e,t,n){var r,i=this._x0,s=this._y0,o,u,c,l,h=this._x1,d=this._y1,p=[],g=this._root,_,E;for(g&&p.push(new ee(g,i,s,h,d)),n==null?n=1/0:(i=e-n,s=t-n,h=e+n,d=t+n,n*=n);_=p.pop();)if(!(!(g=_.node)||(o=_.x0)>h||(u=_.y0)>d||(c=_.x1)<i||(l=_.y1)<s))if(g.length){var v=(o+c)/2,P=(u+l)/2;p.push(new ee(g[3],v,P,c,l),new ee(g[2],o,P,v,l),new ee(g[1],v,u,c,P),new ee(g[0],o,u,v,P)),(E=(t>=P)<<1|e>=v)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-E],p[p.length-1-E]=_)}else{var b=e-+this._x.call(null,g.data),N=t-+this._y.call(null,g.data),x=b*b+N*N;if(x<n){var M=Math.sqrt(n=x);i=e-M,s=t-M,h=e+M,d=t+M,r=g.data}}return r}function xb(e){if(isNaN(h=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,u=this._y0,c=this._x1,l=this._y1,h,d,p,g,_,E,v,P;if(!n)return this;if(n.length)for(;;){if((_=h>=(p=(o+c)/2))?o=p:c=p,(E=d>=(g=(u+l)/2))?u=g:l=g,t=n,!(n=n[v=E<<1|_]))return this;if(!n.length)break;(t[v+1&3]||t[v+2&3]||t[v+3&3])&&(r=t,P=v)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[v]=s:delete t[v],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[P]=n:this._root=n),this):(this._root=s,this)}function Vb(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Nb(){return this._root}function Db(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function kb(e){var t=[],n,r=this._root,i,s,o,u,c;for(r&&t.push(new ee(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,u=n.x1,c=n.y1)&&r.length){var l=(s+u)/2,h=(o+c)/2;(i=r[3])&&t.push(new ee(i,l,h,u,c)),(i=r[2])&&t.push(new ee(i,s,h,l,c)),(i=r[1])&&t.push(new ee(i,l,o,u,h)),(i=r[0])&&t.push(new ee(i,s,o,l,h))}return this}function Ob(e){var t=[],n=[],r;for(this._root&&t.push(new ee(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,u=r.y0,c=r.x1,l=r.y1,h=(o+c)/2,d=(u+l)/2;(s=i[0])&&t.push(new ee(s,o,u,h,d)),(s=i[1])&&t.push(new ee(s,h,u,c,d)),(s=i[2])&&t.push(new ee(s,o,d,h,l)),(s=i[3])&&t.push(new ee(s,h,d,c,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Mb(e){return e[0]}function Lb(e){return arguments.length?(this._x=e,this):this._x}function Fb(e){return e[1]}function Ub(e){return arguments.length?(this._y=e,this):this._y}function T_(e,t,n){var r=new kc(t??Mb,n??Fb,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function kc(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function bd(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ne=T_.prototype=kc.prototype;ne.copy=function(){var e=new kc(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=bd(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=bd(r));return e};ne.add=Ib;ne.addAll=Rb;ne.cover=Sb;ne.data=bb;ne.extent=Cb;ne.find=Pb;ne.remove=xb;ne.removeAll=Vb;ne.root=Nb;ne.size=Db;ne.visit=kb;ne.visitAfter=Ob;ne.x=Lb;ne.y=Ub;function fn(e){return function(){return e}}function $r(e){return(e()-.5)*1e-6}function Bb(e){return e.index}function Cd(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function $b(e){var t=Bb,n=d,r,i=fn(30),s,o,u,c,l,h=1;e==null&&(e=[]);function d(v){return 1/Math.min(u[v.source.index],u[v.target.index])}function p(v){for(var P=0,b=e.length;P<h;++P)for(var N=0,x,M,U,I,w,T,S;N<b;++N)x=e[N],M=x.source,U=x.target,I=U.x+U.vx-M.x-M.vx||$r(l),w=U.y+U.vy-M.y-M.vy||$r(l),T=Math.sqrt(I*I+w*w),T=(T-s[N])/T*v*r[N],I*=T,w*=T,U.vx-=I*(S=c[N]),U.vy-=w*S,M.vx+=I*(S=1-S),M.vy+=w*S}function g(){if(o){var v,P=o.length,b=e.length,N=new Map(o.map((M,U)=>[t(M,U,o),M])),x;for(v=0,u=new Array(P);v<b;++v)x=e[v],x.index=v,typeof x.source!="object"&&(x.source=Cd(N,x.source)),typeof x.target!="object"&&(x.target=Cd(N,x.target)),u[x.source.index]=(u[x.source.index]||0)+1,u[x.target.index]=(u[x.target.index]||0)+1;for(v=0,c=new Array(b);v<b;++v)x=e[v],c[v]=u[x.source.index]/(u[x.source.index]+u[x.target.index]);r=new Array(b),_(),s=new Array(b),E()}}function _(){if(o)for(var v=0,P=e.length;v<P;++v)r[v]=+n(e[v],v,e)}function E(){if(o)for(var v=0,P=e.length;v<P;++v)s[v]=+i(e[v],v,e)}return p.initialize=function(v,P){o=v,l=P,g()},p.links=function(v){return arguments.length?(e=v,g(),p):e},p.id=function(v){return arguments.length?(t=v,p):t},p.iterations=function(v){return arguments.length?(h=+v,p):h},p.strength=function(v){return arguments.length?(n=typeof v=="function"?v:fn(+v),_(),p):n},p.distance=function(v){return arguments.length?(i=typeof v=="function"?v:fn(+v),E(),p):i},p}const qb=1664525,jb=1013904223,Pd=4294967296;function zb(){let e=1;return()=>(e=(qb*e+jb)%Pd)/Pd}function Hb(e){return e.x}function Gb(e){return e.y}var Wb=10,Kb=Math.PI*(3-Math.sqrt(5));function Qb(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,u=new Map,c=Vc(d),l=Sc("tick","end"),h=zb();e==null&&(e=[]);function d(){p(),l.call("tick",t),n<r&&(c.stop(),l.call("end",t))}function p(E){var v,P=e.length,b;E===void 0&&(E=1);for(var N=0;N<E;++N)for(n+=(s-n)*i,u.forEach(function(x){x(n)}),v=0;v<P;++v)b=e[v],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function g(){for(var E=0,v=e.length,P;E<v;++E){if(P=e[E],P.index=E,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var b=Wb*Math.sqrt(.5+E),N=E*Kb;P.x=b*Math.cos(N),P.y=b*Math.sin(N)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function _(E){return E.initialize&&E.initialize(e,h),E}return g(),t={tick:p,restart:function(){return c.restart(d),t},stop:function(){return c.stop(),t},nodes:function(E){return arguments.length?(e=E,g(),u.forEach(_),t):e},alpha:function(E){return arguments.length?(n=+E,t):n},alphaMin:function(E){return arguments.length?(r=+E,t):r},alphaDecay:function(E){return arguments.length?(i=+E,t):+i},alphaTarget:function(E){return arguments.length?(s=+E,t):s},velocityDecay:function(E){return arguments.length?(o=1-E,t):1-o},randomSource:function(E){return arguments.length?(h=E,u.forEach(_),t):h},force:function(E,v){return arguments.length>1?(v==null?u.delete(E):u.set(E,_(v)),t):u.get(E)},find:function(E,v,P){var b=0,N=e.length,x,M,U,I,w;for(P==null?P=1/0:P*=P,b=0;b<N;++b)I=e[b],x=E-I.x,M=v-I.y,U=x*x+M*M,U<P&&(w=I,P=U);return w},on:function(E,v){return arguments.length>1?(l.on(E,v),t):l.on(E)}}}function Xb(){var e,t,n,r,i=fn(-30),s,o=1,u=1/0,c=.81;function l(g){var _,E=e.length,v=T_(e,Hb,Gb).visitAfter(d);for(r=g,_=0;_<E;++_)t=e[_],v.visit(p)}function h(){if(e){var g,_=e.length,E;for(s=new Array(_),g=0;g<_;++g)E=e[g],s[E.index]=+i(E,g,e)}}function d(g){var _=0,E,v,P=0,b,N,x;if(g.length){for(b=N=x=0;x<4;++x)(E=g[x])&&(v=Math.abs(E.value))&&(_+=E.value,P+=v,b+=v*E.x,N+=v*E.y);g.x=b/P,g.y=N/P}else{E=g,E.x=E.data.x,E.y=E.data.y;do _+=s[E.data.index];while(E=E.next)}g.value=_}function p(g,_,E,v){if(!g.value)return!0;var P=g.x-t.x,b=g.y-t.y,N=v-_,x=P*P+b*b;if(N*N/c<x)return x<u&&(P===0&&(P=$r(n),x+=P*P),b===0&&(b=$r(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)),t.vx+=P*g.value*r/x,t.vy+=b*g.value*r/x),!0;if(g.length||x>=u)return;(g.data!==t||g.next)&&(P===0&&(P=$r(n),x+=P*P),b===0&&(b=$r(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)));do g.data!==t&&(N=s[g.data.index]*r/x,t.vx+=P*N,t.vy+=b*N);while(g=g.next)}return l.initialize=function(g,_){e=g,n=_,h()},l.strength=function(g){return arguments.length?(i=typeof g=="function"?g:fn(+g),h(),l):i},l.distanceMin=function(g){return arguments.length?(o=g*g,l):Math.sqrt(o)},l.distanceMax=function(g){return arguments.length?(u=g*g,l):Math.sqrt(u)},l.theta=function(g){return arguments.length?(c=g*g,l):Math.sqrt(c)},l}function Yb(e,t,n){var r,i=fn(.1),s,o;typeof e!="function"&&(e=fn(+e)),t==null&&(t=0),n==null&&(n=0);function u(l){for(var h=0,d=r.length;h<d;++h){var p=r[h],g=p.x-t||1e-6,_=p.y-n||1e-6,E=Math.sqrt(g*g+_*_),v=(o[h]-E)*s[h]*l/E;p.vx+=g*v,p.vy+=_*v}}function c(){if(r){var l,h=r.length;for(s=new Array(h),o=new Array(h),l=0;l<h;++l)o[l]=+e(r[l],l,r),s[l]=isNaN(o[l])?0:+i(r[l],l,r)}}return u.initialize=function(l){r=l,c()},u.strength=function(l){return arguments.length?(i=typeof l=="function"?l:fn(+l),c(),u):i},u.radius=function(l){return arguments.length?(e=typeof l=="function"?l:fn(+l),c(),u):e},u.x=function(l){return arguments.length?(t=+l,u):t},u.y=function(l){return arguments.length?(n=+l,u):n},u}var dt=1e-6,it=Math.PI,Se=it/2,xd=it/4,xe=it*2,cn=180/it,ge=it/180,vt=Math.abs,Jb=Math.atan,fs=Math.atan2,St=Math.cos,bt=Math.sin,Zb=Math.sign||function(e){return e>0?1:e<0?-1:0},Ir=Math.sqrt;function tC(e){return e>1?0:e<-1?it:Math.acos(e)}function ds(e){return e>1?Se:e<-1?-Se:Math.asin(e)}function be(){}function Xo(e,t){e&&Nd.hasOwnProperty(e.type)&&Nd[e.type](e,t)}var Vd={Feature:function(e,t){Xo(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Xo(n[r].geometry,t)}},Nd={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){sl(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)sl(n[r],t,0)},Polygon:function(e,t){Dd(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Dd(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Xo(n[r],t)}};function sl(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function Dd(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)sl(e[n],t,1);t.polygonEnd()}function Br(e,t){e&&Vd.hasOwnProperty(e.type)?Vd[e.type](e,t):Xo(e,t)}function ol(e){return[fs(e[1],e[0]),ds(e[2])]}function ti(e){var t=e[0],n=e[1],r=St(n);return[r*St(t),r*bt(t),bt(n)]}function Zs(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Yo(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function mu(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function to(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function al(e){var t=Ir(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function ul(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function ll(e,t){return vt(e)>it&&(e-=Math.round(e/xe)*xe),[e,t]}ll.invert=ll;function eC(e,t,n){return(e%=xe)?t||n?ul(Od(e),Md(t,n)):Od(e):t||n?Md(t,n):ll}function kd(e){return function(t,n){return t+=e,vt(t)>it&&(t-=Math.round(t/xe)*xe),[t,n]}}function Od(e){var t=kd(e);return t.invert=kd(-e),t}function Md(e,t){var n=St(e),r=bt(e),i=St(t),s=bt(t);function o(u,c){var l=St(c),h=St(u)*l,d=bt(u)*l,p=bt(c),g=p*n+h*r;return[fs(d*i-g*s,h*n-p*r),ds(g*i+d*s)]}return o.invert=function(u,c){var l=St(c),h=St(u)*l,d=bt(u)*l,p=bt(c),g=p*i-d*s;return[fs(d*i+p*s,h*n+g*r),ds(g*n-h*r)]},o}function nC(e,t,n,r,i,s){if(n){var o=St(t),u=bt(t),c=r*n;i==null?(i=t+r*xe,s=t-c/2):(i=Ld(o,i),s=Ld(o,s),(r>0?i<s:i>s)&&(i+=r*xe));for(var l,h=i;r>0?h>s:h<s;h-=c)l=ol([o,-u*St(h),-u*bt(h)]),e.point(l[0],l[1])}}function Ld(e,t){t=ti(t),t[0]-=e,al(t);var n=tC(-t[1]);return((-t[2]<0?-n:n)+xe-dt)%xe}function A_(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:be,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function _o(e,t){return vt(e[0]-t[0])<dt&&vt(e[1]-t[1])<dt}function eo(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function I_(e,t,n,r,i){var s=[],o=[],u,c;if(e.forEach(function(_){if(!((E=_.length-1)<=0)){var E,v=_[0],P=_[E],b;if(_o(v,P)){if(!v[2]&&!P[2]){for(i.lineStart(),u=0;u<E;++u)i.point((v=_[u])[0],v[1]);i.lineEnd();return}P[0]+=2*dt}s.push(b=new eo(v,_,null,!0)),o.push(b.o=new eo(v,null,b,!1)),s.push(b=new eo(P,_,null,!1)),o.push(b.o=new eo(P,null,b,!0))}}),!!s.length){for(o.sort(t),Fd(s),Fd(o),u=0,c=o.length;u<c;++u)o[u].e=n=!n;for(var l=s[0],h,d;;){for(var p=l,g=!0;p.v;)if((p=p.n)===l)return;h=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(u=0,c=h.length;u<c;++u)i.point((d=h[u])[0],d[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(g)for(h=p.p.z,u=h.length-1;u>=0;--u)i.point((d=h[u])[0],d[1]);else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,h=p.z,g=!g}while(!p.v);i.lineEnd()}}}function Fd(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function gu(e){return vt(e[0])<=it?e[0]:Zb(e[0])*((vt(e[0])+it)%xe-it)}function rC(e,t){var n=gu(t),r=t[1],i=bt(r),s=[bt(n),-St(n),0],o=0,u=0,c=new yr;i===1?r=Se+dt:i===-1&&(r=-Se-dt);for(var l=0,h=e.length;l<h;++l)if(p=(d=e[l]).length)for(var d,p,g=d[p-1],_=gu(g),E=g[1]/2+xd,v=bt(E),P=St(E),b=0;b<p;++b,_=x,v=U,P=I,g=N){var N=d[b],x=gu(N),M=N[1]/2+xd,U=bt(M),I=St(M),w=x-_,T=w>=0?1:-1,S=T*w,R=S>it,C=v*U;if(c.add(fs(C*T*bt(S),P*I+C*St(S))),o+=R?w+T*xe:w,R^_>=n^x>=n){var A=Yo(ti(g),ti(N));al(A);var X=Yo(s,A);al(X);var F=(R^w>=0?-1:1)*ds(X[2]);(r>F||r===F&&(A[0]||A[1]))&&(u+=R^w>=0?1:-1)}}return(o<-dt||o<dt&&c<-1e-12)^u&1}function R_(e,t,n,r){return function(i){var s=t(i),o=A_(),u=t(o),c=!1,l,h,d,p={point:g,lineStart:E,lineEnd:v,polygonStart:function(){p.point=P,p.lineStart=b,p.lineEnd=N,h=[],l=[]},polygonEnd:function(){p.point=g,p.lineStart=E,p.lineEnd=v,h=Yg(h);var x=rC(l,r);h.length?(c||(i.polygonStart(),c=!0),I_(h,sC,x,n,i)):x&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),h=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function g(x,M){e(x,M)&&i.point(x,M)}function _(x,M){s.point(x,M)}function E(){p.point=_,s.lineStart()}function v(){p.point=g,s.lineEnd()}function P(x,M){d.push([x,M]),u.point(x,M)}function b(){u.lineStart(),d=[]}function N(){P(d[0][0],d[0][1]),u.lineEnd();var x=u.clean(),M=o.result(),U,I=M.length,w,T,S;if(d.pop(),l.push(d),d=null,!!I){if(x&1){if(T=M[0],(w=T.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),U=0;U<w;++U)i.point((S=T[U])[0],S[1]);i.lineEnd()}return}I>1&&x&2&&M.push(M.pop().concat(M.shift())),h.push(M.filter(iC))}}return p}}function iC(e){return e.length>1}function sC(e,t){return((e=e.x)[0]<0?e[1]-Se-dt:Se-e[1])-((t=t.x)[0]<0?t[1]-Se-dt:Se-t[1])}const Ud=R_(function(){return!0},oC,uC,[-it,-Se]);function oC(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var u=s>0?it:-it,c=vt(s-t);vt(c-it)<dt?(e.point(t,n=(n+o)/2>0?Se:-Se),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&c>=it&&(vt(t-r)<dt&&(t-=r*dt),vt(s-u)<dt&&(s-=u*dt),n=aC(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=o),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function aC(e,t,n,r){var i,s,o=bt(e-n);return vt(o)>dt?Jb((bt(t)*(s=St(r))*bt(n)-bt(r)*(i=St(t))*bt(e))/(i*s*o)):(t+r)/2}function uC(e,t,n,r){var i;if(e==null)i=n*Se,r.point(-it,i),r.point(0,i),r.point(it,i),r.point(it,0),r.point(it,-i),r.point(0,-i),r.point(-it,-i),r.point(-it,0),r.point(-it,i);else if(vt(e[0]-t[0])>dt){var s=e[0]<t[0]?it:-it;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function lC(e){var t=St(e),n=2*ge,r=t>0,i=vt(t)>dt;function s(h,d,p,g){nC(g,e,n,p,h,d)}function o(h,d){return St(h)*St(d)>t}function u(h){var d,p,g,_,E;return{lineStart:function(){_=g=!1,E=1},point:function(v,P){var b=[v,P],N,x=o(v,P),M=r?x?0:l(v,P):x?l(v+(v<0?it:-it),P):0;if(!d&&(_=g=x)&&h.lineStart(),x!==g&&(N=c(d,b),(!N||_o(d,N)||_o(b,N))&&(b[2]=1)),x!==g)E=0,x?(h.lineStart(),N=c(b,d),h.point(N[0],N[1])):(N=c(d,b),h.point(N[0],N[1],2),h.lineEnd()),d=N;else if(i&&d&&r^x){var U;!(M&p)&&(U=c(b,d,!0))&&(E=0,r?(h.lineStart(),h.point(U[0][0],U[0][1]),h.point(U[1][0],U[1][1]),h.lineEnd()):(h.point(U[1][0],U[1][1]),h.lineEnd(),h.lineStart(),h.point(U[0][0],U[0][1],3)))}x&&(!d||!_o(d,b))&&h.point(b[0],b[1]),d=b,g=x,p=M},lineEnd:function(){g&&h.lineEnd(),d=null},clean:function(){return E|(_&&g)<<1}}}function c(h,d,p){var g=ti(h),_=ti(d),E=[1,0,0],v=Yo(g,_),P=Zs(v,v),b=v[0],N=P-b*b;if(!N)return!p&&h;var x=t*P/N,M=-t*b/N,U=Yo(E,v),I=to(E,x),w=to(v,M);mu(I,w);var T=U,S=Zs(I,T),R=Zs(T,T),C=S*S-R*(Zs(I,I)-1);if(!(C<0)){var A=Ir(C),X=to(T,(-S-A)/R);if(mu(X,I),X=ol(X),!p)return X;var F=h[0],Y=d[0],lt=h[1],mt=d[1],kt;Y<F&&(kt=F,F=Y,Y=kt);var Ve=Y-F,re=vt(Ve-it)<dt,Ot=re||Ve<dt;if(!re&&mt<lt&&(kt=lt,lt=mt,mt=kt),Ot?re?lt+mt>0^X[1]<(vt(X[0]-F)<dt?lt:mt):lt<=X[1]&&X[1]<=mt:Ve>it^(F<=X[0]&&X[0]<=Y)){var ct=to(T,(-S+A)/R);return mu(ct,I),[X,ol(ct)]}}}function l(h,d){var p=r?e:it-e,g=0;return h<-p?g|=1:h>p&&(g|=2),d<-p?g|=4:d>p&&(g|=8),g}return R_(o,u,s,r?[0,-e]:[-it,e-it])}function cC(e,t,n,r,i,s){var o=e[0],u=e[1],c=t[0],l=t[1],h=0,d=1,p=c-o,g=l-u,_;if(_=n-o,!(!p&&_>0)){if(_/=p,p<0){if(_<h)return;_<d&&(d=_)}else if(p>0){if(_>d)return;_>h&&(h=_)}if(_=i-o,!(!p&&_<0)){if(_/=p,p<0){if(_>d)return;_>h&&(h=_)}else if(p>0){if(_<h)return;_<d&&(d=_)}if(_=r-u,!(!g&&_>0)){if(_/=g,g<0){if(_<h)return;_<d&&(d=_)}else if(g>0){if(_>d)return;_>h&&(h=_)}if(_=s-u,!(!g&&_<0)){if(_/=g,g<0){if(_>d)return;_>h&&(h=_)}else if(g>0){if(_<h)return;_<d&&(d=_)}return h>0&&(e[0]=o+h*p,e[1]=u+h*g),d<1&&(t[0]=o+d*p,t[1]=u+d*g),!0}}}}}var Fi=1e9,no=-Fi;function hC(e,t,n,r){function i(l,h){return e<=l&&l<=n&&t<=h&&h<=r}function s(l,h,d,p){var g=0,_=0;if(l==null||(g=o(l,d))!==(_=o(h,d))||c(l,h)<0^d>0)do p.point(g===0||g===3?e:n,g>1?r:t);while((g=(g+d+4)%4)!==_);else p.point(h[0],h[1])}function o(l,h){return vt(l[0]-e)<dt?h>0?0:3:vt(l[0]-n)<dt?h>0?2:1:vt(l[1]-t)<dt?h>0?1:0:h>0?3:2}function u(l,h){return c(l.x,h.x)}function c(l,h){var d=o(l,1),p=o(h,1);return d!==p?d-p:d===0?h[1]-l[1]:d===1?l[0]-h[0]:d===2?l[1]-h[1]:h[0]-l[0]}return function(l){var h=l,d=A_(),p,g,_,E,v,P,b,N,x,M,U,I={point:w,lineStart:C,lineEnd:A,polygonStart:S,polygonEnd:R};function w(F,Y){i(F,Y)&&h.point(F,Y)}function T(){for(var F=0,Y=0,lt=g.length;Y<lt;++Y)for(var mt=g[Y],kt=1,Ve=mt.length,re=mt[0],Ot,ct,An=re[0],ie=re[1];kt<Ve;++kt)Ot=An,ct=ie,re=mt[kt],An=re[0],ie=re[1],ct<=r?ie>r&&(An-Ot)*(r-ct)>(ie-ct)*(e-Ot)&&++F:ie<=r&&(An-Ot)*(r-ct)<(ie-ct)*(e-Ot)&&--F;return F}function S(){h=d,p=[],g=[],U=!0}function R(){var F=T(),Y=U&&F,lt=(p=Yg(p)).length;(Y||lt)&&(l.polygonStart(),Y&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),lt&&I_(p,u,F,s,l),l.polygonEnd()),h=l,p=g=_=null}function C(){I.point=X,g&&g.push(_=[]),M=!0,x=!1,b=N=NaN}function A(){p&&(X(E,v),P&&x&&d.rejoin(),p.push(d.result())),I.point=w,x&&h.lineEnd()}function X(F,Y){var lt=i(F,Y);if(g&&_.push([F,Y]),M)E=F,v=Y,P=lt,M=!1,lt&&(h.lineStart(),h.point(F,Y));else if(lt&&x)h.point(F,Y);else{var mt=[b=Math.max(no,Math.min(Fi,b)),N=Math.max(no,Math.min(Fi,N))],kt=[F=Math.max(no,Math.min(Fi,F)),Y=Math.max(no,Math.min(Fi,Y))];cC(mt,kt,e,t,n,r)?(x||(h.lineStart(),h.point(mt[0],mt[1])),h.point(kt[0],kt[1]),lt||h.lineEnd(),U=!1):lt&&(h.lineStart(),h.point(F,Y),U=!1)}b=F,N=Y,x=lt}return I}}const cl=e=>e;var _u=new yr,hl=new yr,S_,b_,fl,dl,hn={point:be,lineStart:be,lineEnd:be,polygonStart:function(){hn.lineStart=fC,hn.lineEnd=pC},polygonEnd:function(){hn.lineStart=hn.lineEnd=hn.point=be,_u.add(vt(hl)),hl=new yr},result:function(){var e=_u/2;return _u=new yr,e}};function fC(){hn.point=dC}function dC(e,t){hn.point=C_,S_=fl=e,b_=dl=t}function C_(e,t){hl.add(dl*e-fl*t),fl=e,dl=t}function pC(){C_(S_,b_)}var ei=1/0,Jo=ei,ps=-ei,Zo=ps,ta={point:mC,lineStart:be,lineEnd:be,polygonStart:be,polygonEnd:be,result:function(){var e=[[ei,Jo],[ps,Zo]];return ps=Zo=-(Jo=ei=1/0),e}};function mC(e,t){e<ei&&(ei=e),e>ps&&(ps=e),t<Jo&&(Jo=t),t>Zo&&(Zo=t)}var pl=0,ml=0,Ui=0,ea=0,na=0,qr=0,gl=0,_l=0,Bi=0,P_,x_,Ge,We,Re={point:wr,lineStart:Bd,lineEnd:$d,polygonStart:function(){Re.lineStart=yC,Re.lineEnd=vC},polygonEnd:function(){Re.point=wr,Re.lineStart=Bd,Re.lineEnd=$d},result:function(){var e=Bi?[gl/Bi,_l/Bi]:qr?[ea/qr,na/qr]:Ui?[pl/Ui,ml/Ui]:[NaN,NaN];return pl=ml=Ui=ea=na=qr=gl=_l=Bi=0,e}};function wr(e,t){pl+=e,ml+=t,++Ui}function Bd(){Re.point=gC}function gC(e,t){Re.point=_C,wr(Ge=e,We=t)}function _C(e,t){var n=e-Ge,r=t-We,i=Ir(n*n+r*r);ea+=i*(Ge+e)/2,na+=i*(We+t)/2,qr+=i,wr(Ge=e,We=t)}function $d(){Re.point=wr}function yC(){Re.point=wC}function vC(){V_(P_,x_)}function wC(e,t){Re.point=V_,wr(P_=Ge=e,x_=We=t)}function V_(e,t){var n=e-Ge,r=t-We,i=Ir(n*n+r*r);ea+=i*(Ge+e)/2,na+=i*(We+t)/2,qr+=i,i=We*e-Ge*t,gl+=i*(Ge+e),_l+=i*(We+t),Bi+=i*3,wr(Ge=e,We=t)}function N_(e){this._context=e}N_.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,xe);break}}},result:be};var yl=new yr,yu,D_,k_,$i,qi,ms={point:be,lineStart:function(){ms.point=EC},lineEnd:function(){yu&&O_(D_,k_),ms.point=be},polygonStart:function(){yu=!0},polygonEnd:function(){yu=null},result:function(){var e=+yl;return yl=new yr,e}};function EC(e,t){ms.point=O_,D_=$i=e,k_=qi=t}function O_(e,t){$i-=e,qi-=t,yl.add(Ir($i*$i+qi*qi)),$i=e,qi=t}let qd,ra,jd,zd;class Hd{constructor(t){this._append=t==null?M_:TC(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==jd||this._append!==ra){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,jd=r,ra=this._append,zd=this._,this._=i}this._+=zd;break}}}result(){const t=this._;return this._="",t.length?t:null}}function M_(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function TC(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return M_;if(t!==qd){const n=10**t;qd=t,ra=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return ra}function AC(e,t){let n=3,r=4.5,i,s;function o(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Br(u,i(s))),s.result()}return o.area=function(u){return Br(u,i(hn)),hn.result()},o.measure=function(u){return Br(u,i(ms)),ms.result()},o.bounds=function(u){return Br(u,i(ta)),ta.result()},o.centroid=function(u){return Br(u,i(Re)),Re.result()},o.projection=function(u){return arguments.length?(i=u==null?(e=null,cl):(e=u).stream,o):e},o.context=function(u){return arguments.length?(s=u==null?(t=null,new Hd(n)):new N_(t=u),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),o):r},o.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const c=Math.floor(u);if(!(c>=0))throw new RangeError(`invalid digits: ${u}`);n=c}return t===null&&(s=new Hd(n)),o},o.projection(e).digits(n).context(t)}function Oc(e){return function(t){var n=new vl;for(var r in e)n[r]=e[r];return n.stream=t,n}}function vl(){}vl.prototype={constructor:vl,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Mc(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Br(n,e.stream(ta)),t(ta.result()),r!=null&&e.clipExtent(r),e}function L_(e,t,n){return Mc(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([u,c])},n)}function IC(e,t,n){return L_(e,[[0,0],t],n)}function RC(e,t,n){return Mc(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([o,u])},n)}function SC(e,t,n){return Mc(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,u])},n)}var Gd=16,bC=St(30*ge);function Wd(e,t){return+t?PC(e,t):CC(e)}function CC(e){return Oc({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function PC(e,t){function n(r,i,s,o,u,c,l,h,d,p,g,_,E,v){var P=l-r,b=h-i,N=P*P+b*b;if(N>4*t&&E--){var x=o+p,M=u+g,U=c+_,I=Ir(x*x+M*M+U*U),w=ds(U/=I),T=vt(vt(U)-1)<dt||vt(s-d)<dt?(s+d)/2:fs(M,x),S=e(T,w),R=S[0],C=S[1],A=R-r,X=C-i,F=b*A-P*X;(F*F/N>t||vt((P*A+b*X)/N-.5)>.3||o*p+u*g+c*_<bC)&&(n(r,i,s,o,u,c,R,C,T,x/=I,M/=I,U,E,v),v.point(R,C),n(R,C,T,x,M,U,l,h,d,p,g,_,E,v))}}return function(r){var i,s,o,u,c,l,h,d,p,g,_,E,v={point:P,lineStart:b,lineEnd:x,polygonStart:function(){r.polygonStart(),v.lineStart=M},polygonEnd:function(){r.polygonEnd(),v.lineStart=b}};function P(w,T){w=e(w,T),r.point(w[0],w[1])}function b(){d=NaN,v.point=N,r.lineStart()}function N(w,T){var S=ti([w,T]),R=e(w,T);n(d,p,h,g,_,E,d=R[0],p=R[1],h=w,g=S[0],_=S[1],E=S[2],Gd,r),r.point(d,p)}function x(){v.point=P,r.lineEnd()}function M(){b(),v.point=U,v.lineEnd=I}function U(w,T){N(i=w,T),s=d,o=p,u=g,c=_,l=E,v.point=N}function I(){n(d,p,h,g,_,E,s,o,i,u,c,l,Gd,r),v.lineEnd=x,x()}return v}}var xC=Oc({point:function(e,t){this.stream.point(e*ge,t*ge)}});function VC(e){return Oc({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function NC(e,t,n,r,i){function s(o,u){return o*=r,u*=i,[t+e*o,n-e*u]}return s.invert=function(o,u){return[(o-t)/e*r,(n-u)/e*i]},s}function Kd(e,t,n,r,i,s){if(!s)return NC(e,t,n,r,i);var o=St(s),u=bt(s),c=o*e,l=u*e,h=o/e,d=u/e,p=(u*n-o*t)/e,g=(u*t+o*n)/e;function _(E,v){return E*=r,v*=i,[c*E-l*v+t,n-l*E-c*v]}return _.invert=function(E,v){return[r*(h*E-d*v+p),i*(g-d*E-h*v)]},_}function DC(e){return kC(function(){return e})()}function kC(e){var t,n=150,r=480,i=250,s=0,o=0,u=0,c=0,l=0,h,d=0,p=1,g=1,_=null,E=Ud,v=null,P,b,N,x=cl,M=.5,U,I,w,T,S;function R(F){return w(F[0]*ge,F[1]*ge)}function C(F){return F=w.invert(F[0],F[1]),F&&[F[0]*cn,F[1]*cn]}R.stream=function(F){return T&&S===F?T:T=xC(VC(h)(E(U(x(S=F)))))},R.preclip=function(F){return arguments.length?(E=F,_=void 0,X()):E},R.postclip=function(F){return arguments.length?(x=F,v=P=b=N=null,X()):x},R.clipAngle=function(F){return arguments.length?(E=+F?lC(_=F*ge):(_=null,Ud),X()):_*cn},R.clipExtent=function(F){return arguments.length?(x=F==null?(v=P=b=N=null,cl):hC(v=+F[0][0],P=+F[0][1],b=+F[1][0],N=+F[1][1]),X()):v==null?null:[[v,P],[b,N]]},R.scale=function(F){return arguments.length?(n=+F,A()):n},R.translate=function(F){return arguments.length?(r=+F[0],i=+F[1],A()):[r,i]},R.center=function(F){return arguments.length?(s=F[0]%360*ge,o=F[1]%360*ge,A()):[s*cn,o*cn]},R.rotate=function(F){return arguments.length?(u=F[0]%360*ge,c=F[1]%360*ge,l=F.length>2?F[2]%360*ge:0,A()):[u*cn,c*cn,l*cn]},R.angle=function(F){return arguments.length?(d=F%360*ge,A()):d*cn},R.reflectX=function(F){return arguments.length?(p=F?-1:1,A()):p<0},R.reflectY=function(F){return arguments.length?(g=F?-1:1,A()):g<0},R.precision=function(F){return arguments.length?(U=Wd(I,M=F*F),X()):Ir(M)},R.fitExtent=function(F,Y){return L_(R,F,Y)},R.fitSize=function(F,Y){return IC(R,F,Y)},R.fitWidth=function(F,Y){return RC(R,F,Y)},R.fitHeight=function(F,Y){return SC(R,F,Y)};function A(){var F=Kd(n,0,0,p,g,d).apply(null,t(s,o)),Y=Kd(n,r-F[0],i-F[1],p,g,d);return h=eC(u,c,l),I=ul(t,Y),w=ul(h,I),U=Wd(I,M),X()}function X(){return T=S=null,R}return function(){return t=e.apply(this,arguments),R.invert=t.invert&&C,A()}}function F_(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}F_.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(vt(i)>dt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function OC(){return DC(F_).scale(175.295)}function ji(e,t,n){this.k=e,this.x=t,this.y=n}ji.prototype={constructor:ji,scale:function(e){return e===1?this:new ji(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ji(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ji.prototype;function MC(e){return e}function LC(e){if(e==null)return MC;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(u,c){c||(t=n=0);var l=2,h=u.length,d=new Array(h);for(d[0]=(t+=u[0])*r+s,d[1]=(n+=u[1])*i+o;l<h;)d[l]=u[l],++l;return d}}function FC(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function Qd(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Xd(e,n)})}:Xd(e,t)}function Xd(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=UC(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function UC(e,t){var n=LC(e.transform),r=e.arcs;function i(h,d){d.length&&d.pop();for(var p=r[h<0?~h:h],g=0,_=p.length;g<_;++g)d.push(n(p[g],g));h<0&&FC(d,_)}function s(h){return n(h)}function o(h){for(var d=[],p=0,g=h.length;p<g;++p)i(h[p],d);return d.length<2&&d.push(d[0]),d}function u(h){for(var d=o(h);d.length<4;)d.push(d[0]);return d}function c(h){return h.map(u)}function l(h){var d=h.type,p;switch(d){case"GeometryCollection":return{type:d,geometries:h.geometries.map(l)};case"Point":p=s(h.coordinates);break;case"MultiPoint":p=h.coordinates.map(s);break;case"LineString":p=o(h.arcs);break;case"MultiLineString":p=h.arcs.map(o);break;case"Polygon":p=c(h.arcs);break;case"MultiPolygon":p=h.arcs.map(c);break;default:return null}return{type:d,coordinates:p}}return l(t)}async function BC(e,t,n,r,i,s,o,u,c){if($(t)){at(n,!0);try{const l=await It.get(`https://great-wave-api-1muq.onrender.com/api/images?q=${$(t)}`);at(r,l.data,!0);const h=$(r).map(p=>p.link).filter(Boolean);let d=[];if(h.length>0)try{d=(await It.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:h})).data,console.log("Geolocation API data:",d)}catch{}at(i,d.filter(p=>{if(p==null)return!1;const g=Number(p.lat),_=Number(p.lng);return!(isNaN(g)||isNaN(_)||g===0&&_===0)}),!0);try{await P1($(t)),at(s,await Ig(),!0),at(o,await Rg(5),!0),u(),c()}catch(p){console.warn("Firebase update failed:",p)}at(t,"")}catch(l){console.error("Error fetching images",l)}finally{at(n,!1)}}}var $C=Kn('<div class="loading-indicator svelte-1ve61ht">Loading...</div>'),qC=gs('<path fill="#ADC2CE" stroke="#377293" stroke-width="0.5"></path>'),jC=(e,t,n)=>{at(t,$(n).domain,!0),console.log("Pin Domain:",$(t))},zC=(e,t)=>at(t,null),HC=gs('<g class="location-pin svelte-1ve61ht"><circle class="pin svelte-1ve61ht"></circle></g>'),GC=gs(" <!>",1),WC=Kn('<svg width="200" height="125" viewBox="0 0 200 125" class="world-map svelte-1ve61ht"><!><!></svg> <p class="map-caption svelte-1ve61ht"><!></p>',1),KC=Kn("<p>Loading world map...</p>"),QC=(e,t,n,r)=>{at(t,n($(r).link),!0),console.log("Hovered Domain:",$(t))},XC=(e,t)=>at(t,null),YC=Kn('<div class="image-with-title svelte-1ve61ht"><a target="_blank" rel="noopener noreferrer"><img class="svelte-1ve61ht"/></a> <div class="image-title-box"><!></div></div>'),JC=Kn('<div class="image-container svelte-1ve61ht"></div>'),ZC=Kn('<div class="no-images-placeholder svelte-1ve61ht"><p>Your search results will appear here</p></div>'),tP=gs('<line stroke="#fff" stroke-opacity="0.6" stroke-width="2" class="svelte-1ve61ht"></line>'),eP=(e,t)=>console.log($(t).id),nP=gs('<text fill="steelblue" text-anchor="middle" alignment-baseline="middle" filter="url(#dropshadow)" class="svelte-1ve61ht"> </text>'),rP=Kn('<li class="svelte-1ve61ht"> <span class="count svelte-1ve61ht"> </span></li>'),iP=Kn(`<main class="svelte-1ve61ht"><!> <div class="header svelte-1ve61ht"><div class="header-image-crossfade svelte-1ve61ht"><img alt="Great Wave"/> <img alt="Tomoko Nagao Great Wave"/></div> <div><div class="title svelte-1ve61ht">GREAT WAVE <span style="color: #F0BF91;">REMIX</span></div> <p class="subtitle svelte-1ve61ht">Discover Hokusai's "Great Wave off Kanagawa" in diverse and unexpected
        contexts worldwide. Search for any term to see how this iconic artwork
        appears in images across various topics and countries.</p></div></div> <div class="header-piping svelte-1ve61ht"></div> <h1 class="svelte-1ve61ht">HOKUSAI'S <em class="italic svelte-1ve61ht">GREAT WAVE</em> CAN BE <input type="text" placeholder="ANYTHING" class="svelte-1ve61ht"/> <div class="search-container svelte-1ve61ht"><div class="button-wrapper svelte-1ve61ht"><button class="svelte-1ve61ht">Search</button></div> <div class="call-to-action svelte-1ve61ht">No images yet â try a search!</div></div></h1> <div class="main-grid svelte-1ve61ht"><div class="left-column svelte-1ve61ht"><div class="map-container svelte-1ve61ht"><!></div> <!></div> <div class="right-column svelte-1ve61ht"><div class="word-cloud-container svelte-1ve61ht"><h3 class="svelte-1ve61ht">Trending topics</h3> <svg width="100%" height="400" viewBox="0 0 400 400" class="svelte-1ve61ht"><defs><filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.3"></feDropShadow></filter></defs><g style="transform: translate(0, -100px)"><!><!></g></svg> <div class="trending-panel svelte-1ve61ht"><ul class="svelte-1ve61ht"></ul></div></div></div></div> <h2 class="svelte-1ve61ht">Google Ngram Viewer shows a steady rise in mentions of "Great Wave off
    Kanagawa"</h2> <div class="bottom-panel svelte-1ve61ht"><div class="chart-container svelte-1ve61ht"><iframe name="ngram_chart" src="https://books.google.com/ngrams/interactive_chart?content=Great+Wave+off+Kanagawa&amp;year_start=1800&amp;year_end=2022&amp;corpus=en&amp;smoothing=3" width="900" height="400" marginwidth="50" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" class="svelte-1ve61ht"></iframe></div></div></main>`);function sP(e,t){up(t,!0);let n=Lt(!1),r;const i=["/great-wave-everywhere/main-image.jpeg","/great-wave-everywhere/tomoko_nagao_hokusai-the_great_wave_of_kanagawa_with_mc_cupnoodle_kewpie_kikkoman_and_kitty_2012_digital_art_50_x_70_cm-_70_x_100_cm.jpe_3.jpg"];Au(()=>{r=setInterval(()=>{at(n,!$(n))},5e3)}),Tv(()=>{clearInterval(r)});function s(H){if(!H)return null;try{return H.replace(/^https?:\/\//,"").split("?")[0].replace(/\/$/,"")}catch{return null}}function o(H){if(!H)return null;try{const z=H.startsWith("http")?H:`https://${H}`;return new URL(z).hostname}catch{return H}}let u=Lt(null),c=Lt(ze([])),l=Lt(""),h=Lt(ze([])),d=Lt(ze([])),p=Lt(ze([])),g=Lt(!1),_=Lt(ze([])),E=Lt(null);async function v(){try{const H=await fetch("/great-wave-everywhere/ne_110m_admin_0_countries.json");if(!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const z=await H.json(),rt=Object.keys(z.objects)[0];at(E,Qd(z,z.objects[rt]),!0)}catch{try{const z=await fetch("/ne_110m_admin_0_countries.json");if(z.ok){const rt=await z.json(),Pt=Object.keys(rt.objects)[0];at(E,Qd(rt,rt.objects[Pt]),!0)}}catch{}}}Au(async()=>{at(g,!0);try{try{at(h,await Ig(),!0),at(p,await Rg(5),!0),P(),b()}catch(H){console.warn("Firebase connection failed:",H),at(h,[],!0),at(p,[],!0)}await v()}finally{at(g,!1)}});function P(){at(d,[],!0);for(let H=1;H<$(h).length;H++)$(d).push({source:$(h)[H-1].id,target:$(h)[H].id})}function b(){const H=Math.max(...$(h).map(z=>z.count));Qb($(h)).force("link",$b($(d)).id(z=>z.id).distance(25)).force("charge",Xb().strength(-100)).force("center",Ab(200,300)).force("gravity",Yb(z=>150*(1-z.count/H),200,300).strength(.5)).force("boundary",()=>{$(h).forEach(z=>{z.x=Math.max(20,Math.min(380,z.x||0)),z.y=Math.max(20,Math.min(580,z.y||0))})}).on("tick",()=>{at(h,[...$(h)],!0)})}function N(H){return $(h).find(z=>z.id===H)}function x(H){const z=N(H.source),rt=N(H.target);return{x1:(z==null?void 0:z.x)||0,y1:(z==null?void 0:z.y)||0,x2:(rt==null?void 0:rt.x)||0,y2:(rt==null?void 0:rt.y)||0}}var M=iP(),U=wt(M);{var I=H=>{var z=$C();Mt(H,z)};xn(U,H=>{$(g)&&H(I)})}var w=$t(U,2),T=wt(w),S=wt(T);let R;var C=$t(S,2);let A;var X=$t(w,4),F=$t(wt(X),3),Y=$t(F,2),lt=wt(Y),mt=wt(lt);mt.__click=[BC,l,g,c,_,h,p,P,b];var kt=$t(X,2),Ve=wt(kt),re=wt(Ve),Ot=wt(re);{var ct=H=>{var z=WC();const rt=js(()=>OC().scale(40).translate([100,62.5])),Pt=js(()=>AC().projection($(rt)));var de=Ci(z),Jt=wt(de);Or(Jt,17,()=>$(E).features,kr,(gt,we,Cr)=>{var Zn=Za();const Ne=js(()=>$(Pt)($(we)));var Be=Ci(Zn);{var Rn=Ee=>{var on=qC();qe(()=>Wt(on,"d",$(Ne))),Mt(Ee,on)},tr=Ee=>{var on=kh();qe(Te=>Pi(on,Te),[()=>{var Te;return console.log(`No path data for country ${Cr}:`,(Te=$(we).geometry)==null?void 0:Te.type)}]),Mt(Ee,on)};xn(Be,Ee=>{$(Ne)?Ee(Rn):Ee(tr,!1)})}Mt(gt,Zn)});var se=$t(Jt);{var Ue=gt=>{var we=Za(),Cr=Ci(we);Or(Cr,17,()=>$(_),kr,(Zn,Ne)=>{var Be=GC();const Rn=js(()=>$(rt)([$(Ne).lng,$(Ne).lat]));var tr=Ci(Be),Ee=$t(tr);{var on=Te=>{var Sn=HC();Sn.__mouseover=[jC,u,Ne],Sn.__mouseout=[zC,u];var er=wt(Sn);qe(()=>{Wt(er,"cx",$(Rn)[0]),Wt(er,"cy",$(Rn)[1]),Wt(er,"r",$(u)===$(Ne).domain?7:4),Wt(er,"fill",$(u)===$(Ne).domain?"#ff4500":"#ff6b35")}),Mt(Te,Sn)};xn(Ee,Te=>{$(Rn)&&Te(on)})}qe(Te=>Pi(tr,Te),[()=>console.log($(Ne))]),Mt(Zn,Be)}),Mt(gt,we)};xn(se,gt=>{$(_).length>0&&gt(Ue)})}var sn=$t(de,2),In=wt(sn);{var Tt=gt=>{var we=kh("Rollover to see server locations");Mt(gt,we)};xn(In,gt=>{$(_).length>0&&gt(Tt)})}Mt(H,z)},An=H=>{var z=KC();Mt(H,z)};xn(Ot,H=>{$(E)?H(ct):H(An,!1)})}var ie=$t(re,2);{var Da=H=>{var z=JC();Or(z,21,()=>$(c),kr,(rt,Pt)=>{var de=YC(),Jt=wt(de),se=wt(Jt);se.__mouseover=[QC,u,o,Pt],se.__mouseout=[XC,u];var Ue=$t(Jt,2),sn=wt(Ue);pv(sn,()=>`<textarea readonly rows='2'>${$(Pt).title}</textarea>`),qe((In,Tt)=>{Wt(Jt,"href",$(Pt).link),Wt(se,"src",$(Pt).link),Fh(se,`border: ${In??""};`),Fh(Ue,`background: ${Tt??""};`)},[()=>$(u)===o($(Pt).link)?"2px solid #ff6b35":"none",()=>$(u)===s($(Pt).link)?"#ffe5d0":"#f9f9f9"]),Mt(rt,de)}),Mt(H,z)},Rr=H=>{var z=ZC();Mt(H,z)};xn(ie,H=>{$(c).length>0?H(Da):H(Rr,!1)})}var ka=$t(Ve,2),Oa=wt(ka),Jn=$t(wt(Oa),2),Sr=$t(wt(Jn)),br=wt(Sr);Or(br,17,()=>$(d),kr,(H,z)=>{var rt=Za(),Pt=Ci(rt);{var de=Jt=>{var se=tP();qe((Ue,sn,In,Tt)=>{Wt(se,"x1",Ue),Wt(se,"y1",sn),Wt(se,"x2",In),Wt(se,"y2",Tt)},[()=>x($(z)).x1,()=>x($(z)).y1,()=>x($(z)).x2,()=>x($(z)).y2]),Mt(Jt,se)};xn(Pt,Jt=>{N($(z).source)&&N($(z).target)&&Jt(de)})}Mt(H,rt)});var di=$t(br);Or(di,17,()=>$(h),kr,(H,z)=>{var rt=nP();rt.__mouseover=[eP,z];var Pt=wt(rt);qe(()=>{Wt(rt,"x",$(z).x),Wt(rt,"y",$(z).y),Wt(rt,"font-size",`${10*$(z).count}px`),Pi(Pt,$(z).id)}),Mt(H,rt)});var pi=$t(Jn,2),mi=wt(pi);Or(mi,21,()=>$(p),kr,(H,z)=>{var rt=rP(),Pt=wt(rt),de=$t(Pt),Jt=wt(de);qe(()=>{Pi(Pt,`${$(z).id??""} `),Pi(Jt,`(${$(z).count??""})`)}),Mt(H,rt)}),qe((H,z)=>{Wt(S,"src",i[0]),R=Lh(S,1,"svelte-1ve61ht",null,R,H),Wt(C,"src",i[1]),A=Lh(C,1,"svelte-1ve61ht",null,A,z)},[()=>({visible:!$(n),hidden:$(n)}),()=>({visible:$(n),hidden:!$(n)})]),Ev(F,()=>$(l),H=>at(l,H)),Mt(e,M),lp()}sv(["click","mouseover","mouseout"]);av(sP,{target:document.getElementById("app")});
