var ay=Object.defineProperty;var uy=(e,t,n)=>t in e?ay(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ka=(e,t,n)=>uy(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Rh=!1;var yl=Array.isArray,ly=Array.prototype.indexOf,vl=Array.from,cy=Object.defineProperty,Bi=Object.getOwnPropertyDescriptor,hy=Object.getOwnPropertyDescriptors,fy=Object.prototype,dy=Array.prototype,Qd=Object.getPrototypeOf,Sh=Object.isExtensible;function py(e){for(var t=0;t<e.length;t++)e[t]()}const Ve=2,Xd=4,ta=8,wl=16,An=32,Jr=64,El=128,Ie=256,po=512,Ne=1024,gn=2048,wr=4096,pn=8192,Tl=16384,Yd=32768,Al=65536,bh=1<<17,my=1<<18,Jd=1<<19,_u=1<<20,Qa=Symbol("$state"),gy=Symbol(""),Zd=new class extends Error{constructor(){super(...arguments);Ka(this,"name","StaleReactionError");Ka(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function tp(e){return e===this.v}function _y(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ep(e){return!_y(e,this.v)}function yy(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function vy(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function wy(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Ey(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ty(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ay(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Iy(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Ry=!1;const Il=1,Rl=2,np=4,Sy=8,by=16,rp=1,Cy=2,le=Symbol(),Py="http://www.w3.org/1999/xhtml";function ip(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let de=null;function Ch(e){de=e}function sp(e,t=!1,n){var r=de={p:de,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};Ly(()=>{r.d=!0})}function op(e){const t=de;if(t!==null){const o=t.e;if(o!==null){var n=dt,r=ut;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];Fn(s.effect),en(s.reaction),mp(s.fn)}}finally{Fn(n),en(r)}}de=t.p,t.m=!0}return{}}function ap(){return!0}function He(e){if(typeof e!="object"||e===null||Qa in e)return e;const t=Qd(e);if(t!==fy&&t!==dy)return e;var n=new Map,r=yl(e),i=Mt(0),s=ut,o=u=>{var c=ut;en(s);var l=u();return en(c),l};return r&&n.set("length",Mt(e.length)),new Proxy(e,{defineProperty(u,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&Ty();var h=n.get(c);return h===void 0?h=o(()=>{var d=Mt(l.value);return n.set(c,d),d}):et(h,l.value,!0),!0},deleteProperty(u,c){var l=n.get(c);if(l===void 0){if(c in u){const p=o(()=>Mt(le));n.set(c,p),Xa(i)}}else{if(r&&typeof c=="string"){var h=n.get("length"),d=Number(c);Number.isInteger(d)&&d<h.v&&et(h,d)}et(l,le),Xa(i)}return!0},get(u,c,l){var g;if(c===Qa)return e;var h=n.get(c),d=c in u;if(h===void 0&&(!d||(g=Bi(u,c))!=null&&g.writable)&&(h=o(()=>{var _=He(d?u[c]:le),E=Mt(_);return E}),n.set(c,h)),h!==void 0){var p=B(h);return p===le?void 0:p}return Reflect.get(u,c,l)},getOwnPropertyDescriptor(u,c){var l=Reflect.getOwnPropertyDescriptor(u,c);if(l&&"value"in l){var h=n.get(c);h&&(l.value=B(h))}else if(l===void 0){var d=n.get(c),p=d==null?void 0:d.v;if(d!==void 0&&p!==le)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return l},has(u,c){var p;if(c===Qa)return!0;var l=n.get(c),h=l!==void 0&&l.v!==le||Reflect.has(u,c);if(l!==void 0||dt!==null&&(!h||(p=Bi(u,c))!=null&&p.writable)){l===void 0&&(l=o(()=>{var g=h?He(u[c]):le,_=Mt(g);return _}),n.set(c,l));var d=B(l);if(d===le)return!1}return h},set(u,c,l,h){var N;var d=n.get(c),p=c in u;if(r&&c==="length")for(var g=l;g<d.v;g+=1){var _=n.get(g+"");_!==void 0?et(_,le):g in u&&(_=o(()=>Mt(le)),n.set(g+"",_))}if(d===void 0)(!p||(N=Bi(u,c))!=null&&N.writable)&&(d=o(()=>Mt(void 0)),et(d,He(l)),n.set(c,d));else{p=d.v!==le;var E=o(()=>He(l));et(d,E)}var v=Reflect.getOwnPropertyDescriptor(u,c);if(v!=null&&v.set&&v.set.call(h,l),!p){if(r&&typeof c=="string"){var b=n.get("length"),C=Number(c);Number.isInteger(C)&&C>=b.v&&et(b,C+1)}Xa(i)}return!0},ownKeys(u){B(i);var c=Reflect.ownKeys(u).filter(d=>{var p=n.get(d);return p===void 0||p.v!==le});for(var[l,h]of n)h.v!==le&&!(l in u)&&c.push(l);return c},setPrototypeOf(){Ay()}})}function Xa(e,t=1){et(e,e.v+t)}function Sl(e){var t=Ve|gn,n=ut!==null&&(ut.f&Ve)!==0?ut:null;return dt===null||n!==null&&(n.f&Ie)!==0?t|=Ie:dt.f|=Jd,{ctx:de,deps:null,effects:null,equals:tp,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??dt,ac:null}}function Us(e){const t=Sl(e);return Ap(t),t}function xy(e){const t=Sl(e);return t.equals=ep,t}function up(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Mn(t[n])}}function Vy(e){for(var t=e.parent;t!==null;){if((t.f&Ve)===0)return t;t=t.parent}return null}function lp(e){var t,n=dt;Fn(Vy(e));try{up(e),t=bp(e)}finally{Fn(n)}return t}function cp(e){var t=lp(e);if(e.equals(t)||(e.v=t,e.wv=Rp()),!ti){var n=(xn||(e.f&Ie)!==0)&&e.deps!==null?wr:Ne;nn(e,n)}}const Gi=new Map;function mo(e,t){var n={f:0,v:e,reactions:null,equals:tp,rv:0,wv:0};return n}function Mt(e,t){const n=mo(e);return Ap(n),n}function Ny(e,t=!1,n=!0){const r=mo(e);return t||(r.equals=ep),r}function et(e,t,n=!1){ut!==null&&(!Ge||(ut.f&bh)!==0)&&ap()&&(ut.f&(Ve|wl|bh))!==0&&!(jt!=null&&jt[1].includes(e)&&jt[0]===ut)&&Iy();let r=n?He(t):t;return yu(e,r)}function yu(e,t){if(!e.equals(t)){var n=e.v;ti?Gi.set(e,t):Gi.set(e,n),e.v=t,(e.f&Ve)!==0&&((e.f&gn)!==0&&lp(e),nn(e,(e.f&Ie)===0?Ne:wr)),e.wv=Rp(),hp(e,gn),dt!==null&&(dt.f&Ne)!==0&&(dt.f&(An|Jr))===0&&(Se===null?Gy([e]):Se.push(e))}return t}function hp(e,t){var n=e.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i],o=s.f;(o&gn)===0&&(nn(s,t),(o&(Ne|Ie))!==0&&((o&Ve)!==0?hp(s,wr):xl(s)))}}let Dy=!1;var Ph,fp,dp,pp;function ky(){if(Ph===void 0){Ph=window,fp=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;dp=Bi(t,"firstChild").get,pp=Bi(t,"nextSibling").get,Sh(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Sh(n)&&(n.__t=void 0)}}function ea(e=""){return document.createTextNode(e)}function Te(e){return dp.call(e)}function na(e){return pp.call(e)}function Tt(e,t){return Te(e)}function Ri(e,t){{var n=Te(e);return n instanceof Comment&&n.data===""?na(n):n}}function Bt(e,t=1,n=!1){let r=e;for(;t--;)r=na(r);return r}function Oy(e){e.textContent=""}function My(e){dt===null&&ut===null&&wy(),ut!==null&&(ut.f&Ie)!==0&&dt===null&&vy(),ti&&yy()}function Fy(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Zr(e,t,n,r=!0){var i=dt,s={ctx:de,deps:null,nodes_start:null,nodes_end:null,f:e|gn,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Pl(s),s.f|=Yd}catch(c){throw Mn(s),c}else t!==null&&xl(s);var o=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(Jd|El))===0;if(!o&&r&&(i!==null&&Fy(s,i),ut!==null&&(ut.f&Ve)!==0)){var u=ut;(u.effects??(u.effects=[])).push(s)}return s}function Ly(e){const t=Zr(ta,null,!1);return nn(t,Ne),t.teardown=e,t}function Uy(e){My();var t=dt!==null&&(dt.f&An)!==0&&de!==null&&!de.m;if(t){var n=de;(n.e??(n.e=[])).push({fn:e,effect:dt,reaction:ut})}else{var r=mp(e);return r}}function By(e){const t=Zr(Jr,e,!0);return(n={})=>new Promise(r=>{n.outro?go(t,()=>{Mn(t),r(void 0)}):(Mn(t),r(void 0))})}function mp(e){return Zr(Xd,e,!1)}function $y(e){return Zr(ta,e,!0)}function Fe(e,t=[],n=Sl){const r=t.map(n);return bl(()=>e(...r.map(B)))}function bl(e,t=0){var n=Zr(ta|wl|t,e,!0);return n}function Wi(e,t=!0){return Zr(ta|An,e,!0,t)}function gp(e){var t=e.teardown;if(t!==null){const n=ti,r=ut;xh(!0),en(null);try{t.call(null)}finally{xh(n),en(r)}}}function _p(e,t=!1){var i;var n=e.first;for(e.first=e.last=null;n!==null;){(i=n.ac)==null||i.abort(Zd);var r=n.next;(n.f&Jr)!==0?n.parent=null:Mn(n,t),n=r}}function qy(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&An)===0&&Mn(t),t=n}}function Mn(e,t=!0){var n=!1;(t||(e.f&my)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(yp(e.nodes_start,e.nodes_end),n=!0),_p(e,t&&!n),Eo(e,0),nn(e,Tl);var r=e.transitions;if(r!==null)for(const s of r)s.stop();gp(e);var i=e.parent;i!==null&&i.first!==null&&vp(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function yp(e,t){for(;e!==null;){var n=e===t?null:na(e);e.remove(),e=n}}function vp(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function go(e,t){var n=[];Cl(e,n,!0),wp(n,()=>{Mn(e),t&&t()})}function wp(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Cl(e,t,n){if((e.f&pn)===0){if(e.f^=pn,e.transitions!==null)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&Al)!==0||(r.f&An)!==0;Cl(r,t,s?n:!1),r=i}}}function _o(e){Ep(e,!0)}function Ep(e,t){if((e.f&pn)!==0){e.f^=pn;for(var n=e.first;n!==null;){var r=n.next,i=(n.f&Al)!==0||(n.f&An)!==0;Ep(n,i?t:!1),n=r}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let yo=[];function jy(){var e=yo;yo=[],py(e)}function zy(e){yo.length===0&&queueMicrotask(jy),yo.push(e)}function Hy(e){var t=dt;if((t.f&Yd)===0){if((t.f&El)===0)throw e;t.fn(e)}else Tp(e,t)}function Tp(e,t){for(;t!==null;){if((t.f&El)!==0)try{t.b.error(e);return}catch{}t=t.parent}throw e}let vu=!1,vo=null,lr=!1,ti=!1;function xh(e){ti=e}let Zs=[];let ut=null,Ge=!1;function en(e){ut=e}let dt=null;function Fn(e){dt=e}let jt=null;function Ap(e){ut!==null&&ut.f&_u&&(jt===null?jt=[ut,[e]]:jt[1].push(e))}let se=null,we=0,Se=null;function Gy(e){Se=e}let Ip=1,wo=0,xn=!1;function Rp(){return++Ip}function ra(e){var d;var t=e.f;if((t&gn)!==0)return!0;if((t&wr)!==0){var n=e.deps,r=(t&Ie)!==0;if(n!==null){var i,s,o=(t&po)!==0,u=r&&dt!==null&&!xn,c=n.length;if(o||u){var l=e,h=l.parent;for(i=0;i<c;i++)s=n[i],(o||!((d=s==null?void 0:s.reactions)!=null&&d.includes(l)))&&(s.reactions??(s.reactions=[])).push(l);o&&(l.f^=po),u&&h!==null&&(h.f&Ie)===0&&(l.f^=Ie)}for(i=0;i<c;i++)if(s=n[i],ra(s)&&cp(s),s.wv>e.wv)return!0}(!r||dt!==null&&!xn)&&nn(e,Ne)}return!1}function Sp(e,t,n=!0){var r=e.reactions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];jt!=null&&jt[1].includes(e)&&jt[0]===ut||((s.f&Ve)!==0?Sp(s,t,!1):t===s&&(n?nn(s,gn):(s.f&Ne)!==0&&nn(s,wr),xl(s)))}}function bp(e){var g;var t=se,n=we,r=Se,i=ut,s=xn,o=jt,u=de,c=Ge,l=e.f;se=null,we=0,Se=null,xn=(l&Ie)!==0&&(Ge||!lr||ut===null),ut=(l&(An|Jr))===0?e:null,jt=null,Ch(e.ctx),Ge=!1,wo++,e.f|=_u,e.ac!==null&&(e.ac.abort(Zd),e.ac=null);try{var h=(0,e.fn)(),d=e.deps;if(se!==null){var p;if(Eo(e,we),d!==null&&we>0)for(d.length=we+se.length,p=0;p<se.length;p++)d[we+p]=se[p];else e.deps=d=se;if(!xn||(l&Ve)!==0&&e.reactions!==null)for(p=we;p<d.length;p++)((g=d[p]).reactions??(g.reactions=[])).push(e)}else d!==null&&we<d.length&&(Eo(e,we),d.length=we);if(ap()&&Se!==null&&!Ge&&d!==null&&(e.f&(Ve|wr|gn))===0)for(p=0;p<Se.length;p++)Sp(Se[p],e);return i!==null&&i!==e&&(wo++,Se!==null&&(r===null?r=Se:r.push(...Se))),h}catch(_){Hy(_)}finally{se=t,we=n,Se=r,ut=i,xn=s,jt=o,Ch(u),Ge=c,e.f^=_u}}function Wy(e,t){let n=t.reactions;if(n!==null){var r=ly.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&Ve)!==0&&(se===null||!se.includes(t))&&(nn(t,wr),(t.f&(Ie|po))===0&&(t.f^=po),up(t),Eo(t,0))}function Eo(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Wy(e,n[r])}function Pl(e){var t=e.f;if((t&Tl)===0){nn(e,Ne);var n=dt,r=lr;dt=e,lr=!0;try{(t&wl)!==0?qy(e):_p(e),gp(e);var i=bp(e);e.teardown=typeof i=="function"?i:null,e.wv=Ip;var s;Rh&&Ry&&(e.f&gn)!==0&&e.deps}finally{lr=r,dt=n}}}function Ky(){try{Ey()}catch(e){if(vo!==null)Tp(e,vo);else throw e}}function Qy(){var e=lr;try{var t=0;for(lr=!0;Zs.length>0;){t++>1e3&&Ky();var n=Zs,r=n.length;Zs=[];for(var i=0;i<r;i++){var s=Yy(n[i]);Xy(s)}Gi.clear()}}finally{vu=!1,lr=e,vo=null}}function Xy(e){var t=e.length;if(t!==0)for(var n=0;n<t;n++){var r=e[n];(r.f&(Tl|pn))===0&&ra(r)&&(Pl(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?vp(r):r.fn=null))}}function xl(e){vu||(vu=!0,queueMicrotask(Qy));for(var t=vo=e;t.parent!==null;){t=t.parent;var n=t.f;if((n&(Jr|An))!==0){if((n&Ne)===0)return;t.f^=Ne}}Zs.push(t)}function Yy(e){for(var t=[],n=e;n!==null;){var r=n.f,i=(r&(An|Jr))!==0,s=i&&(r&Ne)!==0;if(!s&&(r&pn)===0){(r&Xd)!==0?t.push(n):i?n.f^=Ne:ra(n)&&Pl(n);var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return t}function B(e){var t=e.f,n=(t&Ve)!==0;if(ut!==null&&!Ge){if(!(jt!=null&&jt[1].includes(e))||jt[0]!==ut){var r=ut.deps;e.rv<wo&&(e.rv=wo,se===null&&r!==null&&r[we]===e?we++:se===null?se=[e]:(!xn||!se.includes(e))&&se.push(e))}}else if(n&&e.deps===null&&e.effects===null){var i=e,s=i.parent;s!==null&&(s.f&Ie)===0&&(i.f^=Ie)}return n&&(i=e,ra(i)&&cp(i)),ti&&Gi.has(e)?Gi.get(e):e.v}function Vl(e){var t=Ge;try{return Ge=!0,e()}finally{Ge=t}}const Jy=-7169;function nn(e,t){e.f=e.f&Jy|t}const Zy=["touchstart","touchmove"];function tv(e){return Zy.includes(e)}let Vh=!1;function ev(){Vh||(Vh=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function nv(e){var t=ut,n=dt;en(null),Fn(null);try{return e()}finally{en(t),Fn(n)}}function rv(e,t,n,r=n){e.addEventListener(t,()=>nv(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),ev()}const Cp=new Set,wu=new Set;function iv(e){for(var t=0;t<e.length;t++)Cp.add(e[t]);for(var n of wu)n(e)}function Bs(e){var C;var t=this,n=t.ownerDocument,r=e.type,i=((C=e.composedPath)==null?void 0:C.call(e))||[],s=i[0]||e.target,o=0,u=e.__root;if(u){var c=i.indexOf(u);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var l=i.indexOf(t);if(l===-1)return;c<=l&&(o=c)}if(s=i[o]||e.target,s!==t){cy(e,"currentTarget",{configurable:!0,get(){return s||n}});var h=ut,d=dt;en(null),Fn(null);try{for(var p,g=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+r];if(E!=null&&(!s.disabled||e.target===s))if(yl(E)){var[v,...b]=E;v.apply(s,[e,...b])}else E.call(s,e)}catch(N){p?g.push(N):p=N}if(e.cancelBubble||_===t||_===null)break;s=_}if(p){for(let N of g)queueMicrotask(()=>{throw N});throw p}}finally{e.__root=t,delete e.currentTarget,en(h),Fn(d)}}}function Nl(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function dr(e,t){var n=dt;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function Hn(e,t){var n=(t&rp)!==0,r=(t&Cy)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=Nl(s?e:"<!>"+e),n||(i=Te(i)));var o=r||fp?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=Te(o),c=o.lastChild;dr(u,c)}else dr(o,o);return o}}function sv(e,t,n="svg"){var r=!e.startsWith("<!>"),i=(t&rp)!==0,s=`<${n}>${r?e:"<!>"+e}</${n}>`,o;return()=>{if(!o){var u=Nl(s),c=Te(u);if(i)for(o=document.createDocumentFragment();Te(c);)o.appendChild(Te(c));else o=Te(c)}var l=o.cloneNode(!0);if(i){var h=Te(l),d=l.lastChild;dr(h,d)}else dr(l,l);return l}}function ei(e,t){return sv(e,t,"svg")}function ov(e=""){{var t=ea(e+"");return dr(t,t),t}}function Ya(){var e=document.createDocumentFragment(),t=document.createComment(""),n=ea();return e.append(t,n),dr(t,n),e}function $t(e,t){e!==null&&e.before(t)}function xr(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function av(e,t){return uv(e,t)}const Vr=new Map;function uv(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:o=!0}){ky();var u=new Set,c=d=>{for(var p=0;p<d.length;p++){var g=d[p];if(!u.has(g)){u.add(g);var _=tv(g);t.addEventListener(g,Bs,{passive:_});var E=Vr.get(g);E===void 0?(document.addEventListener(g,Bs,{passive:_}),Vr.set(g,1)):Vr.set(g,E+1)}}};c(vl(Cp)),wu.add(c);var l=void 0,h=By(()=>{var d=n??t.appendChild(ea());return Wi(()=>{if(s){sp({});var p=de;p.c=s}i&&(r.$$events=i),l=e(d,r)||{},s&&op()}),()=>{var _;for(var p of u){t.removeEventListener(p,Bs);var g=Vr.get(p);--g===0?(document.removeEventListener(p,Bs),Vr.delete(p)):Vr.set(p,g)}wu.delete(c),d!==n&&((_=d.parentNode)==null||_.removeChild(d))}});return lv.set(l,h),l}let lv=new WeakMap;function ln(e,t,[n,r]=[0,0]){var i=e,s=null,o=null,u=le,c=n>0?Al:0,l=!1;const h=(p,g=!0)=>{l=!0,d(g,p)},d=(p,g)=>{u!==(u=p)&&(u?(s?_o(s):g&&(s=Wi(()=>g(i))),o&&go(o,()=>{o=null})):(o?_o(o):g&&(o=Wi(()=>g(i,[n+1,r]))),s&&go(s,()=>{s=null})))};bl(()=>{l=!1,t(h),l||d(null,null)},c)}function rr(e,t){return t}function cv(e,t,n,r){for(var i=[],s=t.length,o=0;o<s;o++)Cl(t[o].e,i,!0);var u=s>0&&i.length===0&&n!==null;if(u){var c=n.parentNode;Oy(c),c.append(n),r.clear(),Cn(e,t[0].prev,t[s-1].next)}wp(i,()=>{for(var l=0;l<s;l++){var h=t[l];u||(r.delete(h.k),Cn(e,h.prev,h.next)),Mn(h.e,!u)}})}function ir(e,t,n,r,i,s=null){var o=e,u={flags:t,items:new Map,first:null},c=(t&np)!==0;if(c){var l=e;o=l.appendChild(ea())}var h=null,d=!1,p=xy(()=>{var g=n();return yl(g)?g:g==null?[]:vl(g)});bl(()=>{var g=B(p),_=g.length;d&&_===0||(d=_===0,hv(g,u,o,i,t,r,n),s!==null&&(_===0?h?_o(h):h=Wi(()=>s(o)):h!==null&&go(h,()=>{h=null})),B(p))})}function hv(e,t,n,r,i,s,o){var X,L,J,ct;var u=(i&Sy)!==0,c=(i&(Il|Rl))!==0,l=e.length,h=t.items,d=t.first,p=d,g,_=null,E,v=[],b=[],C,N,x,M;if(u)for(M=0;M<l;M+=1)C=e[M],N=s(C,M),x=h.get(N),x!==void 0&&((X=x.a)==null||X.measure(),(E??(E=new Set)).add(x));for(M=0;M<l;M+=1){if(C=e[M],N=s(C,M),x=h.get(N),x===void 0){var U=p?p.e.nodes_start:n;_=dv(U,t,_,_===null?t.first:_.next,C,N,M,r,i,o),h.set(N,_),v=[],b=[],p=_.next;continue}if(c&&fv(x,C,M,i),(x.e.f&pn)!==0&&(_o(x.e),u&&((L=x.a)==null||L.unfix(),(E??(E=new Set)).delete(x))),x!==p){if(g!==void 0&&g.has(x)){if(v.length<b.length){var I=b[0],w;_=I.prev;var T=v[0],S=v[v.length-1];for(w=0;w<v.length;w+=1)Nh(v[w],I,n);for(w=0;w<b.length;w+=1)g.delete(b[w]);Cn(t,T.prev,S.next),Cn(t,_,T),Cn(t,S,I),p=I,_=S,M-=1,v=[],b=[]}else g.delete(x),Nh(x,p,n),Cn(t,x.prev,x.next),Cn(t,x,_===null?t.first:_.next),Cn(t,_,x),_=x;continue}for(v=[],b=[];p!==null&&p.k!==N;)(p.e.f&pn)===0&&(g??(g=new Set)).add(p),b.push(p),p=p.next;if(p===null)continue;x=p}v.push(x),_=x,p=x.next}if(p!==null||g!==void 0){for(var R=g===void 0?[]:vl(g);p!==null;)(p.e.f&pn)===0&&R.push(p),p=p.next;var P=R.length;if(P>0){var A=(i&np)!==0&&l===0?n:null;if(u){for(M=0;M<P;M+=1)(J=R[M].a)==null||J.measure();for(M=0;M<P;M+=1)(ct=R[M].a)==null||ct.fix()}cv(t,R,A,h)}}u&&zy(()=>{var _t;if(E!==void 0)for(x of E)(_t=x.a)==null||_t.apply()}),dt.first=t.first&&t.first.e,dt.last=_&&_.e}function fv(e,t,n,r){(r&Il)!==0&&yu(e.v,t),(r&Rl)!==0?yu(e.i,n):e.i=n}function dv(e,t,n,r,i,s,o,u,c,l){var h=(c&Il)!==0,d=(c&by)===0,p=h?d?Ny(i,!1,!1):mo(i):i,g=(c&Rl)===0?o:mo(o),_={i:g,v:p,k:s,a:null,e:null,prev:n,next:r};try{return _.e=Wi(()=>u(e,p,g,l),Dy),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function Nh(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var o=na(s);i.before(s),s=o}}function Cn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function pv(e,t,n=!1,r=!1,i=!1){var s=e,o="";Fe(()=>{var u=dt;if(o!==(o=t()??"")&&(u.nodes_start!==null&&(yp(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),o!=="")){var c=o+"";n?c=`<svg>${c}</svg>`:r&&(c=`<math>${c}</math>`);var l=Nl(c);if((n||r)&&(l=Te(l)),dr(Te(l),l.lastChild),n||r)for(;Te(l);)s.before(Te(l));else s.before(l)}})}const Dh=[...` 	
\r\fÂ \v\uFEFF`];function mv(e,t,n){var r=""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,o=0;(o=r.indexOf(i,o))>=0;){var u=o+s;(o===0||Dh.includes(r[o-1]))&&(u===r.length||Dh.includes(r[u]))?r=(o===0?"":r.substring(0,o))+r.substring(u+1):o=u}}return r===""?null:r}function gv(e,t){return e==null?null:String(e)}function _v(e,t,n,r,i,s){var o=e.__className;if(o!==n||o===void 0){var u=mv(n,r,s);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(s&&i!==s)for(var c in s){var l=!!s[c];(i==null||l!==!!i[c])&&e.classList.toggle(c,l)}return s}function yv(e,t,n,r){var i=e.__style;if(i!==t){var s=gv(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return r}const vv=Symbol("is custom element"),wv=Symbol("is html");function ie(e,t,n,r){var i=Ev(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[gy]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Tv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Ev(e){return e.__attributes??(e.__attributes={[vv]:e.nodeName.includes("-"),[wv]:e.namespaceURI===Py})}var kh=new Map;function Tv(e){var t=kh.get(e.nodeName);if(t)return t;kh.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=hy(r);for(var s in n)n[s].set&&t.push(s);r=Qd(r)}return t}function Av(e,t,n=t){rv(e,"input",r=>{var i=r?e.defaultValue:e.value;if(i=Ja(e)?Za(i):i,n(i),i!==(i=t())){var s=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(o,e.value.length))}}),Vl(t)==null&&e.value&&n(Ja(e)?Za(e.value):e.value),$y(()=>{var r=t();Ja(e)&&r===Za(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Ja(e){var t=e.type;return t==="number"||t==="range"}function Za(e){return e===""?null:+e}function Eu(e){de===null&&ip(),Uy(()=>{const t=Vl(e);if(typeof t=="function")return t})}function Iv(e){de===null&&ip(),Eu(()=>()=>Vl(e))}const Rv="5";var Kd;typeof window<"u"&&((Kd=window.__svelte??(window.__svelte={})).v??(Kd.v=new Set)).add(Rv);function Pp(e,t){return function(){return e.apply(t,arguments)}}const{toString:Sv}=Object.prototype,{getPrototypeOf:Dl}=Object,{iterator:ia,toStringTag:xp}=Symbol,sa=(e=>t=>{const n=Sv.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),$e=e=>(e=e.toLowerCase(),t=>sa(t)===e),oa=e=>t=>typeof t===e,{isArray:ni}=Array,Ki=oa("undefined");function bv(e){return e!==null&&!Ki(e)&&e.constructor!==null&&!Ki(e.constructor)&&pe(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Vp=$e("ArrayBuffer");function Cv(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Vp(e.buffer),t}const Pv=oa("string"),pe=oa("function"),Np=oa("number"),aa=e=>e!==null&&typeof e=="object",xv=e=>e===!0||e===!1,to=e=>{if(sa(e)!=="object")return!1;const t=Dl(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(xp in e)&&!(ia in e)},Vv=$e("Date"),Nv=$e("File"),Dv=$e("Blob"),kv=$e("FileList"),Ov=e=>aa(e)&&pe(e.pipe),Mv=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||pe(e.append)&&((t=sa(e))==="formdata"||t==="object"&&pe(e.toString)&&e.toString()==="[object FormData]"))},Fv=$e("URLSearchParams"),[Lv,Uv,Bv,$v]=["ReadableStream","Request","Response","Headers"].map($e),qv=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fs(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),ni(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],t.call(null,e[u],u,e)}}function Dp(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const or=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,kp=e=>!Ki(e)&&e!==or;function Tu(){const{caseless:e}=kp(this)&&this||{},t={},n=(r,i)=>{const s=e&&Dp(t,i)||i;to(t[s])&&to(r)?t[s]=Tu(t[s],r):to(r)?t[s]=Tu({},r):ni(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&fs(arguments[r],n);return t}const jv=(e,t,n,{allOwnKeys:r}={})=>(fs(t,(i,s)=>{n&&pe(i)?e[s]=Pp(i,n):e[s]=i},{allOwnKeys:r}),e),zv=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Hv=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Gv=(e,t,n,r)=>{let i,s,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&Dl(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Wv=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},Kv=e=>{if(!e)return null;if(ni(e))return e;let t=e.length;if(!Np(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Qv=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Dl(Uint8Array)),Xv=(e,t)=>{const r=(e&&e[ia]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},Yv=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Jv=$e("HTMLFormElement"),Zv=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Oh=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),t0=$e("RegExp"),Op=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};fs(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},e0=e=>{Op(e,(t,n)=>{if(pe(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(pe(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},n0=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return ni(e)?r(e):r(String(e).split(t)),n},r0=()=>{},i0=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function s0(e){return!!(e&&pe(e.append)&&e[xp]==="FormData"&&e[ia])}const o0=e=>{const t=new Array(10),n=(r,i)=>{if(aa(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=ni(r)?[]:{};return fs(r,(o,u)=>{const c=n(o,i+1);!Ki(c)&&(s[u]=c)}),t[i]=void 0,s}}return r};return n(e,0)},a0=$e("AsyncFunction"),u0=e=>e&&(aa(e)||pe(e))&&pe(e.then)&&pe(e.catch),Mp=((e,t)=>e?setImmediate:t?((n,r)=>(or.addEventListener("message",({source:i,data:s})=>{i===or&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),or.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",pe(or.postMessage)),l0=typeof queueMicrotask<"u"?queueMicrotask.bind(or):typeof process<"u"&&process.nextTick||Mp,c0=e=>e!=null&&pe(e[ia]),D={isArray:ni,isArrayBuffer:Vp,isBuffer:bv,isFormData:Mv,isArrayBufferView:Cv,isString:Pv,isNumber:Np,isBoolean:xv,isObject:aa,isPlainObject:to,isReadableStream:Lv,isRequest:Uv,isResponse:Bv,isHeaders:$v,isUndefined:Ki,isDate:Vv,isFile:Nv,isBlob:Dv,isRegExp:t0,isFunction:pe,isStream:Ov,isURLSearchParams:Fv,isTypedArray:Qv,isFileList:kv,forEach:fs,merge:Tu,extend:jv,trim:qv,stripBOM:zv,inherits:Hv,toFlatObject:Gv,kindOf:sa,kindOfTest:$e,endsWith:Wv,toArray:Kv,forEachEntry:Xv,matchAll:Yv,isHTMLForm:Jv,hasOwnProperty:Oh,hasOwnProp:Oh,reduceDescriptors:Op,freezeMethods:e0,toObjectSet:n0,toCamelCase:Zv,noop:r0,toFiniteNumber:i0,findKey:Dp,global:or,isContextDefined:kp,isSpecCompliantForm:s0,toJSONObject:o0,isAsyncFn:a0,isThenable:u0,setImmediate:Mp,asap:l0,isIterable:c0};function Z(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}D.inherits(Z,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const Fp=Z.prototype,Lp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Lp[e]={value:e}});Object.defineProperties(Z,Lp);Object.defineProperty(Fp,"isAxiosError",{value:!0});Z.from=(e,t,n,r,i,s)=>{const o=Object.create(Fp);return D.toFlatObject(e,o,function(c){return c!==Error.prototype},u=>u!=="isAxiosError"),Z.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const h0=null;function Au(e){return D.isPlainObject(e)||D.isArray(e)}function Up(e){return D.endsWith(e,"[]")?e.slice(0,-2):e}function Mh(e,t,n){return e?e.concat(t).map(function(i,s){return i=Up(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function f0(e){return D.isArray(e)&&!e.some(Au)}const d0=D.toFlatObject(D,{},null,function(t){return/^is[A-Z]/.test(t)});function ua(e,t,n){if(!D.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=D.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,v){return!D.isUndefined(v[E])});const r=n.metaTokens,i=n.visitor||h,s=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(i))throw new TypeError("visitor must be a function");function l(_){if(_===null)return"";if(D.isDate(_))return _.toISOString();if(D.isBoolean(_))return _.toString();if(!c&&D.isBlob(_))throw new Z("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(_)||D.isTypedArray(_)?c&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,E,v){let b=_;if(_&&!v&&typeof _=="object"){if(D.endsWith(E,"{}"))E=r?E:E.slice(0,-2),_=JSON.stringify(_);else if(D.isArray(_)&&f0(_)||(D.isFileList(_)||D.endsWith(E,"[]"))&&(b=D.toArray(_)))return E=Up(E),b.forEach(function(N,x){!(D.isUndefined(N)||N===null)&&t.append(o===!0?Mh([E],x,s):o===null?E:E+"[]",l(N))}),!1}return Au(_)?!0:(t.append(Mh(v,E,s),l(_)),!1)}const d=[],p=Object.assign(d0,{defaultVisitor:h,convertValue:l,isVisitable:Au});function g(_,E){if(!D.isUndefined(_)){if(d.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));d.push(_),D.forEach(_,function(b,C){(!(D.isUndefined(b)||b===null)&&i.call(t,b,D.isString(C)?C.trim():C,E,p))===!0&&g(b,E?E.concat(C):[C])}),d.pop()}}if(!D.isObject(e))throw new TypeError("data must be an object");return g(e),t}function Fh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function kl(e,t){this._pairs=[],e&&ua(e,this,t)}const Bp=kl.prototype;Bp.append=function(t,n){this._pairs.push([t,n])};Bp.toString=function(t){const n=t?function(r){return t.call(this,r,Fh)}:Fh;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function p0(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $p(e,t,n){if(!t)return e;const r=n&&n.encode||p0;D.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=D.isURLSearchParams(t)?t.toString():new kl(t,n).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Lh{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){D.forEach(this.handlers,function(r){r!==null&&t(r)})}}const qp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},m0=typeof URLSearchParams<"u"?URLSearchParams:kl,g0=typeof FormData<"u"?FormData:null,_0=typeof Blob<"u"?Blob:null,y0={isBrowser:!0,classes:{URLSearchParams:m0,FormData:g0,Blob:_0},protocols:["http","https","file","blob","url","data"]},Ol=typeof window<"u"&&typeof document<"u",Iu=typeof navigator=="object"&&navigator||void 0,v0=Ol&&(!Iu||["ReactNative","NativeScript","NS"].indexOf(Iu.product)<0),w0=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",E0=Ol&&window.location.href||"http://localhost",T0=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ol,hasStandardBrowserEnv:v0,hasStandardBrowserWebWorkerEnv:w0,navigator:Iu,origin:E0},Symbol.toStringTag,{value:"Module"})),ne={...T0,...y0};function A0(e,t){return ua(e,new ne.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return ne.isNode&&D.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function I0(e){return D.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function R0(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function jp(e){function t(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),c=s>=n.length;return o=!o&&D.isArray(i)?i.length:o,c?(D.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!D.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],s)&&D.isArray(i[o])&&(i[o]=R0(i[o])),!u)}if(D.isFormData(e)&&D.isFunction(e.entries)){const n={};return D.forEachEntry(e,(r,i)=>{t(I0(r),i,n,0)}),n}return null}function S0(e,t,n){if(D.isString(e))try{return(t||JSON.parse)(e),D.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const ds={transitional:qp,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=D.isObject(t);if(s&&D.isHTMLForm(t)&&(t=new FormData(t)),D.isFormData(t))return i?JSON.stringify(jp(t)):t;if(D.isArrayBuffer(t)||D.isBuffer(t)||D.isStream(t)||D.isFile(t)||D.isBlob(t)||D.isReadableStream(t))return t;if(D.isArrayBufferView(t))return t.buffer;if(D.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return A0(t,this.formSerializer).toString();if((u=D.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return ua(u?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),S0(t)):t}],transformResponse:[function(t){const n=this.transitional||ds.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(D.isResponse(t)||D.isReadableStream(t))return t;if(t&&D.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Z.from(u,Z.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ne.classes.FormData,Blob:ne.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],e=>{ds.headers[e]={}});const b0=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),C0=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&b0[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Uh=Symbol("internals");function Si(e){return e&&String(e).trim().toLowerCase()}function eo(e){return e===!1||e==null?e:D.isArray(e)?e.map(eo):String(e)}function P0(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const x0=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function tu(e,t,n,r,i){if(D.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!D.isString(t)){if(D.isString(r))return t.indexOf(r)!==-1;if(D.isRegExp(r))return r.test(t)}}function V0(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function N0(e,t){const n=D.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,o){return this[r].call(this,t,i,s,o)},configurable:!0})})}let me=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,c,l){const h=Si(c);if(!h)throw new Error("header name must be a non-empty string");const d=D.findKey(i,h);(!d||i[d]===void 0||l===!0||l===void 0&&i[d]!==!1)&&(i[d||c]=eo(u))}const o=(u,c)=>D.forEach(u,(l,h)=>s(l,h,c));if(D.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(D.isString(t)&&(t=t.trim())&&!x0(t))o(C0(t),n);else if(D.isObject(t)&&D.isIterable(t)){let u={},c,l;for(const h of t){if(!D.isArray(h))throw TypeError("Object iterator must return a key-value pair");u[l=h[0]]=(c=u[l])?D.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(u,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=Si(t),t){const r=D.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return P0(i);if(D.isFunction(n))return n.call(this,i,r);if(D.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Si(t),t){const r=D.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||tu(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(o){if(o=Si(o),o){const u=D.findKey(r,o);u&&(!n||tu(r,r[u],u,n))&&(delete r[u],i=!0)}}return D.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||tu(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return D.forEach(this,(i,s)=>{const o=D.findKey(r,s);if(o){n[o]=eo(i),delete n[s];return}const u=t?V0(s):String(s).trim();u!==s&&delete n[s],n[u]=eo(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return D.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&D.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[Uh]=this[Uh]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=Si(o);r[u]||(N0(i,o),r[u]=!0)}return D.isArray(t)?t.forEach(s):s(t),this}};me.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(me.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});D.freezeMethods(me);function eu(e,t){const n=this||ds,r=t||n,i=me.from(r.headers);let s=r.data;return D.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function zp(e){return!!(e&&e.__CANCEL__)}function ri(e,t,n){Z.call(this,e??"canceled",Z.ERR_CANCELED,t,n),this.name="CanceledError"}D.inherits(ri,Z,{__CANCEL__:!0});function Hp(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Z("Request failed with status code "+n.status,[Z.ERR_BAD_REQUEST,Z.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function D0(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function k0(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),h=r[s];o||(o=l),n[i]=c,r[i]=l;let d=s,p=0;for(;d!==i;)p+=n[d++],d=d%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),l-o<t)return;const g=h&&l-h;return g?Math.round(p*1e3/g):void 0}}function O0(e,t){let n=0,r=1e3/t,i,s;const o=(l,h=Date.now())=>{n=h,i=null,s&&(clearTimeout(s),s=null),e.apply(null,l)};return[(...l)=>{const h=Date.now(),d=h-n;d>=r?o(l,h):(i=l,s||(s=setTimeout(()=>{s=null,o(i)},r-d)))},()=>i&&o(i)]}const To=(e,t,n=3)=>{let r=0;const i=k0(50,250);return O0(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,c=o-r,l=i(c),h=o<=u;r=o;const d={loaded:o,total:u,progress:u?o/u:void 0,bytes:c,rate:l||void 0,estimated:l&&u&&h?(u-o)/l:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(d)},n)},Bh=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},$h=e=>(...t)=>D.asap(()=>e(...t)),M0=ne.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ne.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ne.origin),ne.navigator&&/(msie|trident)/i.test(ne.navigator.userAgent)):()=>!0,F0=ne.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];D.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),D.isString(r)&&o.push("path="+r),D.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function L0(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function U0(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Gp(e,t,n){let r=!L0(t);return e&&(r||n==!1)?U0(e,t):t}const qh=e=>e instanceof me?{...e}:e;function pr(e,t){t=t||{};const n={};function r(l,h,d,p){return D.isPlainObject(l)&&D.isPlainObject(h)?D.merge.call({caseless:p},l,h):D.isPlainObject(h)?D.merge({},h):D.isArray(h)?h.slice():h}function i(l,h,d,p){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l,d,p)}else return r(l,h,d,p)}function s(l,h){if(!D.isUndefined(h))return r(void 0,h)}function o(l,h){if(D.isUndefined(h)){if(!D.isUndefined(l))return r(void 0,l)}else return r(void 0,h)}function u(l,h,d){if(d in t)return r(l,h);if(d in e)return r(void 0,l)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(l,h,d)=>i(qh(l),qh(h),d,!0)};return D.forEach(Object.keys(Object.assign({},e,t)),function(h){const d=c[h]||i,p=d(e[h],t[h],h);D.isUndefined(p)&&d!==u||(n[h]=p)}),n}const Wp=e=>{const t=pr({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=t;t.headers=o=me.from(o),t.url=$p(Gp(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let c;if(D.isFormData(n)){if(ne.hasStandardBrowserEnv||ne.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[l,...h]=c?c.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([l||"multipart/form-data",...h].join("; "))}}if(ne.hasStandardBrowserEnv&&(r&&D.isFunction(r)&&(r=r(t)),r||r!==!1&&M0(t.url))){const l=i&&s&&F0.read(s);l&&o.set(i,l)}return t},B0=typeof XMLHttpRequest<"u",$0=B0&&function(e){return new Promise(function(n,r){const i=Wp(e);let s=i.data;const o=me.from(i.headers).normalize();let{responseType:u,onUploadProgress:c,onDownloadProgress:l}=i,h,d,p,g,_;function E(){g&&g(),_&&_(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(i.method.toUpperCase(),i.url,!0),v.timeout=i.timeout;function b(){if(!v)return;const N=me.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),M={data:!u||u==="text"||u==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:N,config:e,request:v};Hp(function(I){n(I),E()},function(I){r(I),E()},M),v=null}"onloadend"in v?v.onloadend=b:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(b)},v.onabort=function(){v&&(r(new Z("Request aborted",Z.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new Z("Network Error",Z.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let x=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const M=i.transitional||qp;i.timeoutErrorMessage&&(x=i.timeoutErrorMessage),r(new Z(x,M.clarifyTimeoutError?Z.ETIMEDOUT:Z.ECONNABORTED,e,v)),v=null},s===void 0&&o.setContentType(null),"setRequestHeader"in v&&D.forEach(o.toJSON(),function(x,M){v.setRequestHeader(M,x)}),D.isUndefined(i.withCredentials)||(v.withCredentials=!!i.withCredentials),u&&u!=="json"&&(v.responseType=i.responseType),l&&([p,_]=To(l,!0),v.addEventListener("progress",p)),c&&v.upload&&([d,g]=To(c),v.upload.addEventListener("progress",d),v.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(h=N=>{v&&(r(!N||N.type?new ri(null,e,v):N),v.abort(),v=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const C=D0(i.url);if(C&&ne.protocols.indexOf(C)===-1){r(new Z("Unsupported protocol "+C+":",Z.ERR_BAD_REQUEST,e));return}v.send(s||null)})},q0=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(l){if(!i){i=!0,u();const h=l instanceof Error?l:this.reason;r.abort(h instanceof Z?h:new ri(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new Z(`timeout ${t} of ms exceeded`,Z.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(s):l.removeEventListener("abort",s)}),e=null)};e.forEach(l=>l.addEventListener("abort",s));const{signal:c}=r;return c.unsubscribe=()=>D.asap(u),c}},j0=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},z0=async function*(e,t){for await(const n of H0(e))yield*j0(n,t)},H0=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},jh=(e,t,n,r)=>{const i=z0(e,t);let s=0,o,u=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:l,value:h}=await i.next();if(l){u(),c.close();return}let d=h.byteLength;if(n){let p=s+=d;n(p)}c.enqueue(new Uint8Array(h))}catch(l){throw u(l),l}},cancel(c){return u(c),i.return()}},{highWaterMark:2})},la=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Kp=la&&typeof ReadableStream=="function",G0=la&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Qp=(e,...t)=>{try{return!!e(...t)}catch{return!1}},W0=Kp&&Qp(()=>{let e=!1;const t=new Request(ne.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),zh=64*1024,Ru=Kp&&Qp(()=>D.isReadableStream(new Response("").body)),Ao={stream:Ru&&(e=>e.body)};la&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Ao[t]&&(Ao[t]=D.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Z(`Response type '${t}' is not supported`,Z.ERR_NOT_SUPPORT,r)})})})(new Response);const K0=async e=>{if(e==null)return 0;if(D.isBlob(e))return e.size;if(D.isSpecCompliantForm(e))return(await new Request(ne.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(D.isArrayBufferView(e)||D.isArrayBuffer(e))return e.byteLength;if(D.isURLSearchParams(e)&&(e=e+""),D.isString(e))return(await G0(e)).byteLength},Q0=async(e,t)=>{const n=D.toFiniteNumber(e.getContentLength());return n??K0(t)},X0=la&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:c,responseType:l,headers:h,withCredentials:d="same-origin",fetchOptions:p}=Wp(e);l=l?(l+"").toLowerCase():"text";let g=q0([i,s&&s.toAbortSignal()],o),_;const E=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&W0&&n!=="get"&&n!=="head"&&(v=await Q0(h,r))!==0){let M=new Request(t,{method:"POST",body:r,duplex:"half"}),U;if(D.isFormData(r)&&(U=M.headers.get("content-type"))&&h.setContentType(U),M.body){const[I,w]=Bh(v,To($h(c)));r=jh(M.body,zh,I,w)}}D.isString(d)||(d=d?"include":"omit");const b="credentials"in Request.prototype;_=new Request(t,{...p,signal:g,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:b?d:void 0});let C=await fetch(_,p);const N=Ru&&(l==="stream"||l==="response");if(Ru&&(u||N&&E)){const M={};["status","statusText","headers"].forEach(T=>{M[T]=C[T]});const U=D.toFiniteNumber(C.headers.get("content-length")),[I,w]=u&&Bh(U,To($h(u),!0))||[];C=new Response(jh(C.body,zh,I,()=>{w&&w(),E&&E()}),M)}l=l||"text";let x=await Ao[D.findKey(Ao,l)||"text"](C,e);return!N&&E&&E(),await new Promise((M,U)=>{Hp(M,U,{data:x,headers:me.from(C.headers),status:C.status,statusText:C.statusText,config:e,request:_})})}catch(b){throw E&&E(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new Z("Network Error",Z.ERR_NETWORK,e,_),{cause:b.cause||b}):Z.from(b,b&&b.code,e,_)}}),Su={http:h0,xhr:$0,fetch:X0};D.forEach(Su,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Hh=e=>`- ${e}`,Y0=e=>D.isFunction(e)||e===null||e===!1,Xp={getAdapter:e=>{e=D.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let o;if(r=n,!Y0(n)&&(r=Su[(o=String(n)).toLowerCase()],r===void 0))throw new Z(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,c])=>`adapter ${u} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(Hh).join(`
`):" "+Hh(s[0]):"as no adapter specified";throw new Z("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Su};function nu(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ri(null,e)}function Gh(e){return nu(e),e.headers=me.from(e.headers),e.data=eu.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Xp.getAdapter(e.adapter||ds.adapter)(e).then(function(r){return nu(e),r.data=eu.call(e,e.transformResponse,r),r.headers=me.from(r.headers),r},function(r){return zp(r)||(nu(e),r&&r.response&&(r.response.data=eu.call(e,e.transformResponse,r.response),r.response.headers=me.from(r.response.headers))),Promise.reject(r)})}const Yp="1.10.0",ca={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ca[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Wh={};ca.transitional=function(t,n,r){function i(s,o){return"[Axios v"+Yp+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(t===!1)throw new Z(i(o," has been removed"+(n?" in "+n:"")),Z.ERR_DEPRECATED);return n&&!Wh[o]&&(Wh[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,u):!0}};ca.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function J0(e,t,n){if(typeof e!="object")throw new Z("options must be an object",Z.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const u=e[s],c=u===void 0||o(u,s,e);if(c!==!0)throw new Z("option "+s+" must be "+c,Z.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Z("Unknown option "+s,Z.ERR_BAD_OPTION)}}const no={assertOptions:J0,validators:ca},je=no.validators;let cr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Lh,response:new Lh}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=pr(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&no.assertOptions(r,{silentJSONParsing:je.transitional(je.boolean),forcedJSONParsing:je.transitional(je.boolean),clarifyTimeoutError:je.transitional(je.boolean)},!1),i!=null&&(D.isFunction(i)?n.paramsSerializer={serialize:i}:no.assertOptions(i,{encode:je.function,serialize:je.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),no.assertOptions(n,{baseUrl:je.spelling("baseURL"),withXsrfToken:je.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&D.merge(s.common,s[n.method]);s&&D.forEach(["delete","get","head","post","put","patch","common"],_=>{delete s[_]}),n.headers=me.concat(o,s);const u=[];let c=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(n)===!1||(c=c&&E.synchronous,u.unshift(E.fulfilled,E.rejected))});const l=[];this.interceptors.response.forEach(function(E){l.push(E.fulfilled,E.rejected)});let h,d=0,p;if(!c){const _=[Gh.bind(this),void 0];for(_.unshift.apply(_,u),_.push.apply(_,l),p=_.length,h=Promise.resolve(n);d<p;)h=h.then(_[d++],_[d++]);return h}p=u.length;let g=n;for(d=0;d<p;){const _=u[d++],E=u[d++];try{g=_(g)}catch(v){E.call(this,v);break}}try{h=Gh.call(this,g)}catch(_){return Promise.reject(_)}for(d=0,p=l.length;d<p;)h=h.then(l[d++],l[d++]);return h}getUri(t){t=pr(this.defaults,t);const n=Gp(t.baseURL,t.url,t.allowAbsoluteUrls);return $p(n,t.params,t.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(t){cr.prototype[t]=function(n,r){return this.request(pr(r||{},{method:t,url:n,data:(r||{}).data}))}});D.forEach(["post","put","patch"],function(t){function n(r){return function(s,o,u){return this.request(pr(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}cr.prototype[t]=n(),cr.prototype[t+"Form"]=n(!0)});let Z0=class Jp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},t(function(s,o,u){r.reason||(r.reason=new ri(s,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Jp(function(i){t=i}),cancel:t}}};function tw(e){return function(n){return e.apply(null,n)}}function ew(e){return D.isObject(e)&&e.isAxiosError===!0}const bu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(bu).forEach(([e,t])=>{bu[t]=e});function Zp(e){const t=new cr(e),n=Pp(cr.prototype.request,t);return D.extend(n,cr.prototype,t,{allOwnKeys:!0}),D.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return Zp(pr(e,i))},n}const At=Zp(ds);At.Axios=cr;At.CanceledError=ri;At.CancelToken=Z0;At.isCancel=zp;At.VERSION=Yp;At.toFormData=ua;At.AxiosError=Z;At.Cancel=At.CanceledError;At.all=function(t){return Promise.all(t)};At.spread=tw;At.isAxiosError=ew;At.mergeConfig=pr;At.AxiosHeaders=me;At.formToJSON=e=>jp(D.isHTMLForm(e)?new FormData(e):e);At.getAdapter=Xp.getAdapter;At.HttpStatusCode=bu;At.default=At;const{Axios:fP,AxiosError:dP,CanceledError:pP,isCancel:mP,CancelToken:gP,VERSION:_P,all:yP,Cancel:vP,isAxiosError:wP,spread:EP,toFormData:TP,AxiosHeaders:AP,HttpStatusCode:IP,formToJSON:RP,getAdapter:SP,mergeConfig:bP}=At;class mr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,u=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);u&&(n[r++]=u),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function*nw(e){for(const t of e)yield*t}function tm(e){return Array.from(nw(e))}var rw={value:()=>{}};function Ml(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ro(n)}function ro(e){this._=e}function iw(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ro.prototype=Ml.prototype={constructor:ro,on:function(e,t){var n=this._,r=iw(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=sw(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=Kh(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Kh(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ro(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function sw(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Kh(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=rw,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cu="http://www.w3.org/1999/xhtml";const Qh={svg:"http://www.w3.org/2000/svg",xhtml:Cu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ha(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Qh.hasOwnProperty(t)?{space:Qh[t],local:e}:e}function ow(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cu&&t.documentElement.namespaceURI===Cu?t.createElement(e):t.createElementNS(n,e)}}function aw(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function em(e){var t=ha(e);return(t.local?aw:ow)(t)}function uw(){}function Fl(e){return e==null?uw:function(){return this.querySelector(e)}}function lw(e){typeof e!="function"&&(e=Fl(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=new Array(o),c,l,h=0;h<o;++h)(c=s[h])&&(l=e.call(c,c.__data__,h,s))&&("__data__"in c&&(l.__data__=c.__data__),u[h]=l);return new Ue(r,this._parents)}function cw(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function hw(){return[]}function nm(e){return e==null?hw:function(){return this.querySelectorAll(e)}}function fw(e){return function(){return cw(e.apply(this,arguments))}}function dw(e){typeof e=="function"?e=fw(e):e=nm(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new Ue(r,i)}function rm(e){return function(){return this.matches(e)}}function im(e){return function(t){return t.matches(e)}}var pw=Array.prototype.find;function mw(e){return function(){return pw.call(this.children,e)}}function gw(){return this.firstElementChild}function _w(e){return this.select(e==null?gw:mw(typeof e=="function"?e:im(e)))}var yw=Array.prototype.filter;function vw(){return Array.from(this.children)}function ww(e){return function(){return yw.call(this.children,e)}}function Ew(e){return this.selectAll(e==null?vw:ww(typeof e=="function"?e:im(e)))}function Tw(e){typeof e!="function"&&(e=rm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new Ue(r,this._parents)}function sm(e){return new Array(e.length)}function Aw(){return new Ue(this._enter||this._groups.map(sm),this._parents)}function Io(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Io.prototype={constructor:Io,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Iw(e){return function(){return e}}function Rw(e,t,n,r,i,s){for(var o=0,u,c=t.length,l=s.length;o<l;++o)(u=t[o])?(u.__data__=s[o],r[o]=u):n[o]=new Io(e,s[o]);for(;o<c;++o)(u=t[o])&&(i[o]=u)}function Sw(e,t,n,r,i,s,o){var u,c,l=new Map,h=t.length,d=s.length,p=new Array(h),g;for(u=0;u<h;++u)(c=t[u])&&(p[u]=g=o.call(c,c.__data__,u,t)+"",l.has(g)?i[u]=c:l.set(g,c));for(u=0;u<d;++u)g=o.call(e,s[u],u,s)+"",(c=l.get(g))?(r[u]=c,c.__data__=s[u],l.delete(g)):n[u]=new Io(e,s[u]);for(u=0;u<h;++u)(c=t[u])&&l.get(p[u])===c&&(i[u]=c)}function bw(e){return e.__data__}function Cw(e,t){if(!arguments.length)return Array.from(this,bw);var n=t?Sw:Rw,r=this._parents,i=this._groups;typeof e!="function"&&(e=Iw(e));for(var s=i.length,o=new Array(s),u=new Array(s),c=new Array(s),l=0;l<s;++l){var h=r[l],d=i[l],p=d.length,g=Pw(e.call(h,h&&h.__data__,l,r)),_=g.length,E=u[l]=new Array(_),v=o[l]=new Array(_),b=c[l]=new Array(p);n(h,d,E,v,b,g,t);for(var C=0,N=0,x,M;C<_;++C)if(x=E[C]){for(C>=N&&(N=C+1);!(M=v[N])&&++N<_;);x._next=M||null}}return o=new Ue(o,r),o._enter=u,o._exit=c,o}function Pw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xw(){return new Ue(this._exit||this._groups.map(sm),this._parents)}function Vw(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Nw(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),u=new Array(i),c=0;c<o;++c)for(var l=n[c],h=r[c],d=l.length,p=u[c]=new Array(d),g,_=0;_<d;++_)(g=l[_]||h[_])&&(p[_]=g);for(;c<i;++c)u[c]=n[c];return new Ue(u,this._parents)}function Dw(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function kw(e){e||(e=Ow);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],u=o.length,c=i[s]=new Array(u),l,h=0;h<u;++h)(l=o[h])&&(c[h]=l);c.sort(t)}return new Ue(i,this._parents).order()}function Ow(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Mw(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Fw(){return Array.from(this)}function Lw(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function Uw(){let e=0;for(const t of this)++e;return e}function Bw(){return!this.node()}function $w(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,u;s<o;++s)(u=i[s])&&e.call(u,u.__data__,s,i);return this}function qw(e){return function(){this.removeAttribute(e)}}function jw(e){return function(){this.removeAttributeNS(e.space,e.local)}}function zw(e,t){return function(){this.setAttribute(e,t)}}function Hw(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Gw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Ww(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Kw(e,t){var n=ha(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?jw:qw:typeof t=="function"?n.local?Ww:Gw:n.local?Hw:zw)(n,t))}function om(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Qw(e){return function(){this.style.removeProperty(e)}}function Xw(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Yw(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Jw(e,t,n){return arguments.length>1?this.each((t==null?Qw:typeof t=="function"?Yw:Xw)(e,t,n??"")):jr(this.node(),e)}function jr(e,t){return e.style.getPropertyValue(t)||om(e).getComputedStyle(e,null).getPropertyValue(t)}function Zw(e){return function(){delete this[e]}}function tE(e,t){return function(){this[e]=t}}function eE(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function nE(e,t){return arguments.length>1?this.each((t==null?Zw:typeof t=="function"?eE:tE)(e,t)):this.node()[e]}function am(e){return e.trim().split(/^|\s+/)}function Ll(e){return e.classList||new um(e)}function um(e){this._node=e,this._names=am(e.getAttribute("class")||"")}um.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function lm(e,t){for(var n=Ll(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function cm(e,t){for(var n=Ll(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function rE(e){return function(){lm(this,e)}}function iE(e){return function(){cm(this,e)}}function sE(e,t){return function(){(t.apply(this,arguments)?lm:cm)(this,e)}}function oE(e,t){var n=am(e+"");if(arguments.length<2){for(var r=Ll(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?sE:t?rE:iE)(n,t))}function aE(){this.textContent=""}function uE(e){return function(){this.textContent=e}}function lE(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function cE(e){return arguments.length?this.each(e==null?aE:(typeof e=="function"?lE:uE)(e)):this.node().textContent}function hE(){this.innerHTML=""}function fE(e){return function(){this.innerHTML=e}}function dE(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function pE(e){return arguments.length?this.each(e==null?hE:(typeof e=="function"?dE:fE)(e)):this.node().innerHTML}function mE(){this.nextSibling&&this.parentNode.appendChild(this)}function gE(){return this.each(mE)}function _E(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function yE(){return this.each(_E)}function vE(e){var t=typeof e=="function"?e:em(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function wE(){return null}function EE(e,t){var n=typeof e=="function"?e:em(e),r=t==null?wE:typeof t=="function"?t:Fl(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function TE(){var e=this.parentNode;e&&e.removeChild(this)}function AE(){return this.each(TE)}function IE(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function RE(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function SE(e){return this.select(e?RE:IE)}function bE(e){return arguments.length?this.property("__data__",e):this.node().__data__}function CE(e){return function(t){e.call(this,t,this.__data__)}}function PE(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function xE(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function VE(e,t,n){return function(){var r=this.__on,i,s=CE(t);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function NE(e,t,n){var r=PE(e+""),i,s=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,l=u.length,h;c<l;++c)for(i=0,h=u[c];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(u=t?VE:xE,i=0;i<s;++i)this.each(u(r[i],t,n));return this}function hm(e,t,n){var r=om(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function DE(e,t){return function(){return hm(this,e,t)}}function kE(e,t){return function(){return hm(this,e,t.apply(this,arguments))}}function OE(e,t){return this.each((typeof t=="function"?kE:DE)(e,t))}function*ME(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var FE=[null];function Ue(e,t){this._groups=e,this._parents=t}function ps(){return new Ue([[document.documentElement]],FE)}function LE(){return this}Ue.prototype=ps.prototype={constructor:Ue,select:lw,selectAll:dw,selectChild:_w,selectChildren:Ew,filter:Tw,data:Cw,enter:Aw,exit:xw,join:Vw,merge:Nw,selection:LE,order:Dw,sort:kw,call:Mw,nodes:Fw,node:Lw,size:Uw,empty:Bw,each:$w,attr:Kw,style:Jw,property:nE,classed:oE,text:cE,html:pE,raise:gE,lower:yE,append:vE,insert:EE,remove:AE,clone:SE,datum:bE,on:NE,dispatch:OE,[Symbol.iterator]:ME};function Ul(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function fm(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ms(){}var Qi=.7,Ro=1/Qi,Ur="\\s*([+-]?\\d+)\\s*",Xi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",UE=/^#([0-9a-f]{3,8})$/,BE=new RegExp(`^rgb\\(${Ur},${Ur},${Ur}\\)$`),$E=new RegExp(`^rgb\\(${Qe},${Qe},${Qe}\\)$`),qE=new RegExp(`^rgba\\(${Ur},${Ur},${Ur},${Xi}\\)$`),jE=new RegExp(`^rgba\\(${Qe},${Qe},${Qe},${Xi}\\)$`),zE=new RegExp(`^hsl\\(${Xi},${Qe},${Qe}\\)$`),HE=new RegExp(`^hsla\\(${Xi},${Qe},${Qe},${Xi}\\)$`),Xh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ul(ms,Yi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Yh,formatHex:Yh,formatHex8:GE,formatHsl:WE,formatRgb:Jh,toString:Jh});function Yh(){return this.rgb().formatHex()}function GE(){return this.rgb().formatHex8()}function WE(){return dm(this).formatHsl()}function Jh(){return this.rgb().formatRgb()}function Yi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=UE.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Zh(t):n===3?new fe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$s(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$s(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=BE.exec(e))?new fe(t[1],t[2],t[3],1):(t=$E.exec(e))?new fe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qE.exec(e))?$s(t[1],t[2],t[3],t[4]):(t=jE.exec(e))?$s(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=zE.exec(e))?nf(t[1],t[2]/100,t[3]/100,1):(t=HE.exec(e))?nf(t[1],t[2]/100,t[3]/100,t[4]):Xh.hasOwnProperty(e)?Zh(Xh[e]):e==="transparent"?new fe(NaN,NaN,NaN,0):null}function Zh(e){return new fe(e>>16&255,e>>8&255,e&255,1)}function $s(e,t,n,r){return r<=0&&(e=t=n=NaN),new fe(e,t,n,r)}function KE(e){return e instanceof ms||(e=Yi(e)),e?(e=e.rgb(),new fe(e.r,e.g,e.b,e.opacity)):new fe}function Pu(e,t,n,r){return arguments.length===1?KE(e):new fe(e,t,n,r??1)}function fe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ul(fe,Pu,fm(ms,{brighter(e){return e=e==null?Ro:Math.pow(Ro,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Qi:Math.pow(Qi,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new fe(hr(this.r),hr(this.g),hr(this.b),So(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tf,formatHex:tf,formatHex8:QE,formatRgb:ef,toString:ef}));function tf(){return`#${ar(this.r)}${ar(this.g)}${ar(this.b)}`}function QE(){return`#${ar(this.r)}${ar(this.g)}${ar(this.b)}${ar((isNaN(this.opacity)?1:this.opacity)*255)}`}function ef(){const e=So(this.opacity);return`${e===1?"rgb(":"rgba("}${hr(this.r)}, ${hr(this.g)}, ${hr(this.b)}${e===1?")":`, ${e})`}`}function So(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ar(e){return e=hr(e),(e<16?"0":"")+e.toString(16)}function nf(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Le(e,t,n,r)}function dm(e){if(e instanceof Le)return new Le(e.h,e.s,e.l,e.opacity);if(e instanceof ms||(e=Yi(e)),!e)return new Le;if(e instanceof Le)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,u=s-i,c=(s+i)/2;return u?(t===s?o=(n-r)/u+(n<r)*6:n===s?o=(r-t)/u+2:o=(t-n)/u+4,u/=c<.5?s+i:2-s-i,o*=60):u=c>0&&c<1?0:o,new Le(o,u,c,e.opacity)}function XE(e,t,n,r){return arguments.length===1?dm(e):new Le(e,t,n,r??1)}function Le(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ul(Le,XE,fm(ms,{brighter(e){return e=e==null?Ro:Math.pow(Ro,e),new Le(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qi:Math.pow(Qi,e),new Le(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new fe(ru(e>=240?e-240:e+120,i,r),ru(e,i,r),ru(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Le(rf(this.h),qs(this.s),qs(this.l),So(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=So(this.opacity);return`${e===1?"hsl(":"hsla("}${rf(this.h)}, ${qs(this.s)*100}%, ${qs(this.l)*100}%${e===1?")":`, ${e})`}`}}));function rf(e){return e=(e||0)%360,e<0?e+360:e}function qs(e){return Math.max(0,Math.min(1,e||0))}function ru(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const pm=e=>()=>e;function YE(e,t){return function(n){return e+n*t}}function JE(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function ZE(e){return(e=+e)==1?mm:function(t,n){return n-t?JE(t,n,e):pm(isNaN(t)?n:t)}}function mm(e,t){var n=t-e;return n?YE(e,n):pm(isNaN(e)?t:e)}const sf=function e(t){var n=ZE(t);function r(i,s){var o=n((i=Pu(i)).r,(s=Pu(s)).r),u=n(i.g,s.g),c=n(i.b,s.b),l=mm(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=u(h),i.b=c(h),i.opacity=l(h),i+""}}return r.gamma=e,r}(1);function Pn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var xu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iu=new RegExp(xu.source,"g");function tT(e){return function(){return e}}function eT(e){return function(t){return e(t)+""}}function nT(e,t){var n=xu.lastIndex=iu.lastIndex=0,r,i,s,o=-1,u=[],c=[];for(e=e+"",t=t+"";(r=xu.exec(e))&&(i=iu.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),u[o]?u[o]+=s:u[++o]=s),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,c.push({i:o,x:Pn(r,i)})),n=iu.lastIndex;return n<t.length&&(s=t.slice(n),u[o]?u[o]+=s:u[++o]=s),u.length<2?c[0]?eT(c[0].x):tT(t):(t=c.length,function(l){for(var h=0,d;h<t;++h)u[(d=c[h]).i]=d.x(l);return u.join("")})}var of=180/Math.PI,Vu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gm(e,t,n,r,i,s){var o,u,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,c/=u),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*of,skewX:Math.atan(c)*of,scaleX:o,scaleY:u}}var js;function rT(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Vu:gm(t.a,t.b,t.c,t.d,t.e,t.f)}function iT(e){return e==null||(js||(js=document.createElementNS("http://www.w3.org/2000/svg","g")),js.setAttribute("transform",e),!(e=js.transform.baseVal.consolidate()))?Vu:(e=e.matrix,gm(e.a,e.b,e.c,e.d,e.e,e.f))}function _m(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,h,d,p,g,_){if(l!==d||h!==p){var E=g.push("translate(",null,t,null,n);_.push({i:E-4,x:Pn(l,d)},{i:E-2,x:Pn(h,p)})}else(d||p)&&g.push("translate("+d+t+p+n)}function o(l,h,d,p){l!==h?(l-h>180?h+=360:h-l>180&&(l+=360),p.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Pn(l,h)})):h&&d.push(i(d)+"rotate("+h+r)}function u(l,h,d,p){l!==h?p.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Pn(l,h)}):h&&d.push(i(d)+"skewX("+h+r)}function c(l,h,d,p,g,_){if(l!==d||h!==p){var E=g.push(i(g)+"scale(",null,",",null,")");_.push({i:E-4,x:Pn(l,d)},{i:E-2,x:Pn(h,p)})}else(d!==1||p!==1)&&g.push(i(g)+"scale("+d+","+p+")")}return function(l,h){var d=[],p=[];return l=e(l),h=e(h),s(l.translateX,l.translateY,h.translateX,h.translateY,d,p),o(l.rotate,h.rotate,d,p),u(l.skewX,h.skewX,d,p),c(l.scaleX,l.scaleY,h.scaleX,h.scaleY,d,p),l=h=null,function(g){for(var _=-1,E=p.length,v;++_<E;)d[(v=p[_]).i]=v.x(g);return d.join("")}}}var sT=_m(rT,"px, ","px)","deg)"),oT=_m(iT,", ",")",")"),zr=0,Ci=0,bi=0,ym=1e3,bo,Pi,Co=0,gr=0,fa=0,Ji=typeof performance=="object"&&performance.now?performance:Date,vm=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Bl(){return gr||(vm(aT),gr=Ji.now()+fa)}function aT(){gr=0}function Po(){this._call=this._time=this._next=null}Po.prototype=$l.prototype={constructor:Po,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Bl():+n)+(t==null?0:+t),!this._next&&Pi!==this&&(Pi?Pi._next=this:bo=this,Pi=this),this._call=e,this._time=n,Nu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nu())}};function $l(e,t,n){var r=new Po;return r.restart(e,t,n),r}function uT(){Bl(),++zr;for(var e=bo,t;e;)(t=gr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--zr}function af(){gr=(Co=Ji.now())+fa,zr=Ci=0;try{uT()}finally{zr=0,cT(),gr=0}}function lT(){var e=Ji.now(),t=e-Co;t>ym&&(fa-=t,Co=e)}function cT(){for(var e,t=bo,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:bo=n);Pi=e,Nu(r)}function Nu(e){if(!zr){Ci&&(Ci=clearTimeout(Ci));var t=e-gr;t>24?(e<1/0&&(Ci=setTimeout(af,e-Ji.now()-fa)),bi&&(bi=clearInterval(bi))):(bi||(Co=Ji.now(),bi=setInterval(lT,ym)),zr=1,vm(af))}}function uf(e,t,n){var r=new Po;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var hT=Ml("start","end","cancel","interrupt"),fT=[],wm=0,lf=1,Du=2,io=3,cf=4,ku=5,so=6;function da(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;dT(e,n,{name:t,index:r,group:i,on:hT,tween:fT,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:wm})}function ql(e,t){var n=qe(e,t);if(n.state>wm)throw new Error("too late; already scheduled");return n}function sn(e,t){var n=qe(e,t);if(n.state>io)throw new Error("too late; already running");return n}function qe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function dT(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=$l(s,0,n.time);function s(l){n.state=lf,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var h,d,p,g;if(n.state!==lf)return c();for(h in r)if(g=r[h],g.name===n.name){if(g.state===io)return uf(o);g.state===cf?(g.state=so,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[h]):+h<t&&(g.state=so,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[h])}if(uf(function(){n.state===io&&(n.state=cf,n.timer.restart(u,n.delay,n.time),u(l))}),n.state=Du,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Du){for(n.state=io,i=new Array(p=n.tween.length),h=0,d=-1;h<p;++h)(g=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=g);i.length=d+1}}function u(l){for(var h=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=ku,1),d=-1,p=i.length;++d<p;)i[d].call(e,h);n.state===ku&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=so,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function pT(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>Du&&r.state<ku,r.state=so,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function mT(e){return this.each(function(){pT(this,e)})}function gT(e,t){var n,r;return function(){var i=sn(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,u=r.length;o<u;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function _T(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=sn(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var u={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=u;break}c===l&&i.push(u)}s.tween=i}}function yT(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=qe(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?gT:_T)(n,e,t))}function jl(e,t,n){var r=e._id;return e.each(function(){var i=sn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return qe(i,r).value[t]}}function Em(e,t){var n;return(typeof t=="number"?Pn:t instanceof Yi?sf:(n=Yi(t))?(t=n,sf):nT)(e,t)}function vT(e){return function(){this.removeAttribute(e)}}function wT(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ET(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function TT(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function AT(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function IT(e,t,n){var r,i,s;return function(){var o,u=n(this),c;return u==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=u+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u)))}}function RT(e,t){var n=ha(e),r=n==="transform"?oT:Em;return this.attrTween(e,typeof t=="function"?(n.local?IT:AT)(n,r,jl(this,"attr."+e,t)):t==null?(n.local?wT:vT)(n):(n.local?TT:ET)(n,r,t))}function ST(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function bT(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function CT(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&bT(e,s)),n}return i._value=t,i}function PT(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&ST(e,s)),n}return i._value=t,i}function xT(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=ha(e);return this.tween(n,(r.local?CT:PT)(r,t))}function VT(e,t){return function(){ql(this,e).delay=+t.apply(this,arguments)}}function NT(e,t){return t=+t,function(){ql(this,e).delay=t}}function DT(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?VT:NT)(t,e)):qe(this.node(),t).delay}function kT(e,t){return function(){sn(this,e).duration=+t.apply(this,arguments)}}function OT(e,t){return t=+t,function(){sn(this,e).duration=t}}function MT(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?kT:OT)(t,e)):qe(this.node(),t).duration}function FT(e,t){if(typeof t!="function")throw new Error;return function(){sn(this,e).ease=t}}function LT(e){var t=this._id;return arguments.length?this.each(FT(t,e)):qe(this.node(),t).ease}function UT(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;sn(this,e).ease=n}}function BT(e){if(typeof e!="function")throw new Error;return this.each(UT(this._id,e))}function $T(e){typeof e!="function"&&(e=rm(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,u=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&u.push(c);return new _n(r,this._parents,this._name,this._id)}function qT(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),u=0;u<s;++u)for(var c=t[u],l=n[u],h=c.length,d=o[u]=new Array(h),p,g=0;g<h;++g)(p=c[g]||l[g])&&(d[g]=p);for(;u<r;++u)o[u]=t[u];return new _n(o,this._parents,this._name,this._id)}function jT(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function zT(e,t,n){var r,i,s=jT(t)?ql:sn;return function(){var o=s(this,e),u=o.on;u!==r&&(i=(r=u).copy()).on(t,n),o.on=i}}function HT(e,t){var n=this._id;return arguments.length<2?qe(this.node(),n).on.on(e):this.each(zT(n,e,t))}function GT(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function WT(){return this.on("end.remove",GT(this._id))}function KT(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Fl(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var u=r[o],c=u.length,l=s[o]=new Array(c),h,d,p=0;p<c;++p)(h=u[p])&&(d=e.call(h,h.__data__,p,u))&&("__data__"in h&&(d.__data__=h.__data__),l[p]=d,da(l[p],t,n,p,l,qe(h,n)));return new _n(s,this._parents,t,n)}function QT(e){var t=this._name,n=this._id;typeof e!="function"&&(e=nm(e));for(var r=this._groups,i=r.length,s=[],o=[],u=0;u<i;++u)for(var c=r[u],l=c.length,h,d=0;d<l;++d)if(h=c[d]){for(var p=e.call(h,h.__data__,d,c),g,_=qe(h,n),E=0,v=p.length;E<v;++E)(g=p[E])&&da(g,t,n,E,p,_);s.push(p),o.push(h)}return new _n(s,o,t,n)}var XT=ps.prototype.constructor;function YT(){return new XT(this._groups,this._parents)}function JT(e,t){var n,r,i;return function(){var s=jr(this,e),o=(this.style.removeProperty(e),jr(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function Tm(e){return function(){this.style.removeProperty(e)}}function ZT(e,t,n){var r,i=n+"",s;return function(){var o=jr(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function t1(e,t,n){var r,i,s;return function(){var o=jr(this,e),u=n(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(e),jr(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,u))}}function e1(e,t){var n,r,i,s="style."+t,o="end."+s,u;return function(){var c=sn(this,e),l=c.on,h=c.value[s]==null?u||(u=Tm(t)):void 0;(l!==n||i!==h)&&(r=(n=l).copy()).on(o,i=h),c.on=r}}function n1(e,t,n){var r=(e+="")=="transform"?sT:Em;return t==null?this.styleTween(e,JT(e,r)).on("end.style."+e,Tm(e)):typeof t=="function"?this.styleTween(e,t1(e,r,jl(this,"style."+e,t))).each(e1(this._id,e)):this.styleTween(e,ZT(e,r,t),n).on("end.style."+e,null)}function r1(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function i1(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&r1(e,o,n)),r}return s._value=t,s}function s1(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,i1(e,t,n??""))}function o1(e){return function(){this.textContent=e}}function a1(e){return function(){var t=e(this);this.textContent=t??""}}function u1(e){return this.tween("text",typeof e=="function"?a1(jl(this,"text",e)):o1(e==null?"":e+""))}function l1(e){return function(t){this.textContent=e.call(this,t)}}function c1(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&l1(i)),t}return r._value=e,r}function h1(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,c1(e))}function f1(){for(var e=this._name,t=this._id,n=Am(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)if(c=o[l]){var h=qe(c,t);da(c,e,n,l,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new _n(r,this._parents,e,n)}function d1(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var u={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var l=sn(this,r),h=l.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(c)),l.on=t}),i===0&&s()})}var p1=0;function _n(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Am(){return++p1}var cn=ps.prototype;_n.prototype={constructor:_n,select:KT,selectAll:QT,selectChild:cn.selectChild,selectChildren:cn.selectChildren,filter:$T,merge:qT,selection:YT,transition:f1,call:cn.call,nodes:cn.nodes,node:cn.node,size:cn.size,empty:cn.empty,each:cn.each,on:HT,attr:RT,attrTween:xT,style:n1,styleTween:s1,text:u1,textTween:h1,remove:WT,tween:yT,delay:DT,duration:MT,ease:LT,easeVarying:BT,end:d1,[Symbol.iterator]:cn[Symbol.iterator]};function m1(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var g1={time:null,delay:0,duration:250,ease:m1};function _1(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function y1(e){var t,n;e instanceof _n?(t=e._id,e=e._name):(t=Am(),(n=g1).time=Bl(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],u=o.length,c,l=0;l<u;++l)(c=o[l])&&da(c,e,t,l,o,n||_1(c,t));return new _n(r,this._parents,e,t)}ps.prototype.interrupt=mT;ps.prototype.transition=y1;function v1(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,o=n.length,u,c=0,l=0;for(s=0;s<o;++s)u=n[s],c+=u.x,l+=u.y;for(c=(c/o-e)*r,l=(l/o-t)*r,s=0;s<o;++s)u=n[s],u.x-=c,u.y-=l}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function w1(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Im(this.cover(t,n),t,n,e)}function Im(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},u=e._x0,c=e._y0,l=e._x1,h=e._y1,d,p,g,_,E,v,b,C;if(!s)return e._root=o,e;for(;s.length;)if((E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p,i=s,!(s=s[b=v<<1|E]))return i[b]=o,e;if(g=+e._x.call(null,s.data),_=+e._y.call(null,s.data),t===g&&n===_)return o.next=s,i?i[b]=o:e._root=o,e;do i=i?i[b]=new Array(4):e._root=new Array(4),(E=t>=(d=(u+l)/2))?u=d:l=d,(v=n>=(p=(c+h)/2))?c=p:h=p;while((b=v<<1|E)===(C=(_>=p)<<1|g>=d));return i[C]=s,i[b]=o,e}function E1(e){var t,n,r=e.length,i,s,o=new Array(r),u=new Array(r),c=1/0,l=1/0,h=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,u[n]=s,i<c&&(c=i),i>h&&(h=i),s<l&&(l=s),s>d&&(d=s));if(c>h||l>d)return this;for(this.cover(c,l).cover(h,d),n=0;n<r;++n)Im(this,o[n],u[n],e[n]);return this}function T1(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n||1,u=this._root,c,l;n>e||e>=i||r>t||t>=s;)switch(l=(t<r)<<1|e<n,c=new Array(4),c[l]=u,u=c,o*=2,l){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function A1(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function I1(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function oe(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function R1(e,t,n){var r,i=this._x0,s=this._y0,o,u,c,l,h=this._x1,d=this._y1,p=[],g=this._root,_,E;for(g&&p.push(new oe(g,i,s,h,d)),n==null?n=1/0:(i=e-n,s=t-n,h=e+n,d=t+n,n*=n);_=p.pop();)if(!(!(g=_.node)||(o=_.x0)>h||(u=_.y0)>d||(c=_.x1)<i||(l=_.y1)<s))if(g.length){var v=(o+c)/2,b=(u+l)/2;p.push(new oe(g[3],v,b,c,l),new oe(g[2],o,b,v,l),new oe(g[1],v,u,c,b),new oe(g[0],o,u,v,b)),(E=(t>=b)<<1|e>=v)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-E],p[p.length-1-E]=_)}else{var C=e-+this._x.call(null,g.data),N=t-+this._y.call(null,g.data),x=C*C+N*N;if(x<n){var M=Math.sqrt(n=x);i=e-M,s=t-M,h=e+M,d=t+M,r=g.data}}return r}function S1(e){if(isNaN(h=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,u=this._y0,c=this._x1,l=this._y1,h,d,p,g,_,E,v,b;if(!n)return this;if(n.length)for(;;){if((_=h>=(p=(o+c)/2))?o=p:c=p,(E=d>=(g=(u+l)/2))?u=g:l=g,t=n,!(n=n[v=E<<1|_]))return this;if(!n.length)break;(t[v+1&3]||t[v+2&3]||t[v+3&3])&&(r=t,b=v)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[v]=s:delete t[v],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[b]=n:this._root=n),this):(this._root=s,this)}function b1(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function C1(){return this._root}function P1(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function x1(e){var t=[],n,r=this._root,i,s,o,u,c;for(r&&t.push(new oe(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,u=n.x1,c=n.y1)&&r.length){var l=(s+u)/2,h=(o+c)/2;(i=r[3])&&t.push(new oe(i,l,h,u,c)),(i=r[2])&&t.push(new oe(i,s,h,l,c)),(i=r[1])&&t.push(new oe(i,l,o,u,h)),(i=r[0])&&t.push(new oe(i,s,o,l,h))}return this}function V1(e){var t=[],n=[],r;for(this._root&&t.push(new oe(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,u=r.y0,c=r.x1,l=r.y1,h=(o+c)/2,d=(u+l)/2;(s=i[0])&&t.push(new oe(s,o,u,h,d)),(s=i[1])&&t.push(new oe(s,h,u,c,d)),(s=i[2])&&t.push(new oe(s,o,d,h,l)),(s=i[3])&&t.push(new oe(s,h,d,c,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function N1(e){return e[0]}function D1(e){return arguments.length?(this._x=e,this):this._x}function k1(e){return e[1]}function O1(e){return arguments.length?(this._y=e,this):this._y}function Rm(e,t,n){var r=new zl(t??N1,n??k1,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function zl(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function hf(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ae=Rm.prototype=zl.prototype;ae.copy=function(){var e=new zl(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=hf(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=hf(r));return e};ae.add=w1;ae.addAll=E1;ae.cover=T1;ae.data=A1;ae.extent=I1;ae.find=R1;ae.remove=S1;ae.removeAll=b1;ae.root=C1;ae.size=P1;ae.visit=x1;ae.visitAfter=V1;ae.x=D1;ae.y=O1;function dn(e){return function(){return e}}function Fr(e){return(e()-.5)*1e-6}function M1(e){return e.index}function ff(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function F1(e){var t=M1,n=d,r,i=dn(30),s,o,u,c,l,h=1;e==null&&(e=[]);function d(v){return 1/Math.min(u[v.source.index],u[v.target.index])}function p(v){for(var b=0,C=e.length;b<h;++b)for(var N=0,x,M,U,I,w,T,S;N<C;++N)x=e[N],M=x.source,U=x.target,I=U.x+U.vx-M.x-M.vx||Fr(l),w=U.y+U.vy-M.y-M.vy||Fr(l),T=Math.sqrt(I*I+w*w),T=(T-s[N])/T*v*r[N],I*=T,w*=T,U.vx-=I*(S=c[N]),U.vy-=w*S,M.vx+=I*(S=1-S),M.vy+=w*S}function g(){if(o){var v,b=o.length,C=e.length,N=new Map(o.map((M,U)=>[t(M,U,o),M])),x;for(v=0,u=new Array(b);v<C;++v)x=e[v],x.index=v,typeof x.source!="object"&&(x.source=ff(N,x.source)),typeof x.target!="object"&&(x.target=ff(N,x.target)),u[x.source.index]=(u[x.source.index]||0)+1,u[x.target.index]=(u[x.target.index]||0)+1;for(v=0,c=new Array(C);v<C;++v)x=e[v],c[v]=u[x.source.index]/(u[x.source.index]+u[x.target.index]);r=new Array(C),_(),s=new Array(C),E()}}function _(){if(o)for(var v=0,b=e.length;v<b;++v)r[v]=+n(e[v],v,e)}function E(){if(o)for(var v=0,b=e.length;v<b;++v)s[v]=+i(e[v],v,e)}return p.initialize=function(v,b){o=v,l=b,g()},p.links=function(v){return arguments.length?(e=v,g(),p):e},p.id=function(v){return arguments.length?(t=v,p):t},p.iterations=function(v){return arguments.length?(h=+v,p):h},p.strength=function(v){return arguments.length?(n=typeof v=="function"?v:dn(+v),_(),p):n},p.distance=function(v){return arguments.length?(i=typeof v=="function"?v:dn(+v),E(),p):i},p}const L1=1664525,U1=1013904223,df=4294967296;function B1(){let e=1;return()=>(e=(L1*e+U1)%df)/df}function $1(e){return e.x}function q1(e){return e.y}var j1=10,z1=Math.PI*(3-Math.sqrt(5));function H1(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,u=new Map,c=$l(d),l=Ml("tick","end"),h=B1();e==null&&(e=[]);function d(){p(),l.call("tick",t),n<r&&(c.stop(),l.call("end",t))}function p(E){var v,b=e.length,C;E===void 0&&(E=1);for(var N=0;N<E;++N)for(n+=(s-n)*i,u.forEach(function(x){x(n)}),v=0;v<b;++v)C=e[v],C.fx==null?C.x+=C.vx*=o:(C.x=C.fx,C.vx=0),C.fy==null?C.y+=C.vy*=o:(C.y=C.fy,C.vy=0);return t}function g(){for(var E=0,v=e.length,b;E<v;++E){if(b=e[E],b.index=E,b.fx!=null&&(b.x=b.fx),b.fy!=null&&(b.y=b.fy),isNaN(b.x)||isNaN(b.y)){var C=j1*Math.sqrt(.5+E),N=E*z1;b.x=C*Math.cos(N),b.y=C*Math.sin(N)}(isNaN(b.vx)||isNaN(b.vy))&&(b.vx=b.vy=0)}}function _(E){return E.initialize&&E.initialize(e,h),E}return g(),t={tick:p,restart:function(){return c.restart(d),t},stop:function(){return c.stop(),t},nodes:function(E){return arguments.length?(e=E,g(),u.forEach(_),t):e},alpha:function(E){return arguments.length?(n=+E,t):n},alphaMin:function(E){return arguments.length?(r=+E,t):r},alphaDecay:function(E){return arguments.length?(i=+E,t):+i},alphaTarget:function(E){return arguments.length?(s=+E,t):s},velocityDecay:function(E){return arguments.length?(o=1-E,t):1-o},randomSource:function(E){return arguments.length?(h=E,u.forEach(_),t):h},force:function(E,v){return arguments.length>1?(v==null?u.delete(E):u.set(E,_(v)),t):u.get(E)},find:function(E,v,b){var C=0,N=e.length,x,M,U,I,w;for(b==null?b=1/0:b*=b,C=0;C<N;++C)I=e[C],x=E-I.x,M=v-I.y,U=x*x+M*M,U<b&&(w=I,b=U);return w},on:function(E,v){return arguments.length>1?(l.on(E,v),t):l.on(E)}}}function G1(){var e,t,n,r,i=dn(-30),s,o=1,u=1/0,c=.81;function l(g){var _,E=e.length,v=Rm(e,$1,q1).visitAfter(d);for(r=g,_=0;_<E;++_)t=e[_],v.visit(p)}function h(){if(e){var g,_=e.length,E;for(s=new Array(_),g=0;g<_;++g)E=e[g],s[E.index]=+i(E,g,e)}}function d(g){var _=0,E,v,b=0,C,N,x;if(g.length){for(C=N=x=0;x<4;++x)(E=g[x])&&(v=Math.abs(E.value))&&(_+=E.value,b+=v,C+=v*E.x,N+=v*E.y);g.x=C/b,g.y=N/b}else{E=g,E.x=E.data.x,E.y=E.data.y;do _+=s[E.data.index];while(E=E.next)}g.value=_}function p(g,_,E,v){if(!g.value)return!0;var b=g.x-t.x,C=g.y-t.y,N=v-_,x=b*b+C*C;if(N*N/c<x)return x<u&&(b===0&&(b=Fr(n),x+=b*b),C===0&&(C=Fr(n),x+=C*C),x<o&&(x=Math.sqrt(o*x)),t.vx+=b*g.value*r/x,t.vy+=C*g.value*r/x),!0;if(g.length||x>=u)return;(g.data!==t||g.next)&&(b===0&&(b=Fr(n),x+=b*b),C===0&&(C=Fr(n),x+=C*C),x<o&&(x=Math.sqrt(o*x)));do g.data!==t&&(N=s[g.data.index]*r/x,t.vx+=b*N,t.vy+=C*N);while(g=g.next)}return l.initialize=function(g,_){e=g,n=_,h()},l.strength=function(g){return arguments.length?(i=typeof g=="function"?g:dn(+g),h(),l):i},l.distanceMin=function(g){return arguments.length?(o=g*g,l):Math.sqrt(o)},l.distanceMax=function(g){return arguments.length?(u=g*g,l):Math.sqrt(u)},l.theta=function(g){return arguments.length?(c=g*g,l):Math.sqrt(c)},l}function W1(e,t,n){var r,i=dn(.1),s,o;typeof e!="function"&&(e=dn(+e)),t==null&&(t=0),n==null&&(n=0);function u(l){for(var h=0,d=r.length;h<d;++h){var p=r[h],g=p.x-t||1e-6,_=p.y-n||1e-6,E=Math.sqrt(g*g+_*_),v=(o[h]-E)*s[h]*l/E;p.vx+=g*v,p.vy+=_*v}}function c(){if(r){var l,h=r.length;for(s=new Array(h),o=new Array(h),l=0;l<h;++l)o[l]=+e(r[l],l,r),s[l]=isNaN(o[l])?0:+i(r[l],l,r)}}return u.initialize=function(l){r=l,c()},u.strength=function(l){return arguments.length?(i=typeof l=="function"?l:dn(+l),c(),u):i},u.radius=function(l){return arguments.length?(e=typeof l=="function"?l:dn(+l),c(),u):e},u.x=function(l){return arguments.length?(t=+l,u):t},u.y=function(l){return arguments.length?(n=+l,u):n},u}var mt=1e-6,ot=Math.PI,Pe=ot/2,pf=ot/4,De=ot*2,hn=180/ot,Ee=ot/180,Et=Math.abs,K1=Math.atan,Zi=Math.atan2,Pt=Math.cos,xt=Math.sin,Q1=Math.sign||function(e){return e>0?1:e<0?-1:0},Er=Math.sqrt;function X1(e){return e>1?0:e<-1?ot:Math.acos(e)}function ts(e){return e>1?Pe:e<-1?-Pe:Math.asin(e)}function xe(){}function xo(e,t){e&&gf.hasOwnProperty(e.type)&&gf[e.type](e,t)}var mf={Feature:function(e,t){xo(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)xo(n[r].geometry,t)}},gf={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ou(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Ou(n[r],t,0)},Polygon:function(e,t){_f(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)_f(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)xo(n[r],t)}};function Ou(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function _f(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Ou(e[n],t,1);t.polygonEnd()}function Nr(e,t){e&&mf.hasOwnProperty(e.type)?mf[e.type](e,t):xo(e,t)}function Mu(e){return[Zi(e[1],e[0]),ts(e[2])]}function Hr(e){var t=e[0],n=e[1],r=Pt(n);return[r*Pt(t),r*xt(t),xt(n)]}function zs(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Vo(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function su(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Hs(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Fu(e){var t=Er(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Lu(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function Uu(e,t){return Et(e)>ot&&(e-=Math.round(e/De)*De),[e,t]}Uu.invert=Uu;function Y1(e,t,n){return(e%=De)?t||n?Lu(vf(e),wf(t,n)):vf(e):t||n?wf(t,n):Uu}function yf(e){return function(t,n){return t+=e,Et(t)>ot&&(t-=Math.round(t/De)*De),[t,n]}}function vf(e){var t=yf(e);return t.invert=yf(-e),t}function wf(e,t){var n=Pt(e),r=xt(e),i=Pt(t),s=xt(t);function o(u,c){var l=Pt(c),h=Pt(u)*l,d=xt(u)*l,p=xt(c),g=p*n+h*r;return[Zi(d*i-g*s,h*n-p*r),ts(g*i+d*s)]}return o.invert=function(u,c){var l=Pt(c),h=Pt(u)*l,d=xt(u)*l,p=xt(c),g=p*i-d*s;return[Zi(d*i+p*s,h*n+g*r),ts(g*n-h*r)]},o}function J1(e,t,n,r,i,s){if(n){var o=Pt(t),u=xt(t),c=r*n;i==null?(i=t+r*De,s=t-c/2):(i=Ef(o,i),s=Ef(o,s),(r>0?i<s:i>s)&&(i+=r*De));for(var l,h=i;r>0?h>s:h<s;h-=c)l=Mu([o,-u*Pt(h),-u*xt(h)]),e.point(l[0],l[1])}}function Ef(e,t){t=Hr(t),t[0]-=e,Fu(t);var n=X1(-t[1]);return((-t[2]<0?-n:n)+De-mt)%De}function Sm(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:xe,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function oo(e,t){return Et(e[0]-t[0])<mt&&Et(e[1]-t[1])<mt}function Gs(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function bm(e,t,n,r,i){var s=[],o=[],u,c;if(e.forEach(function(_){if(!((E=_.length-1)<=0)){var E,v=_[0],b=_[E],C;if(oo(v,b)){if(!v[2]&&!b[2]){for(i.lineStart(),u=0;u<E;++u)i.point((v=_[u])[0],v[1]);i.lineEnd();return}b[0]+=2*mt}s.push(C=new Gs(v,_,null,!0)),o.push(C.o=new Gs(v,null,C,!1)),s.push(C=new Gs(b,_,null,!1)),o.push(C.o=new Gs(b,null,C,!0))}}),!!s.length){for(o.sort(t),Tf(s),Tf(o),u=0,c=o.length;u<c;++u)o[u].e=n=!n;for(var l=s[0],h,d;;){for(var p=l,g=!0;p.v;)if((p=p.n)===l)return;h=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(u=0,c=h.length;u<c;++u)i.point((d=h[u])[0],d[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(g)for(h=p.p.z,u=h.length-1;u>=0;--u)i.point((d=h[u])[0],d[1]);else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,h=p.z,g=!g}while(!p.v);i.lineEnd()}}}function Tf(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function ou(e){return Et(e[0])<=ot?e[0]:Q1(e[0])*((Et(e[0])+ot)%De-ot)}function Z1(e,t){var n=ou(t),r=t[1],i=xt(r),s=[xt(n),-Pt(n),0],o=0,u=0,c=new mr;i===1?r=Pe+mt:i===-1&&(r=-Pe-mt);for(var l=0,h=e.length;l<h;++l)if(p=(d=e[l]).length)for(var d,p,g=d[p-1],_=ou(g),E=g[1]/2+pf,v=xt(E),b=Pt(E),C=0;C<p;++C,_=x,v=U,b=I,g=N){var N=d[C],x=ou(N),M=N[1]/2+pf,U=xt(M),I=Pt(M),w=x-_,T=w>=0?1:-1,S=T*w,R=S>ot,P=v*U;if(c.add(Zi(P*T*xt(S),b*I+P*Pt(S))),o+=R?w+T*De:w,R^_>=n^x>=n){var A=Vo(Hr(g),Hr(N));Fu(A);var X=Vo(s,A);Fu(X);var L=(R^w>=0?-1:1)*ts(X[2]);(r>L||r===L&&(A[0]||A[1]))&&(u+=R^w>=0?1:-1)}}return(o<-mt||o<mt&&c<-1e-12)^u&1}function Cm(e,t,n,r){return function(i){var s=t(i),o=Sm(),u=t(o),c=!1,l,h,d,p={point:g,lineStart:E,lineEnd:v,polygonStart:function(){p.point=b,p.lineStart=C,p.lineEnd=N,h=[],l=[]},polygonEnd:function(){p.point=g,p.lineStart=E,p.lineEnd=v,h=tm(h);var x=Z1(l,r);h.length?(c||(i.polygonStart(),c=!0),bm(h,eA,x,n,i)):x&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),h=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function g(x,M){e(x,M)&&i.point(x,M)}function _(x,M){s.point(x,M)}function E(){p.point=_,s.lineStart()}function v(){p.point=g,s.lineEnd()}function b(x,M){d.push([x,M]),u.point(x,M)}function C(){u.lineStart(),d=[]}function N(){b(d[0][0],d[0][1]),u.lineEnd();var x=u.clean(),M=o.result(),U,I=M.length,w,T,S;if(d.pop(),l.push(d),d=null,!!I){if(x&1){if(T=M[0],(w=T.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),U=0;U<w;++U)i.point((S=T[U])[0],S[1]);i.lineEnd()}return}I>1&&x&2&&M.push(M.pop().concat(M.shift())),h.push(M.filter(tA))}}return p}}function tA(e){return e.length>1}function eA(e,t){return((e=e.x)[0]<0?e[1]-Pe-mt:Pe-e[1])-((t=t.x)[0]<0?t[1]-Pe-mt:Pe-t[1])}const Af=Cm(function(){return!0},nA,iA,[-ot,-Pe]);function nA(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var u=s>0?ot:-ot,c=Et(s-t);Et(c-ot)<mt?(e.point(t,n=(n+o)/2>0?Pe:-Pe),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&c>=ot&&(Et(t-r)<mt&&(t-=r*mt),Et(s-u)<mt&&(s-=u*mt),n=rA(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=o),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function rA(e,t,n,r){var i,s,o=xt(e-n);return Et(o)>mt?K1((xt(t)*(s=Pt(r))*xt(n)-xt(r)*(i=Pt(t))*xt(e))/(i*s*o)):(t+r)/2}function iA(e,t,n,r){var i;if(e==null)i=n*Pe,r.point(-ot,i),r.point(0,i),r.point(ot,i),r.point(ot,0),r.point(ot,-i),r.point(0,-i),r.point(-ot,-i),r.point(-ot,0),r.point(-ot,i);else if(Et(e[0]-t[0])>mt){var s=e[0]<t[0]?ot:-ot;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function sA(e){var t=Pt(e),n=2*Ee,r=t>0,i=Et(t)>mt;function s(h,d,p,g){J1(g,e,n,p,h,d)}function o(h,d){return Pt(h)*Pt(d)>t}function u(h){var d,p,g,_,E;return{lineStart:function(){_=g=!1,E=1},point:function(v,b){var C=[v,b],N,x=o(v,b),M=r?x?0:l(v,b):x?l(v+(v<0?ot:-ot),b):0;if(!d&&(_=g=x)&&h.lineStart(),x!==g&&(N=c(d,C),(!N||oo(d,N)||oo(C,N))&&(C[2]=1)),x!==g)E=0,x?(h.lineStart(),N=c(C,d),h.point(N[0],N[1])):(N=c(d,C),h.point(N[0],N[1],2),h.lineEnd()),d=N;else if(i&&d&&r^x){var U;!(M&p)&&(U=c(C,d,!0))&&(E=0,r?(h.lineStart(),h.point(U[0][0],U[0][1]),h.point(U[1][0],U[1][1]),h.lineEnd()):(h.point(U[1][0],U[1][1]),h.lineEnd(),h.lineStart(),h.point(U[0][0],U[0][1],3)))}x&&(!d||!oo(d,C))&&h.point(C[0],C[1]),d=C,g=x,p=M},lineEnd:function(){g&&h.lineEnd(),d=null},clean:function(){return E|(_&&g)<<1}}}function c(h,d,p){var g=Hr(h),_=Hr(d),E=[1,0,0],v=Vo(g,_),b=zs(v,v),C=v[0],N=b-C*C;if(!N)return!p&&h;var x=t*b/N,M=-t*C/N,U=Vo(E,v),I=Hs(E,x),w=Hs(v,M);su(I,w);var T=U,S=zs(I,T),R=zs(T,T),P=S*S-R*(zs(I,I)-1);if(!(P<0)){var A=Er(P),X=Hs(T,(-S-A)/R);if(su(X,I),X=Mu(X),!p)return X;var L=h[0],J=d[0],ct=h[1],_t=d[1],Ot;J<L&&(Ot=L,L=J,J=Ot);var ke=J-L,ge=Et(ke-ot)<mt,Lt=ge||ke<mt;if(!ge&&_t<ct&&(Ot=ct,ct=_t,_t=Ot),Lt?ge?ct+_t>0^X[1]<(Et(X[0]-L)<mt?ct:_t):ct<=X[1]&&X[1]<=_t:ke>ot^(L<=X[0]&&X[0]<=J)){var ht=Hs(T,(-S+A)/R);return su(ht,I),[X,Mu(ht)]}}}function l(h,d){var p=r?e:ot-e,g=0;return h<-p?g|=1:h>p&&(g|=2),d<-p?g|=4:d>p&&(g|=8),g}return Cm(o,u,s,r?[0,-e]:[-ot,e-ot])}function oA(e,t,n,r,i,s){var o=e[0],u=e[1],c=t[0],l=t[1],h=0,d=1,p=c-o,g=l-u,_;if(_=n-o,!(!p&&_>0)){if(_/=p,p<0){if(_<h)return;_<d&&(d=_)}else if(p>0){if(_>d)return;_>h&&(h=_)}if(_=i-o,!(!p&&_<0)){if(_/=p,p<0){if(_>d)return;_>h&&(h=_)}else if(p>0){if(_<h)return;_<d&&(d=_)}if(_=r-u,!(!g&&_>0)){if(_/=g,g<0){if(_<h)return;_<d&&(d=_)}else if(g>0){if(_>d)return;_>h&&(h=_)}if(_=s-u,!(!g&&_<0)){if(_/=g,g<0){if(_>d)return;_>h&&(h=_)}else if(g>0){if(_<h)return;_<d&&(d=_)}return h>0&&(e[0]=o+h*p,e[1]=u+h*g),d<1&&(t[0]=o+d*p,t[1]=u+d*g),!0}}}}}var xi=1e9,Ws=-xi;function aA(e,t,n,r){function i(l,h){return e<=l&&l<=n&&t<=h&&h<=r}function s(l,h,d,p){var g=0,_=0;if(l==null||(g=o(l,d))!==(_=o(h,d))||c(l,h)<0^d>0)do p.point(g===0||g===3?e:n,g>1?r:t);while((g=(g+d+4)%4)!==_);else p.point(h[0],h[1])}function o(l,h){return Et(l[0]-e)<mt?h>0?0:3:Et(l[0]-n)<mt?h>0?2:1:Et(l[1]-t)<mt?h>0?1:0:h>0?3:2}function u(l,h){return c(l.x,h.x)}function c(l,h){var d=o(l,1),p=o(h,1);return d!==p?d-p:d===0?h[1]-l[1]:d===1?l[0]-h[0]:d===2?l[1]-h[1]:h[0]-l[0]}return function(l){var h=l,d=Sm(),p,g,_,E,v,b,C,N,x,M,U,I={point:w,lineStart:P,lineEnd:A,polygonStart:S,polygonEnd:R};function w(L,J){i(L,J)&&h.point(L,J)}function T(){for(var L=0,J=0,ct=g.length;J<ct;++J)for(var _t=g[J],Ot=1,ke=_t.length,ge=_t[0],Lt,ht,In=ge[0],ue=ge[1];Ot<ke;++Ot)Lt=In,ht=ue,ge=_t[Ot],In=ge[0],ue=ge[1],ht<=r?ue>r&&(In-Lt)*(r-ht)>(ue-ht)*(e-Lt)&&++L:ue<=r&&(In-Lt)*(r-ht)<(ue-ht)*(e-Lt)&&--L;return L}function S(){h=d,p=[],g=[],U=!0}function R(){var L=T(),J=U&&L,ct=(p=tm(p)).length;(J||ct)&&(l.polygonStart(),J&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),ct&&bm(p,u,L,s,l),l.polygonEnd()),h=l,p=g=_=null}function P(){I.point=X,g&&g.push(_=[]),M=!0,x=!1,C=N=NaN}function A(){p&&(X(E,v),b&&x&&d.rejoin(),p.push(d.result())),I.point=w,x&&h.lineEnd()}function X(L,J){var ct=i(L,J);if(g&&_.push([L,J]),M)E=L,v=J,b=ct,M=!1,ct&&(h.lineStart(),h.point(L,J));else if(ct&&x)h.point(L,J);else{var _t=[C=Math.max(Ws,Math.min(xi,C)),N=Math.max(Ws,Math.min(xi,N))],Ot=[L=Math.max(Ws,Math.min(xi,L)),J=Math.max(Ws,Math.min(xi,J))];oA(_t,Ot,e,t,n,r)?(x||(h.lineStart(),h.point(_t[0],_t[1])),h.point(Ot[0],Ot[1]),ct||h.lineEnd(),U=!1):ct&&(h.lineStart(),h.point(L,J),U=!1)}C=L,N=J,x=ct}return I}}const Bu=e=>e;var au=new mr,$u=new mr,Pm,xm,qu,ju,fn={point:xe,lineStart:xe,lineEnd:xe,polygonStart:function(){fn.lineStart=uA,fn.lineEnd=cA},polygonEnd:function(){fn.lineStart=fn.lineEnd=fn.point=xe,au.add(Et($u)),$u=new mr},result:function(){var e=au/2;return au=new mr,e}};function uA(){fn.point=lA}function lA(e,t){fn.point=Vm,Pm=qu=e,xm=ju=t}function Vm(e,t){$u.add(ju*e-qu*t),qu=e,ju=t}function cA(){Vm(Pm,xm)}var Gr=1/0,No=Gr,es=-Gr,Do=es,ko={point:hA,lineStart:xe,lineEnd:xe,polygonStart:xe,polygonEnd:xe,result:function(){var e=[[Gr,No],[es,Do]];return es=Do=-(No=Gr=1/0),e}};function hA(e,t){e<Gr&&(Gr=e),e>es&&(es=e),t<No&&(No=t),t>Do&&(Do=t)}var zu=0,Hu=0,Vi=0,Oo=0,Mo=0,Lr=0,Gu=0,Wu=0,Ni=0,Nm,Dm,We,Ke,be={point:_r,lineStart:If,lineEnd:Rf,polygonStart:function(){be.lineStart=pA,be.lineEnd=mA},polygonEnd:function(){be.point=_r,be.lineStart=If,be.lineEnd=Rf},result:function(){var e=Ni?[Gu/Ni,Wu/Ni]:Lr?[Oo/Lr,Mo/Lr]:Vi?[zu/Vi,Hu/Vi]:[NaN,NaN];return zu=Hu=Vi=Oo=Mo=Lr=Gu=Wu=Ni=0,e}};function _r(e,t){zu+=e,Hu+=t,++Vi}function If(){be.point=fA}function fA(e,t){be.point=dA,_r(We=e,Ke=t)}function dA(e,t){var n=e-We,r=t-Ke,i=Er(n*n+r*r);Oo+=i*(We+e)/2,Mo+=i*(Ke+t)/2,Lr+=i,_r(We=e,Ke=t)}function Rf(){be.point=_r}function pA(){be.point=gA}function mA(){km(Nm,Dm)}function gA(e,t){be.point=km,_r(Nm=We=e,Dm=Ke=t)}function km(e,t){var n=e-We,r=t-Ke,i=Er(n*n+r*r);Oo+=i*(We+e)/2,Mo+=i*(Ke+t)/2,Lr+=i,i=Ke*e-We*t,Gu+=i*(We+e),Wu+=i*(Ke+t),Ni+=i*3,_r(We=e,Ke=t)}function Om(e){this._context=e}Om.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,De);break}}},result:xe};var Ku=new mr,uu,Mm,Fm,Di,ki,ns={point:xe,lineStart:function(){ns.point=_A},lineEnd:function(){uu&&Lm(Mm,Fm),ns.point=xe},polygonStart:function(){uu=!0},polygonEnd:function(){uu=null},result:function(){var e=+Ku;return Ku=new mr,e}};function _A(e,t){ns.point=Lm,Mm=Di=e,Fm=ki=t}function Lm(e,t){Di-=e,ki-=t,Ku.add(Er(Di*Di+ki*ki)),Di=e,ki=t}let Sf,Fo,bf,Cf;class Pf{constructor(t){this._append=t==null?Um:yA(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==bf||this._append!==Fo){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,bf=r,Fo=this._append,Cf=this._,this._=i}this._+=Cf;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Um(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function yA(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Um;if(t!==Sf){const n=10**t;Sf=t,Fo=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return Fo}function vA(e,t){let n=3,r=4.5,i,s;function o(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Nr(u,i(s))),s.result()}return o.area=function(u){return Nr(u,i(fn)),fn.result()},o.measure=function(u){return Nr(u,i(ns)),ns.result()},o.bounds=function(u){return Nr(u,i(ko)),ko.result()},o.centroid=function(u){return Nr(u,i(be)),be.result()},o.projection=function(u){return arguments.length?(i=u==null?(e=null,Bu):(e=u).stream,o):e},o.context=function(u){return arguments.length?(s=u==null?(t=null,new Pf(n)):new Om(t=u),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),o):r},o.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const c=Math.floor(u);if(!(c>=0))throw new RangeError(`invalid digits: ${u}`);n=c}return t===null&&(s=new Pf(n)),o},o.projection(e).digits(n).context(t)}function Hl(e){return function(t){var n=new Qu;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Qu(){}Qu.prototype={constructor:Qu,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Gl(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Nr(n,e.stream(ko)),t(ko.result()),r!=null&&e.clipExtent(r),e}function Bm(e,t,n){return Gl(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([u,c])},n)}function wA(e,t,n){return Bm(e,[[0,0],t],n)}function EA(e,t,n){return Gl(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([o,u])},n)}function TA(e,t,n){return Gl(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,u])},n)}var xf=16,AA=Pt(30*Ee);function Vf(e,t){return+t?RA(e,t):IA(e)}function IA(e){return Hl({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function RA(e,t){function n(r,i,s,o,u,c,l,h,d,p,g,_,E,v){var b=l-r,C=h-i,N=b*b+C*C;if(N>4*t&&E--){var x=o+p,M=u+g,U=c+_,I=Er(x*x+M*M+U*U),w=ts(U/=I),T=Et(Et(U)-1)<mt||Et(s-d)<mt?(s+d)/2:Zi(M,x),S=e(T,w),R=S[0],P=S[1],A=R-r,X=P-i,L=C*A-b*X;(L*L/N>t||Et((b*A+C*X)/N-.5)>.3||o*p+u*g+c*_<AA)&&(n(r,i,s,o,u,c,R,P,T,x/=I,M/=I,U,E,v),v.point(R,P),n(R,P,T,x,M,U,l,h,d,p,g,_,E,v))}}return function(r){var i,s,o,u,c,l,h,d,p,g,_,E,v={point:b,lineStart:C,lineEnd:x,polygonStart:function(){r.polygonStart(),v.lineStart=M},polygonEnd:function(){r.polygonEnd(),v.lineStart=C}};function b(w,T){w=e(w,T),r.point(w[0],w[1])}function C(){d=NaN,v.point=N,r.lineStart()}function N(w,T){var S=Hr([w,T]),R=e(w,T);n(d,p,h,g,_,E,d=R[0],p=R[1],h=w,g=S[0],_=S[1],E=S[2],xf,r),r.point(d,p)}function x(){v.point=b,r.lineEnd()}function M(){C(),v.point=U,v.lineEnd=I}function U(w,T){N(i=w,T),s=d,o=p,u=g,c=_,l=E,v.point=N}function I(){n(d,p,h,g,_,E,s,o,i,u,c,l,xf,r),v.lineEnd=x,x()}return v}}var SA=Hl({point:function(e,t){this.stream.point(e*Ee,t*Ee)}});function bA(e){return Hl({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function CA(e,t,n,r,i){function s(o,u){return o*=r,u*=i,[t+e*o,n-e*u]}return s.invert=function(o,u){return[(o-t)/e*r,(n-u)/e*i]},s}function Nf(e,t,n,r,i,s){if(!s)return CA(e,t,n,r,i);var o=Pt(s),u=xt(s),c=o*e,l=u*e,h=o/e,d=u/e,p=(u*n-o*t)/e,g=(u*t+o*n)/e;function _(E,v){return E*=r,v*=i,[c*E-l*v+t,n-l*E-c*v]}return _.invert=function(E,v){return[r*(h*E-d*v+p),i*(g-d*E-h*v)]},_}function PA(e){return xA(function(){return e})()}function xA(e){var t,n=150,r=480,i=250,s=0,o=0,u=0,c=0,l=0,h,d=0,p=1,g=1,_=null,E=Af,v=null,b,C,N,x=Bu,M=.5,U,I,w,T,S;function R(L){return w(L[0]*Ee,L[1]*Ee)}function P(L){return L=w.invert(L[0],L[1]),L&&[L[0]*hn,L[1]*hn]}R.stream=function(L){return T&&S===L?T:T=SA(bA(h)(E(U(x(S=L)))))},R.preclip=function(L){return arguments.length?(E=L,_=void 0,X()):E},R.postclip=function(L){return arguments.length?(x=L,v=b=C=N=null,X()):x},R.clipAngle=function(L){return arguments.length?(E=+L?sA(_=L*Ee):(_=null,Af),X()):_*hn},R.clipExtent=function(L){return arguments.length?(x=L==null?(v=b=C=N=null,Bu):aA(v=+L[0][0],b=+L[0][1],C=+L[1][0],N=+L[1][1]),X()):v==null?null:[[v,b],[C,N]]},R.scale=function(L){return arguments.length?(n=+L,A()):n},R.translate=function(L){return arguments.length?(r=+L[0],i=+L[1],A()):[r,i]},R.center=function(L){return arguments.length?(s=L[0]%360*Ee,o=L[1]%360*Ee,A()):[s*hn,o*hn]},R.rotate=function(L){return arguments.length?(u=L[0]%360*Ee,c=L[1]%360*Ee,l=L.length>2?L[2]%360*Ee:0,A()):[u*hn,c*hn,l*hn]},R.angle=function(L){return arguments.length?(d=L%360*Ee,A()):d*hn},R.reflectX=function(L){return arguments.length?(p=L?-1:1,A()):p<0},R.reflectY=function(L){return arguments.length?(g=L?-1:1,A()):g<0},R.precision=function(L){return arguments.length?(U=Vf(I,M=L*L),X()):Er(M)},R.fitExtent=function(L,J){return Bm(R,L,J)},R.fitSize=function(L,J){return wA(R,L,J)},R.fitWidth=function(L,J){return EA(R,L,J)},R.fitHeight=function(L,J){return TA(R,L,J)};function A(){var L=Nf(n,0,0,p,g,d).apply(null,t(s,o)),J=Nf(n,r-L[0],i-L[1],p,g,d);return h=Y1(u,c,l),I=Lu(t,J),w=Lu(h,I),U=Vf(I,M),X()}function X(){return T=S=null,R}return function(){return t=e.apply(this,arguments),R.invert=t.invert&&P,A()}}function $m(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}$m.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(Et(i)>mt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function VA(){return PA($m).scale(175.295)}function Oi(e,t,n){this.k=e,this.x=t,this.y=n}Oi.prototype={constructor:Oi,scale:function(e){return e===1?this:new Oi(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Oi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Oi.prototype;function NA(e){return e}function DA(e){if(e==null)return NA;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(u,c){c||(t=n=0);var l=2,h=u.length,d=new Array(h);for(d[0]=(t+=u[0])*r+s,d[1]=(n+=u[1])*i+o;l<h;)d[l]=u[l],++l;return d}}function kA(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function Df(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return kf(e,n)})}:kf(e,t)}function kf(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=OA(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function OA(e,t){var n=DA(e.transform),r=e.arcs;function i(h,d){d.length&&d.pop();for(var p=r[h<0?~h:h],g=0,_=p.length;g<_;++g)d.push(n(p[g],g));h<0&&kA(d,_)}function s(h){return n(h)}function o(h){for(var d=[],p=0,g=h.length;p<g;++p)i(h[p],d);return d.length<2&&d.push(d[0]),d}function u(h){for(var d=o(h);d.length<4;)d.push(d[0]);return d}function c(h){return h.map(u)}function l(h){var d=h.type,p;switch(d){case"GeometryCollection":return{type:d,geometries:h.geometries.map(l)};case"Point":p=s(h.coordinates);break;case"MultiPoint":p=h.coordinates.map(s);break;case"LineString":p=o(h.arcs);break;case"MultiLineString":p=h.arcs.map(o);break;case"Polygon":p=c(h.arcs);break;case"MultiPolygon":p=h.arcs.map(c);break;default:return null}return{type:d,coordinates:p}}return l(t)}const MA=()=>{};var Of={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},FA=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],o=e[n++],u=e[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},jm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,u=o?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,h=s>>2,d=(s&3)<<4|u>>4;let p=(u&15)<<2|l>>6,g=l&63;c||(g=64,o||(p=64)),r.push(n[h],n[d],n[p],n[g])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(qm(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):FA(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],u=i<e.length?n[e.charAt(i)]:0;++i;const l=i<e.length?n[e.charAt(i)]:64;++i;const d=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||u==null||l==null||d==null)throw new LA;const p=s<<2|u>>4;if(r.push(p),l!==64){const g=u<<4&240|l>>2;if(r.push(g),d!==64){const _=l<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class LA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UA=function(e){const t=qm(e);return jm.encodeByteArray(t,!0)},Lo=function(e){return UA(e).replace(/\./g,"")},BA=function(e){try{return jm.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA=()=>$A().__FIREBASE_DEFAULTS__,jA=()=>{if(typeof process>"u"||typeof Of>"u")return;const e=Of.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},zA=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&BA(e[1]);return t&&JSON.parse(t)},Wl=()=>{try{return MA()||qA()||jA()||zA()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},HA=e=>{var t,n;return(n=(t=Wl())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},GA=e=>{const t=HA(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},zm=()=>{var e;return(e=Wl())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kl(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function KA(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Lo(JSON.stringify(n)),Lo(JSON.stringify(o)),""].join(".")}const $i={};function XA(){const e={prod:[],emulator:[]};for(const t of Object.keys($i))$i[t]?e.emulator.push(t):e.prod.push(t);return e}function YA(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let Mf=!1;function JA(e,t){if(typeof window>"u"||typeof document>"u"||!Kl(window.location.host)||$i[e]===t||$i[e]||Mf)return;$i[e]=t;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=XA().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function u(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function l(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Mf=!0,o()},p}function h(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=YA(r),g=n("text"),_=document.getElementById(g)||document.createElement("span"),E=n("learnmore"),v=document.getElementById(E)||document.createElement("a"),b=n("preprendIcon"),C=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;u(N),h(v,E);const x=l();c(C,b),N.append(C,_,v,x),document.body.appendChild(N)}s?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tI(){var e;const t=(e=Wl())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eI(){return!tI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nI(){try{return typeof indexedDB=="object"}catch{return!1}}function rI(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="FirebaseError";class ii extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=iI,Object.setPrototypeOf(this,ii.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hm.prototype.create)}}class Hm{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?sI(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new ii(i,u,r)}}function sI(e,t){return e.replace(oI,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const oI=/\{\$([^}]+)}/g;function Uo(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],o=t[i];if(Ff(s)&&Ff(o)){if(!Uo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ff(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(e){return e&&e._delegate?e._delegate:e}class rs{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new WA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(lI(t))try{this.getOrInitializeService({instanceIdentifier:sr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=sr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=sr){return this.instances.has(t)}getOptions(t=sr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:uI(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=sr){return this.component?this.component.multipleInstances?t:sr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uI(e){return e===sr?void 0:e}function lI(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new aI(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(st||(st={}));const hI={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},fI=st.INFO,dI={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},pI=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=dI[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Gm{constructor(t){this.name=t,this._logLevel=fI,this._logHandler=pI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in st))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?hI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...t),this._logHandler(this,st.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...t),this._logHandler(this,st.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,st.INFO,...t),this._logHandler(this,st.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,st.WARN,...t),this._logHandler(this,st.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...t),this._logHandler(this,st.ERROR,...t)}}const mI=(e,t)=>t.some(n=>e instanceof n);let Lf,Uf;function gI(){return Lf||(Lf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _I(){return Uf||(Uf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wm=new WeakMap,Xu=new WeakMap,Km=new WeakMap,lu=new WeakMap,Ql=new WeakMap;function yI(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(Nn(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Wm.set(n,e)}).catch(()=>{}),Ql.set(t,e),t}function vI(e){if(Xu.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});Xu.set(e,t)}let Yu={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Xu.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Km.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function wI(e){Yu=e(Yu)}function EI(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(cu(this),t,...n);return Km.set(r,t.sort?t.sort():[t]),Nn(r)}:_I().includes(e)?function(...t){return e.apply(cu(this),t),Nn(Wm.get(this))}:function(...t){return Nn(e.apply(cu(this),t))}}function TI(e){return typeof e=="function"?EI(e):(e instanceof IDBTransaction&&vI(e),mI(e,gI())?new Proxy(e,Yu):e)}function Nn(e){if(e instanceof IDBRequest)return yI(e);if(lu.has(e))return lu.get(e);const t=TI(e);return t!==e&&(lu.set(e,t),Ql.set(t,e)),t}const cu=e=>Ql.get(e);function AI(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),u=Nn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Nn(o.result),c.oldVersion,c.newVersion,Nn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),u}const II=["get","getKey","getAll","getAllKeys","count"],RI=["put","add","delete","clear"],hu=new Map;function Bf(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(hu.get(t))return hu.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=RI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||II.includes(n)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(u.shift())),(await Promise.all([l[n](...u),i&&c.done]))[0]};return hu.set(t,s),s}wI(e=>({...e,get:(t,n,r)=>Bf(t,n)||e.get(t,n,r),has:(t,n)=>!!Bf(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(bI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function bI(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Ju="@firebase/app",$f="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn=new Gm("@firebase/app"),CI="@firebase/app-compat",PI="@firebase/analytics-compat",xI="@firebase/analytics",VI="@firebase/app-check-compat",NI="@firebase/app-check",DI="@firebase/auth",kI="@firebase/auth-compat",OI="@firebase/database",MI="@firebase/data-connect",FI="@firebase/database-compat",LI="@firebase/functions",UI="@firebase/functions-compat",BI="@firebase/installations",$I="@firebase/installations-compat",qI="@firebase/messaging",jI="@firebase/messaging-compat",zI="@firebase/performance",HI="@firebase/performance-compat",GI="@firebase/remote-config",WI="@firebase/remote-config-compat",KI="@firebase/storage",QI="@firebase/storage-compat",XI="@firebase/firestore",YI="@firebase/ai",JI="@firebase/firestore-compat",ZI="firebase",tR="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu="[DEFAULT]",eR={[Ju]:"fire-core",[CI]:"fire-core-compat",[xI]:"fire-analytics",[PI]:"fire-analytics-compat",[NI]:"fire-app-check",[VI]:"fire-app-check-compat",[DI]:"fire-auth",[kI]:"fire-auth-compat",[OI]:"fire-rtdb",[MI]:"fire-data-connect",[FI]:"fire-rtdb-compat",[LI]:"fire-fn",[UI]:"fire-fn-compat",[BI]:"fire-iid",[$I]:"fire-iid-compat",[qI]:"fire-fcm",[jI]:"fire-fcm-compat",[zI]:"fire-perf",[HI]:"fire-perf-compat",[GI]:"fire-rc",[WI]:"fire-rc-compat",[KI]:"fire-gcs",[QI]:"fire-gcs-compat",[XI]:"fire-fst",[JI]:"fire-fst-compat",[YI]:"fire-vertex","fire-js":"fire-js",[ZI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo=new Map,nR=new Map,tl=new Map;function qf(e,t){try{e.container.addComponent(t)}catch(n){vn.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function $o(e){const t=e.name;if(tl.has(t))return vn.debug(`There were multiple attempts to register component ${t}.`),!1;tl.set(t,e);for(const n of Bo.values())qf(n,e);for(const n of nR.values())qf(n,e);return!0}function rR(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function iR(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dn=new Hm("app","Firebase",sR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new rs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Dn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=tR;function Qm(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Zu,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw Dn.create("bad-app-name",{appName:String(i)});if(n||(n=zm()),!n)throw Dn.create("no-options");const s=Bo.get(i);if(s){if(Uo(n,s.options)&&Uo(r,s.config))return s;throw Dn.create("duplicate-app",{appName:i})}const o=new cI(i);for(const c of tl.values())o.addComponent(c);const u=new oR(n,r,o);return Bo.set(i,u),u}function uR(e=Zu){const t=Bo.get(e);if(!t&&e===Zu&&zm())return Qm();if(!t)throw Dn.create("no-app",{appName:e});return t}function Br(e,t,n){var r;let i=(r=eR[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${t}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),vn.warn(u.join(" "));return}$o(new rs(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR="firebase-heartbeat-database",cR=1,is="firebase-heartbeat-store";let fu=null;function Xm(){return fu||(fu=AI(lR,cR,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(is)}catch(n){console.warn(n)}}}}).catch(e=>{throw Dn.create("idb-open",{originalErrorMessage:e.message})})),fu}async function hR(e){try{const n=(await Xm()).transaction(is),r=await n.objectStore(is).get(Ym(e));return await n.done,r}catch(t){if(t instanceof ii)vn.warn(t.message);else{const n=Dn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});vn.warn(n.message)}}}async function jf(e,t){try{const r=(await Xm()).transaction(is,"readwrite");await r.objectStore(is).put(t,Ym(e)),await r.done}catch(n){if(n instanceof ii)vn.warn(n.message);else{const r=Dn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});vn.warn(r.message)}}}function Ym(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR=1024,dR=30;class pR{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new gR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zf();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>dR){const o=_R(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){vn.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=zf(),{heartbeatsToSend:r,unsentEntries:i}=mR(this._heartbeatsCache.heartbeats),s=Lo(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return vn.warn(n),""}}}function zf(){return new Date().toISOString().substring(0,10)}function mR(e,t=fR){const n=[];let r=e.slice();for(const i of e){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Hf(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Hf(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class gR{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nI()?rI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await hR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return jf(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return jf(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Hf(e){return Lo(JSON.stringify({version:2,heartbeats:e})).length}function _R(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(e){$o(new rs("platform-logger",t=>new SI(t),"PRIVATE")),$o(new rs("heartbeat",t=>new pR(t),"PRIVATE")),Br(Ju,$f,e),Br(Ju,$f,"esm2017"),Br("fire-js","")}yR("");var vR="firebase",wR="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Br(vR,wR,"app");var Gf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kn,Jm;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(I,w){function T(){}T.prototype=w.prototype,I.D=w.prototype,I.prototype=new T,I.prototype.constructor=I,I.C=function(S,R,P){for(var A=Array(arguments.length-2),X=2;X<arguments.length;X++)A[X-2]=arguments[X];return w.prototype[R].apply(S,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,w,T){T||(T=0);var S=Array(16);if(typeof w=="string")for(var R=0;16>R;++R)S[R]=w.charCodeAt(T++)|w.charCodeAt(T++)<<8|w.charCodeAt(T++)<<16|w.charCodeAt(T++)<<24;else for(R=0;16>R;++R)S[R]=w[T++]|w[T++]<<8|w[T++]<<16|w[T++]<<24;w=I.g[0],T=I.g[1],R=I.g[2];var P=I.g[3],A=w+(P^T&(R^P))+S[0]+3614090360&4294967295;w=T+(A<<7&4294967295|A>>>25),A=P+(R^w&(T^R))+S[1]+3905402710&4294967295,P=w+(A<<12&4294967295|A>>>20),A=R+(T^P&(w^T))+S[2]+606105819&4294967295,R=P+(A<<17&4294967295|A>>>15),A=T+(w^R&(P^w))+S[3]+3250441966&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(P^T&(R^P))+S[4]+4118548399&4294967295,w=T+(A<<7&4294967295|A>>>25),A=P+(R^w&(T^R))+S[5]+1200080426&4294967295,P=w+(A<<12&4294967295|A>>>20),A=R+(T^P&(w^T))+S[6]+2821735955&4294967295,R=P+(A<<17&4294967295|A>>>15),A=T+(w^R&(P^w))+S[7]+4249261313&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(P^T&(R^P))+S[8]+1770035416&4294967295,w=T+(A<<7&4294967295|A>>>25),A=P+(R^w&(T^R))+S[9]+2336552879&4294967295,P=w+(A<<12&4294967295|A>>>20),A=R+(T^P&(w^T))+S[10]+4294925233&4294967295,R=P+(A<<17&4294967295|A>>>15),A=T+(w^R&(P^w))+S[11]+2304563134&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(P^T&(R^P))+S[12]+1804603682&4294967295,w=T+(A<<7&4294967295|A>>>25),A=P+(R^w&(T^R))+S[13]+4254626195&4294967295,P=w+(A<<12&4294967295|A>>>20),A=R+(T^P&(w^T))+S[14]+2792965006&4294967295,R=P+(A<<17&4294967295|A>>>15),A=T+(w^R&(P^w))+S[15]+1236535329&4294967295,T=R+(A<<22&4294967295|A>>>10),A=w+(R^P&(T^R))+S[1]+4129170786&4294967295,w=T+(A<<5&4294967295|A>>>27),A=P+(T^R&(w^T))+S[6]+3225465664&4294967295,P=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(P^w))+S[11]+643717713&4294967295,R=P+(A<<14&4294967295|A>>>18),A=T+(P^w&(R^P))+S[0]+3921069994&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^P&(T^R))+S[5]+3593408605&4294967295,w=T+(A<<5&4294967295|A>>>27),A=P+(T^R&(w^T))+S[10]+38016083&4294967295,P=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(P^w))+S[15]+3634488961&4294967295,R=P+(A<<14&4294967295|A>>>18),A=T+(P^w&(R^P))+S[4]+3889429448&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^P&(T^R))+S[9]+568446438&4294967295,w=T+(A<<5&4294967295|A>>>27),A=P+(T^R&(w^T))+S[14]+3275163606&4294967295,P=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(P^w))+S[3]+4107603335&4294967295,R=P+(A<<14&4294967295|A>>>18),A=T+(P^w&(R^P))+S[8]+1163531501&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(R^P&(T^R))+S[13]+2850285829&4294967295,w=T+(A<<5&4294967295|A>>>27),A=P+(T^R&(w^T))+S[2]+4243563512&4294967295,P=w+(A<<9&4294967295|A>>>23),A=R+(w^T&(P^w))+S[7]+1735328473&4294967295,R=P+(A<<14&4294967295|A>>>18),A=T+(P^w&(R^P))+S[12]+2368359562&4294967295,T=R+(A<<20&4294967295|A>>>12),A=w+(T^R^P)+S[5]+4294588738&4294967295,w=T+(A<<4&4294967295|A>>>28),A=P+(w^T^R)+S[8]+2272392833&4294967295,P=w+(A<<11&4294967295|A>>>21),A=R+(P^w^T)+S[11]+1839030562&4294967295,R=P+(A<<16&4294967295|A>>>16),A=T+(R^P^w)+S[14]+4259657740&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^P)+S[1]+2763975236&4294967295,w=T+(A<<4&4294967295|A>>>28),A=P+(w^T^R)+S[4]+1272893353&4294967295,P=w+(A<<11&4294967295|A>>>21),A=R+(P^w^T)+S[7]+4139469664&4294967295,R=P+(A<<16&4294967295|A>>>16),A=T+(R^P^w)+S[10]+3200236656&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^P)+S[13]+681279174&4294967295,w=T+(A<<4&4294967295|A>>>28),A=P+(w^T^R)+S[0]+3936430074&4294967295,P=w+(A<<11&4294967295|A>>>21),A=R+(P^w^T)+S[3]+3572445317&4294967295,R=P+(A<<16&4294967295|A>>>16),A=T+(R^P^w)+S[6]+76029189&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(T^R^P)+S[9]+3654602809&4294967295,w=T+(A<<4&4294967295|A>>>28),A=P+(w^T^R)+S[12]+3873151461&4294967295,P=w+(A<<11&4294967295|A>>>21),A=R+(P^w^T)+S[15]+530742520&4294967295,R=P+(A<<16&4294967295|A>>>16),A=T+(R^P^w)+S[2]+3299628645&4294967295,T=R+(A<<23&4294967295|A>>>9),A=w+(R^(T|~P))+S[0]+4096336452&4294967295,w=T+(A<<6&4294967295|A>>>26),A=P+(T^(w|~R))+S[7]+1126891415&4294967295,P=w+(A<<10&4294967295|A>>>22),A=R+(w^(P|~T))+S[14]+2878612391&4294967295,R=P+(A<<15&4294967295|A>>>17),A=T+(P^(R|~w))+S[5]+4237533241&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~P))+S[12]+1700485571&4294967295,w=T+(A<<6&4294967295|A>>>26),A=P+(T^(w|~R))+S[3]+2399980690&4294967295,P=w+(A<<10&4294967295|A>>>22),A=R+(w^(P|~T))+S[10]+4293915773&4294967295,R=P+(A<<15&4294967295|A>>>17),A=T+(P^(R|~w))+S[1]+2240044497&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~P))+S[8]+1873313359&4294967295,w=T+(A<<6&4294967295|A>>>26),A=P+(T^(w|~R))+S[15]+4264355552&4294967295,P=w+(A<<10&4294967295|A>>>22),A=R+(w^(P|~T))+S[6]+2734768916&4294967295,R=P+(A<<15&4294967295|A>>>17),A=T+(P^(R|~w))+S[13]+1309151649&4294967295,T=R+(A<<21&4294967295|A>>>11),A=w+(R^(T|~P))+S[4]+4149444226&4294967295,w=T+(A<<6&4294967295|A>>>26),A=P+(T^(w|~R))+S[11]+3174756917&4294967295,P=w+(A<<10&4294967295|A>>>22),A=R+(w^(P|~T))+S[2]+718787259&4294967295,R=P+(A<<15&4294967295|A>>>17),A=T+(P^(R|~w))+S[9]+3951481745&4294967295,I.g[0]=I.g[0]+w&4294967295,I.g[1]=I.g[1]+(R+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+P&4294967295}r.prototype.u=function(I,w){w===void 0&&(w=I.length);for(var T=w-this.blockSize,S=this.B,R=this.h,P=0;P<w;){if(R==0)for(;P<=T;)i(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<w;)if(S[R++]=I.charCodeAt(P++),R==this.blockSize){i(this,S),R=0;break}}else for(;P<w;)if(S[R++]=I[P++],R==this.blockSize){i(this,S),R=0;break}}this.h=R,this.o+=w},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var w=1;w<I.length-8;++w)I[w]=0;var T=8*this.o;for(w=I.length-8;w<I.length;++w)I[w]=T&255,T/=256;for(this.u(I),I=Array(16),w=T=0;4>w;++w)for(var S=0;32>S;S+=8)I[T++]=this.g[w]>>>S&255;return I};function s(I,w){var T=u;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=w(I)}function o(I,w){this.h=w;for(var T=[],S=!0,R=I.length-1;0<=R;R--){var P=I[R]|0;S&&P==w||(T[R]=P,S=!1)}this.g=T}var u={};function c(I){return-128<=I&&128>I?s(I,function(w){return new o([w|0],0>w?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return v(l(-I));for(var w=[],T=1,S=0;I>=T;S++)w[S]=I/T|0,T*=4294967296;return new o(w,0)}function h(I,w){if(I.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(I.charAt(0)=="-")return v(h(I.substring(1),w));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=l(Math.pow(w,8)),S=d,R=0;R<I.length;R+=8){var P=Math.min(8,I.length-R),A=parseInt(I.substring(R,R+P),w);8>P?(P=l(Math.pow(w,P)),S=S.j(P).add(l(A))):(S=S.j(T),S=S.add(l(A)))}return S}var d=c(0),p=c(1),g=c(16777216);e=o.prototype,e.m=function(){if(E(this))return-v(this).m();for(var I=0,w=1,T=0;T<this.g.length;T++){var S=this.i(T);I+=(0<=S?S:4294967296+S)*w,w*=4294967296}return I},e.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(E(this))return"-"+v(this).toString(I);for(var w=l(Math.pow(I,6)),T=this,S="";;){var R=x(T,w).g;T=b(T,R.j(w));var P=((0<T.g.length?T.g[0]:T.h)>>>0).toString(I);if(T=R,_(T))return P+S;for(;6>P.length;)P="0"+P;S=P+S}},e.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var w=0;w<I.g.length;w++)if(I.g[w]!=0)return!1;return!0}function E(I){return I.h==-1}e.l=function(I){return I=b(this,I),E(I)?-1:_(I)?0:1};function v(I){for(var w=I.g.length,T=[],S=0;S<w;S++)T[S]=~I.g[S];return new o(T,~I.h).add(p)}e.abs=function(){return E(this)?v(this):this},e.add=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0,R=0;R<=w;R++){var P=S+(this.i(R)&65535)+(I.i(R)&65535),A=(P>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);S=A>>>16,P&=65535,A&=65535,T[R]=A<<16|P}return new o(T,T[T.length-1]&-2147483648?-1:0)};function b(I,w){return I.add(v(w))}e.j=function(I){if(_(this)||_(I))return d;if(E(this))return E(I)?v(this).j(v(I)):v(v(this).j(I));if(E(I))return v(this.j(v(I)));if(0>this.l(g)&&0>I.l(g))return l(this.m()*I.m());for(var w=this.g.length+I.g.length,T=[],S=0;S<2*w;S++)T[S]=0;for(S=0;S<this.g.length;S++)for(var R=0;R<I.g.length;R++){var P=this.i(S)>>>16,A=this.i(S)&65535,X=I.i(R)>>>16,L=I.i(R)&65535;T[2*S+2*R]+=A*L,C(T,2*S+2*R),T[2*S+2*R+1]+=P*L,C(T,2*S+2*R+1),T[2*S+2*R+1]+=A*X,C(T,2*S+2*R+1),T[2*S+2*R+2]+=P*X,C(T,2*S+2*R+2)}for(S=0;S<w;S++)T[S]=T[2*S+1]<<16|T[2*S];for(S=w;S<2*w;S++)T[S]=0;return new o(T,0)};function C(I,w){for(;(I[w]&65535)!=I[w];)I[w+1]+=I[w]>>>16,I[w]&=65535,w++}function N(I,w){this.g=I,this.h=w}function x(I,w){if(_(w))throw Error("division by zero");if(_(I))return new N(d,d);if(E(I))return w=x(v(I),w),new N(v(w.g),v(w.h));if(E(w))return w=x(I,v(w)),new N(v(w.g),w.h);if(30<I.g.length){if(E(I)||E(w))throw Error("slowDivide_ only works with positive integers.");for(var T=p,S=w;0>=S.l(I);)T=M(T),S=M(S);var R=U(T,1),P=U(S,1);for(S=U(S,2),T=U(T,2);!_(S);){var A=P.add(S);0>=A.l(I)&&(R=R.add(T),P=A),S=U(S,1),T=U(T,1)}return w=b(I,R.j(w)),new N(R,w)}for(R=d;0<=I.l(w);){for(T=Math.max(1,Math.floor(I.m()/w.m())),S=Math.ceil(Math.log(T)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),P=l(T),A=P.j(w);E(A)||0<A.l(I);)T-=S,P=l(T),A=P.j(w);_(P)&&(P=p),R=R.add(P),I=b(I,A)}return new N(R,I)}e.A=function(I){return x(this,I).h},e.and=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)&I.i(S);return new o(T,this.h&I.h)},e.or=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)|I.i(S);return new o(T,this.h|I.h)},e.xor=function(I){for(var w=Math.max(this.g.length,I.g.length),T=[],S=0;S<w;S++)T[S]=this.i(S)^I.i(S);return new o(T,this.h^I.h)};function M(I){for(var w=I.g.length+1,T=[],S=0;S<w;S++)T[S]=I.i(S)<<1|I.i(S-1)>>>31;return new o(T,I.h)}function U(I,w){var T=w>>5;w%=32;for(var S=I.g.length-T,R=[],P=0;P<S;P++)R[P]=0<w?I.i(P+T)>>>w|I.i(P+T+1)<<32-w:I.i(P+T);return new o(R,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Jm=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=h,kn=o}).apply(typeof Gf<"u"?Gf:typeof self<"u"?self:typeof window<"u"?window:{});var Ks=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zm,Mi,tg,ao,el,eg,ng,rg;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,f,m){return a==Array.prototype||a==Object.prototype||(a[f]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ks=="object"&&Ks];for(var f=0;f<a.length;++f){var m=a[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function i(a,f){if(f)t:{var m=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var V=a[y];if(!(V in m))break t;m=m[V]}a=a[a.length-1],y=m[a],f=f(y),f!=y&&f!=null&&t(m,a,{configurable:!0,writable:!0,value:f})}}function s(a,f){a instanceof String&&(a+="");var m=0,y=!1,V={next:function(){if(!y&&m<a.length){var k=m++;return{value:f(k,a[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(a){return a||function(){return s(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(a){var f=typeof a;return f=f!="object"?f:a?Array.isArray(a)?"array":f:"null",f=="array"||f=="object"&&typeof a.length=="number"}function l(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function h(a,f,m){return a.call.apply(a.bind,arguments)}function d(a,f,m){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,y),a.apply(f,V)}}return function(){return a.apply(f,arguments)}}function p(a,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function g(a,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function _(a,f){function m(){}m.prototype=f.prototype,a.aa=f.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(y,V,k){for(var $=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)$[pt-2]=arguments[pt];return f.prototype[V].apply(y,$)}}function E(a){const f=a.length;if(0<f){const m=Array(f);for(let y=0;y<f;y++)m[y]=a[y];return m}return[]}function v(a,f){for(let m=1;m<arguments.length;m++){const y=arguments[m];if(c(y)){const V=a.length||0,k=y.length||0;a.length=V+k;for(let $=0;$<k;$++)a[V+$]=y[$]}else a.push(y)}}class b{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function C(a){return/^[\s\xa0]*$/.test(a)}function N(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function x(a){return x[" "](a),a}x[" "]=function(){};var M=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function U(a,f,m){for(const y in a)f.call(m,a[y],y,a)}function I(a,f){for(const m in a)f.call(void 0,a[m],m,a)}function w(a){const f={};for(const m in a)f[m]=a[m];return f}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(a,f){let m,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(m in y)a[m]=y[m];for(let k=0;k<T.length;k++)m=T[k],Object.prototype.hasOwnProperty.call(y,m)&&(a[m]=y[m])}}function R(a){var f=1;a=a.split(":");const m=[];for(;0<f&&a.length;)m.push(a.shift()),f--;return a.length&&m.push(a.join(":")),m}function P(a){u.setTimeout(()=>{throw a},0)}function A(){var a=Ot;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class X{constructor(){this.h=this.g=null}add(f,m){const y=L.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var L=new b(()=>new J,a=>a.reset());class J{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let ct,_t=!1,Ot=new X,ke=()=>{const a=u.Promise.resolve(void 0);ct=()=>{a.then(ge)}};var ge=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(m){P(m)}var f=L;f.j(a),100>f.h&&(f.h++,a.next=f.g,f.g=a)}_t=!1};function Lt(){this.s=this.s,this.C=this.C}Lt.prototype.s=!1,Lt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Lt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ht(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}ht.prototype.h=function(){this.defaultPrevented=!0};var In=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};u.addEventListener("test",m,f),u.removeEventListener("test",m,f)}catch{}return a}();function ue(a,f){if(ht.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget){if(M){t:{try{x(f.nodeName);var V=!0;break t}catch{}V=!1}V||(f=null)}}else m=="mouseover"?f=a.fromElement:m=="mouseout"&&(f=a.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:xa[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ue.aa.h.call(this)}}_(ue,ht);var xa={2:"touch",3:"pen",4:"mouse"};ue.prototype.h=function(){ue.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Ir="closure_listenable_"+(1e6*Math.random()|0),Va=0;function As(a,f,m,y,V){this.listener=a,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=V,this.key=++Va,this.da=this.fa=!1}function Rr(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Qn(a){this.src=a,this.g={},this.h=0}Qn.prototype.add=function(a,f,m,y,V){var k=a.toString();a=this.g[k],a||(a=this.g[k]=[],this.h++);var $=hi(a,f,y,V);return-1<$?(f=a[$],m||(f.fa=!1)):(f=new As(f,this.src,k,!!y,V),f.fa=m,a.push(f)),f};function ci(a,f){var m=f.type;if(m in a.g){var y=a.g[m],V=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=V)&&Array.prototype.splice.call(y,V,1),k&&(Rr(f),a.g[m].length==0&&(delete a.g[m],a.h--))}}function hi(a,f,m,y){for(var V=0;V<a.length;++V){var k=a[V];if(!k.da&&k.listener==f&&k.capture==!!m&&k.ha==y)return V}return-1}var fi="closure_lm_"+(1e6*Math.random()|0),H={};function j(a,f,m,y,V){if(Array.isArray(f)){for(var k=0;k<f.length;k++)j(a,f[k],m,y,V);return null}return m=ye(m),a&&a[Ir]?a.K(f,m,l(y)?!!y.capture:!1,V):K(a,f,m,!1,y,V)}function K(a,f,m,y,V,k){if(!f)throw Error("Invalid event type");var $=l(V)?!!V.capture:!!V,pt=Qt(a);if(pt||(a[fi]=pt=new Qn(a)),m=pt.add(f,m,y,$,k),m.proxy)return m;if(y=nt(),m.proxy=y,y.src=a,y.listener=m,a.addEventListener)In||(V=$),V===void 0&&(V=!1),a.addEventListener(f.toString(),y,V);else if(a.attachEvent)a.attachEvent(Kt(f.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function nt(){function a(m){return f.call(a.src,a.listener,m)}const f=Ut;return a}function yt(a,f,m,y,V){if(Array.isArray(f))for(var k=0;k<f.length;k++)yt(a,f[k],m,y,V);else y=l(y)?!!y.capture:!!y,m=ye(m),a&&a[Ir]?(a=a.i,f=String(f).toString(),f in a.g&&(k=a.g[f],m=hi(k,m,y,V),-1<m&&(Rr(k[m]),Array.prototype.splice.call(k,m,1),k.length==0&&(delete a.g[f],a.h--)))):a&&(a=Qt(a))&&(f=a.g[f.toString()],a=-1,f&&(a=hi(f,m,y,V)),(m=-1<a?f[a]:null)&&bt(m))}function bt(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[Ir])ci(f.i,a);else{var m=a.type,y=a.proxy;f.removeEventListener?f.removeEventListener(m,y,a.capture):f.detachEvent?f.detachEvent(Kt(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=Qt(f))?(ci(m,a),m.h==0&&(m.src=null,f[fi]=null)):Rr(a)}}}function Kt(a){return a in H?H[a]:H[a]="on"+a}function Ut(a,f){if(a.da)a=!0;else{f=new ue(f,this);var m=a.listener,y=a.ha||a.src;a.fa&&bt(a),a=m.call(y,f)}return a}function Qt(a){return a=a[fi],a instanceof Qn?a:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function ye(a){return typeof a=="function"?a:(a[_e]||(a[_e]=function(f){return a.handleEvent(f)}),a[_e])}function ft(){Lt.call(this),this.i=new Qn(this),this.M=this,this.F=null}_(ft,Lt),ft.prototype[Ir]=!0,ft.prototype.removeEventListener=function(a,f,m,y){yt(this,a,f,m,y)};function Rt(a,f){var m,y=a.F;if(y)for(m=[];y;y=y.F)m.push(y);if(a=a.M,y=f.type||f,typeof f=="string")f=new ht(f,a);else if(f instanceof ht)f.target=f.target||a;else{var V=f;f=new ht(y,a),S(f,V)}if(V=!0,m)for(var k=m.length-1;0<=k;k--){var $=f.g=m[k];V=Re($,y,!0,f)&&V}if($=f.g=a,V=Re($,y,!0,f)&&V,V=Re($,y,!1,f)&&V,m)for(k=0;k<m.length;k++)$=f.g=m[k],V=Re($,y,!1,f)&&V}ft.prototype.N=function(){if(ft.aa.N.call(this),this.i){var a=this.i,f;for(f in a.g){for(var m=a.g[f],y=0;y<m.length;y++)Rr(m[y]);delete a.g[f],a.h--}}this.F=null},ft.prototype.K=function(a,f,m,y){return this.i.add(String(a),f,!1,m,y)},ft.prototype.L=function(a,f,m,y){return this.i.add(String(a),f,!0,m,y)};function Re(a,f,m,y){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();for(var V=!0,k=0;k<f.length;++k){var $=f[k];if($&&!$.da&&$.capture==m){var pt=$.listener,zt=$.ha||$.src;$.fa&&ci(a.i,$),V=pt.call(zt,y)!==!1&&V}}return V&&!y.defaultPrevented}function Xn(a,f,m){if(typeof a=="function")m&&(a=p(a,m));else if(a&&typeof a.handleEvent=="function")a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:u.setTimeout(a,f||0)}function Oe(a){a.g=Xn(()=>{a.g=null,a.i&&(a.i=!1,Oe(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class on extends Lt{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Oe(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xt(a){Lt.call(this),this.h=a,this.g={}}_(Xt,Lt);var Yn=[];function Jn(a){U(a.g,function(f,m){this.g.hasOwnProperty(m)&&bt(f)},a),a.g={}}Xt.prototype.N=function(){Xt.aa.N.call(this),Jn(this)},Xt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Na=u.JSON.stringify,M_=u.JSON.parse,F_=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function Da(){}Da.prototype.h=null;function kc(a){return a.h||(a.h=a.i())}function Oc(){}var di={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ka(){ht.call(this,"d")}_(ka,ht);function Oa(){ht.call(this,"c")}_(Oa,ht);var Zn={},Mc=null;function Is(){return Mc=Mc||new ft}Zn.La="serverreachability";function Fc(a){ht.call(this,Zn.La,a)}_(Fc,ht);function pi(a){const f=Is();Rt(f,new Fc(f))}Zn.STAT_EVENT="statevent";function Lc(a,f){ht.call(this,Zn.STAT_EVENT,a),this.stat=f}_(Lc,ht);function re(a){const f=Is();Rt(f,new Lc(f,a))}Zn.Ma="timingevent";function Uc(a,f){ht.call(this,Zn.Ma,a),this.size=f}_(Uc,ht);function mi(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},f)}function gi(){this.g=!0}gi.prototype.xa=function(){this.g=!1};function L_(a,f,m,y,V,k){a.info(function(){if(a.g)if(k)for(var $="",pt=k.split("&"),zt=0;zt<pt.length;zt++){var at=pt[zt].split("=");if(1<at.length){var Yt=at[0];at=at[1];var Jt=Yt.split("_");$=2<=Jt.length&&Jt[1]=="type"?$+(Yt+"="+at+"&"):$+(Yt+"=redacted&")}}else $=null;else $=k;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+f+`
`+m+`
`+$})}function U_(a,f,m,y,V,k,$){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+f+`
`+m+`
`+k+" "+$})}function Sr(a,f,m,y){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+$_(a,m)+(y?" "+y:"")})}function B_(a,f){a.info(function(){return"TIMEOUT: "+f})}gi.prototype.info=function(){};function $_(a,f){if(!a.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var y=m[a];if(!(2>y.length)){var V=y[1];if(Array.isArray(V)&&!(1>V.length)){var k=V[0];if(k!="noop"&&k!="stop"&&k!="close")for(var $=1;$<V.length;$++)V[$]=""}}}}return Na(m)}catch{return f}}var Rs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Bc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ma;function Ss(){}_(Ss,Da),Ss.prototype.g=function(){return new XMLHttpRequest},Ss.prototype.i=function(){return{}},Ma=new Ss;function Rn(a,f,m,y){this.j=a,this.i=f,this.l=m,this.R=y||1,this.U=new Xt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $c}function $c(){this.i=null,this.g="",this.h=!1}var qc={},Fa={};function La(a,f,m){a.L=1,a.v=xs(an(f)),a.m=m,a.P=!0,jc(a,null)}function jc(a,f){a.F=Date.now(),bs(a),a.A=an(a.v);var m=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),rh(m.i,"t",y),a.C=0,m=a.j.J,a.h=new $c,a.g=Eh(a.j,m?f:null,!a.m),0<a.O&&(a.M=new on(p(a.Y,a,a.g),a.O)),f=a.U,m=a.g,y=a.ca;var V="readystatechange";Array.isArray(V)||(V&&(Yn[0]=V.toString()),V=Yn);for(var k=0;k<V.length;k++){var $=j(m,V[k],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,f)):(a.u="GET",a.g.ea(a.A,a.u,null,f)),pi(),L_(a.i,a.u,a.A,a.l,a.R,a.m)}Rn.prototype.ca=function(a){a=a.target;const f=this.M;f&&un(a)==3?f.j():this.Y(a)},Rn.prototype.Y=function(a){try{if(a==this.g)t:{const Jt=un(this.g);var f=this.g.Ba();const Pr=this.g.Z();if(!(3>Jt)&&(Jt!=3||this.g&&(this.h.h||this.g.oa()||ch(this.g)))){this.J||Jt!=4||f==7||(f==8||0>=Pr?pi(3):pi(2)),Ua(this);var m=this.g.Z();this.X=m;e:if(zc(this)){var y=ch(this.g);a="";var V=y.length,k=un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tr(this),_i(this);var $="";break e}this.h.i=new u.TextDecoder}for(f=0;f<V;f++)this.h.h=!0,a+=this.h.i.decode(y[f],{stream:!(k&&f==V-1)});y.length=0,this.h.g+=a,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,U_(this.i,this.u,this.A,this.l,this.R,Jt,m),this.o){if(this.T&&!this.K){e:{if(this.g){var pt,zt=this.g;if((pt=zt.g?zt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(pt)){var at=pt;break e}}at=null}if(m=at)Sr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ba(this,m);else{this.o=!1,this.s=3,re(12),tr(this),_i(this);break t}}if(this.P){m=!0;let Me;for(;!this.J&&this.C<$.length;)if(Me=q_(this,$),Me==Fa){Jt==4&&(this.s=4,re(14),m=!1),Sr(this.i,this.l,null,"[Incomplete Response]");break}else if(Me==qc){this.s=4,re(15),Sr(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else Sr(this.i,this.l,Me,null),Ba(this,Me);if(zc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jt!=4||$.length!=0||this.h.h||(this.s=1,re(16),m=!1),this.o=this.o&&m,!m)Sr(this.i,this.l,$,"[Invalid Chunked Response]"),tr(this),_i(this);else if(0<$.length&&!this.W){this.W=!0;var Yt=this.j;Yt.g==this&&Yt.ba&&!Yt.M&&(Yt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Ga(Yt),Yt.M=!0,re(11))}}else Sr(this.i,this.l,$,null),Ba(this,$);Jt==4&&tr(this),this.o&&!this.J&&(Jt==4?_h(this.j,this):(this.o=!1,bs(this)))}else sy(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,re(12)):(this.s=0,re(13)),tr(this),_i(this)}}}catch{}finally{}};function zc(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function q_(a,f){var m=a.C,y=f.indexOf(`
`,m);return y==-1?Fa:(m=Number(f.substring(m,y)),isNaN(m)?qc:(y+=1,y+m>f.length?Fa:(f=f.slice(y,y+m),a.C=y+m,f)))}Rn.prototype.cancel=function(){this.J=!0,tr(this)};function bs(a){a.S=Date.now()+a.I,Hc(a,a.I)}function Hc(a,f){if(a.B!=null)throw Error("WatchDog timer not null");a.B=mi(p(a.ba,a),f)}function Ua(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Rn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(B_(this.i,this.A),this.L!=2&&(pi(),re(17)),tr(this),this.s=2,_i(this)):Hc(this,this.S-a)};function _i(a){a.j.G==0||a.J||_h(a.j,a)}function tr(a){Ua(a);var f=a.M;f&&typeof f.ma=="function"&&f.ma(),a.M=null,Jn(a.U),a.g&&(f=a.g,a.g=null,f.abort(),f.ma())}function Ba(a,f){try{var m=a.j;if(m.G!=0&&(m.g==a||$a(m.h,a))){if(!a.K&&$a(m.h,a)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)Ms(m),ks(m);else break t;Ha(m),re(18)}}else m.za=V[1],0<m.za-m.T&&37500>V[2]&&m.F&&m.v==0&&!m.C&&(m.C=mi(p(m.Za,m),6e3));if(1>=Kc(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else nr(m,11)}else if((a.K||m.g==a)&&Ms(m),!C(f))for(V=m.Da.g.parse(f),f=0;f<V.length;f++){let at=V[f];if(m.T=at[0],at=at[1],m.G==2)if(at[0]=="c"){m.K=at[1],m.ia=at[2];const Yt=at[3];Yt!=null&&(m.la=Yt,m.j.info("VER="+m.la));const Jt=at[4];Jt!=null&&(m.Aa=Jt,m.j.info("SVER="+m.Aa));const Pr=at[5];Pr!=null&&typeof Pr=="number"&&0<Pr&&(y=1.5*Pr,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;const Me=a.g;if(Me){const Ls=Me.g?Me.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ls){var k=y.h;k.g||Ls.indexOf("spdy")==-1&&Ls.indexOf("quic")==-1&&Ls.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(qa(k,k.h),k.h=null))}if(y.D){const Wa=Me.g?Me.g.getResponseHeader("X-HTTP-Session-Id"):null;Wa&&(y.ya=Wa,vt(y.I,y.D,Wa))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var $=a;if(y.qa=wh(y,y.J?y.ia:null,y.W),$.K){Qc(y.h,$);var pt=$,zt=y.L;zt&&(pt.I=zt),pt.B&&(Ua(pt),bs(pt)),y.g=$}else mh(y);0<m.i.length&&Os(m)}else at[0]!="stop"&&at[0]!="close"||nr(m,7);else m.G==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?nr(m,7):za(m):at[0]!="noop"&&m.l&&m.l.ta(at),m.v=0)}}pi(4)}catch{}}var j_=class{constructor(a,f){this.g=a,this.map=f}};function Gc(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wc(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Kc(a){return a.h?1:a.g?a.g.size:0}function $a(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function qa(a,f){a.g?a.g.add(f):a.h=f}function Qc(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}Gc.prototype.cancel=function(){if(this.i=Xc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Xc(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const m of a.g.values())f=f.concat(m.D);return f}return E(a.i)}function z_(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var f=[],m=a.length,y=0;y<m;y++)f.push(a[y]);return f}f=[],m=0;for(y in a)f[m++]=a[y];return f}function H_(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var f=[];a=a.length;for(var m=0;m<a;m++)f.push(m);return f}f=[],m=0;for(const y in a)f[m++]=y;return f}}}function Yc(a,f){if(a.forEach&&typeof a.forEach=="function")a.forEach(f,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,f,void 0);else for(var m=H_(a),y=z_(a),V=y.length,k=0;k<V;k++)f.call(void 0,y[k],m&&m[k],a)}var Jc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function G_(a,f){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var y=a[m].indexOf("="),V=null;if(0<=y){var k=a[m].substring(0,y);V=a[m].substring(y+1)}else k=a[m];f(k,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function er(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof er){this.h=a.h,Cs(this,a.j),this.o=a.o,this.g=a.g,Ps(this,a.s),this.l=a.l;var f=a.i,m=new wi;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),Zc(this,m),this.m=a.m}else a&&(f=String(a).match(Jc))?(this.h=!1,Cs(this,f[1]||"",!0),this.o=yi(f[2]||""),this.g=yi(f[3]||"",!0),Ps(this,f[4]),this.l=yi(f[5]||"",!0),Zc(this,f[6]||"",!0),this.m=yi(f[7]||"")):(this.h=!1,this.i=new wi(null,this.h))}er.prototype.toString=function(){var a=[],f=this.j;f&&a.push(vi(f,th,!0),":");var m=this.g;return(m||f=="file")&&(a.push("//"),(f=this.o)&&a.push(vi(f,th,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(vi(m,m.charAt(0)=="/"?Q_:K_,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",vi(m,Y_)),a.join("")};function an(a){return new er(a)}function Cs(a,f,m){a.j=m?yi(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function Ps(a,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);a.s=f}else a.s=null}function Zc(a,f,m){f instanceof wi?(a.i=f,J_(a.i,a.h)):(m||(f=vi(f,X_)),a.i=new wi(f,a.h))}function vt(a,f,m){a.i.set(f,m)}function xs(a){return vt(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function yi(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function vi(a,f,m){return typeof a=="string"?(a=encodeURI(a).replace(f,W_),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function W_(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var th=/[#\/\?@]/g,K_=/[#\?:]/g,Q_=/[#\?]/g,X_=/[#\?@]/g,Y_=/#/g;function wi(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function Sn(a){a.g||(a.g=new Map,a.h=0,a.i&&G_(a.i,function(f,m){a.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}e=wi.prototype,e.add=function(a,f){Sn(this),this.i=null,a=br(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(f),this.h+=1,this};function eh(a,f){Sn(a),f=br(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function nh(a,f){return Sn(a),f=br(a,f),a.g.has(f)}e.forEach=function(a,f){Sn(this),this.g.forEach(function(m,y){m.forEach(function(V){a.call(f,V,y,this)},this)},this)},e.na=function(){Sn(this);const a=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){const V=a[y];for(let k=0;k<V.length;k++)m.push(f[y])}return m},e.V=function(a){Sn(this);let f=[];if(typeof a=="string")nh(this,a)&&(f=f.concat(this.g.get(br(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)f=f.concat(a[m])}return f},e.set=function(a,f){return Sn(this),this.i=null,a=br(this,a),nh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},e.get=function(a,f){return a?(a=this.V(a),0<a.length?String(a[0]):f):f};function rh(a,f,m){eh(a,f),0<m.length&&(a.i=null,a.g.set(br(a,f),E(m)),a.h+=m.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];const k=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var V=k;$[y]!==""&&(V+="="+encodeURIComponent(String($[y]))),a.push(V)}}return this.i=a.join("&")};function br(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function J_(a,f){f&&!a.j&&(Sn(a),a.i=null,a.g.forEach(function(m,y){var V=y.toLowerCase();y!=V&&(eh(this,y),rh(this,V,m))},a)),a.j=f}function Z_(a,f){const m=new gi;if(u.Image){const y=new Image;y.onload=g(bn,m,"TestLoadImage: loaded",!0,f,y),y.onerror=g(bn,m,"TestLoadImage: error",!1,f,y),y.onabort=g(bn,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=g(bn,m,"TestLoadImage: timeout",!1,f,y),u.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else f(!1)}function ty(a,f){const m=new gi,y=new AbortController,V=setTimeout(()=>{y.abort(),bn(m,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:y.signal}).then(k=>{clearTimeout(V),k.ok?bn(m,"TestPingServer: ok",!0,f):bn(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),bn(m,"TestPingServer: error",!1,f)})}function bn(a,f,m,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(m)}catch{}}function ey(){this.g=new F_}function ny(a,f,m){const y=m||"";try{Yc(a,function(V,k){let $=V;l(V)&&($=Na(V)),f.push(y+k+"="+encodeURIComponent($))})}catch(V){throw f.push(y+"type="+encodeURIComponent("_badmap")),V}}function Vs(a){this.l=a.Ub||null,this.j=a.eb||!1}_(Vs,Da),Vs.prototype.g=function(){return new Ns(this.l,this.j)},Vs.prototype.i=function(a){return function(){return a}}({});function Ns(a,f){ft.call(this),this.D=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Ns,ft),e=Ns.prototype,e.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=f,this.readyState=1,Ti(this)},e.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(f.body=a),(this.D||u).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ei(this)),this.readyState=0},e.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ti(this)),this.g&&(this.readyState=3,Ti(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ih(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function ih(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}e.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?Ei(this):Ti(this),this.readyState==3&&ih(this)}},e.Ra=function(a){this.g&&(this.response=this.responseText=a,Ei(this))},e.Qa=function(a){this.g&&(this.response=a,Ei(this))},e.ga=function(){this.g&&Ei(this)};function Ei(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ti(a)}e.setRequestHeader=function(a,f){this.u.append(a,f)},e.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=f.next();return a.join(`\r
`)};function Ti(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ns.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function sh(a){let f="";return U(a,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function ja(a,f,m){t:{for(y in m){var y=!1;break t}y=!0}y||(m=sh(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):vt(a,f,m))}function St(a){ft.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(St,ft);var ry=/^https?$/i,iy=["POST","PUT"];e=St.prototype,e.Ha=function(a){this.J=a},e.ea=function(a,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ma.g(),this.v=this.o?kc(this.o):kc(Ma),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(k){oh(this,k);return}if(a=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)m.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const k of y.keys())m.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(k=>k.toLowerCase()=="content-type"),V=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(iy,f,void 0))||y||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,$]of m)this.g.setRequestHeader(k,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{lh(this),this.u=!0,this.g.send(a),this.u=!1}catch(k){oh(this,k)}};function oh(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.m=5,ah(a),Ds(a)}function ah(a){a.A||(a.A=!0,Rt(a,"complete"),Rt(a,"error"))}e.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Rt(this,"complete"),Rt(this,"abort"),Ds(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ds(this,!0)),St.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?uh(this):this.bb())},e.bb=function(){uh(this)};function uh(a){if(a.h&&typeof o<"u"&&(!a.v[1]||un(a)!=4||a.Z()!=2)){if(a.u&&un(a)==4)Xn(a.Ea,0,a);else if(Rt(a,"readystatechange"),un(a)==4){a.h=!1;try{const $=a.Z();t:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var m;if(!(m=f)){var y;if(y=$===0){var V=String(a.D).match(Jc)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),y=!ry.test(V?V.toLowerCase():"")}m=y}if(m)Rt(a,"complete"),Rt(a,"success");else{a.m=6;try{var k=2<un(a)?a.g.statusText:""}catch{k=""}a.l=k+" ["+a.Z()+"]",ah(a)}}finally{Ds(a)}}}}function Ds(a,f){if(a.g){lh(a);const m=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,f||Rt(a,"ready");try{m.onreadystatechange=y}catch{}}}function lh(a){a.I&&(u.clearTimeout(a.I),a.I=null)}e.isActive=function(){return!!this.g};function un(a){return a.g?a.g.readyState:0}e.Z=function(){try{return 2<un(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),M_(f)}};function ch(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function sy(a){const f={};a=(a.g&&2<=un(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(C(a[y]))continue;var m=R(a[y]);const V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const k=f[V]||[];f[V]=k,k.push(m)}I(f,function(y){return y.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ai(a,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||f}function hh(a){this.Aa=0,this.i=[],this.j=new gi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ai("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ai("baseRetryDelayMs",5e3,a),this.cb=Ai("retryDelaySeedMs",1e4,a),this.Wa=Ai("forwardChannelMaxRetries",2,a),this.wa=Ai("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Gc(a&&a.concurrentRequestLimit),this.Da=new ey,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=hh.prototype,e.la=8,e.G=1,e.connect=function(a,f,m,y){re(0),this.W=a,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=wh(this,null,this.W),Os(this)};function za(a){if(fh(a),a.G==3){var f=a.U++,m=an(a.I);if(vt(m,"SID",a.K),vt(m,"RID",f),vt(m,"TYPE","terminate"),Ii(a,m),f=new Rn(a,a.j,f),f.L=2,f.v=xs(an(m)),m=!1,u.navigator&&u.navigator.sendBeacon)try{m=u.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&u.Image&&(new Image().src=f.v,m=!0),m||(f.g=Eh(f.j,null),f.g.ea(f.v)),f.F=Date.now(),bs(f)}vh(a)}function ks(a){a.g&&(Ga(a),a.g.cancel(),a.g=null)}function fh(a){ks(a),a.u&&(u.clearTimeout(a.u),a.u=null),Ms(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Os(a){if(!Wc(a.h)&&!a.s){a.s=!0;var f=a.Ga;ct||ke(),_t||(ct(),_t=!0),Ot.add(f,a),a.B=0}}function oy(a,f){return Kc(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=f.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=mi(p(a.Ga,a,f),yh(a,a.B)),a.B++,!0)}e.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new Rn(this,this.j,a);let k=this.o;if(this.S&&(k?(k=w(k),S(k,this.S)):k=this.S),this.m!==null||this.O||(V.H=k,k=null),this.P)t:{for(var f=0,m=0;m<this.i.length;m++){e:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break e}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break t}if(f===4096||m===this.i.length-1){f=m+1;break t}}f=1e3}else f=1e3;f=ph(this,V,f),m=an(this.I),vt(m,"RID",a),vt(m,"CVER",22),this.D&&vt(m,"X-HTTP-Session-Id",this.D),Ii(this,m),k&&(this.O?f="headers="+encodeURIComponent(String(sh(k)))+"&"+f:this.m&&ja(m,this.m,k)),qa(this.h,V),this.Ua&&vt(m,"TYPE","init"),this.P?(vt(m,"$req",f),vt(m,"SID","null"),V.T=!0,La(V,m,null)):La(V,m,f),this.G=2}}else this.G==3&&(a?dh(this,a):this.i.length==0||Wc(this.h)||dh(this))};function dh(a,f){var m;f?m=f.l:m=a.U++;const y=an(a.I);vt(y,"SID",a.K),vt(y,"RID",m),vt(y,"AID",a.T),Ii(a,y),a.m&&a.o&&ja(y,a.m,a.o),m=new Rn(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),f&&(a.i=f.D.concat(a.i)),f=ph(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),qa(a.h,m),La(m,y,f)}function Ii(a,f){a.H&&U(a.H,function(m,y){vt(f,y,m)}),a.l&&Yc({},function(m,y){vt(f,y,m)})}function ph(a,f,m){m=Math.min(a.i.length,m);var y=a.l?p(a.l.Na,a.l,a):null;t:{var V=a.i;let k=-1;for(;;){const $=["count="+m];k==-1?0<m?(k=V[0].g,$.push("ofs="+k)):k=0:$.push("ofs="+k);let pt=!0;for(let zt=0;zt<m;zt++){let at=V[zt].g;const Yt=V[zt].map;if(at-=k,0>at)k=Math.max(0,V[zt].g-100),pt=!1;else try{ny(Yt,$,"req"+at+"_")}catch{y&&y(Yt)}}if(pt){y=$.join("&");break t}}}return a=a.i.splice(0,m),f.D=a,y}function mh(a){if(!a.g&&!a.u){a.Y=1;var f=a.Fa;ct||ke(),_t||(ct(),_t=!0),Ot.add(f,a),a.v=0}}function Ha(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=mi(p(a.Fa,a),yh(a,a.v)),a.v++,!0)}e.Fa=function(){if(this.u=null,gh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=mi(p(this.ab,this),a)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,re(10),ks(this),gh(this))};function Ga(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function gh(a){a.g=new Rn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var f=an(a.qa);vt(f,"RID","rpc"),vt(f,"SID",a.K),vt(f,"AID",a.T),vt(f,"CI",a.F?"0":"1"),!a.F&&a.ja&&vt(f,"TO",a.ja),vt(f,"TYPE","xmlhttp"),Ii(a,f),a.m&&a.o&&ja(f,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=xs(an(f)),m.m=null,m.P=!0,jc(m,a)}e.Za=function(){this.C!=null&&(this.C=null,ks(this),Ha(this),re(19))};function Ms(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function _h(a,f){var m=null;if(a.g==f){Ms(a),Ga(a),a.g=null;var y=2}else if($a(a.h,f))m=f.D,Qc(a.h,f),y=1;else return;if(a.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var V=a.B;y=Is(),Rt(y,new Uc(y,m)),Os(a)}else mh(a);else if(V=f.s,V==3||V==0&&0<f.X||!(y==1&&oy(a,f)||y==2&&Ha(a)))switch(m&&0<m.length&&(f=a.h,f.i=f.i.concat(m)),V){case 1:nr(a,5);break;case 4:nr(a,10);break;case 3:nr(a,6);break;default:nr(a,2)}}}function yh(a,f){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*f}function nr(a,f){if(a.j.info("Error code "+f),f==2){var m=p(a.fb,a),y=a.Xa;const V=!y;y=new er(y||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Cs(y,"https"),xs(y),V?Z_(y.toString(),m):ty(y.toString(),m)}else re(2);a.G=0,a.l&&a.l.sa(f),vh(a),fh(a)}e.fb=function(a){a?(this.j.info("Successfully pinged google.com"),re(2)):(this.j.info("Failed to ping google.com"),re(1))};function vh(a){if(a.G=0,a.ka=[],a.l){const f=Xc(a.h);(f.length!=0||a.i.length!=0)&&(v(a.ka,f),v(a.ka,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.ra()}}function wh(a,f,m){var y=m instanceof er?an(m):new er(m);if(y.g!="")f&&(y.g=f+"."+y.g),Ps(y,y.s);else{var V=u.location;y=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;var k=new er(null);y&&Cs(k,y),f&&(k.g=f),V&&Ps(k,V),m&&(k.l=m),y=k}return m=a.D,f=a.ya,m&&f&&vt(y,m,f),vt(y,"VER",a.la),Ii(a,y),y}function Eh(a,f,m){if(f&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Ca&&!a.pa?new St(new Vs({eb:m})):new St(a.pa),f.Ha(a.J),f}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Th(){}e=Th.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Fs(){}Fs.prototype.g=function(a,f){return new ve(a,f)};function ve(a,f){ft.call(this),this.g=new hh(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(a?a["X-WebChannel-Client-Profile"]=f.va:a={"X-WebChannel-Client-Profile":f.va}),this.g.S=a,(a=f&&f.Sb)&&!C(a)&&(this.g.m=a),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!C(f)&&(this.g.D=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new Cr(this)}_(ve,ft),ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ve.prototype.close=function(){za(this.g)},ve.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=Na(a),a=m);f.i.push(new j_(f.Ya++,a)),f.G==3&&Os(f)},ve.prototype.N=function(){this.g.l=null,delete this.j,za(this.g),delete this.g,ve.aa.N.call(this)};function Ah(a){ka.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){t:{for(const m in f){a=m;break t}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}_(Ah,ka);function Ih(){Oa.call(this),this.status=1}_(Ih,Oa);function Cr(a){this.g=a}_(Cr,Th),Cr.prototype.ua=function(){Rt(this.g,"a")},Cr.prototype.ta=function(a){Rt(this.g,new Ah(a))},Cr.prototype.sa=function(a){Rt(this.g,new Ih)},Cr.prototype.ra=function(){Rt(this.g,"b")},Fs.prototype.createWebChannel=Fs.prototype.g,ve.prototype.send=ve.prototype.o,ve.prototype.open=ve.prototype.m,ve.prototype.close=ve.prototype.close,rg=function(){return new Fs},ng=function(){return Is()},eg=Zn,el={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Rs.NO_ERROR=0,Rs.TIMEOUT=8,Rs.HTTP_ERROR=6,ao=Rs,Bc.COMPLETE="complete",tg=Bc,Oc.EventType=di,di.OPEN="a",di.CLOSE="b",di.ERROR="c",di.MESSAGE="d",ft.prototype.listen=ft.prototype.K,Mi=Oc,St.prototype.listenOnce=St.prototype.L,St.prototype.getLastError=St.prototype.Ka,St.prototype.getLastErrorCode=St.prototype.Ba,St.prototype.getStatus=St.prototype.Z,St.prototype.getResponseJson=St.prototype.Oa,St.prototype.getResponseText=St.prototype.oa,St.prototype.send=St.prototype.ea,St.prototype.setWithCredentials=St.prototype.Ha,Zm=St}).apply(typeof Ks<"u"?Ks:typeof self<"u"?self:typeof window<"u"?window:{});const Wf="@firebase/firestore",Kf="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}te.UNAUTHENTICATED=new te(null),te.GOOGLE_CREDENTIALS=new te("google-credentials-uid"),te.FIRST_PARTY=new te("first-party-uid"),te.MOCK_USER=new te("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let si="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr=new Gm("@firebase/firestore");function Dr(){return yr.logLevel}function z(e,...t){if(yr.logLevel<=st.DEBUG){const n=t.map(Xl);yr.debug(`Firestore (${si}): ${e}`,...n)}}function wn(e,...t){if(yr.logLevel<=st.ERROR){const n=t.map(Xl);yr.error(`Firestore (${si}): ${e}`,...n)}}function Ln(e,...t){if(yr.logLevel<=st.WARN){const n=t.map(Xl);yr.warn(`Firestore (${si}): ${e}`,...n)}}function Xl(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,ig(e,r,n)}function ig(e,t,n){let r=`FIRESTORE (${si}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw wn(r),new Error(r)}function lt(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||ig(t,i,r)}function Y(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends ii{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ER{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(te.UNAUTHENTICATED))}shutdown(){}}class TR{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class AR{constructor(t){this.t=t,this.currentUser=te.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){lt(this.o===void 0,42304);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new mn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mn,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;t.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mn)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(lt(typeof r.accessToken=="string",31837,{l:r}),new sg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return lt(t===null||typeof t=="string",2055,{h:t}),new te(t)}}class IR{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=te.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class RR{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new IR(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(te.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qf{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SR{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,iR(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){lt(this.o===void 0,3512);const r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};const i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Qf(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(lt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Qf(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=bR(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%62))}return r}}function tt(e,t){return e<t?-1:e>t?1:0}function nl(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return tt(r,i);{const s=og(),o=CR(s.encode(Xf(e,n)),s.encode(Xf(t,n)));return o!==0?o:tt(r,i)}}n+=r>65535?2:1}return tt(e.length,t.length)}function Xf(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function CR(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return tt(e[n],t[n]);return tt(e.length,t.length)}function Wr(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf="__name__";class ze{constructor(t,n,r){n===void 0?n=0:n>t.length&&W(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&W(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return ze.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof ze?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const s=ze.compareSegments(t.get(i),n.get(i));if(s!==0)return s}return tt(t.length,n.length)}static compareSegments(t,n){const r=ze.isNumericId(t),i=ze.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?ze.extractNumericId(t).compare(ze.extractNumericId(n)):nl(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return kn.fromString(t.substring(4,t.length-2))}}class gt extends ze{construct(t,n,r){return new gt(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new q(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new gt(n)}static emptyPath(){return new gt([])}}const PR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gt extends ze{construct(t,n,r){return new Gt(t,n,r)}static isValidIdentifier(t){return PR.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Yf}static keyField(){return new Gt([Yf])}static fromServerFormat(t){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new q(O.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new q(O.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Gt(n)}static emptyPath(){return new Gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(t){this.path=t}static fromPath(t){return new G(gt.fromString(t))}static fromName(t){return new G(gt.fromString(t).popFirst(5))}static empty(){return new G(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&gt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return gt.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new G(new gt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(e,t,n){if(!n)throw new q(O.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function xR(e,t,n,r){if(t===!0&&r===!0)throw new q(O.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Jf(e){if(!G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Zf(e){if(G.isDocumentKey(e))throw new q(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function ug(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function pa(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":W(12329,{type:typeof e})}function En(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new q(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=pa(e);throw new q(O.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function VR(e,t){if(t<=0)throw new q(O.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(e,t){const n={typeString:e};return t&&(n.value=t),n}function gs(e,t){if(!ug(e))throw new q(O.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new q(O.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=-62135596800,ed=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(t){return wt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*ed);return new wt(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<td)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ed}_compareTo(t){return this.seconds===t.seconds?tt(this.nanoseconds,t.nanoseconds):tt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(gs(t,wt._jsonSchema))return new wt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-td;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:kt("string",wt._jsonSchemaVersion),seconds:kt("number"),nanoseconds:kt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{static fromTimestamp(t){return new Q(t)}static min(){return new Q(new wt(0,0))}static max(){return new Q(new wt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss=-1;function NR(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Q.fromTimestamp(r===1e9?new wt(n+1,0):new wt(n,r));return new Un(i,G.empty(),t)}function DR(e){return new Un(e.readTime,e.key,ss)}class Un{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new Un(Q.min(),G.empty(),ss)}static max(){return new Un(Q.max(),G.empty(),ss)}}function kR(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=G.comparator(e.documentKey,t.documentKey),n!==0?n:tt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class MR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oi(e){if(e.code!==O.FAILED_PRECONDITION||e.message!==OR)throw e;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&W(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new F((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):F.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):F.reject(n)}static resolve(t){return new F((n,r)=>{n(t)})}static reject(t){return new F((n,r)=>{r(t)})}static waitFor(t){return new F((n,r)=>{let i=0,s=0,o=!1;t.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(t){let n=F.resolve(!1);for(const r of t)n=n.next(i=>i?F.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new F((r,i)=>{const s=t.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const l=c;n(t[l]).next(h=>{o[l]=h,++u,u===s&&r(o)},h=>i(h))}})}static doWhile(t,n){return new F((r,i)=>{const s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}}function FR(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ai(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}ma.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jl=-1;function ga(e){return e==null}function qo(e){return e===0&&1/e==-1/0}function LR(e){return typeof e=="number"&&Number.isInteger(e)&&!qo(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="";function UR(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=nd(t)),t=BR(e.get(n),t);return nd(t)}function BR(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const s=e.charAt(i);switch(s){case"\0":n+="";break;case lg:n+="";break;default:n+=s}}return n}function nd(e){return e+lg+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Gn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function cg(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(t,n){this.comparator=t,this.root=n||Ht.EMPTY}insert(t,n){return new It(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(t){return new It(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Qs(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Qs(this.root,t,this.comparator,!1)}getReverseIterator(){return new Qs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Qs(this.root,t,this.comparator,!0)}}class Qs{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ht{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??Ht.RED,this.left=i??Ht.EMPTY,this.right=s??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new Ht(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return Ht.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw W(43730,{key:this.key,value:this.value});if(this.right.isRed())throw W(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw W(27949);return t+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw W(57766)}get value(){throw W(16141)}get color(){throw W(16727)}get left(){throw W(29726)}get right(){throw W(36894)}copy(t,n,r,i,s){return this}insert(t,n,r){return new Ht(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(t){this.comparator=t,this.data=new It(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new id(this.data.getIterator())}getIteratorFrom(t){return new id(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Ft)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Ft(this.comparator);return n.data=t,n}}class id{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(t){this.fields=t,t.sort(Gt.comparator)}static empty(){return new Ae([])}unionWith(t){let n=new Ft(Gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Ae(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Wr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new hg("Invalid base64 string: "+s):s}}(t);return new Wt(n)}static fromUint8Array(t){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new Wt(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return tt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const $R=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bn(e){if(lt(!!e,39018),typeof e=="string"){let t=0;const n=$R.exec(e);if(lt(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Ct(e.seconds),nanos:Ct(e.nanos)}}function Ct(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function $n(e){return typeof e=="string"?Wt.fromBase64String(e):Wt.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg="server_timestamp",dg="__type__",pg="__previous_value__",mg="__local_write_time__";function Zl(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[dg])===null||n===void 0?void 0:n.stringValue)===fg}function _a(e){const t=e.mapValue.fields[pg];return Zl(t)?_a(t):t}function os(e){const t=Bn(e.mapValue.fields[mg].timestampValue);return new wt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(t,n,r,i,s,o,u,c,l,h){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=h}}const jo="(default)";class as{constructor(t,n){this.projectId=t,this.database=n||jo}static empty(){return new as("","")}get isDefaultDatabase(){return this.database===jo}isEqual(t){return t instanceof as&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg="__type__",jR="__max__",Xs={mapValue:{}},_g="__vector__",zo="value";function qn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Zl(e)?4:HR(e)?9007199254740991:zR(e)?10:11:W(28295,{value:e})}function rn(e,t){if(e===t)return!0;const n=qn(e);if(n!==qn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return os(e).isEqual(os(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Bn(i.timestampValue),u=Bn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return $n(i.bytesValue).isEqual($n(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return Ct(i.geoPointValue.latitude)===Ct(s.geoPointValue.latitude)&&Ct(i.geoPointValue.longitude)===Ct(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ct(i.integerValue)===Ct(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Ct(i.doubleValue),u=Ct(s.doubleValue);return o===u?qo(o)===qo(u):isNaN(o)&&isNaN(u)}return!1}(e,t);case 9:return Wr(e.arrayValue.values||[],t.arrayValue.values||[],rn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(rd(o)!==rd(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!rn(o[c],u[c])))return!1;return!0}(e,t);default:return W(52216,{left:e})}}function us(e,t){return(e.values||[]).find(n=>rn(n,t))!==void 0}function Kr(e,t){if(e===t)return 0;const n=qn(e),r=qn(t);if(n!==r)return tt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tt(e.booleanValue,t.booleanValue);case 2:return function(s,o){const u=Ct(s.integerValue||s.doubleValue),c=Ct(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(e,t);case 3:return sd(e.timestampValue,t.timestampValue);case 4:return sd(os(e),os(t));case 5:return nl(e.stringValue,t.stringValue);case 6:return function(s,o){const u=$n(s),c=$n(o);return u.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let l=0;l<u.length&&l<c.length;l++){const h=tt(u[l],c[l]);if(h!==0)return h}return tt(u.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const u=tt(Ct(s.latitude),Ct(o.latitude));return u!==0?u:tt(Ct(s.longitude),Ct(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return od(e.arrayValue,t.arrayValue);case 10:return function(s,o){var u,c,l,h;const d=s.fields||{},p=o.fields||{},g=(u=d[zo])===null||u===void 0?void 0:u.arrayValue,_=(c=p[zo])===null||c===void 0?void 0:c.arrayValue,E=tt(((l=g==null?void 0:g.values)===null||l===void 0?void 0:l.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:od(g,_)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===Xs.mapValue&&o===Xs.mapValue)return 0;if(s===Xs.mapValue)return 1;if(o===Xs.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),l=o.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const p=nl(c[d],h[d]);if(p!==0)return p;const g=Kr(u[c[d]],l[h[d]]);if(g!==0)return g}return tt(c.length,h.length)}(e.mapValue,t.mapValue);default:throw W(23264,{le:n})}}function sd(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return tt(e,t);const n=Bn(e),r=Bn(t),i=tt(n.seconds,r.seconds);return i!==0?i:tt(n.nanos,r.nanos)}function od(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Kr(n[i],r[i]);if(s)return s}return tt(n.length,r.length)}function Qr(e){return rl(e)}function rl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=Bn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return $n(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return G.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=rl(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${rl(n.fields[o])}`;return i+"}"}(e.mapValue):W(61005,{value:e})}function uo(e){switch(qn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=_a(e);return t?16+uo(t):16;case 5:return 2*e.stringValue.length;case 6:return $n(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+uo(s),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return Gn(r.fields,(s,o)=>{i+=s.length+uo(o)}),i}(e.mapValue);default:throw W(13486,{value:e})}}function ad(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function il(e){return!!e&&"integerValue"in e}function tc(e){return!!e&&"arrayValue"in e}function ud(e){return!!e&&"nullValue"in e}function ld(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function lo(e){return!!e&&"mapValue"in e}function zR(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[gg])===null||n===void 0?void 0:n.stringValue)===_g}function qi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Gn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=qi(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=qi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function HR(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===jR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(t){this.value=t}static empty(){return new he({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!lo(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=qi(n)}setAll(t){let n=Gt.emptyPath(),r={},i=[];t.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=qi(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){const n=this.field(t.popLast());lo(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return rn(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];lo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){Gn(n,(i,s)=>t[i]=s);for(const i of r)delete t[i]}clone(){return new he(qi(this.value))}}function yg(e){const t=[];return Gn(e.fields,(n,r)=>{const i=new Gt([n]);if(lo(r)){const s=yg(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new Ae(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(t,n,r,i,s,o,u){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(t){return new ee(t,0,Q.min(),Q.min(),Q.min(),he.empty(),0)}static newFoundDocument(t,n,r,i){return new ee(t,1,n,Q.min(),r,i,0)}static newNoDocument(t,n){return new ee(t,2,n,Q.min(),Q.min(),he.empty(),0)}static newUnknownDocument(t,n){return new ee(t,3,n,Q.min(),Q.min(),he.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=he.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=he.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof ee&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ee(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(t,n){this.position=t,this.inclusive=n}}function cd(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=Kr(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function hd(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!rn(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(t,n="asc"){this.field=t,this.dir=n}}function GR(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{}class Dt extends vg{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new KR(t,n,r):n==="array-contains"?new YR(t,r):n==="in"?new JR(t,r):n==="not-in"?new ZR(t,r):n==="array-contains-any"?new tS(t,r):new Dt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new QR(t,r):new XR(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Kr(n,this.value)):n!==null&&qn(this.value)===qn(n)&&this.matchesComparison(Kr(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Be extends vg{constructor(t,n){super(),this.filters=t,this.op=n,this.he=null}static create(t,n){return new Be(t,n)}matches(t){return wg(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function wg(e){return e.op==="and"}function Eg(e){return WR(e)&&wg(e)}function WR(e){for(const t of e.filters)if(t instanceof Be)return!1;return!0}function sl(e){if(e instanceof Dt)return e.field.canonicalString()+e.op.toString()+Qr(e.value);if(Eg(e))return e.filters.map(t=>sl(t)).join(",");{const t=e.filters.map(n=>sl(n)).join(",");return`${e.op}(${t})`}}function Tg(e,t){return e instanceof Dt?function(r,i){return i instanceof Dt&&r.op===i.op&&r.field.isEqual(i.field)&&rn(r.value,i.value)}(e,t):e instanceof Be?function(r,i){return i instanceof Be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&Tg(o,i.filters[u]),!0):!1}(e,t):void W(19439)}function Ag(e){return e instanceof Dt?function(n){return`${n.field.canonicalString()} ${n.op} ${Qr(n.value)}`}(e):e instanceof Be?function(n){return n.op.toString()+" {"+n.getFilters().map(Ag).join(" ,")+"}"}(e):"Filter"}class KR extends Dt{constructor(t,n,r){super(t,n,r),this.key=G.fromName(r.referenceValue)}matches(t){const n=G.comparator(t.key,this.key);return this.matchesComparison(n)}}class QR extends Dt{constructor(t,n){super(t,"in",n),this.keys=Ig("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class XR extends Dt{constructor(t,n){super(t,"not-in",n),this.keys=Ig("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function Ig(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class YR extends Dt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return tc(n)&&us(n.arrayValue,this.value)}}class JR extends Dt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&us(this.value.arrayValue,n)}}class ZR extends Dt{constructor(t,n){super(t,"not-in",n)}matches(t){if(us(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!us(this.value.arrayValue,n)}}class tS extends Dt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!tc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>us(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(t,n=null,r=[],i=[],s=null,o=null,u=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.Pe=null}}function fd(e,t=null,n=[],r=[],i=null,s=null,o=null){return new eS(e,t,n,r,i,s,o)}function ec(e){const t=Y(e);if(t.Pe===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>sl(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ga(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Qr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Qr(r)).join(",")),t.Pe=n}return t.Pe}function nc(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!GR(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Tg(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!hd(e.startAt,t.startAt)&&hd(e.endAt,t.endAt)}function ol(e){return G.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(t,n=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function nS(e,t,n,r,i,s,o,u){return new ui(e,t,n,r,i,s,o,u)}function rc(e){return new ui(e)}function dd(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Rg(e){return e.collectionGroup!==null}function ji(e){const t=Y(e);if(t.Te===null){t.Te=[];const n=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Ft(Gt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(u=u.add(l.field))})}),u})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Te.push(new ls(s,r))}),n.has(Gt.keyField().canonicalString())||t.Te.push(new ls(Gt.keyField(),r))}return t.Te}function Xe(e){const t=Y(e);return t.Ie||(t.Ie=rS(t,ji(e))),t.Ie}function rS(e,t){if(e.limitType==="F")return fd(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ls(i.field,s)});const n=e.endAt?new Ho(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Ho(e.startAt.position,e.startAt.inclusive):null;return fd(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function al(e,t){const n=e.filters.concat([t]);return new ui(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Go(e,t,n){return new ui(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ya(e,t){return nc(Xe(e),Xe(t))&&e.limitType===t.limitType}function Sg(e){return`${ec(Xe(e))}|lt:${e.limitType}`}function kr(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Ag(i)).join(", ")}]`),ga(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Qr(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Qr(i)).join(",")),`Target(${r})`}(Xe(e))}; limitType=${e.limitType})`}function va(e,t){return t.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(const s of ji(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,u,c){const l=cd(o,u,c);return o.inclusive?l<=0:l<0}(r.startAt,ji(r),i)||r.endAt&&!function(o,u,c){const l=cd(o,u,c);return o.inclusive?l>=0:l>0}(r.endAt,ji(r),i))}(e,t)}function iS(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function bg(e){return(t,n)=>{let r=!1;for(const i of ji(e)){const s=sS(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function sS(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(s,o,u){const c=o.data.field(s),l=u.data.field(s);return c!==null&&l!==null?Kr(c,l):W(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return W(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Gn(this.inner,(n,r)=>{for(const[i,s]of r)t(i,s)})}isEmpty(){return cg(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=new It(G.comparator);function Tn(){return oS}const Cg=new It(G.comparator);function Fi(...e){let t=Cg;for(const n of e)t=t.insert(n.key,n);return t}function Pg(e){let t=Cg;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function ur(){return zi()}function xg(){return zi()}function zi(){return new Tr(e=>e.toString(),(e,t)=>e.isEqual(t))}const aS=new It(G.comparator),uS=new Ft(G.comparator);function rt(...e){let t=uS;for(const n of e)t=t.add(n);return t}const lS=new Ft(tt);function cS(){return lS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qo(t)?"-0":t}}function Vg(e){return{integerValue:""+e}}function hS(e,t){return LR(t)?Vg(t):ic(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(){this._=void 0}}function fS(e,t,n){return e instanceof Wo?function(i,s){const o={fields:{[dg]:{stringValue:fg},[mg]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Zl(s)&&(s=_a(s)),s&&(o.fields[pg]=s),{mapValue:o}}(n,t):e instanceof cs?Dg(e,t):e instanceof hs?kg(e,t):function(i,s){const o=Ng(i,s),u=pd(o)+pd(i.Ee);return il(o)&&il(i.Ee)?Vg(u):ic(i.serializer,u)}(e,t)}function dS(e,t,n){return e instanceof cs?Dg(e,t):e instanceof hs?kg(e,t):n}function Ng(e,t){return e instanceof Ko?function(r){return il(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}class Wo extends wa{}class cs extends wa{constructor(t){super(),this.elements=t}}function Dg(e,t){const n=Og(t);for(const r of e.elements)n.some(i=>rn(i,r))||n.push(r);return{arrayValue:{values:n}}}class hs extends wa{constructor(t){super(),this.elements=t}}function kg(e,t){let n=Og(t);for(const r of e.elements)n=n.filter(i=>!rn(i,r));return{arrayValue:{values:n}}}class Ko extends wa{constructor(t,n){super(),this.serializer=t,this.Ee=n}}function pd(e){return Ct(e.integerValue||e.doubleValue)}function Og(e){return tc(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function pS(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof cs&&i instanceof cs||r instanceof hs&&i instanceof hs?Wr(r.elements,i.elements,rn):r instanceof Ko&&i instanceof Ko?rn(r.Ee,i.Ee):r instanceof Wo&&i instanceof Wo}(e.transform,t.transform)}class mS{constructor(t,n){this.version=t,this.transformResults=n}}class Ye{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Ye}static exists(t){return new Ye(void 0,t)}static updateTime(t){return new Ye(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function co(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Ea{}function Mg(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Lg(e.key,Ye.none()):new _s(e.key,e.data,Ye.none());{const n=e.data,r=he.empty();let i=new Ft(Gt.comparator);for(let s of t.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Wn(e.key,r,new Ae(i.toArray()),Ye.none())}}function gS(e,t,n){e instanceof _s?function(i,s,o){const u=i.value.clone(),c=gd(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,n):e instanceof Wn?function(i,s,o){if(!co(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=gd(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Fg(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Hi(e,t,n,r){return e instanceof _s?function(s,o,u,c){if(!co(s.precondition,o))return u;const l=s.value.clone(),h=_d(s.fieldTransforms,c,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(e,t,n,r):e instanceof Wn?function(s,o,u,c){if(!co(s.precondition,o))return u;const l=_d(s.fieldTransforms,c,o),h=o.data;return h.setAll(Fg(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,r):function(s,o,u){return co(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(e,t,n)}function _S(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),s=Ng(r.transform,i||null);s!=null&&(n===null&&(n=he.empty()),n.set(r.field,s))}return n||null}function md(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Wr(r,i,(s,o)=>pS(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class _s extends Ea{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Wn extends Ea{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Fg(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function gd(e,t,n){const r=new Map;lt(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,u=t.data.field(s.field);r.set(s.field,dS(o,u,n[i]))}return r}function _d(e,t,n){const r=new Map;for(const i of e){const s=i.transform,o=n.data.field(i.field);r.set(i.field,fS(s,o,t))}return r}class Lg extends Ea{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yS extends Ea{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&gS(s,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Hi(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Hi(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=xg();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const c=Mg(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),rt())}isEqual(t){return this.batchId===t.batchId&&Wr(this.mutations,t.mutations,(n,r)=>md(n,r))&&Wr(this.baseMutations,t.baseMutations,(n,r)=>md(n,r))}}class sc{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){lt(t.mutations.length===r.length,58842,{Ve:t.mutations.length,me:r.length});let i=function(){return aS}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new sc(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt,it;function TS(e){switch(e){case O.OK:return W(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return W(15467,{code:e})}}function Ug(e){if(e===void 0)return wn("GRPC error has no .code"),O.UNKNOWN;switch(e){case Nt.OK:return O.OK;case Nt.CANCELLED:return O.CANCELLED;case Nt.UNKNOWN:return O.UNKNOWN;case Nt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Nt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Nt.INTERNAL:return O.INTERNAL;case Nt.UNAVAILABLE:return O.UNAVAILABLE;case Nt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Nt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Nt.NOT_FOUND:return O.NOT_FOUND;case Nt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Nt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Nt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Nt.ABORTED:return O.ABORTED;case Nt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Nt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Nt.DATA_LOSS:return O.DATA_LOSS;default:return W(39323,{code:e})}}(it=Nt||(Nt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=new kn([4294967295,4294967295],0);function yd(e){const t=og().encode(e),n=new Jm;return n.update(t),new Uint8Array(n.digest())}function vd(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new kn([n,r],0),new kn([i,s],0)]}class oc{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Li(`Invalid padding: ${n}`);if(r<0)throw new Li(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Li(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Li(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*t.length-n,this.ge=kn.fromNumber(this.fe)}pe(t,n,r){let i=t.add(n.multiply(kn.fromNumber(r)));return i.compare(AS)===1&&(i=new kn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const n=yd(t),[r,i]=vd(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(t,n,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new oc(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(t){if(this.fe===0)return;const n=yd(t),[r,i]=vd(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Li extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const i=new Map;return i.set(t,ys.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new Ta(Q.min(),i,new It(tt),Tn(),rt())}}class ys{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new ys(r,n,rt(),rt(),rt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(t,n,r,i){this.Se=t,this.removedTargetIds=n,this.key=r,this.be=i}}class Bg{constructor(t,n){this.targetId=t,this.De=n}}class $g{constructor(t,n,r=Wt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}}class wd{constructor(){this.ve=0,this.Ce=Ed(),this.Fe=Wt.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=rt(),n=rt(),r=rt();return this.Ce.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:W(38017,{changeType:s})}}),new ys(this.Fe,this.Me,t,n,r)}ke(){this.xe=!1,this.Ce=Ed()}qe(t,n){this.xe=!0,this.Ce=this.Ce.insert(t,n)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class IS{constructor(t){this.We=t,this.Ge=new Map,this.ze=Tn(),this.je=Ys(),this.Je=Ys(),this.He=new It(tt)}Ye(t){for(const n of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(n,t.be):this.Xe(n,t.key,t.be);for(const n of t.removedTargetIds)this.Xe(n,t.key,t.be)}et(t){this.forEachTarget(t,n=>{const r=this.tt(n);switch(t.state){case 0:this.nt(n)&&r.Be(t.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(t.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(t.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(t.resumeToken));break;default:W(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(t){const n=t.targetId,r=t.De.count,i=this.st(n);if(i){const s=i.target;if(ol(s))if(r===0){const o=new G(s.path);this.Xe(n,o,ee.newNoDocument(o,Q.min()))}else lt(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const u=this._t(t),c=u?this.ut(u,t,o):1;if(c!==0){this.rt(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,l)}}}}}_t(t){const n=t.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=$n(r).toUint8Array()}catch(c){if(c instanceof hg)return Ln("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new oc(o,i,s)}catch(c){return Ln(c instanceof Li?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.fe===0?null:u}ut(t,n,r){return n.De.count===r-this.ht(t,n.targetId)?0:2}ht(t,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(u)||(this.Xe(n,s,null),i++)}),i}Pt(t){const n=new Map;this.Ge.forEach((s,o)=>{const u=this.st(o);if(u){if(s.current&&ol(u.target)){const c=new G(u.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,ee.newNoDocument(c,t))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=rt();this.Je.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const l=this.st(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(t));const i=new Ta(t,n,this.He,this.ze,r);return this.ze=Tn(),this.je=Ys(),this.Je=Ys(),this.He=new It(tt),i}Ze(t,n){if(!this.nt(t))return;const r=this.It(t,n.key)?2:0;this.tt(t).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(t)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(t))}Xe(t,n,r){if(!this.nt(t))return;const i=this.tt(t);this.It(t,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(t)),this.Je=this.Je.insert(n,this.dt(n).add(t)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(t){this.Ge.delete(t)}ot(t){const n=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let n=this.Ge.get(t);return n||(n=new wd,this.Ge.set(t,n)),n}dt(t){let n=this.Je.get(t);return n||(n=new Ft(tt),this.Je=this.Je.insert(t,n)),n}Tt(t){let n=this.je.get(t);return n||(n=new Ft(tt),this.je=this.je.insert(t,n)),n}nt(t){const n=this.st(t)!==null;return n||z("WatchChangeAggregator","Detected inactive target",t),n}st(t){const n=this.Ge.get(t);return n&&n.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new wd),this.We.getRemoteKeysForTarget(t).forEach(n=>{this.Xe(t,n,null)})}It(t,n){return this.We.getRemoteKeysForTarget(t).has(n)}}function Ys(){return new It(G.comparator)}function Ed(){return new It(G.comparator)}const RS={asc:"ASCENDING",desc:"DESCENDING"},SS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bS={and:"AND",or:"OR"};class CS{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function ul(e,t){return e.useProto3Json||ga(t)?t:{value:t}}function Qo(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function qg(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function PS(e,t){return Qo(e,t.toTimestamp())}function Je(e){return lt(!!e,49232),Q.fromTimestamp(function(n){const r=Bn(n);return new wt(r.seconds,r.nanos)}(e))}function ac(e,t){return ll(e,t).canonicalString()}function ll(e,t){const n=function(i){return new gt(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function jg(e){const t=gt.fromString(e);return lt(Kg(t),10190,{key:t.toString()}),t}function cl(e,t){return ac(e.databaseId,t.path)}function du(e,t){const n=jg(t);if(n.get(1)!==e.databaseId.projectId)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new q(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new G(Hg(n))}function zg(e,t){return ac(e.databaseId,t)}function xS(e){const t=jg(e);return t.length===4?gt.emptyPath():Hg(t)}function hl(e){return new gt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Hg(e){return lt(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Td(e,t,n){return{name:cl(e,t),fields:n.value.mapValue.fields}}function VS(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:W(39313,{state:l})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(l,h){return l.useProto3Json?(lt(h===void 0||typeof h=="string",58123),Wt.fromBase64String(h||"")):(lt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Wt.fromUint8Array(h||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(l){const h=l.code===void 0?O.UNKNOWN:Ug(l.code);return new q(h,l.message||"")}(o);n=new $g(r,i,s,u||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=du(e,r.document.name),s=Je(r.document.updateTime),o=r.document.createTime?Je(r.document.createTime):Q.min(),u=new he({mapValue:{fields:r.document.fields}}),c=ee.newFoundDocument(i,s,o,u),l=r.targetIds||[],h=r.removedTargetIds||[];n=new ho(l,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=du(e,r.document),s=r.readTime?Je(r.readTime):Q.min(),o=ee.newNoDocument(i,s),u=r.removedTargetIds||[];n=new ho([],u,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=du(e,r.document),s=r.removedTargetIds||[];n=new ho([],s,i,null)}else{if(!("filter"in t))return W(11601,{At:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new ES(i,s),u=r.targetId;n=new Bg(u,o)}}return n}function NS(e,t){let n;if(t instanceof _s)n={update:Td(e,t.key,t.value)};else if(t instanceof Lg)n={delete:cl(e,t.key)};else if(t instanceof Wn)n={update:Td(e,t.key,t.data),updateMask:$S(t.fieldMask)};else{if(!(t instanceof yS))return W(16599,{Rt:t.type});n={verify:cl(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof Wo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof cs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof hs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ko)return{fieldPath:o.field.canonicalString(),increment:u.Ee};throw W(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:PS(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W(27497)}(e,t.precondition)),n}function DS(e,t){return e&&e.length>0?(lt(t!==void 0,14353),e.map(n=>function(i,s){let o=i.updateTime?Je(i.updateTime):Je(s);return o.isEqual(Q.min())&&(o=Je(s)),new mS(o,i.transformResults||[])}(n,t))):[]}function kS(e,t){return{documents:[zg(e,t.path)]}}function OS(e,t){const n={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=zg(e,i);const s=function(l){if(l.length!==0)return Wg(Be.create(l,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(l){if(l.length!==0)return l.map(h=>function(p){return{field:Or(p.field),direction:LS(p.dir)}}(h))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const u=ul(e,t.limit);return u!==null&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{Vt:n,parent:i}}function MS(e){let t=xS(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){lt(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let s=[];n.where&&(s=function(d){const p=Gg(d);return p instanceof Be&&Eg(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(_){return new ls(Mr(_.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(p))}(n.orderBy));let u=null;n.limit&&(u=function(d){let p;return p=typeof d=="object"?d.value:d,ga(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(d){const p=!!d.before,g=d.values||[];return new Ho(g,p)}(n.startAt));let l=null;return n.endAt&&(l=function(d){const p=!d.before,g=d.values||[];return new Ho(g,p)}(n.endAt)),nS(t,i,o,s,u,"F",c,l)}function FS(e,t){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W(28987,{purpose:i})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Gg(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Mr(n.unaryFilter.field);return Dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Mr(n.unaryFilter.field);return Dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mr(n.unaryFilter.field);return Dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mr(n.unaryFilter.field);return Dt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return W(61313);default:return W(60726)}}(e):e.fieldFilter!==void 0?function(n){return Dt.create(Mr(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return W(58110);default:return W(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Be.create(n.compositeFilter.filters.map(r=>Gg(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W(1026)}}(n.compositeFilter.op))}(e):W(30097,{filter:e})}function LS(e){return RS[e]}function US(e){return SS[e]}function BS(e){return bS[e]}function Or(e){return{fieldPath:e.canonicalString()}}function Mr(e){return Gt.fromServerFormat(e.fieldPath)}function Wg(e){return e instanceof Dt?function(n){if(n.op==="=="){if(ld(n.value))return{unaryFilter:{field:Or(n.field),op:"IS_NAN"}};if(ud(n.value))return{unaryFilter:{field:Or(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ld(n.value))return{unaryFilter:{field:Or(n.field),op:"IS_NOT_NAN"}};if(ud(n.value))return{unaryFilter:{field:Or(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Or(n.field),op:US(n.op),value:n.value}}}(e):e instanceof Be?function(n){const r=n.getFilters().map(i=>Wg(i));return r.length===1?r[0]:{compositeFilter:{op:BS(n.op),filters:r}}}(e):W(54877,{filter:e})}function $S(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Kg(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(t,n,r,i,s=Q.min(),o=Q.min(),u=Wt.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(t){return new Vn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(t){this.gt=t}}function jS(e){const t=MS({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Go(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(){this.Dn=new HS}addToCollectionParentIndex(t,n){return this.Dn.add(n),F.resolve()}getCollectionParents(t,n){return F.resolve(this.Dn.getEntries(n))}addFieldIndex(t,n){return F.resolve()}deleteFieldIndex(t,n){return F.resolve()}deleteAllFieldIndexes(t){return F.resolve()}createTargetIndexes(t,n){return F.resolve()}getDocumentsMatchingTarget(t,n){return F.resolve(null)}getIndexType(t,n){return F.resolve(0)}getFieldIndexes(t,n){return F.resolve([])}getNextCollectionGroupToUpdate(t){return F.resolve(null)}getMinOffset(t,n){return F.resolve(Un.min())}getMinOffsetFromCollectionGroup(t,n){return F.resolve(Un.min())}updateCollectionGroup(t,n,r){return F.resolve()}updateIndexEntries(t,n){return F.resolve()}}class HS{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new Ft(gt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new Ft(gt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qg=41943040;class ce{static withCacheSize(t){return new ce(t,ce.DEFAULT_COLLECTION_PERCENTILE,ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ce.DEFAULT_COLLECTION_PERCENTILE=10,ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ce.DEFAULT=new ce(Qg,ce.DEFAULT_COLLECTION_PERCENTILE,ce.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ce.DISABLED=new ce(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Xr(0)}static ur(){return new Xr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Id="LruGarbageCollector",GS=1048576;function Rd([e,t],[n,r]){const i=tt(e,n);return i===0?tt(t,r):i}class WS{constructor(t){this.Tr=t,this.buffer=new Ft(Rd),this.Ir=0}dr(){return++this.Ir}Er(t){const n=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Rd(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class KS{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){z(Id,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ai(n)?z(Id,"Ignoring IndexedDB error during garbage collection: ",n):await oi(n)}await this.Rr(3e5)})}}class QS{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.mr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return F.resolve(ma.ue);const r=new WS(n);return this.Vr.forEachTarget(t,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(t,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.Vr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(Ad)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ad):this.pr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,n){let r,i,s,o,u,c,l;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(r=d,u=Date.now(),this.removeTargets(t,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(t,r))).next(d=>(l=Date.now(),Dr()<=st.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function XS(e,t){return new QS(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(){this.changes=new Tr(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,ee.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&Hi(r.mutation,i,Ae.empty(),wt.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,rt()).next(()=>r))}getLocalViewOfDocuments(t,n,r=rt()){const i=ur();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let o=Fi();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=ur();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,rt()))}populateOverlays(t,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(t,n,r,i){let s=Tn();const o=zi(),u=function(){return zi()}();return n.forEach((c,l)=>{const h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof Wn)?s=s.insert(l.key,l):h!==void 0?(o.set(l.key,h.mutation.getFieldMask()),Hi(h.mutation,l,h.mutation.getFieldMask(),wt.now())):o.set(l.key,Ae.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((l,h)=>o.set(l,h)),n.forEach((l,h)=>{var d;return u.set(l,new JS(h,(d=o.get(l))!==null&&d!==void 0?d:null))}),u))}recalculateAndSaveOverlays(t,n){const r=zi();let i=new It((o,u)=>o-u),s=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let h=r.get(c)||Ae.empty();h=u.applyToLocalView(l,h),r.set(c,h);const d=(i.get(u.batchId)||rt()).add(c);i=i.insert(u.batchId,d)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),l=c.key,h=c.value,d=xg();h.forEach(p=>{if(!s.has(p)){const g=Mg(n.get(p),r.get(p));g!==null&&d.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,d))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):Rg(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):F.resolve(ur());let u=ss,c=s;return o.next(l=>F.forEach(l,(h,d)=>(u<d.largestBatchId&&(u=d.largestBatchId),s.get(h)?F.resolve():this.remoteDocumentCache.getEntry(t,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(t,l,s)).next(()=>this.computeViews(t,c,l,rt())).next(h=>({batchId:u,changes:Pg(h)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new G(n)).next(r=>{let i=Fi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const s=n.collectionGroup;let o=Fi();return this.indexManager.getCollectionParents(t,s).next(u=>F.forEach(u,c=>{const l=function(d,p){return new ui(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,r,i).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(o=>{s.forEach((c,l)=>{const h=l.getKey();o.get(h)===null&&(o=o.insert(h,ee.newInvalidDocument(h)))});let u=Fi();return o.forEach((c,l)=>{const h=s.get(c);h!==void 0&&Hi(h.mutation,l,Ae.empty(),wt.now()),va(n,l)&&(u=u.insert(c,l))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,n){return F.resolve(this.Br.get(n))}saveBundleMetadata(t,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Je(i.createTime)}}(n)),F.resolve()}getNamedQuery(t,n){return F.resolve(this.Lr.get(n))}saveNamedQuery(t,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:jS(i.bundledQuery),readTime:Je(i.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(){this.overlays=new It(G.comparator),this.kr=new Map}getOverlay(t,n){return F.resolve(this.overlays.get(n))}getOverlays(t,n){const r=ur();return F.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.wt(t,n,s)}),F.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),F.resolve()}getOverlaysForCollection(t,n,r){const i=ur(),s=n.length+1,o=new G(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return F.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new It((l,h)=>l-h);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let h=s.get(l.largestBatchId);h===null&&(h=ur(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const u=ur(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>u.set(l,h)),!(u.size()>=i)););return F.resolve(u)}wt(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new wS(n,r));let s=this.kr.get(n);s===void 0&&(s=rt(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(){this.sessionToken=Wt.EMPTY_BYTE_STRING}getSessionToken(t){return F.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(){this.qr=new Ft(qt.Qr),this.$r=new Ft(qt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,n){const r=new qt(t,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Wr(new qt(t,n))}Gr(t,n){t.forEach(r=>this.removeReference(r,n))}zr(t){const n=new G(new gt([])),r=new qt(n,t),i=new qt(n,t+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const n=new G(new gt([])),r=new qt(n,t),i=new qt(n,t+1);let s=rt();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new qt(t,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class qt{constructor(t,n){this.key=t,this.Hr=n}static Qr(t,n){return G.comparator(t.key,n.key)||tt(t.Hr,n.Hr)}static Ur(t,n){return tt(t.Hr,n.Hr)||G.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Ft(qt.Qr)}checkEmpty(t){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new vS(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.Yr=this.Yr.add(new qt(u.key,s)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return F.resolve(o)}lookupMutationBatch(t,n){return F.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return F.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?Jl:this.er-1)}getAllMutationBatches(t){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new qt(n,0),i=new qt(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const u=this.Zr(o.Hr);s.push(u)}),F.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Ft(tt);return n.forEach(i=>{const s=new qt(i,0),o=new qt(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],u=>{r=r.add(u.Hr)})}),F.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new qt(new G(s),0);let u=new Ft(tt);return this.Yr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(u=u.add(c.Hr)),!0)},o),F.resolve(this.ei(u))}ei(t){const n=[];return t.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){lt(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return F.forEach(n.mutations,i=>{const s=new qt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Yr=r})}rr(t){}containsKey(t,n){const r=new qt(n,0),i=this.Yr.firstAfterOrEqual(r);return F.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,F.resolve()}ti(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(t){this.ni=t,this.docs=function(){return new It(G.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():ee.newInvalidDocument(n))}getEntries(t,n){let r=Tn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ee.newInvalidDocument(i))}),F.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=Tn();const o=n.path,u=new G(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:l,value:{document:h}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||kR(DR(h),r)<=0||(i.has(h.key)||va(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return F.resolve(s)}getAllFromCollectionGroup(t,n,r,i){W(9500)}ri(t,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new sb(this)}getSize(t){return F.resolve(this.size)}}class sb extends YS{constructor(t){super(),this.Or=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(t,i)):this.Or.removeEntry(r)}),F.waitFor(n)}getFromCache(t,n){return this.Or.getEntry(t,n)}getAllFromCache(t,n){return this.Or.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(t){this.persistence=t,this.ii=new Tr(n=>ec(n),nc),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.si=0,this.oi=new uc,this.targetCount=0,this._i=Xr.ar()}forEachTarget(t,n){return this.ii.forEach((r,i)=>n(i)),F.resolve()}getLastRemoteSnapshotVersion(t){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return F.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),F.resolve()}hr(t){this.ii.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this._i=new Xr(n),this.highestTargetId=n),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,n){return this.hr(n),this.targetCount+=1,F.resolve()}updateTargetData(t,n){return this.hr(n),F.resolve()}removeTargetData(t,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(t,n,r){let i=0;const s=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)}),F.waitFor(s).next(()=>i)}getTargetCount(t){return F.resolve(this.targetCount)}getTargetData(t,n){const r=this.ii.get(n)||null;return F.resolve(r)}addMatchingKeys(t,n,r){return this.oi.Kr(n,r),F.resolve()}removeMatchingKeys(t,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),F.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.oi.zr(n),F.resolve()}getMatchingKeysForTargetId(t,n){const r=this.oi.Jr(n);return F.resolve(r)}containsKey(t,n){return F.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(t,n){this.ai={},this.overlays={},this.ui=new ma(0),this.ci=!1,this.ci=!0,this.li=new nb,this.referenceDelegate=t(this),this.hi=new ob(this),this.indexManager=new zS,this.remoteDocumentCache=function(i){return new ib(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new qS(n),this.Ti=new tb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new eb,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ai[t.toKey()];return r||(r=new rb(n,this.referenceDelegate),this.ai[t.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,n,r){z("MemoryPersistence","Starting transaction:",t);const i=new ab(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(t,n){return F.or(Object.values(this.ai).map(r=>()=>r.containsKey(t,n)))}}class ab extends MR{constructor(t){super(),this.currentSequenceNumber=t}}class lc{constructor(t){this.persistence=t,this.Ai=new uc,this.Ri=null}static Vi(t){return new lc(t)}get mi(){if(this.Ri)return this.Ri;throw W(60996)}addReference(t,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),F.resolve()}removeReference(t,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),F.resolve()}markPotentiallyOrphaned(t,n){return this.mi.add(n.toString()),F.resolve()}removeTarget(t,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ii(){this.Ri=new Set}di(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.mi,r=>{const i=G.fromPath(r);return this.fi(t,i).next(s=>{s||n.removeEntry(i,Q.min())})}).next(()=>(this.Ri=null,n.apply(t)))}updateLimboDocument(t,n){return this.fi(t,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(t){return 0}fi(t,n){return F.or([()=>F.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class Xo{constructor(t,n){this.persistence=t,this.gi=new Tr(r=>UR(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=XS(this,n)}static Vi(t,n){return new Xo(t,n)}Ii(){}di(t){return F.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}mr(t){const n=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}yr(t){let n=0;return this.gr(t,r=>{n++}).next(()=>n)}gr(t,n){return F.forEach(this.gi,(r,i)=>this.Sr(t,r,i).next(s=>s?F.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(t,o=>this.Sr(t,o,n).next(u=>{u||(r++,s.removeEntry(o,Q.min()))})).next(()=>s.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.gi.set(n,t.currentSequenceNumber),F.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),F.resolve()}removeReference(t,n,r){return this.gi.set(r,t.currentSequenceNumber),F.resolve()}updateLimboDocument(t,n){return this.gi.set(n,t.currentSequenceNumber),F.resolve()}Pi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=uo(t.data.value)),n}Sr(t,n,r){return F.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.gi.get(n);return F.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.Is=r,this.ds=i}static Es(t,n){let r=rt(),i=rt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new cc(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return eI()?8:FR(ZA())>0?6:4}()}initialize(t,n){this.gs=t,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(t,n,r,i){const s={result:null};return this.ps(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(t,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new ub;return this.ws(t,n,o).next(u=>{if(s.result=u,this.Rs)return this.Ss(t,n,o,u.size)})}).next(()=>s.result)}Ss(t,n,r,i){return r.documentReadCount<this.Vs?(Dr()<=st.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",kr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),F.resolve()):(Dr()<=st.DEBUG&&z("QueryEngine","Query:",kr(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Dr()<=st.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",kr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Xe(n))):F.resolve())}ps(t,n){if(dd(n))return F.resolve(null);let r=Xe(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Go(n,null,"F"),r=Xe(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{const o=rt(...s);return this.gs.getDocuments(t,o).next(u=>this.indexManager.getMinOffset(t,r).next(c=>{const l=this.bs(n,u);return this.Ds(n,l,o,c.readTime)?this.ps(t,Go(n,null,"F")):this.vs(t,l,n,c)}))})))}ys(t,n,r,i){return dd(n)||i.isEqual(Q.min())?F.resolve(null):this.gs.getDocuments(t,r).next(s=>{const o=this.bs(n,s);return this.Ds(n,o,r,i)?F.resolve(null):(Dr()<=st.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),kr(n)),this.vs(t,o,n,NR(i,ss)).next(u=>u))})}bs(t,n){let r=new Ft(bg(t));return n.forEach((i,s)=>{va(t,s)&&(r=r.add(s))}),r}Ds(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(t,n,r){return Dr()<=st.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",kr(n)),this.gs.getDocumentsMatchingQuery(t,n,Un.min(),r)}vs(t,n,r,i){return this.gs.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc="LocalStore",cb=3e8;class hb{constructor(t,n,r,i){this.persistence=t,this.Cs=n,this.serializer=i,this.Fs=new It(tt),this.Ms=new Tr(s=>ec(s),nc),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(r)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new ZS(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Fs))}}function fb(e,t,n,r){return new hb(e,t,n,r)}async function Yg(e,t){const n=Y(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=rt();for(const l of i){o.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}for(const l of s){u.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Bs:l,removedBatchIds:o,addedBatchIds:u}))})})}function db(e,t){const n=Y(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,c,l,h){const d=l.batch,p=d.keys();let g=F.resolve();return p.forEach(_=>{g=g.next(()=>h.getEntry(c,_)).next(E=>{const v=l.docVersions.get(_);lt(v!==null,48541),E.version.compareTo(v)<0&&(d.applyToRemoteDocument(E,l),E.isValidDocument()&&(E.setReadTime(l.commitVersion),h.addEntry(E)))})}),g.next(()=>u.mutationQueue.removeMutationBatch(c,d))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=rt();for(let l=0;l<u.mutationResults.length;++l)u.mutationResults[l].transformResults.length>0&&(c=c.add(u.batch.mutations[l].key));return c}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function Jg(e){const t=Y(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.hi.getLastRemoteSnapshotVersion(n))}function pb(e,t){const n=Y(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const u=[];t.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;u.push(n.hi.removeMatchingKeys(s,h.removedDocuments,d).next(()=>n.hi.addMatchingKeys(s,h.addedDocuments,d)));let g=p.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?g=g.withResumeToken(Wt.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(d,g),function(E,v,b){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=cb?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(p,g,h)&&u.push(n.hi.updateTargetData(s,g))});let c=Tn(),l=rt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),u.push(mb(s,o,t.documentUpdates).next(h=>{c=h.Ls,l=h.ks})),!r.isEqual(Q.min())){const h=n.hi.getLastRemoteSnapshotVersion(s).next(d=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(h)}return F.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.Fs=i,s))}function mb(e,t,n){let r=rt(),i=rt();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let o=Tn();return n.forEach((u,c)=>{const l=s.get(u);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(Q.min())?(t.removeEntry(u,c.readTime),o=o.insert(u,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(u,c)):z(hc,"Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function gb(e,t){const n=Y(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=Jl),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function _b(e,t){const n=Y(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,t).next(s=>s?(i=s,F.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new Vn(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(t,r.targetId)),r})}async function fl(e,t,n){const r=Y(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ai(o))throw o;z(hc,`Failed to update sequence numbers for target ${t}: ${o}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function Sd(e,t,n){const r=Y(e);let i=Q.min(),s=rt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,h){const d=Y(c),p=d.Ms.get(h);return p!==void 0?F.resolve(d.Fs.get(p)):d.hi.getTargetData(l,h)}(r,o,Xe(t)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,t,n?i:Q.min(),n?s:rt())).next(u=>(yb(r,iS(t),u),{documents:u,qs:s})))}function yb(e,t,n){let r=e.xs.get(t)||Q.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.xs.set(t,r)}class bd{constructor(){this.activeTargetIds=cS()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class vb{constructor(){this.Fo=new bd,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,n,r){this.Mo[t]=n}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new bd,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="ConnectivityMonitor";class Pd{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){z(Cd,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){z(Cd,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Js=null;function dl(){return Js===null?Js=function(){return 268435456+Math.round(2147483648*Math.random())}():Js++,"0x"+Js.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu="RestConnection",Eb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Tb{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===jo?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,n,r,i,s){const o=dl(),u=this.Go(t,n.toUriEncodedString());z(pu,`Sending RPC '${t}' ${o}:`,u,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);const{host:l}=new URL(u),h=Kl(l);return this.jo(t,u,c,r,h).then(d=>(z(pu,`Received RPC '${t}' ${o}: `,d),d),d=>{throw Ln(pu,`RPC '${t}' ${o} failed with error: `,d,"url: ",u,"request:",r),d})}Jo(t,n,r,i,s,o){return this.Wo(t,n,r,i,s)}zo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+si}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>t[s]=i),r&&r.headers.forEach((i,s)=>t[s]=i)}Go(t,n){const r=Eb[t];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class Ib extends Tb{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,n,r,i,s){const o=dl();return new Promise((u,c)=>{const l=new Zm;l.setWithCredentials(!0),l.listenOnce(tg.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ao.NO_ERROR:const d=l.getResponseJson();z(Zt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),u(d);break;case ao.TIMEOUT:z(Zt,`RPC '${t}' ${o} timed out`),c(new q(O.DEADLINE_EXCEEDED,"Request time out"));break;case ao.HTTP_ERROR:const p=l.getStatus();if(z(Zt,`RPC '${t}' ${o} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const E=function(b){const C=b.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(C)>=0?C:O.UNKNOWN}(_.status);c(new q(E,_.message))}else c(new q(O.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new q(O.UNAVAILABLE,"Connection failed."));break;default:W(9055,{c_:t,streamId:o,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{z(Zt,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);z(Zt,`RPC '${t}' ${o} sending request:`,i),l.send(n,"POST",h,r,15)})}P_(t,n,r){const i=dl(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=rg(),u=ng(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=s.join("");z(Zt,`Creating RPC '${t}' stream ${i}: ${h}`,c);const d=o.createWebChannel(h,c);this.T_(d);let p=!1,g=!1;const _=new Ab({Ho:v=>{g?z(Zt,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(p||(z(Zt,`Opening RPC '${t}' stream ${i} transport.`),d.open(),p=!0),z(Zt,`RPC '${t}' stream ${i} sending:`,v),d.send(v))},Yo:()=>d.close()}),E=(v,b,C)=>{v.listen(b,N=>{try{C(N)}catch(x){setTimeout(()=>{throw x},0)}})};return E(d,Mi.EventType.OPEN,()=>{g||(z(Zt,`RPC '${t}' stream ${i} transport opened.`),_.s_())}),E(d,Mi.EventType.CLOSE,()=>{g||(g=!0,z(Zt,`RPC '${t}' stream ${i} transport closed`),_.__(),this.I_(d))}),E(d,Mi.EventType.ERROR,v=>{g||(g=!0,Ln(Zt,`RPC '${t}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),_.__(new q(O.UNAVAILABLE,"The operation could not be completed")))}),E(d,Mi.EventType.MESSAGE,v=>{var b;if(!g){const C=v.data[0];lt(!!C,16349);const N=C,x=(N==null?void 0:N.error)||((b=N[0])===null||b===void 0?void 0:b.error);if(x){z(Zt,`RPC '${t}' stream ${i} received error:`,x);const M=x.status;let U=function(T){const S=Nt[T];if(S!==void 0)return Ug(S)}(M),I=x.message;U===void 0&&(U=O.INTERNAL,I="Unknown error status: "+M+" with message "+x.message),g=!0,_.__(new q(U,I)),d.close()}else z(Zt,`RPC '${t}' stream ${i} received:`,C),_.a_(C)}}),E(u,eg.STAT_EVENT,v=>{v.stat===el.PROXY?z(Zt,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===el.NOPROXY&&z(Zt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.o_()},0),_}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(n=>n===t)}}function mu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(e){return new CS(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(t,n,r=1e3,i=1.5,s=6e4){this.Fi=t,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd="PersistentStream";class t_{constructor(t,n,r,i,s,o,u,c){this.Fi=t,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Zg(t,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():n&&n.code===O.RESOURCE_EXHAUSTED?(wn(n.toString()),wn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(n)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{t(()=>{const i=new q(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(t,n){const r=this.K_(this.b_);this.stream=this.z_(t,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return z(xd,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return n=>{this.Fi.enqueueAndForget(()=>this.b_===t?n():(z(xd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Rb extends t_{constructor(t,n,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(t,n){return this.connection.P_("Listen",t,n)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const n=VS(this.serializer,t),r=function(s){if(!("targetChange"in s))return Q.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Q.min():o.readTime?Je(o.readTime):Q.min()}(t);return this.listener.J_(n,r)}H_(t){const n={};n.database=hl(this.serializer),n.addTarget=function(s,o){let u;const c=o.target;if(u=ol(c)?{documents:kS(s,c)}:{query:OS(s,c).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=qg(s,o.resumeToken);const l=ul(s,o.expectedCount);l!==null&&(u.expectedCount=l)}else if(o.snapshotVersion.compareTo(Q.min())>0){u.readTime=Qo(s,o.snapshotVersion.toTimestamp());const l=ul(s,o.expectedCount);l!==null&&(u.expectedCount=l)}return u}(this.serializer,t);const r=FS(this.serializer,t);r&&(n.labels=r),this.k_(n)}Y_(t){const n={};n.database=hl(this.serializer),n.removeTarget=t,this.k_(n)}}class Sb extends t_{constructor(t,n,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,n){return this.connection.P_("Write",t,n)}j_(t){return lt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,lt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){lt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const n=DS(t.writeResults,t.commitTime),r=Je(t.commitTime);return this.listener.ta(r,n)}na(){const t={};t.database=hl(this.serializer),this.k_(t)}X_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>NS(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{}class Cb extends bb{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,ll(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(O.UNKNOWN,s.toString())})}Jo(t,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(t,ll(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(O.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Pb{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(wn(n),this._a=!1):z("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr="RemoteStore";class xb{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Ar(this)&&(z(vr,"Restarting streams for network reachability change."),await async function(c){const l=Y(c);l.Ia.add(4),await vs(l),l.Aa.set("Unknown"),l.Ia.delete(4),await Ia(l)}(this))})}),this.Aa=new Pb(r,i)}}async function Ia(e){if(Ar(e))for(const t of e.da)await t(!0)}async function vs(e){for(const t of e.da)await t(!1)}function e_(e,t){const n=Y(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),mc(n)?pc(n):li(n).x_()&&dc(n,t))}function fc(e,t){const n=Y(e),r=li(n);n.Ta.delete(t),r.x_()&&n_(n,t),n.Ta.size===0&&(r.x_()?r.B_():Ar(n)&&n.Aa.set("Unknown"))}function dc(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Q.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}li(e).H_(t)}function n_(e,t){e.Ra.$e(t),li(e).Y_(t)}function pc(e){e.Ra=new IS({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),li(e).start(),e.Aa.aa()}function mc(e){return Ar(e)&&!li(e).M_()&&e.Ta.size>0}function Ar(e){return Y(e).Ia.size===0}function r_(e){e.Ra=void 0}async function Vb(e){e.Aa.set("Online")}async function Nb(e){e.Ta.forEach((t,n)=>{dc(e,t)})}async function Db(e,t){r_(e),mc(e)?(e.Aa.la(t),pc(e)):e.Aa.set("Unknown")}async function kb(e,t,n){if(e.Aa.set("Online"),t instanceof $g&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.Ta.delete(u),i.Ra.removeTarget(u))}(e,t)}catch(r){z(vr,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Yo(e,r)}else if(t instanceof ho?e.Ra.Ye(t):t instanceof Bg?e.Ra.it(t):e.Ra.et(t),!n.isEqual(Q.min()))try{const r=await Jg(e.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Ra.Pt(o);return u.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.Ta.get(l);h&&s.Ta.set(l,h.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,l)=>{const h=s.Ta.get(c);if(!h)return;s.Ta.set(c,h.withResumeToken(Wt.EMPTY_BYTE_STRING,h.snapshotVersion)),n_(s,c);const d=new Vn(h.target,c,l,h.sequenceNumber);dc(s,d)}),s.remoteSyncer.applyRemoteEvent(u)}(e,n)}catch(r){z(vr,"Failed to raise snapshot:",r),await Yo(e,r)}}async function Yo(e,t,n){if(!ai(t))throw t;e.Ia.add(1),await vs(e),e.Aa.set("Offline"),n||(n=()=>Jg(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{z(vr,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await Ia(e)})}function i_(e,t){return t().catch(n=>Yo(e,n,t))}async function Ra(e){const t=Y(e),n=jn(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Jl;for(;Ob(t);)try{const i=await gb(t.localStore,r);if(i===null){t.Pa.length===0&&n.B_();break}r=i.batchId,Mb(t,i)}catch(i){await Yo(t,i)}s_(t)&&o_(t)}function Ob(e){return Ar(e)&&e.Pa.length<10}function Mb(e,t){e.Pa.push(t);const n=jn(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function s_(e){return Ar(e)&&!jn(e).M_()&&e.Pa.length>0}function o_(e){jn(e).start()}async function Fb(e){jn(e).na()}async function Lb(e){const t=jn(e);for(const n of e.Pa)t.X_(n.mutations)}async function Ub(e,t,n){const r=e.Pa.shift(),i=sc.from(r,t,n);await i_(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Ra(e)}async function Bb(e,t){t&&jn(e).Z_&&await async function(r,i){if(function(o){return TS(o)&&o!==O.ABORTED}(i.code)){const s=r.Pa.shift();jn(r).N_(),await i_(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ra(r)}}(e,t),s_(e)&&o_(e)}async function Vd(e,t){const n=Y(e);n.asyncQueue.verifyOperationInProgress(),z(vr,"RemoteStore received new credentials");const r=Ar(n);n.Ia.add(3),await vs(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await Ia(n)}async function $b(e,t){const n=Y(e);t?(n.Ia.delete(2),await Ia(n)):t||(n.Ia.add(2),await vs(n),n.Aa.set("Unknown"))}function li(e){return e.Va||(e.Va=function(n,r,i){const s=Y(n);return s.ia(),new Rb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:Vb.bind(null,e),e_:Nb.bind(null,e),n_:Db.bind(null,e),J_:kb.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),mc(e)?pc(e):e.Aa.set("Unknown")):(await e.Va.stop(),r_(e))})),e.Va}function jn(e){return e.ma||(e.ma=function(n,r,i){const s=Y(n);return s.ia(),new Sb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:Fb.bind(null,e),n_:Bb.bind(null,e),ea:Lb.bind(null,e),ta:Ub.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await Ra(e)):(await e.ma.stop(),e.Pa.length>0&&(z(vr,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){const o=Date.now()+r,u=new gc(t,n,o,i,s);return u.start(r),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(O.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _c(e,t){if(wn("AsyncQueue",`${t}: ${e}`),ai(e))return new q(O.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{static emptySet(t){return new $r(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=Fi(),this.sortedSet=new It(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof $r)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new $r;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(){this.fa=new It(G.comparator)}track(t){const n=t.doc.key,r=this.fa.get(n);r?t.type!==0&&r.type===3?this.fa=this.fa.insert(n,t):t.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.fa=this.fa.remove(n):t.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:t.doc}):W(63341,{At:t,ga:r}):this.fa=this.fa.insert(n,t)}pa(){const t=[];return this.fa.inorderTraversal((n,r)=>{t.push(r)}),t}}class Yr{constructor(t,n,r,i,s,o,u,c,l){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new Yr(t,n,$r.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ya(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class jb{constructor(){this.queries=Dd(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=Y(n),s=i.queries;i.queries=Dd(),s.forEach((o,u)=>{for(const c of u.wa)c.onError(r)})})(this,new q(O.ABORTED,"Firestore shutting down"))}}function Dd(){return new Tr(e=>Sg(e),ya)}async function a_(e,t){const n=Y(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new qb,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=_c(o,`Initialization of query '${kr(t.query)}' failed`);return void t.onError(u)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&yc(n)}async function u_(e,t){const n=Y(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const o=s.wa.indexOf(t);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function zb(e,t){const n=Y(e);let r=!1;for(const i of t){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.wa)u.Ca(i)&&(r=!0);o.ya=i}}r&&yc(n)}function Hb(e,t,n){const r=Y(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function yc(e){e.Da.forEach(t=>{t.next()})}var pl,kd;(kd=pl||(pl={})).Fa="default",kd.Cache="cache";class l_{constructor(t,n,r){this.query=t,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new Yr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),n=!0):this.Ba(t,this.onlineState)&&(this.La(t),n=!0),this.Oa=t,n}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),n=!0),n}Ba(t,n){if(!t.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(t){t=Yr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==pl.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(t){this.key=t}}class h_{constructor(t){this.key=t}}class Gb{constructor(t,n){this.query=t,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=rt(),this.mutatedKeys=rt(),this.Xa=bg(t),this.eu=new $r(this.Xa)}get tu(){return this.Ha}nu(t,n){const r=n?n.ru:new Nd,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const p=i.get(h),g=va(this.query,d)?d:null,_=!!p&&this.mutatedKeys.has(p.key),E=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;p&&g?p.data.isEqual(g.data)?_!==E&&(r.track({type:3,doc:g}),v=!0):this.iu(p,g)||(r.track({type:2,doc:g}),v=!0,(c&&this.Xa(g,c)>0||l&&this.Xa(g,l)<0)&&(u=!0)):!p&&g?(r.track({type:0,doc:g}),v=!0):p&&!g&&(r.track({type:1,doc:p}),v=!0,(c||l)&&(u=!0)),v&&(g?(o=o.add(g),s=E?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:u,mutatedKeys:s}}iu(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const o=t.ru.pa();o.sort((h,d)=>function(g,_){const E=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W(20277,{At:v})}};return E(g)-E(_)}(h.type,d.type)||this.Xa(h.doc,d.doc)),this.su(r),i=i!=null&&i;const u=n&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,l=c!==this.Ya;return this.Ya=c,o.length!==0||l?{snapshot:new Yr(this.query,t.eu,s,o,t.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Nd,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=rt(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return t.forEach(r=>{this.Za.has(r)||n.push(new h_(r))}),this.Za.forEach(r=>{t.has(r)||n.push(new c_(r))}),n}uu(t){this.Ha=t.qs,this.Za=rt();const n=this.nu(t.documents);return this.applyChanges(n,!0)}cu(){return Yr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const vc="SyncEngine";class Wb{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class Kb{constructor(t){this.key=t,this.lu=!1}}class Qb{constructor(t,n,r,i,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Tr(u=>Sg(u),ya),this.Tu=new Map,this.Iu=new Set,this.du=new It(G.comparator),this.Eu=new Map,this.Au=new uc,this.Ru={},this.Vu=new Map,this.mu=Xr.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function Xb(e,t,n=!0){const r=__(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await f_(r,t,n,!0),i}async function Yb(e,t){const n=__(e);await f_(n,t,!0,!1)}async function f_(e,t,n,r){const i=await _b(e.localStore,Xe(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await Jb(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&n&&e_(e.remoteStore,i),u}async function Jb(e,t,n,r,i){e.gu=(d,p,g)=>async function(E,v,b,C){let N=v.view.nu(b);N.Ds&&(N=await Sd(E.localStore,v.query,!1).then(({documents:I})=>v.view.nu(I,N)));const x=C&&C.targetChanges.get(v.targetId),M=C&&C.targetMismatches.get(v.targetId)!=null,U=v.view.applyChanges(N,E.isPrimaryClient,x,M);return Md(E,v.targetId,U._u),U.snapshot}(e,d,p,g);const s=await Sd(e.localStore,t,!0),o=new Gb(t,s.qs),u=o.nu(s.documents),c=ys.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),l=o.applyChanges(u,e.isPrimaryClient,c);Md(e,n,l._u);const h=new Wb(t,n,o);return e.Pu.set(t,h),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),l.snapshot}async function Zb(e,t,n){const r=Y(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!ya(o,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await fl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&fc(r.remoteStore,i.targetId),ml(r,i.targetId)}).catch(oi)):(ml(r,i.targetId),await fl(r.localStore,i.targetId,!0))}async function tC(e,t){const n=Y(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),fc(n.remoteStore,r.targetId))}async function eC(e,t,n){const r=uC(e);try{const i=await function(o,u){const c=Y(o),l=wt.now(),h=u.reduce((g,_)=>g.add(_.key),rt());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=Tn(),E=rt();return c.Os.getEntries(g,h).next(v=>{_=v,_.forEach((b,C)=>{C.isValidDocument()||(E=E.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,_)).next(v=>{d=v;const b=[];for(const C of u){const N=_S(C,d.get(C.key).overlayedDocument);N!=null&&b.push(new Wn(C.key,N,yg(N.value.mapValue),Ye.exists(!0)))}return c.mutationQueue.addMutationBatch(g,l,b,u)}).next(v=>{p=v;const b=v.applyToLocalDocumentSet(d,E);return c.documentOverlayCache.saveOverlays(g,v.batchId,b)})}).then(()=>({batchId:p.batchId,changes:Pg(d)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let l=o.Ru[o.currentUser.toKey()];l||(l=new It(tt)),l=l.insert(u,c),o.Ru[o.currentUser.toKey()]=l}(r,i.batchId,n),await ws(r,i.changes),await Ra(r.remoteStore)}catch(i){const s=_c(i,"Failed to persist write");n.reject(s)}}async function d_(e,t){const n=Y(e);try{const r=await pb(n.localStore,t);t.targetChanges.forEach((i,s)=>{const o=n.Eu.get(s);o&&(lt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?lt(o.lu,14607):i.removedDocuments.size>0&&(lt(o.lu,42227),o.lu=!1))}),await ws(n,r,t)}catch(r){await oi(r)}}function Od(e,t,n){const r=Y(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,o)=>{const u=o.view.va(t);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=Y(o);c.onlineState=u;let l=!1;c.queries.forEach((h,d)=>{for(const p of d.wa)p.va(u)&&(l=!0)}),l&&yc(c)}(r.eventManager,t),i.length&&r.hu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function nC(e,t,n){const r=Y(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let o=new It(G.comparator);o=o.insert(s,ee.newNoDocument(s,Q.min()));const u=rt().add(s),c=new Ta(Q.min(),new Map,new It(tt),o,u);await d_(r,c),r.du=r.du.remove(s),r.Eu.delete(t),wc(r)}else await fl(r.localStore,t,!1).then(()=>ml(r,t,n)).catch(oi)}async function rC(e,t){const n=Y(e),r=t.batch.batchId;try{const i=await db(n.localStore,t);m_(n,r,null),p_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ws(n,i)}catch(i){await oi(i)}}async function iC(e,t,n){const r=Y(e);try{const i=await function(o,u){const c=Y(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,u).next(d=>(lt(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,t);m_(r,t,n),p_(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await ws(r,i)}catch(i){await oi(i)}}function p_(e,t){(e.Vu.get(t)||[]).forEach(n=>{n.resolve()}),e.Vu.delete(t)}function m_(e,t,n){const r=Y(e);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function ml(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(r=>{e.Au.containsKey(r)||g_(e,r)})}function g_(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);n!==null&&(fc(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),wc(e))}function Md(e,t,n){for(const r of n)r instanceof c_?(e.Au.addReference(r.key,t),sC(e,r)):r instanceof h_?(z(vc,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||g_(e,r.key)):W(19791,{yu:r})}function sC(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(z(vc,"New document in limbo: "+n),e.Iu.add(r),wc(e))}function wc(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new G(gt.fromString(t)),r=e.mu.next();e.Eu.set(r,new Kb(n)),e.du=e.du.insert(n,r),e_(e.remoteStore,new Vn(Xe(rc(n.path)),r,"TargetPurposeLimboResolution",ma.ue))}}async function ws(e,t,n){const r=Y(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,c)=>{o.push(r.gu(c,t,n).then(l=>{var h;if((l||n)&&r.isPrimaryClient){const d=l?!l.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);const d=cc.Es(c.targetId,l);s.push(d)}}))}),await Promise.all(o),r.hu.J_(i),await async function(c,l){const h=Y(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>F.forEach(l,p=>F.forEach(p.Is,g=>h.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>F.forEach(p.ds,g=>h.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!ai(d))throw d;z(hc,"Failed to update sequence numbers: "+d)}for(const d of l){const p=d.targetId;if(!d.fromCache){const g=h.Fs.get(p),_=g.snapshotVersion,E=g.withLastLimboFreeSnapshotVersion(_);h.Fs=h.Fs.insert(p,E)}}}(r.localStore,s))}async function oC(e,t){const n=Y(e);if(!n.currentUser.isEqual(t)){z(vc,"User change. New user:",t.toKey());const r=await Yg(n.localStore,t);n.currentUser=t,function(s,o){s.Vu.forEach(u=>{u.forEach(c=>{c.reject(new q(O.CANCELLED,o))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await ws(n,r.Bs)}}function aC(e,t){const n=Y(e),r=n.Eu.get(t);if(r&&r.lu)return rt().add(r.key);{let i=rt();const s=n.Tu.get(t);if(!s)return i;for(const o of s){const u=n.Pu.get(o);i=i.unionWith(u.view.tu)}return i}}function __(e){const t=Y(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=d_.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=aC.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=nC.bind(null,t),t.hu.J_=zb.bind(null,t.eventManager),t.hu.pu=Hb.bind(null,t.eventManager),t}function uC(e){const t=Y(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=rC.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=iC.bind(null,t),t}class Jo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Aa(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,n){return null}Fu(t,n){return null}vu(t){return fb(this.persistence,new lb,t.initialUser,this.serializer)}Du(t){return new Xg(lc.Vi,this.serializer)}bu(t){return new vb}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jo.provider={build:()=>new Jo};class lC extends Jo{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,n){lt(this.persistence.referenceDelegate instanceof Xo,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new KS(r,t.asyncQueue,n)}Du(t){const n=this.cacheSizeBytes!==void 0?ce.withCacheSize(this.cacheSizeBytes):ce.DEFAULT;return new Xg(r=>Xo.Vi(r,n),this.serializer)}}class gl{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Od(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oC.bind(null,this.syncEngine),await $b(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new jb}()}createDatastore(t){const n=Aa(t.databaseInfo.databaseId),r=function(s){return new Ib(s)}(t.databaseInfo);return function(s,o,u,c){return new Cb(s,o,u,c)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,o,u){return new xb(r,i,s,o,u)}(this.localStore,this.datastore,t.asyncQueue,n=>Od(this.syncEngine,n,0),function(){return Pd.C()?new Pd:new wb}())}createSyncEngine(t,n){return function(i,s,o,u,c,l,h){const d=new Qb(i,s,o,u,c,l);return h&&(d.fu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const s=Y(i);z(vr,"RemoteStore shutting down."),s.Ia.add(5),await vs(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}gl.provider={build:()=>new gl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):wn("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn="FirestoreClient";class cC{constructor(t,n,r,i,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=te.UNAUTHENTICATED,this.clientId=Yl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{z(zn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z(zn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new mn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=_c(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function gu(e,t){e.asyncQueue.verifyOperationInProgress(),z(zn,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Yg(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>{Ln("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{z("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Ln("Terminating Firestore due to IndexedDb database deletion failed",i)})}),e._offlineComponents=t}async function Fd(e,t){e.asyncQueue.verifyOperationInProgress();const n=await hC(e);z(zn,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>Vd(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>Vd(t.remoteStore,i)),e._onlineComponents=t}async function hC(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){z(zn,"Using user provided OfflineComponentProvider");try{await gu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===O.FAILED_PRECONDITION||i.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ln("Error using user provided cache. Falling back to memory cache: "+n),await gu(e,new Jo)}}else z(zn,"Using default OfflineComponentProvider"),await gu(e,new lC(void 0));return e._offlineComponents}async function v_(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(z(zn,"Using user provided OnlineComponentProvider"),await Fd(e,e._uninitializedComponentsProvider._online)):(z(zn,"Using default OnlineComponentProvider"),await Fd(e,new gl))),e._onlineComponents}function fC(e){return v_(e).then(t=>t.syncEngine)}async function w_(e){const t=await v_(e),n=t.eventManager;return n.onListen=Xb.bind(null,t.syncEngine),n.onUnlisten=Zb.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Yb.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=tC.bind(null,t.syncEngine),n}function dC(e,t,n={}){const r=new mn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new y_({next:p=>{h.Ou(),o.enqueueAndForget(()=>u_(s,d));const g=p.docs.has(u);!g&&p.fromCache?l.reject(new q(O.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new l_(rc(u.path),h,{includeMetadataChanges:!0,ka:!0});return a_(s,d)}(await w_(e),e.asyncQueue,t,n,r)),r.promise}function pC(e,t,n={}){const r=new mn;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,l){const h=new y_({next:p=>{h.Ou(),o.enqueueAndForget(()=>u_(s,d)),p.fromCache&&c.source==="server"?l.reject(new q(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new l_(u,h,{includeMetadataChanges:!0,ka:!0});return a_(s,d)}(await w_(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="firestore.googleapis.com",Ud=!0;class Bd{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new q(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=T_,this.ssl=Ud}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Ud;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Qg;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<GS)throw new q(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}xR("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=E_((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Sa{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Bd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new q(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Bd(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ER;switch(r.type){case"firstParty":return new RR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Ld.get(n);r&&(z("ComponentProvider","Removing Datastore"),Ld.delete(n),r.terminate())}(this),Promise.resolve()}}function mC(e,t,n,r={}){var i;e=En(e,Sa);const s=Kl(t),o=e._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),c=`${t}:${n}`;s&&(KA(`https://${c}`),JA("Firestore",!0)),o.host!==T_&&o.host!==c&&Ln("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!Uo(l,u)&&(e._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=te.MOCK_USER;else{h=QA(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new q(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new te(p)}e._authCredentials=new TR(new sg(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Kn(this.firestore,t,this._query)}}class Vt{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new On(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Vt(this.firestore,t,this._key)}toJSON(){return{type:Vt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(gs(n,Vt._jsonSchema))return new Vt(t,r||null,new G(gt.fromString(n.referencePath)))}}Vt._jsonSchemaVersion="firestore/documentReference/1.0",Vt._jsonSchema={type:kt("string",Vt._jsonSchemaVersion),referencePath:kt("string")};class On extends Kn{constructor(t,n,r){super(t,n,rc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Vt(this.firestore,null,new G(t))}withConverter(t){return new On(this.firestore,t,this._path)}}function A_(e,t,...n){if(e=yn(e),ag("collection","path",t),e instanceof Sa){const r=gt.fromString(t,...n);return Zf(r),new On(e,null,r)}{if(!(e instanceof Vt||e instanceof On))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(gt.fromString(t,...n));return Zf(r),new On(e.firestore,null,r)}}function I_(e,t,...n){if(e=yn(e),arguments.length===1&&(t=Yl.newId()),ag("doc","path",t),e instanceof Sa){const r=gt.fromString(t,...n);return Jf(r),new Vt(e,null,new G(r))}{if(!(e instanceof Vt||e instanceof On))throw new q(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(gt.fromString(t,...n));return Jf(r),new Vt(e.firestore,e instanceof On?e.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d="AsyncQueue";class qd{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Zg(this,"async_queue_retry"),this.oc=()=>{const r=mu();r&&z($d,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=t;const n=mu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const n=mu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new mn;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!ai(t))throw t;z($d,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const n=this._c.then(()=>(this.nc=!0,t().catch(r=>{throw this.tc=r,this.nc=!1,wn("INTERNAL UNHANDLED ERROR: ",jd(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(t,n,r){this.ac(),this.sc.indexOf(t)>-1&&(n=0);const i=gc.createAndSchedule(this,t,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&W(47125,{hc:jd(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const n of this.ec)if(n.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const n=this.ec.indexOf(t);this.ec.splice(n,1)}}function jd(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class Es extends Sa{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new qd,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new qd(t),this._firestoreClient=void 0,await t}}}function gC(e,t){const n=typeof e=="object"?e:uR(),r=typeof e=="string"?e:jo,i=rR(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=GA("firestore");s&&mC(i,...s)}return i}function Ec(e){if(e._terminated)throw new q(O.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||_C(e),e._firestoreClient}function _C(e){var t,n,r;const i=e._freezeSettings(),s=function(u,c,l,h){return new qR(u,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,E_(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new cC(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ce(Wt.fromBase64String(t))}catch(n){throw new q(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Ce(Wt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Ce._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(gs(t,Ce._jsonSchema))return Ce.fromBase64String(t.bytes)}}Ce._jsonSchemaVersion="firestore/bytes/1.0",Ce._jsonSchema={type:kt("string",Ce._jsonSchemaVersion),bytes:kt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new q(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new q(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new q(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return tt(this._lat,t._lat)||tt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ze._jsonSchemaVersion}}static fromJSON(t){if(gs(t,Ze._jsonSchema))return new Ze(t.latitude,t.longitude)}}Ze._jsonSchemaVersion="firestore/geoPoint/1.0",Ze._jsonSchema={type:kt("string",Ze._jsonSchemaVersion),latitude:kt("number"),longitude:kt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:tn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(gs(t,tn._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new tn(t.vectorValues);throw new q(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}tn._jsonSchemaVersion="firestore/vectorValue/1.0",tn._jsonSchema={type:kt("string",tn._jsonSchemaVersion),vectorValues:kt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=/^__.*__$/;class vC{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Wn(t,this.data,this.fieldMask,n,this.fieldTransforms):new _s(t,this.data,n,this.fieldTransforms)}}class R_{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Wn(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function S_(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W(40011,{Ec:e})}}class Ac{constructor(t,n,r,i,s,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new Ac(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.fc(t),i}gc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return Zo(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(S_(this.Ec)&&yC.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class wC{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Aa(t)}Dc(t,n,r,i=!1){return new Ac({Ec:t,methodName:n,bc:r,path:Gt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ic(e){const t=e._freezeSettings(),n=Aa(e._databaseId);return new wC(e._databaseId,!!t.ignoreUndefinedProperties,n)}function EC(e,t,n,r,i,s={}){const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);Rc("Data must be an object, but it was:",o,r);const u=b_(r,o);let c,l;if(s.merge)c=new Ae(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=_l(t,d,n);if(!o.contains(p))throw new q(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);P_(h,p)||h.push(p)}c=new Ae(h),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new vC(new he(u),c,l)}class Ca extends Tc{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Ca}}function TC(e,t,n,r){const i=e.Dc(1,t,n);Rc("Data must be an object, but it was:",i,r);const s=[],o=he.empty();Gn(r,(c,l)=>{const h=Sc(t,c,n);l=yn(l);const d=i.gc(h);if(l instanceof Ca)s.push(h);else{const p=Ts(l,d);p!=null&&(s.push(h),o.set(h,p))}});const u=new Ae(s);return new R_(o,u,i.fieldTransforms)}function AC(e,t,n,r,i,s){const o=e.Dc(1,t,n),u=[_l(t,r,n)],c=[i];if(s.length%2!=0)throw new q(O.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)u.push(_l(t,s[p])),c.push(s[p+1]);const l=[],h=he.empty();for(let p=u.length-1;p>=0;--p)if(!P_(l,u[p])){const g=u[p];let _=c[p];_=yn(_);const E=o.gc(g);if(_ instanceof Ca)l.push(g);else{const v=Ts(_,E);v!=null&&(l.push(g),h.set(g,v))}}const d=new Ae(l);return new R_(h,d,o.fieldTransforms)}function IC(e,t,n,r=!1){return Ts(n,e.Dc(r?4:3,t))}function Ts(e,t){if(C_(e=yn(e)))return Rc("Unsupported field value:",t,e),b_(e,t);if(e instanceof Tc)return function(r,i){if(!S_(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=Ts(u,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=yn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=wt.fromDate(r);return{timestampValue:Qo(i.serializer,s)}}if(r instanceof wt){const s=new wt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Qo(i.serializer,s)}}if(r instanceof Ze)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ce)return{bytesValue:qg(i.serializer,r._byteString)};if(r instanceof Vt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ac(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof tn)return function(o,u){return{mapValue:{fields:{[gg]:{stringValue:_g},[zo]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw u.wc("VectorValues must only contain numeric values.");return ic(u.serializer,l)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${pa(r)}`)}(e,t)}function b_(e,t){const n={};return cg(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Gn(e,(r,i)=>{const s=Ts(i,t.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function C_(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof wt||e instanceof Ze||e instanceof Ce||e instanceof Vt||e instanceof Tc||e instanceof tn)}function Rc(e,t,n){if(!C_(n)||!ug(n)){const r=pa(n);throw r==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function _l(e,t,n){if((t=yn(t))instanceof ba)return t._internalPath;if(typeof t=="string")return Sc(e,t);throw Zo("Field path arguments must be of type string or ",e,!1,void 0,n)}const RC=new RegExp("[~\\*/\\[\\]]");function Sc(e,t,n){if(t.search(RC)>=0)throw Zo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new ba(...t.split("."))._internalPath}catch{throw Zo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Zo(e,t,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${t}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new q(O.INVALID_ARGUMENT,u+e+c)}function P_(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new SC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(bc("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class SC extends x_{data(){return super.data()}}function bc(e,t){return typeof t=="string"?Sc(e,t):t instanceof ba?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new q(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cc{}class Pc extends Cc{}function CC(e,t,...n){let r=[];t instanceof Cc&&r.push(t),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof Vc).length,u=s.filter(c=>c instanceof xc).length;if(o>1||o>0&&u>0)throw new q(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class xc extends Pc{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new xc(t,n,r)}_apply(t){const n=this._parse(t);return V_(t._query,n),new Kn(t.firestore,t.converter,al(t._query,n))}_parse(t){const n=Ic(t.firestore);return function(s,o,u,c,l,h,d){let p;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Hd(d,h);const _=[];for(const E of d)_.push(zd(c,s,E));p={arrayValue:{values:_}}}else p=zd(c,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Hd(d,h),p=IC(u,o,d,h==="in"||h==="not-in");return Dt.create(l,h,p)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class Vc extends Cc{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new Vc(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Be.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)V_(o,c),o=al(o,c)}(t._query,n),new Kn(t.firestore,t.converter,al(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Nc extends Pc{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new Nc(t,n)}_apply(t){const n=function(i,s,o){if(i.startAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new q(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ls(s,o)}(t._query,this._field,this._direction);return new Kn(t.firestore,t.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ui(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function PC(e,t="asc"){const n=t,r=bc("orderBy",e);return Nc._create(r,n)}class Dc extends Pc{constructor(t,n,r){super(),this.type=t,this._limit=n,this._limitType=r}static _create(t,n,r){return new Dc(t,n,r)}_apply(t){return new Kn(t.firestore,t.converter,Go(t._query,this._limit,this._limitType))}}function xC(e){return VR("limit",e),Dc._create("limit",e,"F")}function zd(e,t,n){if(typeof(n=yn(n))=="string"){if(n==="")throw new q(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rg(t)&&n.indexOf("/")!==-1)throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(gt.fromString(n));if(!G.isDocumentKey(r))throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ad(e,new G(r))}if(n instanceof Vt)return ad(e,n._key);throw new q(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pa(n)}.`)}function Hd(e,t){if(!Array.isArray(e)||e.length===0)throw new q(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function V_(e,t){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new q(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class VC{convertValue(t,n="none"){switch(qn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ct(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes($n(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw W(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Gn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(t){var n,r,i;const s=(i=(r=(n=t.fields)===null||n===void 0?void 0:n[zo].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ct(o.doubleValue));return new tn(s)}convertGeoPoint(t){return new Ze(Ct(t.latitude),Ct(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=_a(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(os(t));default:return null}}convertTimestamp(t){const n=Bn(t);return new wt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=gt.fromString(t);lt(Kg(r),9688,{name:t});const i=new as(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||wn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(e,t,n){let r;return r=e?e.toFirestore(t):t,r}class Ui{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class fr extends x_{constructor(t,n,r,i,s,o){super(t,n,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new fo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(bc("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=fr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}fr._jsonSchemaVersion="firestore/documentSnapshot/1.0",fr._jsonSchema={type:kt("string",fr._jsonSchemaVersion),bundleSource:kt("string","DocumentSnapshot"),bundleName:kt("string"),bundle:kt("string")};class fo extends fr{data(t={}){return super.data(t)}}class qr{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ui(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new fo(this._firestore,this._userDataWriter,r.key,r,new Ui(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new fo(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ui(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new fo(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ui(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return u.type!==0&&(l=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),h=o.indexOf(u.doc.key)),{type:DC(u.type),doc:c,oldIndex:l,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=qr._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Yl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function DC(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W(61501,{type:e})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(e){e=En(e,Vt);const t=En(e.firestore,Es);return dC(Ec(t),e._key).then(n=>MC(t,e,n))}qr._jsonSchemaVersion="firestore/querySnapshot/1.0",qr._jsonSchema={type:kt("string",qr._jsonSchemaVersion),bundleSource:kt("string","QuerySnapshot"),bundleName:kt("string"),bundle:kt("string")};class D_ extends VC{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ce(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Vt(this.firestore,null,n)}}function k_(e){e=En(e,Kn);const t=En(e.firestore,Es),n=Ec(t),r=new D_(t);return bC(e._query),pC(n,e._query).then(i=>new qr(t,r,e,i))}function kC(e,t,n){e=En(e,Vt);const r=En(e.firestore,Es),i=NC(e.converter,t);return O_(r,[EC(Ic(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,Ye.none())])}function OC(e,t,n,...r){e=En(e,Vt);const i=En(e.firestore,Es),s=Ic(i);let o;return o=typeof(t=yn(t))=="string"||t instanceof ba?AC(s,"updateDoc",e._key,t,n,r):TC(s,"updateDoc",e._key,t),O_(i,[o.toMutation(e._key,Ye.exists(!0))])}function O_(e,t){return function(r,i){const s=new mn;return r.asyncQueue.enqueueAndForget(async()=>eC(await fC(r),i,s)),s.promise}(Ec(e),t)}function MC(e,t,n){const r=n.docs.get(t._key),i=new D_(e);return new fr(e,i,t._key,r,new Ui(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){si=i})(aR),$o(new rs("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new Es(new AR(r.getProvider("auth-internal")),new SR(o,r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new q(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new as(l.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Br(Wf,Kf,t),Br(Wf,Kf,"esm2017")})();const FC={apiKey:"AIzaSyAZsdXZU6WbM33SaKP5PoYm7G0V2ABYUSU",authDomain:"great-wave-everywhere.firebaseapp.com",projectId:"great-wave-everywhere",storageBucket:"great-wave-everywhere.firebasestorage.app",messagingSenderId:"636756607685",appId:"1:636756607685:web:2199075bc12821f89466ac",measurementId:"G-XRVYGKFWJ8"},LC=Qm(FC),Pa=gC(LC);async function UC(e){const t=I_(Pa,"words",e.toLowerCase()),n=await N_(t);n.exists()?await OC(t,{count:n.data().count+1}):await kC(t,{count:1})}async function Gd(){return(await k_(A_(Pa,"words"))).docs.map(t=>({id:t.id,count:t.data().count}))}async function Wd(e=5){const t=CC(A_(Pa,"words"),PC("count","desc"),xC(e));return(await k_(t)).docs.map(r=>({id:r.id,count:r.data().count}))}async function BC(e){const t=I_(Pa,"words",e.toLowerCase()),n=await N_(t);return console.log("fetchImagesForWord:",{word:e,ref:t,exists:n.exists(),data:n.data()}),n.exists()?n.data().images||[]:[]}var $C=Hn('<div class="loading-indicator svelte-vuoyhd">Loading...</div>'),qC=Hn('<img alt="Header image"/>'),jC=(e,t)=>{e.key==="Enter"&&t()},zC=ei('<path fill="#ADC2CE" stroke="#377293" stroke-width="0.5"></path>'),HC=(e,t,n,r)=>{et(t,B(n).domain,!0),et(r,B(n).city||B(n).country||"Unknown location",!0)},GC=(e,t,n)=>{et(t,null),et(n,"")},WC=ei('<g class="location-pin svelte-vuoyhd"><circle class="pin svelte-vuoyhd"></circle></g>'),KC=ei(" <!>",1),QC=ei('<svg width="200" height="125" viewBox="0 0 200 125" class="world-map svelte-vuoyhd"><!><!></svg>'),XC=Hn('<span style="color: #377293; font-weight: bold; font-size: 0.95rem;"> </span>'),YC=(e,t,n,r,i,s)=>{et(t,n(B(r).link),!0);const o=B(i).find(u=>u.domain===B(t));et(s,o?o.city||o.country||o.domain||"Unknown location":B(t)||"Unknown location",!0),console.log("Hovered Domain:",B(t))},JC=(e,t,n)=>{et(t,null),et(n,"")},ZC=Hn('<div class="image-with-title svelte-vuoyhd"><a target="_blank" rel="noopener noreferrer"><img style="" class="svelte-vuoyhd"/></a> <div class="image-title-box"><!></div></div>'),tP=Hn('<div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;"><span style="color: #377293; font-weight: bold; font-size: 0.95rem;">Hover for image server locations:</span> <!></div> <div class="image-container svelte-vuoyhd"></div>',1),eP=Hn(`<div class="no-images-placeholder svelte-vuoyhd"><p>Enter a search term above to query Google Images for "Great Wave off
            Kanagawa + [your search term]." Your search results will appear
            here.</p></div>`),nP=ei('<line stroke="#fff" stroke-opacity="0.6" stroke-width="2" class="svelte-vuoyhd"></line>'),rP=(e,t,n)=>t(B(n).id),iP=ei('<text fill="steelblue" text-anchor="middle" alignment-baseline="middle" filter="url(#dropshadow)" style="cursor: pointer;" class="svelte-vuoyhd"> </text>'),sP=Hn('<li class="svelte-vuoyhd"> <span class="count svelte-vuoyhd"> </span></li>'),oP=Hn(`<main class="svelte-vuoyhd"><!>  <div class="header svelte-vuoyhd"><div class="header-image-crossfade svelte-vuoyhd"></div> <div><div class="title svelte-vuoyhd">GREAT WAVE <span style="color: #F0BF91;">REMIX</span></div> <p class="subtitle svelte-vuoyhd">Discover Hokusai's "Great Wave off Kanagawa" in unexpected contexts
        worldwide. Search Google Images for any term you associate with this
        iconic Japanese artwork to see how it has been reimagined in formats
        spanning diverse topics and cultures.</p></div></div> <div class="header-piping svelte-vuoyhd"></div> <h1 class="svelte-vuoyhd">HOKUSAI'S <em class="italic svelte-vuoyhd">GREAT WAVE</em> CAN BE <input type="text" placeholder="ANYTHING" class="svelte-vuoyhd"/> <div class="search-container svelte-vuoyhd"><div class="button-wrapper svelte-vuoyhd"><button class="svelte-vuoyhd">Remix</button></div> <div class="call-to-action svelte-vuoyhd">No images yet â enter a search term!</div></div></h1> <div class="main-grid svelte-vuoyhd"><div class="left-column svelte-vuoyhd"><div class="map-container svelte-vuoyhd"><!></div> <!> <!></div> <div class="right-column svelte-vuoyhd"><div class="word-cloud-container svelte-vuoyhd"><div class="call-to-action svelte-vuoyhd">Or click on a trending topic!</div> <svg width="120%" height="400" viewBox="0 0 480 400" class="svelte-vuoyhd"><defs><filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.3"></feDropShadow></filter></defs><g style="transform: translate(0, -100px)"><!><!></g></svg> <div class="trending-panel svelte-vuoyhd"><ul class="svelte-vuoyhd"></ul></div></div></div></div> <div style="max-width: 700px; text-align: left; color: #377293; padding-top: 5rem;"><h2 class="svelte-vuoyhd">Google Ngram Viewer shows a steady rise in mentions of "Great Wave off
      Kanagawa"</h2> The exponential-like rise in frequency of the phrase âGreat Wave off Kanagawaâ
    in Google Books (millions of published books) shows that references to the artwork
    are appearing dramatically more frequently over time.</div> <div class="bottom-panel svelte-vuoyhd"><div class="chart-container svelte-vuoyhd"><iframe name="ngram_chart" src="https://books.google.com/ngrams/interactive_chart?content=Great+Wave+off+Kanagawa&amp;year_start=1900&amp;year_end=2022&amp;corpus=en&amp;smoothing=3" width="900" height="400" marginwidth="50" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" class="svelte-vuoyhd"></iframe></div></div></main>`);function aP(e,t){sp(t,!0);let n=Mt(0),r;const i=["/great-wave-everywhere/main-image.jpeg","/great-wave-everywhere/Hokusai-Great_Wave_off_Kanagawa-cat-end.jpg","/great-wave-everywhere/tomoko_nagao_hokusai-the_great_wave_of_kanagawa_with_mc_cupnoodle_kewpie_kikkoman_and_kitty_2012_digital_art_50_x_70_cm-_70_x_100_cm.jpe_3.jpg","/great-wave-everywhere/135e9cb8ff232a9c7e1f1be108eb670f.jpg","/great-wave-everywhere/2372ef58832305.5a0b25df284b7.jpg.webp","/great-wave-everywhere/image_BT0qjFvT31.png.jpeg"];Eu(()=>{r=setInterval(()=>{et(n,(B(n)+1)%i.length)},5e3)}),Iv(()=>{clearInterval(r)});async function s(H){et(l,await BC(H),!0),et(h,"");const j=B(l).map(nt=>nt.link).filter(Boolean);let K=[];if(j.length>0)try{K=(await At.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:j})).data}catch{}et(E,K.filter(nt=>{if(nt==null)return!1;const yt=Number(nt.lat),bt=Number(nt.lng);return!(isNaN(yt)||isNaN(bt)||yt===0&&bt===0)}),!0)}function o(H){if(!H)return null;try{return H.replace(/^https?:\/\//,"").split("?")[0].replace(/\/$/,"")}catch{return null}}function u(H){if(!H)return null;try{const j=H.startsWith("http")?H:`https://${H}`;return new URL(j).hostname}catch{return H}}let c=Mt(null),l=Mt(He([])),h=Mt(""),d=Mt(He([])),p=Mt(He([])),g=Mt(He([])),_=Mt(!1),E=Mt(He([])),v=Mt(null),b=Mt("");async function C(){try{const H=await fetch("/great-wave-everywhere/ne_110m_admin_0_countries.json");if(!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const j=await H.json(),K=Object.keys(j.objects)[0];et(v,Df(j,j.objects[K]),!0)}catch{try{const j=await fetch("/ne_110m_admin_0_countries.json");if(j.ok){const K=await j.json(),nt=Object.keys(K.objects)[0];et(v,Df(K,K.objects[nt]),!0)}}catch{}}}Eu(async()=>{et(_,!0);try{try{et(d,await Gd(),!0),et(g,await Wd(5),!0),x(),M()}catch(H){console.warn("Firebase connection failed:",H),et(d,[],!0),et(g,[],!0)}await C()}finally{et(_,!1)}});async function N(){if(B(h)){et(_,!0);try{const H=await At.get(`https://great-wave-api-1muq.onrender.com/api/images?q=${B(h)}`);et(l,H.data,!0);const j=B(l).map(nt=>nt.link).filter(Boolean);let K=[];if(j.length>0)try{K=(await At.post("https://great-wave-api-1muq.onrender.com/api/geolocate",{urls:j})).data,console.log("Geolocation API data:",K)}catch{}et(E,K.filter(nt=>{if(nt==null)return!1;const yt=Number(nt.lat),bt=Number(nt.lng);return!(isNaN(yt)||isNaN(bt)||yt===0&&bt===0)}),!0);try{await UC(B(h)),et(d,await Gd(),!0),et(g,await Wd(5),!0),x(),M()}catch(nt){console.warn("Firebase update failed:",nt)}et(h,"")}catch(H){console.error("Error fetching images",H)}finally{et(_,!1)}}}function x(){et(p,[],!0);for(let H=1;H<B(d).length;H++)B(p).push({source:B(d)[H-1].id,target:B(d)[H].id})}function M(){const H=Math.max(...B(d).map(j=>j.count));H1(B(d)).force("link",F1(B(p)).id(j=>j.id).distance(25)).force("charge",G1().strength(-100)).force("center",v1(200,300)).force("gravity",W1(j=>150*(1-j.count/H),200,300).strength(.5)).force("boundary",()=>{B(d).forEach(j=>{j.x=Math.max(20,Math.min(380,j.x||0)),j.y=Math.max(20,Math.min(580,j.y||0))})}).on("tick",()=>{et(d,[...B(d)],!0)})}function U(H){return B(d).find(j=>j.id===H)}function I(H){const j=U(H.source),K=U(H.target);return{x1:(j==null?void 0:j.x)||0,y1:(j==null?void 0:j.y)||0,x2:(K==null?void 0:K.x)||0,y2:(K==null?void 0:K.y)||0}}var w=oP(),T=Tt(w);{var S=H=>{var j=$C();$t(H,j)};ln(T,H=>{B(_)&&H(S)})}var R=Bt(T,2),P=Tt(R);ir(P,21,()=>i,rr,(H,j,K)=>{var nt=qC();let yt;Fe(bt=>{ie(nt,"src",B(j)),yt=_v(nt,1,"svelte-vuoyhd",null,yt,bt)},[()=>({visible:B(n)===K,hidden:B(n)!==K})]),$t(H,nt)});var A=Bt(R,4),X=Bt(Tt(A),3);X.__keydown=[jC,N];var L=Bt(X,2),J=Tt(L),ct=Tt(J);ct.__click=N;var _t=Bt(A,2),Ot=Tt(_t),ke=Tt(Ot),ge=Tt(ke);{var Lt=H=>{var j=QC();const K=Us(()=>VA().scale(40).translate([100,62.5])),nt=Us(()=>vA().projection(B(K)));var yt=Tt(j);ir(yt,17,()=>B(v).features,rr,(Ut,Qt,_e)=>{var ye=Ya();const ft=Us(()=>B(nt)(B(Qt)));var Rt=Ri(ye);{var Re=Oe=>{var on=zC();Fe(()=>ie(on,"d",B(ft))),$t(Oe,on)},Xn=Oe=>{var on=ov();Fe(Xt=>xr(on,Xt),[()=>{var Xt;return console.log(`No path data for country ${_e}:`,(Xt=B(Qt).geometry)==null?void 0:Xt.type)}]),$t(Oe,on)};ln(Rt,Oe=>{B(ft)?Oe(Re):Oe(Xn,!1)})}$t(Ut,ye)});var bt=Bt(yt);{var Kt=Ut=>{var Qt=Ya(),_e=Ri(Qt);ir(_e,17,()=>B(E),rr,(ye,ft)=>{var Rt=KC();const Re=Us(()=>B(K)([B(ft).lng,B(ft).lat]));var Xn=Ri(Rt),Oe=Bt(Xn);{var on=Xt=>{var Yn=WC();Yn.__mouseover=[HC,c,ft,b],Yn.__mouseout=[GC,c,b];var Jn=Tt(Yn);Fe(()=>{ie(Jn,"cx",B(Re)[0]),ie(Jn,"cy",B(Re)[1]),ie(Jn,"r",B(c)===B(ft).domain?7:4),ie(Jn,"fill",B(c)===B(ft).domain?"#ff4500":"#ff6b35")}),$t(Xt,Yn)};ln(Oe,Xt=>{B(Re)&&Xt(on)})}Fe(Xt=>xr(Xn,Xt),[()=>console.log(B(ft))]),$t(ye,Rt)}),$t(Ut,Qt)};ln(bt,Ut=>{B(E).length>0&&Ut(Kt)})}$t(H,j)};ln(ge,H=>{B(l).length>0&&B(v)&&H(Lt)})}var ht=Bt(ke,2);{var In=H=>{var j=tP(),K=Ri(j),nt=Bt(Tt(K),2);{var yt=Kt=>{var Ut=XC(),Qt=Tt(Ut);Fe(()=>xr(Qt,B(b))),$t(Kt,Ut)};ln(nt,Kt=>{B(b)&&Kt(yt)})}var bt=Bt(K,2);ir(bt,21,()=>B(l),rr,(Kt,Ut)=>{var Qt=ZC(),_e=Tt(Qt),ye=Tt(_e);ye.__mouseover=[YC,c,u,Ut,E,b],ye.__mouseout=[JC,c,b];var ft=Bt(_e,2),Rt=Tt(ft);pv(Rt,()=>`<textarea readonly rows='2'>${B(Ut).title}</textarea>`),Fe(Re=>{ie(_e,"href",B(Ut).link),ie(ye,"src",B(Ut).link),yv(ft,`background: ${Re??""};`)},[()=>B(c)===o(B(Ut).link)?"#ffe5d0":"#f9f9f9"]),$t(Kt,Qt)}),$t(H,j)};ln(ht,H=>{B(l).length>0&&H(In)})}var ue=Bt(ht,2);{var xa=H=>{var j=eP();$t(H,j)};ln(ue,H=>{B(l).length===0&&H(xa)})}var Ir=Bt(Ot,2),Va=Tt(Ir),As=Bt(Tt(Va),2),Rr=Bt(Tt(As)),Qn=Tt(Rr);ir(Qn,17,()=>B(p),rr,(H,j)=>{var K=Ya(),nt=Ri(K);{var yt=bt=>{var Kt=nP();Fe((Ut,Qt,_e,ye)=>{ie(Kt,"x1",Ut),ie(Kt,"y1",Qt),ie(Kt,"x2",_e),ie(Kt,"y2",ye)},[()=>I(B(j)).x1,()=>I(B(j)).y1,()=>I(B(j)).x2,()=>I(B(j)).y2]),$t(bt,Kt)};ln(nt,bt=>{U(B(j).source)&&U(B(j).target)&&bt(yt)})}$t(H,K)});var ci=Bt(Qn);ir(ci,17,()=>B(d),rr,(H,j)=>{var K=iP();K.__click=[rP,s,j],K.__mouseover=yt=>{yt.target.style.fill="#ff6b35",yt.target.style.cursor="pointer"},K.__mouseout=yt=>{yt.target.style.fill="steelblue"};var nt=Tt(K);Fe(()=>{ie(K,"x",B(j).x),ie(K,"y",B(j).y),ie(K,"font-size",`${8+B(j).count}px`),xr(nt,B(j).id)}),$t(H,K)});var hi=Bt(As,2),fi=Tt(hi);ir(fi,21,()=>B(g),rr,(H,j)=>{var K=sP(),nt=Tt(K),yt=Bt(nt),bt=Tt(yt);Fe(()=>{xr(nt,`${B(j).id??""} `),xr(bt,`(${B(j).count??""})`)}),$t(H,K)}),Av(X,()=>B(h),H=>et(h,H)),$t(e,w),op()}iv(["keydown","click","mouseover","mouseout"]);av(aP,{target:document.getElementById("app")});
